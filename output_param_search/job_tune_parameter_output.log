[32m[I 2025-06-28 00:56:49,033][0m A new study created in memory with name: no-name-0ffa944b-a0a6-453e-baf5-0c3625101c6a[0m

Running on: cia011
Can see data? True 

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/28
----------
train Loss: 0.6766 Acc: 0.2871
val Loss: 0.6488 Acc: 0.3864
Epoch 2/28
----------
train Loss: 0.6177 Acc: 0.4450
val Loss: 0.6173 Acc: 0.5000
Epoch 3/28
----------
train Loss: 0.5793 Acc: 0.4833
val Loss: 0.5824 Acc: 0.5682
Epoch 4/28
----------
train Loss: 0.5553 Acc: 0.4880
val Loss: 0.5688 Acc: 0.5909
Epoch 5/28
----------
train Loss: 0.5431 Acc: 0.4833
val Loss: 0.5606 Acc: 0.6136
Epoch 6/28
----------
train Loss: 0.5313 Acc: 0.5024
val Loss: 0.5485 Acc: 0.6136
Epoch 7/28
----------
train Loss: 0.5182 Acc: 0.4928
val Loss: 0.5348 Acc: 0.6136
Epoch 8/28
----------
train Loss: 0.5188 Acc: 0.4976
val Loss: 0.5257 Acc: 0.6136
Epoch 9/28
----------
train Loss: 0.5123 Acc: 0.4976
val Loss: 0.5174 Acc: 0.6364
Epoch 10/28
----------
train Loss: 0.4998 Acc: 0.5024
val Loss: 0.5064 Acc: 0.6364
Epoch 11/28
----------
train Loss: 0.4987 Acc: 0.4976
val Loss: 0.5028 Acc: 0.6364
Epoch 12/28
----------
train Loss: 0.4988 Acc: 0.4928
val Loss: 0.5160 Acc: 0.6591
Epoch 13/28
----------
train Loss: 0.4924 Acc: 0.5024
val Loss: 0.4895 Acc: 0.6364
Epoch 14/28
----------
train Loss: 0.4810 Acc: 0.5120
val Loss: 0.4766 Acc: 0.6364
Epoch 15/28
----------
train Loss: 0.4888 Acc: 0.4976
val Loss: 0.4739 Acc: 0.6591
Epoch 16/28
----------
train Loss: 0.4836 Acc: 0.5024
val Loss: 0.4732 Acc: 0.6591
Epoch 17/28
----------
train Loss: 0.4764 Acc: 0.4976
val Loss: 0.4819 Acc: 0.6591
Epoch 18/28
----------
train Loss: 0.4685 Acc: 0.5072
val Loss: 0.4858 Acc: 0.6591
Epoch 19/28
----------
train Loss: 0.4642 Acc: 0.5120
val Loss: 0.4839 Acc: 0.6818
Epoch 20/28
----------
train Loss: 0.4667 Acc: 0.5024
val Loss: 0.4669 Acc: 0.6364
Epoch 21/28
----------
train Loss: 0.4638 Acc: 0.5215
val Loss: 0.4582 Acc: 0.6818
Epoch 22/28
----------
train Loss: 0.4568 Acc: 0.5407
val Loss: 0.4520 Acc: 0.7045
Epoch 23/28
----------
train Loss: 0.4527 Acc: 0.5263
val Loss: 0.4514 Acc: 0.7045
Epoch 24/28
----------
train Loss: 0.4422 Acc: 0.5455
val Loss: 0.4392 Acc: 0.7045
Epoch 25/28
----------
train Loss: 0.4481 Acc: 0.5407
val Loss: 0.4593 Acc: 0.7500
Epoch 26/28
----------
train Loss: 0.4511 Acc: 0.5359
val Loss: 0.4688 Acc: 0.7273
Epoch 27/28
----------
train Loss: 0.4262 Acc: 0.6077
val Loss: 0.4741 Acc: 0.7500
Epoch 28/28
----------
train Loss: 0.4548 Acc: 0.5502
[32m[I 2025-06-28 01:03:12,508][0m Trial 0 finished with value: 0.7272727272727273 and parameters: {'batch_size': 12, 'lr': 0.0002221064413587264, 'num_epochs': 28, 'weight_decay': 0.1641897258814206, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 0 with value: 0.7272727272727273.[0m
val Loss: 0.4700 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_0.0002221064413587264_epoch_28_wd_0.1641897258814206_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/33
----------
train Loss: 3.8378 Acc: 0.2201
val Loss: 3.7199 Acc: 0.1591
Epoch 2/33
----------
train Loss: 3.8156 Acc: 0.2201
val Loss: 3.7236 Acc: 0.2045
Epoch 3/33
----------
train Loss: 3.7947 Acc: 0.2105
val Loss: 3.6912 Acc: 0.1591
Epoch 4/33
----------
train Loss: 3.8051 Acc: 0.2105
val Loss: 3.6954 Acc: 0.1591
Epoch 5/33
----------
train Loss: 3.8213 Acc: 0.1818
val Loss: 3.7151 Acc: 0.1818
Epoch 6/33
----------
train Loss: 3.8048 Acc: 0.2105
val Loss: 3.7173 Acc: 0.2045
Epoch 7/33
----------
train Loss: 3.8051 Acc: 0.1962
val Loss: 3.7101 Acc: 0.2045
Epoch 8/33
----------
train Loss: 3.7799 Acc: 0.2057
val Loss: 3.7213 Acc: 0.2273
Epoch 9/33
----------
train Loss: 3.7921 Acc: 0.2488
val Loss: 3.7165 Acc: 0.1818
Epoch 10/33
----------
train Loss: 3.7632 Acc: 0.2010
val Loss: 3.7177 Acc: 0.1818
Epoch 11/33
----------
train Loss: 3.7739 Acc: 0.2153
val Loss: 3.7153 Acc: 0.1818
Epoch 12/33
----------
train Loss: 3.7714 Acc: 0.2105
val Loss: 3.7103 Acc: 0.1818
Epoch 13/33
----------
train Loss: 3.7504 Acc: 0.2440
val Loss: 3.6969 Acc: 0.2045
Epoch 14/33
----------
train Loss: 3.7544 Acc: 0.2153
val Loss: 3.6964 Acc: 0.2045
Epoch 15/33
----------
train Loss: 3.7330 Acc: 0.2919
val Loss: 3.7057 Acc: 0.1818
Epoch 16/33
----------
train Loss: 3.7238 Acc: 0.2440
val Loss: 3.6728 Acc: 0.2273
Epoch 17/33
----------
train Loss: 3.7351 Acc: 0.2201
val Loss: 3.6857 Acc: 0.2045
Epoch 18/33
----------
train Loss: 3.7492 Acc: 0.2440
val Loss: 3.6764 Acc: 0.2045
Epoch 19/33
----------
train Loss: 3.7177 Acc: 0.2584
val Loss: 3.6648 Acc: 0.2273
Epoch 20/33
----------
train Loss: 3.7049 Acc: 0.2536
val Loss: 3.6674 Acc: 0.2045
Epoch 21/33
----------
train Loss: 3.7044 Acc: 0.2488
val Loss: 3.6651 Acc: 0.2500
Epoch 22/33
----------
train Loss: 3.7170 Acc: 0.2201
val Loss: 3.6671 Acc: 0.2500
Epoch 23/33
----------
train Loss: 3.6941 Acc: 0.2201
val Loss: 3.6568 Acc: 0.2273
Epoch 24/33
----------
train Loss: 3.6746 Acc: 0.3014
val Loss: 3.6342 Acc: 0.2273
Epoch 25/33
----------
train Loss: 3.6843 Acc: 0.3301
val Loss: 3.6476 Acc: 0.2500
Epoch 26/33
----------
train Loss: 3.6832 Acc: 0.2679
val Loss: 3.6522 Acc: 0.2273
Epoch 27/33
----------
train Loss: 3.6776 Acc: 0.2679
val Loss: 3.6263 Acc: 0.2273
Epoch 28/33
----------
train Loss: 3.6988 Acc: 0.2440
val Loss: 3.6217 Acc: 0.2500
Epoch 29/33
----------
train Loss: 3.6769 Acc: 0.2727
val Loss: 3.6284 Acc: 0.2273
Epoch 30/33
----------
train Loss: 3.6822 Acc: 0.2679
val Loss: 3.6235 Acc: 0.2500
Epoch 31/33
----------
train Loss: 3.6443 Acc: 0.2584
val Loss: 3.6105 Acc: 0.2500
Epoch 32/33
----------
train Loss: 3.6449 Acc: 0.3301
val Loss: 3.6184 Acc: 0.2273
Epoch 33/33
----------
train Loss: 3.6468 Acc: 0.2153
[32m[I 2025-06-28 01:10:42,584][0m Trial 1 finished with value: 0.2272727272727273 and parameters: {'batch_size': 77, 'lr': 1.9243179174413076e-06, 'num_epochs': 33, 'weight_decay': 0.010196778021513905, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 0 with value: 0.7272727272727273.[0m
val Loss: 3.6174 Acc: 0.2273
Best val Acc: 0.227273

Model weights saved at ./model_weights/efficientnetb0_bs_77_lr_1.9243179174413076e-06_epoch_33_wd_0.010196778021513905_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 1.1807 Acc: 0.5024
val Loss: 2.9241 Acc: 0.1364
Epoch 2/95
----------
train Loss: 0.9658 Acc: 0.6124
val Loss: 2.2130 Acc: 0.1364
Epoch 3/95
----------
train Loss: 1.3044 Acc: 0.5646
val Loss: 2.0074 Acc: 0.1364
Epoch 4/95
----------
train Loss: 1.3159 Acc: 0.4928
val Loss: 1.4360 Acc: 0.1364
Epoch 5/95
----------
train Loss: 1.1085 Acc: 0.5024
val Loss: 1.3774 Acc: 0.1364
Epoch 6/95
----------
train Loss: 1.3505 Acc: 0.4306
val Loss: 1.0680 Acc: 0.6364
Epoch 7/95
----------
train Loss: 1.2670 Acc: 0.4880
val Loss: 1.8721 Acc: 0.0909
Epoch 8/95
----------
train Loss: 1.2258 Acc: 0.5263
val Loss: 1.1931 Acc: 0.6364
Epoch 9/95
----------
train Loss: 1.2469 Acc: 0.4976
val Loss: 1.5056 Acc: 0.1364
Epoch 10/95
----------
train Loss: 1.4751 Acc: 0.4306
val Loss: 1.0894 Acc: 0.6364
Epoch 11/95
----------
train Loss: 1.2799 Acc: 0.5120
val Loss: 1.1517 Acc: 0.6364
Epoch 12/95
----------
train Loss: 1.3247 Acc: 0.4402
val Loss: 1.1759 Acc: 0.6364
Epoch 13/95
----------
train Loss: 1.2845 Acc: 0.4880
val Loss: 1.7552 Acc: 0.1364
Epoch 14/95
----------
train Loss: 1.2637 Acc: 0.5072
val Loss: 2.8478 Acc: 0.6364
Epoch 15/95
----------
train Loss: 1.2705 Acc: 0.4880
val Loss: 1.3191 Acc: 0.5682
Epoch 16/95
----------
train Loss: 1.2820 Acc: 0.4785
val Loss: 1.1712 Acc: 0.6364
Epoch 17/95
----------
train Loss: 1.2643 Acc: 0.4880
val Loss: 1.6336 Acc: 0.1364
Epoch 18/95
----------
train Loss: 1.2561 Acc: 0.4928
val Loss: 1.3193 Acc: 0.6364
Epoch 19/95
----------
train Loss: 1.2484 Acc: 0.4880
val Loss: 1.3662 Acc: 0.1364
Epoch 20/95
----------
train Loss: 1.2730 Acc: 0.4928
val Loss: 1.1289 Acc: 0.6364
Epoch 21/95
----------
train Loss: 1.2529 Acc: 0.4689
val Loss: 1.2835 Acc: 0.6364
Epoch 22/95
----------
train Loss: 1.2999 Acc: 0.4737
val Loss: 1.8491 Acc: 0.6364
Epoch 23/95
----------
train Loss: 1.2502 Acc: 0.4976
val Loss: 1.5386 Acc: 0.1364
Epoch 24/95
----------
train Loss: 1.2605 Acc: 0.4833
val Loss: 12.6231 Acc: 0.6364
Epoch 25/95
----------
train Loss: 1.2494 Acc: 0.4976
val Loss: 1.1852 Acc: 0.6364
Epoch 26/95
----------
train Loss: 1.2577 Acc: 0.4928
val Loss: 1.4098 Acc: 0.1364
Epoch 27/95
----------
train Loss: 1.2819 Acc: 0.4689
val Loss: 8.8788 Acc: 0.6364
Epoch 28/95
----------
train Loss: 1.2659 Acc: 0.4976
val Loss: 1.4021 Acc: 0.1364
Epoch 29/95
----------
train Loss: 1.2549 Acc: 0.4928
val Loss: 1.0742 Acc: 0.6364
Epoch 30/95
----------
train Loss: 1.2805 Acc: 0.4928
val Loss: 1.1960 Acc: 0.6364
Epoch 31/95
----------
train Loss: 1.2271 Acc: 0.4833
val Loss: 1.1087 Acc: 0.6364
Epoch 32/95
----------
train Loss: 1.2513 Acc: 0.4976
val Loss: 1.1746 Acc: 0.6364
Epoch 33/95
----------
train Loss: 1.2624 Acc: 0.4976
val Loss: 1.0760 Acc: 0.6364
Epoch 34/95
----------
train Loss: 1.2631 Acc: 0.4833
val Loss: 1.1596 Acc: 0.6364
Epoch 35/95
----------
train Loss: 1.2417 Acc: 0.4928
val Loss: 1.0768 Acc: 0.6364
Epoch 36/95
----------
train Loss: 1.2315 Acc: 0.4976
val Loss: 1.4413 Acc: 0.2273
Epoch 37/95
----------
train Loss: 1.2663 Acc: 0.4354
val Loss: 1.6957 Acc: 0.6364
Epoch 38/95
----------
train Loss: 1.2520 Acc: 0.4833
val Loss: 1.3330 Acc: 0.2045
Epoch 39/95
----------
train Loss: 1.2175 Acc: 0.4785
val Loss: 1.2219 Acc: 0.6364
Epoch 40/95
----------
train Loss: 1.2491 Acc: 0.4976
val Loss: 1.2407 Acc: 0.6364
Epoch 41/95
----------
train Loss: 1.2420 Acc: 0.4976
val Loss: 1.0854 Acc: 0.6364
Epoch 42/95
----------
train Loss: 1.2544 Acc: 0.4976
val Loss: 82.6045 Acc: 0.0909
Epoch 43/95
----------
train Loss: 1.2568 Acc: 0.4737
val Loss: 1.0503 Acc: 0.6591
Epoch 44/95
----------
train Loss: 1.2691 Acc: 0.4880
val Loss: 1.3441 Acc: 0.6364
Epoch 45/95
----------
train Loss: 1.2475 Acc: 0.4737
val Loss: 1.0784 Acc: 0.6364
Epoch 46/95
----------
train Loss: 1.2376 Acc: 0.4928
val Loss: 1.1043 Acc: 0.6364
Epoch 47/95
----------
train Loss: 1.2445 Acc: 0.4976
val Loss: 1.1190 Acc: 0.6364
Epoch 48/95
----------
train Loss: 1.2340 Acc: 0.4880
val Loss: 1.1060 Acc: 0.6364
Epoch 49/95
----------
train Loss: 1.2587 Acc: 0.4976
val Loss: 1.0531 Acc: 0.6364
Epoch 50/95
----------
train Loss: 1.2437 Acc: 0.4976
val Loss: 1.2374 Acc: 0.6364
Epoch 51/95
----------
train Loss: 1.2305 Acc: 0.4976
val Loss: 1.0721 Acc: 0.6364
Epoch 52/95
----------
train Loss: 1.2544 Acc: 0.4880
val Loss: 1.1103 Acc: 0.6364
Epoch 53/95
----------
train Loss: 1.2328 Acc: 0.4880
val Loss: 1.0587 Acc: 0.6364
Epoch 54/95
----------
train Loss: 1.2118 Acc: 0.5167
val Loss: 1.0568 Acc: 0.6364
Epoch 55/95
----------
train Loss: 1.2356 Acc: 0.4737
val Loss: 1.1353 Acc: 0.6364
Epoch 56/95
----------
train Loss: 1.2246 Acc: 0.4880
val Loss: 1.0740 Acc: 0.6364
Epoch 57/95
----------
train Loss: 1.2265 Acc: 0.4976
val Loss: 1.0749 Acc: 0.6364
Epoch 58/95
----------
train Loss: 1.2451 Acc: 0.4928
val Loss: 1.0585 Acc: 0.6364
Epoch 59/95
----------
train Loss: 1.2461 Acc: 0.4976
val Loss: 1.1019 Acc: 0.6364
Epoch 60/95
----------
train Loss: 1.2337 Acc: 0.5024
val Loss: 1.0785 Acc: 0.6364
Epoch 61/95
----------
train Loss: 1.2397 Acc: 0.4880
val Loss: 1.4175 Acc: 0.1364
Epoch 62/95
----------
train Loss: 1.2121 Acc: 0.5024
val Loss: 1.9575 Acc: 0.3636
Epoch 63/95
----------
train Loss: 1.2383 Acc: 0.4976
val Loss: 1.0592 Acc: 0.6364
Epoch 64/95
----------
train Loss: 1.2281 Acc: 0.4976
val Loss: 1.0856 Acc: 0.6364
Epoch 65/95
----------
train Loss: 1.2591 Acc: 0.4833
val Loss: 1.1317 Acc: 0.6364
Epoch 66/95
----------
train Loss: 1.2420 Acc: 0.4976
val Loss: 1.1003 Acc: 0.6364
Epoch 67/95
----------
train Loss: 1.2425 Acc: 0.5024
val Loss: 1.0793 Acc: 0.6364
Epoch 68/95
----------
train Loss: 1.2381 Acc: 0.4976
val Loss: 1.1159 Acc: 0.6364
Epoch 69/95
----------
train Loss: 1.2341 Acc: 0.4928
val Loss: 1.1323 Acc: 0.6364
Epoch 70/95
----------
train Loss: 1.2417 Acc: 0.4976
val Loss: 1.1352 Acc: 0.6364
Epoch 71/95
----------
train Loss: 1.2380 Acc: 0.4976
val Loss: 1.0702 Acc: 0.6364
Epoch 72/95
----------
train Loss: 1.2520 Acc: 0.4976
val Loss: 1.1399 Acc: 0.6364
Epoch 73/95
----------
train Loss: 1.2344 Acc: 0.4976
val Loss: 1.1605 Acc: 0.6364
Epoch 74/95
----------
train Loss: 1.2393 Acc: 0.5072
val Loss: 1.1531 Acc: 0.6364
Epoch 75/95
----------
train Loss: 1.2333 Acc: 0.4976
val Loss: 1.1079 Acc: 0.6364
Epoch 76/95
----------
train Loss: 1.2346 Acc: 0.4976
val Loss: 1.5878 Acc: 0.1364
Epoch 77/95
----------
train Loss: 1.2398 Acc: 0.4976
val Loss: 1.1414 Acc: 0.6364
Epoch 78/95
----------
train Loss: 1.2409 Acc: 0.4976
val Loss: 1.0929 Acc: 0.6364
Epoch 79/95
----------
train Loss: 1.2285 Acc: 0.5120
val Loss: 5.1257 Acc: 0.0909
Epoch 80/95
----------
train Loss: 1.2438 Acc: 0.4976
val Loss: 2.0154 Acc: 0.0909
Epoch 81/95
----------
train Loss: 1.2322 Acc: 0.4976
val Loss: 1.1365 Acc: 0.6364
Epoch 82/95
----------
train Loss: 1.2221 Acc: 0.4928
val Loss: 1.3369 Acc: 0.6364
Epoch 83/95
----------
train Loss: 1.2376 Acc: 0.4928
val Loss: 1.4661 Acc: 0.2500
Epoch 84/95
----------
train Loss: 1.2458 Acc: 0.4976
val Loss: 1.0823 Acc: 0.6364
Epoch 85/95
----------
train Loss: 1.2355 Acc: 0.4976
val Loss: 1.0880 Acc: 0.6364
Epoch 86/95
----------
train Loss: 1.2488 Acc: 0.4880
val Loss: 5.4321 Acc: 0.4318
Epoch 87/95
----------
train Loss: 1.2289 Acc: 0.4976
val Loss: 2.6897 Acc: 0.2273
Epoch 88/95
----------
train Loss: 1.2315 Acc: 0.5024
val Loss: 2.5283 Acc: 0.1364
Epoch 89/95
----------
train Loss: 1.2361 Acc: 0.4833
val Loss: 1.1438 Acc: 0.6364
Epoch 90/95
----------
train Loss: 1.2182 Acc: 0.5120
val Loss: 1.0804 Acc: 0.6364
Epoch 91/95
----------
train Loss: 1.2195 Acc: 0.4976
val Loss: 1.1276 Acc: 0.6364
Epoch 92/95
----------
train Loss: 1.2139 Acc: 0.4833
val Loss: 1.0869 Acc: 0.6364
Epoch 93/95
----------
train Loss: 1.2073 Acc: 0.4928
val Loss: 1.1078 Acc: 0.6364
Epoch 94/95
----------
train Loss: 1.2078 Acc: 0.4976
val Loss: 1.0816 Acc: 0.6364
Epoch 95/95
----------
train Loss: 1.2083 Acc: 0.5120
[32m[I 2025-06-28 01:32:15,492][0m Trial 2 finished with value: 0.6363636363636364 and parameters: {'batch_size': 89, 'lr': 0.005663759340009996, 'num_epochs': 95, 'weight_decay': 0.2116882462190115, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 0 with value: 0.7272727272727273.[0m
val Loss: 1.1553 Acc: 0.6364
Best val Acc: 0.636364

Model weights saved at ./model_weights/efficientnetb0_bs_89_lr_0.005663759340009996_epoch_95_wd_0.2116882462190115_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 0.5612 Acc: 0.4498
val Loss: 0.3454 Acc: 0.6591
Epoch 2/87
----------
train Loss: 0.4792 Acc: 0.6172
val Loss: 0.4386 Acc: 0.5909
Epoch 3/87
----------
train Loss: 0.4304 Acc: 0.7033
val Loss: 0.3636 Acc: 0.7045
Epoch 4/87
----------
train Loss: 0.4215 Acc: 0.6172
val Loss: 0.4085 Acc: 0.6136
Epoch 5/87
----------
train Loss: 0.3825 Acc: 0.7560
val Loss: 0.3312 Acc: 0.7045
Epoch 6/87
----------
train Loss: 0.3410 Acc: 0.7416
val Loss: 0.3432 Acc: 0.6591
Epoch 7/87
----------
train Loss: 0.3258 Acc: 0.8278
val Loss: 0.2619 Acc: 0.7273
Epoch 8/87
----------
train Loss: 0.3712 Acc: 0.7799
val Loss: 0.3798 Acc: 0.6591
Epoch 9/87
----------
train Loss: 0.3619 Acc: 0.7512
val Loss: 0.3929 Acc: 0.6136
Epoch 10/87
----------
train Loss: 0.2646 Acc: 0.9043
val Loss: 0.3739 Acc: 0.7273
Epoch 11/87
----------
train Loss: 0.3555 Acc: 0.7464
val Loss: 0.3239 Acc: 0.7500
Epoch 12/87
----------
train Loss: 0.3164 Acc: 0.7943
val Loss: 0.3597 Acc: 0.6818
Epoch 13/87
----------
train Loss: 0.3098 Acc: 0.8325
val Loss: 0.3135 Acc: 0.7045
Epoch 14/87
----------
train Loss: 0.2598 Acc: 0.8230
val Loss: 0.3396 Acc: 0.7273
Epoch 15/87
----------
train Loss: 0.3120 Acc: 0.8086
val Loss: 0.3217 Acc: 0.7500
Epoch 16/87
----------
train Loss: 0.3177 Acc: 0.7608
val Loss: 0.3308 Acc: 0.6591
Epoch 17/87
----------
train Loss: 0.2963 Acc: 0.8134
val Loss: 0.3488 Acc: 0.6818
Epoch 18/87
----------
train Loss: 0.2705 Acc: 0.8469
val Loss: 0.2917 Acc: 0.7045
Epoch 19/87
----------
train Loss: 0.2578 Acc: 0.9043
val Loss: 0.2671 Acc: 0.7273
Epoch 20/87
----------
train Loss: 0.2829 Acc: 0.8995
val Loss: 0.2736 Acc: 0.7727
Epoch 21/87
----------
train Loss: 0.2983 Acc: 0.9043
val Loss: 0.3114 Acc: 0.7955
Epoch 22/87
----------
train Loss: 0.2728 Acc: 0.8517
val Loss: 0.3195 Acc: 0.7273
Epoch 23/87
----------
train Loss: 0.3077 Acc: 0.8660
val Loss: 0.3171 Acc: 0.7273
Epoch 24/87
----------
train Loss: 0.2376 Acc: 0.8852
val Loss: 0.4081 Acc: 0.6364
Epoch 25/87
----------
train Loss: 0.2665 Acc: 0.9234
val Loss: 0.3157 Acc: 0.7045
Epoch 26/87
----------
train Loss: 0.2864 Acc: 0.9426
[32m[I 2025-06-28 01:38:10,336][0m Trial 3 finished with value: 0.7954545454545455 and parameters: {'batch_size': 89, 'lr': 0.0017894460362713235, 'num_epochs': 87, 'weight_decay': 0.0003362431813560974, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 3 with value: 0.7954545454545455.[0m
val Loss: 0.3028 Acc: 0.7045
Early stopping at epoch 26 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_89_lr_0.0017894460362713235_epoch_87_wd_0.0003362431813560974_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/66
----------
train Loss: 0.7029 Acc: 0.2201
val Loss: 0.6900 Acc: 0.1591
Epoch 2/66
----------
train Loss: 0.6978 Acc: 0.2249
val Loss: 0.6893 Acc: 0.2045
Epoch 3/66
----------
train Loss: 0.6955 Acc: 0.2105
val Loss: 0.6845 Acc: 0.1591
Epoch 4/66
----------
train Loss: 0.6966 Acc: 0.2057
val Loss: 0.6832 Acc: 0.1591
Epoch 5/66
----------
train Loss: 0.7026 Acc: 0.1818
val Loss: 0.6856 Acc: 0.1591
Epoch 6/66
----------
train Loss: 0.7000 Acc: 0.2105
val Loss: 0.6851 Acc: 0.1818
Epoch 7/66
----------
train Loss: 0.6997 Acc: 0.1866
val Loss: 0.6852 Acc: 0.1818
Epoch 8/66
----------
train Loss: 0.6951 Acc: 0.2010
val Loss: 0.6858 Acc: 0.2273
Epoch 9/66
----------
train Loss: 0.6966 Acc: 0.2440
val Loss: 0.6859 Acc: 0.1364
Epoch 10/66
----------
train Loss: 0.6972 Acc: 0.1914
val Loss: 0.6871 Acc: 0.1818
Epoch 11/66
----------
train Loss: 0.6984 Acc: 0.2057
val Loss: 0.6857 Acc: 0.1818
Epoch 12/66
----------
train Loss: 0.6980 Acc: 0.2153
val Loss: 0.6869 Acc: 0.1591
Epoch 13/66
----------
train Loss: 0.6927 Acc: 0.2297
val Loss: 0.6864 Acc: 0.1818
Epoch 14/66
----------
train Loss: 0.6943 Acc: 0.1962
val Loss: 0.6841 Acc: 0.2045
Epoch 15/66
----------
train Loss: 0.6908 Acc: 0.2727
val Loss: 0.6863 Acc: 0.1591
Epoch 16/66
----------
train Loss: 0.6904 Acc: 0.2344
val Loss: 0.6822 Acc: 0.2045
Epoch 17/66
----------
train Loss: 0.6947 Acc: 0.1866
val Loss: 0.6844 Acc: 0.1818
Epoch 18/66
----------
train Loss: 0.6961 Acc: 0.2392
val Loss: 0.6833 Acc: 0.1818
Epoch 19/66
----------
train Loss: 0.6924 Acc: 0.2440
val Loss: 0.6825 Acc: 0.2045
Epoch 20/66
----------
train Loss: 0.6902 Acc: 0.2440
val Loss: 0.6842 Acc: 0.1818
Epoch 21/66
----------
train Loss: 0.6903 Acc: 0.2153
val Loss: 0.6830 Acc: 0.2273
Epoch 22/66
----------
train Loss: 0.6945 Acc: 0.1866
val Loss: 0.6837 Acc: 0.2500
Epoch 23/66
----------
train Loss: 0.6894 Acc: 0.1962
val Loss: 0.6826 Acc: 0.2045
Epoch 24/66
----------
train Loss: 0.6887 Acc: 0.2584
val Loss: 0.6811 Acc: 0.1818
Epoch 25/66
----------
train Loss: 0.6892 Acc: 0.2679
val Loss: 0.6838 Acc: 0.2273
Epoch 26/66
----------
train Loss: 0.6890 Acc: 0.2153
val Loss: 0.6839 Acc: 0.2045
Epoch 27/66
----------
train Loss: 0.6917 Acc: 0.2249
val Loss: 0.6812 Acc: 0.2045
Epoch 28/66
----------
train Loss: 0.6913 Acc: 0.2153
val Loss: 0.6798 Acc: 0.2273
Epoch 29/66
----------
train Loss: 0.6903 Acc: 0.2392
val Loss: 0.6799 Acc: 0.2045
Epoch 30/66
----------
train Loss: 0.6890 Acc: 0.2440
val Loss: 0.6799 Acc: 0.2500
Epoch 31/66
----------
train Loss: 0.6866 Acc: 0.2488
val Loss: 0.6790 Acc: 0.2273
Epoch 32/66
----------
train Loss: 0.6866 Acc: 0.2775
val Loss: 0.6806 Acc: 0.1818
Epoch 33/66
----------
train Loss: 0.6880 Acc: 0.1866
val Loss: 0.6813 Acc: 0.1818
Epoch 34/66
----------
train Loss: 0.6877 Acc: 0.2153
val Loss: 0.6821 Acc: 0.1818
Epoch 35/66
----------
train Loss: 0.6858 Acc: 0.2249
val Loss: 0.6819 Acc: 0.1818
Epoch 36/66
----------
train Loss: 0.6868 Acc: 0.2344
val Loss: 0.6794 Acc: 0.2500
Epoch 37/66
----------
train Loss: 0.6884 Acc: 0.2297
val Loss: 0.6779 Acc: 0.2273
Epoch 38/66
----------
train Loss: 0.6865 Acc: 0.2201
val Loss: 0.6779 Acc: 0.2045
Epoch 39/66
----------
train Loss: 0.6860 Acc: 0.2392
val Loss: 0.6785 Acc: 0.2045
Epoch 40/66
----------
train Loss: 0.6860 Acc: 0.2727
val Loss: 0.6761 Acc: 0.2273
Epoch 41/66
----------
train Loss: 0.6836 Acc: 0.2201
val Loss: 0.6762 Acc: 0.1818
Epoch 42/66
----------
train Loss: 0.6827 Acc: 0.2153
val Loss: 0.6764 Acc: 0.2273
Epoch 43/66
----------
train Loss: 0.6847 Acc: 0.2201
val Loss: 0.6751 Acc: 0.2045
Epoch 44/66
----------
train Loss: 0.6874 Acc: 0.2010
val Loss: 0.6752 Acc: 0.2045
Epoch 45/66
----------
train Loss: 0.6852 Acc: 0.2153
val Loss: 0.6726 Acc: 0.1818
Epoch 46/66
----------
train Loss: 0.6821 Acc: 0.2871
val Loss: 0.6732 Acc: 0.2045
Epoch 47/66
----------
train Loss: 0.6844 Acc: 0.2105
val Loss: 0.6741 Acc: 0.2045
Epoch 48/66
----------
train Loss: 0.6833 Acc: 0.3014
val Loss: 0.6718 Acc: 0.2273
Epoch 49/66
----------
train Loss: 0.6805 Acc: 0.2823
val Loss: 0.6714 Acc: 0.2273
Epoch 50/66
----------
train Loss: 0.6803 Acc: 0.2249
val Loss: 0.6708 Acc: 0.2273
Epoch 51/66
----------
train Loss: 0.6820 Acc: 0.2201
val Loss: 0.6700 Acc: 0.2045
Epoch 52/66
----------
train Loss: 0.6797 Acc: 0.2536
val Loss: 0.6706 Acc: 0.2273
Epoch 53/66
----------
train Loss: 0.6813 Acc: 0.2249
val Loss: 0.6706 Acc: 0.2273
Epoch 54/66
----------
train Loss: 0.6768 Acc: 0.2823
val Loss: 0.6713 Acc: 0.2045
Epoch 55/66
----------
train Loss: 0.6782 Acc: 0.2297
val Loss: 0.6702 Acc: 0.2273
Epoch 56/66
----------
train Loss: 0.6794 Acc: 0.2727
val Loss: 0.6706 Acc: 0.2500
Epoch 57/66
----------
train Loss: 0.6787 Acc: 0.2392
val Loss: 0.6689 Acc: 0.2500
Epoch 58/66
----------
train Loss: 0.6797 Acc: 0.2632
val Loss: 0.6685 Acc: 0.2273
Epoch 59/66
----------
train Loss: 0.6717 Acc: 0.3301
val Loss: 0.6691 Acc: 0.2273
Epoch 60/66
----------
train Loss: 0.6780 Acc: 0.2440
val Loss: 0.6696 Acc: 0.2500
Epoch 61/66
----------
train Loss: 0.6759 Acc: 0.2679
val Loss: 0.6698 Acc: 0.2500
Epoch 62/66
----------
train Loss: 0.6744 Acc: 0.2679
val Loss: 0.6688 Acc: 0.2273
Epoch 63/66
----------
train Loss: 0.6743 Acc: 0.2392
val Loss: 0.6700 Acc: 0.2500
Epoch 64/66
----------
train Loss: 0.6758 Acc: 0.2057
val Loss: 0.6708 Acc: 0.2273
Epoch 65/66
----------
train Loss: 0.6747 Acc: 0.2967
val Loss: 0.6706 Acc: 0.1818
Epoch 66/66
----------
train Loss: 0.6776 Acc: 0.2632
[32m[I 2025-06-28 01:53:12,200][0m Trial 4 finished with value: 0.20454545454545456 and parameters: {'batch_size': 114, 'lr': 1.3146135418453596e-06, 'num_epochs': 66, 'weight_decay': 0.10380878312840114, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 3 with value: 0.7954545454545455.[0m
val Loss: 0.6684 Acc: 0.2045
Best val Acc: 0.204545

Model weights saved at ./model_weights/efficientnetb0_bs_114_lr_1.3146135418453596e-06_epoch_66_wd_0.10380878312840114_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/45
----------
train Loss: 5.7901 Acc: 0.2871
val Loss: 4.8216 Acc: 0.5000
Epoch 2/45
----------
train Loss: 4.1824 Acc: 0.6746
val Loss: 4.2918 Acc: 0.6136
Epoch 3/45
----------
train Loss: 2.9905 Acc: 0.8086
val Loss: 3.7537 Acc: 0.6364
Epoch 4/45
----------
train Loss: 1.9874 Acc: 0.9139
val Loss: 3.2865 Acc: 0.7500
Epoch 5/45
----------
train Loss: 1.1259 Acc: 0.9713
val Loss: 2.8960 Acc: 0.7500
Epoch 6/45
----------
train Loss: 0.6826 Acc: 0.9761
val Loss: 2.6668 Acc: 0.8182
Epoch 7/45
----------
train Loss: 0.3733 Acc: 0.9952
val Loss: 2.7211 Acc: 0.7727
Epoch 8/45
----------
train Loss: 0.2749 Acc: 0.9856
val Loss: 2.7726 Acc: 0.7727
Epoch 9/45
----------
train Loss: 0.2240 Acc: 0.9952
val Loss: 2.5460 Acc: 0.7955
Epoch 10/45
----------
train Loss: 0.1821 Acc: 0.9952
val Loss: 2.4327 Acc: 0.8182
Epoch 11/45
----------
train Loss: 0.1831 Acc: 1.0000
val Loss: 2.4418 Acc: 0.8409
Epoch 12/45
----------
train Loss: 0.1241 Acc: 1.0000
val Loss: 2.6511 Acc: 0.7955
Epoch 13/45
----------
train Loss: 0.1954 Acc: 0.9856
val Loss: 2.7038 Acc: 0.7500
Epoch 14/45
----------
train Loss: 0.2646 Acc: 0.9856
val Loss: 2.5624 Acc: 0.8409
Epoch 15/45
----------
train Loss: 0.1716 Acc: 0.9952
val Loss: 2.6399 Acc: 0.7727
Epoch 16/45
----------
train Loss: 0.1171 Acc: 1.0000
val Loss: 2.9455 Acc: 0.7955
Epoch 17/45
----------
train Loss: 0.1395 Acc: 0.9952
val Loss: 2.6261 Acc: 0.7727
Epoch 18/45
----------
train Loss: 0.0589 Acc: 1.0000
val Loss: 2.6917 Acc: 0.7273
Epoch 19/45
----------
train Loss: 0.1051 Acc: 1.0000
val Loss: 2.6293 Acc: 0.7500
Epoch 20/45
----------
train Loss: 0.2167 Acc: 0.9856
val Loss: 2.6886 Acc: 0.7727
Epoch 21/45
----------
train Loss: 0.3729 Acc: 0.9713
val Loss: 2.9607 Acc: 0.7045
Epoch 22/45
----------
train Loss: 0.5171 Acc: 0.9665
val Loss: 4.1363 Acc: 0.6818
Epoch 23/45
----------
train Loss: 0.3548 Acc: 0.9809
val Loss: 3.9775 Acc: 0.7273
Epoch 24/45
----------
train Loss: 0.2377 Acc: 0.9856
val Loss: 2.9884 Acc: 0.8182
Epoch 25/45
----------
train Loss: 0.1740 Acc: 0.9952
val Loss: 2.8511 Acc: 0.8182
Epoch 26/45
----------
train Loss: 0.1332 Acc: 0.9856
val Loss: 3.0304 Acc: 0.7273
Epoch 27/45
----------
train Loss: 0.1246 Acc: 0.9952
val Loss: 3.0872 Acc: 0.7273
Epoch 28/45
----------
train Loss: 0.2207 Acc: 0.9856
val Loss: 3.0405 Acc: 0.7273
Epoch 29/45
----------
train Loss: 0.2255 Acc: 0.9809
val Loss: 2.7948 Acc: 0.7727
Epoch 30/45
----------
train Loss: 0.1436 Acc: 0.9952
val Loss: 2.5583 Acc: 0.7500
Epoch 31/45
----------
train Loss: 0.3900 Acc: 0.9904
val Loss: 3.2078 Acc: 0.7500
Epoch 32/45
----------
train Loss: 0.1473 Acc: 0.9904
val Loss: 2.9850 Acc: 0.7500
Epoch 33/45
----------
train Loss: 0.3450 Acc: 0.9809
val Loss: 3.2177 Acc: 0.7273
Epoch 34/45
----------
train Loss: 0.3331 Acc: 0.9617
val Loss: 2.7958 Acc: 0.7045
Epoch 35/45
----------
train Loss: 0.2260 Acc: 0.9665
val Loss: 3.7026 Acc: 0.6364
Epoch 36/45
----------
train Loss: 0.2189 Acc: 0.9761
val Loss: 2.7371 Acc: 0.7955
Epoch 37/45
----------
train Loss: 0.1616 Acc: 0.9809
val Loss: 2.7251 Acc: 0.8409
Epoch 38/45
----------
train Loss: 0.2515 Acc: 0.9761
val Loss: 3.5524 Acc: 0.7955
Epoch 39/45
----------
train Loss: 0.1418 Acc: 0.9856
val Loss: 3.5719 Acc: 0.7727
Epoch 40/45
----------
train Loss: 0.0978 Acc: 0.9904
val Loss: 3.6215 Acc: 0.8636
Epoch 41/45
----------
train Loss: 0.1268 Acc: 0.9952
val Loss: 3.3754 Acc: 0.8409
Epoch 42/45
----------
train Loss: 0.0814 Acc: 0.9904
val Loss: 3.0780 Acc: 0.7955
Epoch 43/45
----------
train Loss: 0.0664 Acc: 0.9952
val Loss: 3.7279 Acc: 0.7727
Epoch 44/45
----------
train Loss: 0.1826 Acc: 0.9904
val Loss: 3.7342 Acc: 0.6818
Epoch 45/45
----------
train Loss: 0.0734 Acc: 0.9856
[32m[I 2025-06-28 02:03:27,878][0m Trial 5 finished with value: 0.7727272727272727 and parameters: {'batch_size': 60, 'lr': 0.0003098981815378012, 'num_epochs': 45, 'weight_decay': 0.027852675630239312, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 3 with value: 0.7954545454545455.[0m
val Loss: 3.4413 Acc: 0.6818
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_60_lr_0.0003098981815378012_epoch_45_wd_0.027852675630239312_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/76
----------
train Loss: 6.0175 Acc: 0.1722
val Loss: 5.1325 Acc: 0.1818
Epoch 2/76
----------
train Loss: 5.9754 Acc: 0.2536
val Loss: 5.1050 Acc: 0.3409
Epoch 3/76
----------
train Loss: 5.9857 Acc: 0.2010
val Loss: 5.1980 Acc: 0.2500
Epoch 4/76
----------
train Loss: 5.9711 Acc: 0.2297
val Loss: 5.2020 Acc: 0.1818
Epoch 5/76
----------
train Loss: 5.9870 Acc: 0.2392
val Loss: 5.1841 Acc: 0.2045
Epoch 6/76
----------
train Loss: 5.8307 Acc: 0.2584
val Loss: 5.1744 Acc: 0.1818
Epoch 7/76
----------
train Loss: 5.9423 Acc: 0.2440
[32m[I 2025-06-28 02:05:03,642][0m Trial 6 finished with value: 0.34090909090909094 and parameters: {'batch_size': 45, 'lr': 2.314171079187786e-06, 'num_epochs': 76, 'weight_decay': 0.015235924611477433, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 3 with value: 0.7954545454545455.[0m
val Loss: 5.1658 Acc: 0.2045
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.340909

Model weights saved at ./model_weights/efficientnetb0_bs_45_lr_2.314171079187786e-06_epoch_76_wd_0.015235924611477433_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/43
----------
train Loss: 3.4162 Acc: 0.4163
val Loss: 3.5678 Acc: 0.4773
Epoch 2/43
----------
train Loss: 2.7919 Acc: 0.4737
val Loss: 5.8602 Acc: 0.1364
Epoch 3/43
----------
train Loss: 2.6072 Acc: 0.5167
val Loss: 2.4503 Acc: 0.6364
Epoch 4/43
----------
train Loss: 2.5345 Acc: 0.4976
val Loss: 4.2999 Acc: 0.1364
Epoch 5/43
----------
train Loss: 2.4308 Acc: 0.5502
val Loss: 5.1059 Acc: 0.1364
Epoch 6/43
----------
train Loss: 2.4927 Acc: 0.5407
val Loss: 3.9544 Acc: 0.1364
Epoch 7/43
----------
train Loss: 2.4591 Acc: 0.5072
val Loss: 2.6609 Acc: 0.6364
Epoch 8/43
----------
train Loss: 2.5278 Acc: 0.5120
val Loss: 2.8861 Acc: 0.6364
Epoch 9/43
----------
train Loss: 2.5550 Acc: 0.5072
val Loss: 2.5296 Acc: 0.0909
Epoch 10/43
----------
train Loss: 2.4616 Acc: 0.5550
val Loss: 2.5440 Acc: 0.5455
Epoch 11/43
----------
train Loss: 2.4835 Acc: 0.5072
val Loss: 4.2985 Acc: 0.1364
Epoch 12/43
----------
train Loss: 2.4690 Acc: 0.4689
val Loss: 2.6767 Acc: 0.6364
Epoch 13/43
----------
train Loss: 2.4160 Acc: 0.5263
val Loss: 4.1698 Acc: 0.6364
Epoch 14/43
----------
train Loss: 2.4268 Acc: 0.5311
val Loss: 3.6696 Acc: 0.6364
Epoch 15/43
----------
train Loss: 2.4662 Acc: 0.4976
val Loss: 3.3660 Acc: 0.2727
Epoch 16/43
----------
train Loss: 2.5024 Acc: 0.4928
val Loss: 2.4385 Acc: 0.6364
Epoch 17/43
----------
train Loss: 2.4507 Acc: 0.4928
val Loss: 2.7288 Acc: 0.6364
Epoch 18/43
----------
train Loss: 2.2964 Acc: 0.5502
val Loss: 3.7294 Acc: 0.1364
Epoch 19/43
----------
train Loss: 2.3196 Acc: 0.5598
val Loss: 2.1547 Acc: 0.6364
Epoch 20/43
----------
train Loss: 2.4370 Acc: 0.5407
val Loss: 2.2214 Acc: 0.6364
Epoch 21/43
----------
train Loss: 2.4586 Acc: 0.5311
val Loss: 2.8313 Acc: 0.6364
Epoch 22/43
----------
train Loss: 2.4784 Acc: 0.5072
val Loss: 4.0328 Acc: 0.4773
Epoch 23/43
----------
train Loss: 2.4409 Acc: 0.5024
val Loss: 6.1871 Acc: 0.1364
Epoch 24/43
----------
train Loss: 2.3463 Acc: 0.5455
val Loss: 3.5444 Acc: 0.1364
Epoch 25/43
----------
train Loss: 2.3310 Acc: 0.5359
val Loss: 2.3718 Acc: 0.6364
Epoch 26/43
----------
train Loss: 2.4716 Acc: 0.5215
val Loss: 2.2771 Acc: 0.6364
Epoch 27/43
----------
train Loss: 2.3588 Acc: 0.5407
val Loss: 5.7420 Acc: 0.1136
Epoch 28/43
----------
train Loss: 2.4201 Acc: 0.5120
val Loss: 5.7332 Acc: 0.1364
Epoch 29/43
----------
train Loss: 2.4631 Acc: 0.5215
val Loss: 5.8482 Acc: 0.1136
Epoch 30/43
----------
train Loss: 2.5169 Acc: 0.4880
val Loss: 2.5869 Acc: 0.6364
Epoch 31/43
----------
train Loss: 2.4155 Acc: 0.4976
val Loss: 3.1272 Acc: 0.0909
Epoch 32/43
----------
train Loss: 2.4079 Acc: 0.5024
val Loss: 5.4105 Acc: 0.1364
Epoch 33/43
----------
train Loss: 2.4007 Acc: 0.5311
val Loss: 2.5987 Acc: 0.1364
Epoch 34/43
----------
train Loss: 2.4404 Acc: 0.4928
val Loss: 2.5428 Acc: 0.6591
Epoch 35/43
----------
train Loss: 2.3894 Acc: 0.4928
val Loss: 3.1499 Acc: 0.1364
Epoch 36/43
----------
train Loss: 2.4034 Acc: 0.5263
val Loss: 5.1539 Acc: 0.1364
Epoch 37/43
----------
train Loss: 2.4201 Acc: 0.5311
val Loss: 3.9609 Acc: 0.1364
Epoch 38/43
----------
train Loss: 2.4172 Acc: 0.5263
val Loss: 2.7654 Acc: 0.5455
Epoch 39/43
----------
train Loss: 2.4536 Acc: 0.4785
[32m[I 2025-06-28 02:13:58,046][0m Trial 7 finished with value: 0.6590909090909091 and parameters: {'batch_size': 64, 'lr': 0.00580043297115485, 'num_epochs': 43, 'weight_decay': 0.022453089970455344, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 3 with value: 0.7954545454545455.[0m
val Loss: 2.8047 Acc: 0.4773
Early stopping at epoch 39 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.659091

Model weights saved at ./model_weights/efficientnetb0_bs_64_lr_0.00580043297115485_epoch_43_wd_0.022453089970455344_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/98
----------
train Loss: 1.4383 Acc: 0.1722
val Loss: 1.4003 Acc: 0.1818
Epoch 2/98
----------
train Loss: 1.4345 Acc: 0.2488
val Loss: 1.3912 Acc: 0.3409
Epoch 3/98
----------
train Loss: 1.4391 Acc: 0.2057
val Loss: 1.4140 Acc: 0.2500
Epoch 4/98
----------
train Loss: 1.4364 Acc: 0.2249
val Loss: 1.4210 Acc: 0.1818
Epoch 5/98
----------
train Loss: 1.4410 Acc: 0.2297
val Loss: 1.4236 Acc: 0.2045
Epoch 6/98
----------
train Loss: 1.4138 Acc: 0.2440
val Loss: 1.4215 Acc: 0.1818
Epoch 7/98
----------
train Loss: 1.4377 Acc: 0.2344
[32m[I 2025-06-28 02:15:34,012][0m Trial 8 finished with value: 0.34090909090909094 and parameters: {'batch_size': 48, 'lr': 1.6828815972758592e-06, 'num_epochs': 98, 'weight_decay': 0.05766028565093045, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 3 with value: 0.7954545454545455.[0m
val Loss: 1.4191 Acc: 0.2273
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.340909

Model weights saved at ./model_weights/efficientnetb0_bs_48_lr_1.6828815972758592e-06_epoch_98_wd_0.05766028565093045_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/97
----------
train Loss: 5.3866 Acc: 0.3541
val Loss: 4.5170 Acc: 0.6136
Epoch 2/97
----------
train Loss: 2.3994 Acc: 0.8278
val Loss: 4.9033 Acc: 0.7500
Epoch 3/97
----------
train Loss: 0.6722 Acc: 0.9569
val Loss: 6.1536 Acc: 0.7045
Epoch 4/97
----------
train Loss: 0.4338 Acc: 0.9665
val Loss: 3.7749 Acc: 0.8182
Epoch 5/97
----------
train Loss: 0.5517 Acc: 0.9713
val Loss: 3.0688 Acc: 0.6818
Epoch 6/97
----------
train Loss: 1.0002 Acc: 0.9426
val Loss: 3.4188 Acc: 0.6818
Epoch 7/97
----------
train Loss: 0.9043 Acc: 0.9234
val Loss: 3.1983 Acc: 0.8636
Epoch 8/97
----------
train Loss: 1.0176 Acc: 0.9187
val Loss: 2.7257 Acc: 0.7045
Epoch 9/97
----------
train Loss: 1.3094 Acc: 0.8947
val Loss: 2.5847 Acc: 0.7045
Epoch 10/97
----------
train Loss: 1.3189 Acc: 0.8804
val Loss: 4.1791 Acc: 0.4545
Epoch 11/97
----------
train Loss: 0.7534 Acc: 0.9474
val Loss: 4.1883 Acc: 0.5682
Epoch 12/97
----------
train Loss: 0.7897 Acc: 0.9187
[32m[I 2025-06-28 02:18:17,669][0m Trial 9 finished with value: 0.8636363636363636 and parameters: {'batch_size': 82, 'lr': 0.0010876248437162591, 'num_epochs': 97, 'weight_decay': 0.02619005146207873, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.5471 Acc: 0.7045
Early stopping at epoch 12 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_82_lr_0.0010876248437162591_epoch_97_wd_0.02619005146207873_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 5.9992 Acc: 0.1818
val Loss: 5.1119 Acc: 0.2273
Epoch 2/78
----------
train Loss: 5.7990 Acc: 0.2967
val Loss: 5.0353 Acc: 0.3864
Epoch 3/78
----------
train Loss: 5.6752 Acc: 0.3110
val Loss: 5.0804 Acc: 0.2955
Epoch 4/78
----------
train Loss: 5.5257 Acc: 0.3301
val Loss: 5.0498 Acc: 0.2727
Epoch 5/78
----------
train Loss: 5.4044 Acc: 0.4163
val Loss: 5.0167 Acc: 0.3182
Epoch 6/78
----------
train Loss: 5.1746 Acc: 0.4354
val Loss: 4.9870 Acc: 0.2955
Epoch 7/78
----------
train Loss: 5.1316 Acc: 0.4593
[32m[I 2025-06-28 02:19:53,296][0m Trial 10 finished with value: 0.38636363636363635 and parameters: {'batch_size': 128, 'lr': 2.1687831762321224e-05, 'num_epochs': 78, 'weight_decay': 0.0014316510287727075, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 4.9523 Acc: 0.2727
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.386364

Model weights saved at ./model_weights/efficientnetb0_bs_128_lr_2.1687831762321224e-05_epoch_78_wd_0.0014316510287727075_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 0.5702 Acc: 0.4354
val Loss: 0.3732 Acc: 0.6364
Epoch 2/87
----------
train Loss: 0.4755 Acc: 0.6172
val Loss: 0.3669 Acc: 0.6364
Epoch 3/87
----------
train Loss: 0.4238 Acc: 0.7225
val Loss: 0.2999 Acc: 0.7500
Epoch 4/87
----------
train Loss: 0.4056 Acc: 0.6603
val Loss: 0.3199 Acc: 0.7273
Epoch 5/87
----------
train Loss: 0.3712 Acc: 0.7751
val Loss: 0.3060 Acc: 0.7955
Epoch 6/87
----------
train Loss: 0.3471 Acc: 0.7416
val Loss: 0.3109 Acc: 0.7045
Epoch 7/87
----------
train Loss: 0.3127 Acc: 0.8278
val Loss: 0.3169 Acc: 0.7500
Epoch 8/87
----------
train Loss: 0.3439 Acc: 0.7560
val Loss: 0.2568 Acc: 0.7955
Epoch 9/87
----------
train Loss: 0.3538 Acc: 0.7799
val Loss: 0.2701 Acc: 0.8182
Epoch 10/87
----------
train Loss: 0.2344 Acc: 0.9378
val Loss: 0.2411 Acc: 0.8636
Epoch 11/87
----------
train Loss: 0.3367 Acc: 0.7990
val Loss: 0.2467 Acc: 0.7727
Epoch 12/87
----------
train Loss: 0.2873 Acc: 0.7990
val Loss: 0.4094 Acc: 0.7045
Epoch 13/87
----------
train Loss: 0.2893 Acc: 0.8708
val Loss: 0.3269 Acc: 0.7273
Epoch 14/87
----------
train Loss: 0.2532 Acc: 0.8325
val Loss: 0.3493 Acc: 0.6364
Epoch 15/87
----------
train Loss: 0.3010 Acc: 0.8086
[32m[I 2025-06-28 02:23:18,628][0m Trial 11 finished with value: 0.8636363636363636 and parameters: {'batch_size': 101, 'lr': 0.0011762988950868292, 'num_epochs': 87, 'weight_decay': 0.00011827959860487535, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3123 Acc: 0.7045
Early stopping at epoch 15 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_101_lr_0.0011762988950868292_epoch_87_wd_0.00011827959860487535_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/82
----------
train Loss: 1.2297 Acc: 0.4689
val Loss: 0.8858 Acc: 0.6364
Epoch 2/82
----------
train Loss: 0.5771 Acc: 0.8660
val Loss: 0.7493 Acc: 0.7500
Epoch 3/82
----------
train Loss: 0.2676 Acc: 0.9665
val Loss: 0.6226 Acc: 0.7955
Epoch 4/82
----------
train Loss: 0.1010 Acc: 0.9809
val Loss: 0.4905 Acc: 0.8182
Epoch 5/82
----------
train Loss: 0.0375 Acc: 0.9952
val Loss: 0.7058 Acc: 0.7500
Epoch 6/82
----------
train Loss: 0.0469 Acc: 0.9856
val Loss: 0.5827 Acc: 0.8409
Epoch 7/82
----------
train Loss: 0.0416 Acc: 0.9904
val Loss: 0.6837 Acc: 0.8409
Epoch 8/82
----------
train Loss: 0.0570 Acc: 0.9856
val Loss: 0.7258 Acc: 0.8409
Epoch 9/82
----------
train Loss: 0.1466 Acc: 0.9474
val Loss: 0.7968 Acc: 0.7727
Epoch 10/82
----------
train Loss: 0.1399 Acc: 0.9569
val Loss: 0.8986 Acc: 0.7500
Epoch 11/82
----------
train Loss: 0.1757 Acc: 0.9378
val Loss: 0.8609 Acc: 0.7273
Epoch 12/82
----------
train Loss: 0.1424 Acc: 0.9522
val Loss: 0.9197 Acc: 0.7500
Epoch 13/82
----------
train Loss: 0.1429 Acc: 0.9474
[32m[I 2025-06-28 02:26:17,132][0m Trial 12 finished with value: 0.8409090909090909 and parameters: {'batch_size': 101, 'lr': 0.0007859080698581243, 'num_epochs': 82, 'weight_decay': 0.002723542128011689, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.0759 Acc: 0.7045
Early stopping at epoch 13 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_101_lr_0.0007859080698581243_epoch_82_wd_0.002723542128011689_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/62
----------
train Loss: 3.7893 Acc: 0.2297
val Loss: 3.6366 Acc: 0.2500
Epoch 2/62
----------
train Loss: 3.6455 Acc: 0.2823
val Loss: 3.5360 Acc: 0.2727
Epoch 3/62
----------
train Loss: 3.5107 Acc: 0.3254
val Loss: 3.3794 Acc: 0.3409
Epoch 4/62
----------
train Loss: 3.4200 Acc: 0.3445
val Loss: 3.2790 Acc: 0.3864
Epoch 5/62
----------
train Loss: 3.3351 Acc: 0.3876
val Loss: 3.2005 Acc: 0.4318
Epoch 6/62
----------
train Loss: 3.2159 Acc: 0.4354
val Loss: 3.0949 Acc: 0.5000
Epoch 7/62
----------
train Loss: 3.1011 Acc: 0.4833
val Loss: 2.9662 Acc: 0.5909
Epoch 8/62
----------
train Loss: 3.0168 Acc: 0.4880
val Loss: 2.8580 Acc: 0.6136
Epoch 9/62
----------
train Loss: 2.9284 Acc: 0.5215
val Loss: 2.7280 Acc: 0.6136
Epoch 10/62
----------
train Loss: 2.7484 Acc: 0.5072
val Loss: 2.5989 Acc: 0.6136
Epoch 11/62
----------
train Loss: 2.7535 Acc: 0.5024
val Loss: 2.5283 Acc: 0.6364
Epoch 12/62
----------
train Loss: 2.7043 Acc: 0.5215
val Loss: 2.4666 Acc: 0.6591
Epoch 13/62
----------
train Loss: 2.5513 Acc: 0.5359
val Loss: 2.3465 Acc: 0.6591
Epoch 14/62
----------
train Loss: 2.4665 Acc: 0.5359
val Loss: 2.2978 Acc: 0.6818
Epoch 15/62
----------
train Loss: 2.4688 Acc: 0.5407
val Loss: 2.2356 Acc: 0.6818
Epoch 16/62
----------
train Loss: 2.4148 Acc: 0.5311
val Loss: 2.1649 Acc: 0.6818
Epoch 17/62
----------
train Loss: 2.3431 Acc: 0.5455
val Loss: 2.1037 Acc: 0.6591
Epoch 18/62
----------
train Loss: 2.2836 Acc: 0.5311
val Loss: 2.0467 Acc: 0.6591
Epoch 19/62
----------
train Loss: 2.2298 Acc: 0.5502
val Loss: 2.0110 Acc: 0.6818
Epoch 20/62
----------
train Loss: 2.2201 Acc: 0.5263
val Loss: 1.9614 Acc: 0.6818
Epoch 21/62
----------
train Loss: 2.2170 Acc: 0.5502
val Loss: 1.9376 Acc: 0.6818
Epoch 22/62
----------
train Loss: 2.1836 Acc: 0.5837
val Loss: 1.9005 Acc: 0.6818
Epoch 23/62
----------
train Loss: 2.1340 Acc: 0.5789
val Loss: 1.8603 Acc: 0.6818
Epoch 24/62
----------
train Loss: 1.9874 Acc: 0.6029
val Loss: 1.8034 Acc: 0.6818
Epoch 25/62
----------
train Loss: 2.0957 Acc: 0.5742
val Loss: 1.8047 Acc: 0.7045
Epoch 26/62
----------
train Loss: 2.0958 Acc: 0.5789
val Loss: 1.8018 Acc: 0.7045
Epoch 27/62
----------
train Loss: 1.9321 Acc: 0.6507
val Loss: 1.7715 Acc: 0.7045
Epoch 28/62
----------
train Loss: 2.0739 Acc: 0.5837
val Loss: 1.7502 Acc: 0.7273
Epoch 29/62
----------
train Loss: 2.1113 Acc: 0.5742
val Loss: 1.7326 Acc: 0.7500
Epoch 30/62
----------
train Loss: 2.0104 Acc: 0.6077
val Loss: 1.7324 Acc: 0.7727
Epoch 31/62
----------
train Loss: 1.8700 Acc: 0.6938
val Loss: 1.6973 Acc: 0.7727
Epoch 32/62
----------
train Loss: 1.9576 Acc: 0.6364
val Loss: 1.6613 Acc: 0.7727
Epoch 33/62
----------
train Loss: 1.9918 Acc: 0.6411
val Loss: 1.6546 Acc: 0.7727
Epoch 34/62
----------
train Loss: 1.9126 Acc: 0.6890
val Loss: 1.6394 Acc: 0.7727
Epoch 35/62
----------
train Loss: 1.7195 Acc: 0.7177
val Loss: 1.6170 Acc: 0.7727
Epoch 36/62
----------
train Loss: 2.0499 Acc: 0.6268
val Loss: 1.5869 Acc: 0.7500
Epoch 37/62
----------
train Loss: 1.8171 Acc: 0.7033
val Loss: 1.5940 Acc: 0.7500
Epoch 38/62
----------
train Loss: 1.8380 Acc: 0.7608
val Loss: 1.5762 Acc: 0.7727
Epoch 39/62
----------
train Loss: 1.9229 Acc: 0.6316
val Loss: 1.6077 Acc: 0.7727
Epoch 40/62
----------
train Loss: 1.6909 Acc: 0.7368
val Loss: 1.6001 Acc: 0.7727
Epoch 41/62
----------
train Loss: 1.9914 Acc: 0.6699
val Loss: 1.5783 Acc: 0.7727
Epoch 42/62
----------
train Loss: 1.7267 Acc: 0.7225
val Loss: 1.5421 Acc: 0.7500
Epoch 43/62
----------
train Loss: 1.8192 Acc: 0.6986
val Loss: 1.5263 Acc: 0.7500
Epoch 44/62
----------
train Loss: 1.6270 Acc: 0.7895
val Loss: 1.4963 Acc: 0.7500
Epoch 45/62
----------
train Loss: 1.2924 Acc: 0.8995
val Loss: 1.4680 Acc: 0.7955
Epoch 46/62
----------
train Loss: 1.9223 Acc: 0.7656
val Loss: 1.4745 Acc: 0.7955
Epoch 47/62
----------
train Loss: 1.6042 Acc: 0.8086
val Loss: 1.4519 Acc: 0.8182
Epoch 48/62
----------
train Loss: 1.6624 Acc: 0.7656
val Loss: 1.4415 Acc: 0.8182
Epoch 49/62
----------
train Loss: 1.6266 Acc: 0.8325
val Loss: 1.4260 Acc: 0.8182
Epoch 50/62
----------
train Loss: 1.6068 Acc: 0.7895
val Loss: 1.4427 Acc: 0.7955
Epoch 51/62
----------
train Loss: 1.3185 Acc: 0.9187
val Loss: 1.4042 Acc: 0.7955
Epoch 52/62
----------
train Loss: 1.6583 Acc: 0.7368
val Loss: 1.4076 Acc: 0.8409
Epoch 53/62
----------
train Loss: 1.7757 Acc: 0.7799
val Loss: 1.3998 Acc: 0.8409
Epoch 54/62
----------
train Loss: 1.4231 Acc: 0.8900
val Loss: 1.3754 Acc: 0.8409
Epoch 55/62
----------
train Loss: 1.4886 Acc: 0.8756
val Loss: 1.3494 Acc: 0.8409
Epoch 56/62
----------
train Loss: 1.6414 Acc: 0.8421
val Loss: 1.3591 Acc: 0.8409
Epoch 57/62
----------
train Loss: 1.7769 Acc: 0.7512
val Loss: 1.3455 Acc: 0.8409
Epoch 58/62
----------
train Loss: 1.5348 Acc: 0.7895
val Loss: 1.3451 Acc: 0.8182
Epoch 59/62
----------
train Loss: 1.5908 Acc: 0.8373
val Loss: 1.3392 Acc: 0.8182
Epoch 60/62
----------
train Loss: 1.3538 Acc: 0.8182
val Loss: 1.3430 Acc: 0.8182
Epoch 61/62
----------
train Loss: 1.7591 Acc: 0.6938
val Loss: 1.3398 Acc: 0.8182
Epoch 62/62
----------
train Loss: 1.5712 Acc: 0.8756
[32m[I 2025-06-28 02:40:24,691][0m Trial 13 finished with value: 0.8181818181818182 and parameters: {'batch_size': 106, 'lr': 3.7880960270737374e-05, 'num_epochs': 62, 'weight_decay': 0.00010774239831234079, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.3348 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_106_lr_3.7880960270737374e-05_epoch_62_wd_0.00010774239831234079_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/99
----------
train Loss: 3.3745 Acc: 0.3541
val Loss: 3.3560 Acc: 0.5227
Epoch 2/99
----------
train Loss: 2.7140 Acc: 0.4976
val Loss: 3.4318 Acc: 0.5227
Epoch 3/99
----------
train Loss: 2.5293 Acc: 0.4976
val Loss: 3.6762 Acc: 0.3864
Epoch 4/99
----------
train Loss: 2.4341 Acc: 0.4976
val Loss: 3.7955 Acc: 0.4318
Epoch 5/99
----------
train Loss: 2.4024 Acc: 0.5024
val Loss: 3.9679 Acc: 0.3864
Epoch 6/99
----------
train Loss: 2.3486 Acc: 0.5072
val Loss: 4.0473 Acc: 0.3864
Epoch 7/99
----------
train Loss: 2.2510 Acc: 0.5167
[32m[I 2025-06-28 02:42:00,768][0m Trial 14 finished with value: 0.5227272727272727 and parameters: {'batch_size': 83, 'lr': 0.0006390533324470315, 'num_epochs': 99, 'weight_decay': 0.49897354675817424, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 4.2750 Acc: 0.3636
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.522727

Model weights saved at ./model_weights/efficientnetb0_bs_83_lr_0.0006390533324470315_epoch_99_wd_0.49897354675817424_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/66
----------
train Loss: 1.1948 Acc: 0.4785
val Loss: 1.7270 Acc: 0.6591
Epoch 2/66
----------
train Loss: 0.7005 Acc: 0.7177
val Loss: 1.7260 Acc: 0.6818
Epoch 3/66
----------
train Loss: 0.3939 Acc: 0.8708
val Loss: 1.7501 Acc: 0.6364
Epoch 4/66
----------
train Loss: 0.2206 Acc: 0.9474
val Loss: 0.7511 Acc: 0.7500
Epoch 5/66
----------
train Loss: 0.2059 Acc: 0.9282
val Loss: 1.3101 Acc: 0.7045
Epoch 6/66
----------
train Loss: 0.2374 Acc: 0.9139
val Loss: 1.4022 Acc: 0.6591
Epoch 7/66
----------
train Loss: 0.4057 Acc: 0.8421
val Loss: 2.3400 Acc: 0.5000
Epoch 8/66
----------
train Loss: 0.3237 Acc: 0.8756
val Loss: 1.0748 Acc: 0.6818
Epoch 9/66
----------
train Loss: 0.3922 Acc: 0.8660
val Loss: 1.0135 Acc: 0.7273
Epoch 10/66
----------
train Loss: 0.4749 Acc: 0.8660
val Loss: 0.8051 Acc: 0.6591
Epoch 11/66
----------
train Loss: 0.3972 Acc: 0.9043
val Loss: 0.6603 Acc: 0.7273
Epoch 12/66
----------
train Loss: 0.2185 Acc: 0.9282
val Loss: 1.0330 Acc: 0.6136
Epoch 13/66
----------
train Loss: 0.3082 Acc: 0.9091
val Loss: 0.8251 Acc: 0.7045
Epoch 14/66
----------
train Loss: 0.2216 Acc: 0.9282
val Loss: 1.2682 Acc: 0.7045
Epoch 15/66
----------
train Loss: 0.1061 Acc: 0.9713
val Loss: 1.0143 Acc: 0.7045
Epoch 16/66
----------
train Loss: 0.1179 Acc: 0.9522
val Loss: 1.7141 Acc: 0.3864
Epoch 17/66
----------
train Loss: 0.1211 Acc: 0.9617
val Loss: 1.0280 Acc: 0.7045
Epoch 18/66
----------
train Loss: 0.1795 Acc: 0.9426
val Loss: 0.8760 Acc: 0.7045
Epoch 19/66
----------
train Loss: 0.2124 Acc: 0.9426
val Loss: 1.3983 Acc: 0.6136
Epoch 20/66
----------
train Loss: 0.2945 Acc: 0.9282
val Loss: 1.2816 Acc: 0.7045
Epoch 21/66
----------
train Loss: 0.4491 Acc: 0.8660
val Loss: 0.9718 Acc: 0.6364
Epoch 22/66
----------
train Loss: 0.2470 Acc: 0.9426
val Loss: 0.8391 Acc: 0.6364
Epoch 23/66
----------
train Loss: 0.1008 Acc: 0.9809
val Loss: 0.7302 Acc: 0.7045
Epoch 24/66
----------
train Loss: 0.0862 Acc: 0.9713
val Loss: 0.8884 Acc: 0.6364
Epoch 25/66
----------
train Loss: 0.1364 Acc: 0.9761
val Loss: 0.8091 Acc: 0.7045
Epoch 26/66
----------
train Loss: 0.1838 Acc: 0.9474
val Loss: 1.2183 Acc: 0.7045
Epoch 27/66
----------
train Loss: 0.2522 Acc: 0.9187
val Loss: 0.8177 Acc: 0.6818
Epoch 28/66
----------
train Loss: 0.2043 Acc: 0.9474
val Loss: 0.9412 Acc: 0.6136
Epoch 29/66
----------
train Loss: 0.1432 Acc: 0.9569
val Loss: 0.8571 Acc: 0.7045
Epoch 30/66
----------
train Loss: 0.1057 Acc: 0.9665
val Loss: 0.6995 Acc: 0.7727
Epoch 31/66
----------
train Loss: 0.0834 Acc: 0.9713
val Loss: 0.6727 Acc: 0.7955
Epoch 32/66
----------
train Loss: 0.1454 Acc: 0.9474
val Loss: 0.6689 Acc: 0.7273
Epoch 33/66
----------
train Loss: 0.3107 Acc: 0.9187
val Loss: 0.7296 Acc: 0.7500
Epoch 34/66
----------
train Loss: 0.2279 Acc: 0.9426
val Loss: 1.4051 Acc: 0.5682
Epoch 35/66
----------
train Loss: 0.1675 Acc: 0.9569
val Loss: 0.6968 Acc: 0.7045
Epoch 36/66
----------
train Loss: 0.1782 Acc: 0.9378
val Loss: 1.3766 Acc: 0.6591
Epoch 37/66
----------
train Loss: 0.1649 Acc: 0.9522
val Loss: 0.7444 Acc: 0.7727
Epoch 38/66
----------
train Loss: 0.2059 Acc: 0.9282
val Loss: 1.2992 Acc: 0.7500
Epoch 39/66
----------
train Loss: 0.1377 Acc: 0.9474
val Loss: 1.2152 Acc: 0.6591
Epoch 40/66
----------
train Loss: 0.1651 Acc: 0.9426
val Loss: 1.3739 Acc: 0.6591
Epoch 41/66
----------
train Loss: 0.0835 Acc: 0.9904
val Loss: 0.8188 Acc: 0.7045
Epoch 42/66
----------
train Loss: 0.0124 Acc: 0.9952
val Loss: 0.8297 Acc: 0.7273
Epoch 43/66
----------
train Loss: 0.1614 Acc: 0.9856
val Loss: 1.3792 Acc: 0.5227
Epoch 44/66
----------
train Loss: 0.1026 Acc: 0.9809
val Loss: 0.7740 Acc: 0.6591
Epoch 45/66
----------
train Loss: 0.0804 Acc: 0.9856
val Loss: 0.8166 Acc: 0.6591
Epoch 46/66
----------
train Loss: 0.0872 Acc: 0.9761
val Loss: 0.8805 Acc: 0.7500
Epoch 47/66
----------
train Loss: 0.1676 Acc: 0.9426
val Loss: 0.9004 Acc: 0.7045
Epoch 48/66
----------
train Loss: 0.1678 Acc: 0.9378
val Loss: 1.2446 Acc: 0.6818
Epoch 49/66
----------
train Loss: 0.1731 Acc: 0.9522
val Loss: 0.8767 Acc: 0.6591
Epoch 50/66
----------
train Loss: 0.1721 Acc: 0.9474
val Loss: 0.6616 Acc: 0.7273
Epoch 51/66
----------
train Loss: 0.1203 Acc: 0.9617
val Loss: 0.9982 Acc: 0.6818
Epoch 52/66
----------
train Loss: 0.0958 Acc: 0.9761
val Loss: 0.9655 Acc: 0.6364
Epoch 53/66
----------
train Loss: 0.0427 Acc: 0.9904
val Loss: 0.7356 Acc: 0.7500
Epoch 54/66
----------
train Loss: 0.0382 Acc: 0.9856
val Loss: 1.0074 Acc: 0.6591
Epoch 55/66
----------
train Loss: 0.0585 Acc: 0.9809
val Loss: 1.3479 Acc: 0.5455
Epoch 56/66
----------
train Loss: 0.1208 Acc: 0.9665
val Loss: 1.4327 Acc: 0.6364
Epoch 57/66
----------
train Loss: 0.2665 Acc: 0.9187
val Loss: 2.6053 Acc: 0.6591
Epoch 58/66
----------
train Loss: 0.1120 Acc: 0.9569
val Loss: 1.4676 Acc: 0.7045
Epoch 59/66
----------
train Loss: 0.1002 Acc: 0.9761
val Loss: 1.0451 Acc: 0.6364
Epoch 60/66
----------
train Loss: 0.0663 Acc: 0.9713
val Loss: 0.8364 Acc: 0.6136
Epoch 61/66
----------
train Loss: 0.0621 Acc: 0.9761
val Loss: 1.4631 Acc: 0.4318
Epoch 62/66
----------
train Loss: 0.0566 Acc: 0.9856
val Loss: 1.2986 Acc: 0.5227
Epoch 63/66
----------
train Loss: 0.0644 Acc: 0.9761
[32m[I 2025-06-28 02:56:21,109][0m Trial 15 finished with value: 0.7045454545454546 and parameters: {'batch_size': 127, 'lr': 0.0019468883140186274, 'num_epochs': 66, 'weight_decay': 0.0032042109717921796, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.8174 Acc: 0.2273
Early stopping at epoch 63 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.704545

Model weights saved at ./model_weights/efficientnetb0_bs_127_lr_0.0019468883140186274_epoch_66_wd_0.0032042109717921796_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/89
----------
train Loss: 0.6929 Acc: 0.2440
val Loss: 0.6729 Acc: 0.2955
Epoch 2/89
----------
train Loss: 0.6629 Acc: 0.3062
val Loss: 0.6494 Acc: 0.3409
Epoch 3/89
----------
train Loss: 0.6386 Acc: 0.3828
val Loss: 0.6171 Acc: 0.4318
Epoch 4/89
----------
train Loss: 0.6205 Acc: 0.4258
val Loss: 0.5953 Acc: 0.4773
Epoch 5/89
----------
train Loss: 0.6065 Acc: 0.4641
val Loss: 0.5806 Acc: 0.5227
Epoch 6/89
----------
train Loss: 0.5841 Acc: 0.5024
val Loss: 0.5596 Acc: 0.5909
Epoch 7/89
----------
train Loss: 0.5612 Acc: 0.5550
val Loss: 0.5358 Acc: 0.6136
Epoch 8/89
----------
train Loss: 0.5501 Acc: 0.5359
val Loss: 0.5144 Acc: 0.6818
Epoch 9/89
----------
train Loss: 0.5340 Acc: 0.5646
val Loss: 0.4931 Acc: 0.6818
Epoch 10/89
----------
train Loss: 0.4996 Acc: 0.5598
val Loss: 0.4723 Acc: 0.6591
Epoch 11/89
----------
train Loss: 0.5054 Acc: 0.5550
val Loss: 0.4571 Acc: 0.6818
Epoch 12/89
----------
train Loss: 0.5010 Acc: 0.5646
val Loss: 0.4484 Acc: 0.6818
Epoch 13/89
----------
train Loss: 0.4702 Acc: 0.6124
val Loss: 0.4303 Acc: 0.6818
Epoch 14/89
----------
train Loss: 0.4503 Acc: 0.5981
val Loss: 0.4189 Acc: 0.6591
Epoch 15/89
----------
train Loss: 0.4558 Acc: 0.5981
val Loss: 0.4084 Acc: 0.7045
Epoch 16/89
----------
train Loss: 0.4461 Acc: 0.6172
val Loss: 0.3974 Acc: 0.7045
Epoch 17/89
----------
train Loss: 0.4354 Acc: 0.6172
val Loss: 0.3876 Acc: 0.7045
Epoch 18/89
----------
train Loss: 0.4221 Acc: 0.6651
val Loss: 0.3759 Acc: 0.7273
Epoch 19/89
----------
train Loss: 0.4045 Acc: 0.7129
val Loss: 0.3693 Acc: 0.7500
Epoch 20/89
----------
train Loss: 0.4105 Acc: 0.7081
val Loss: 0.3578 Acc: 0.7500
Epoch 21/89
----------
train Loss: 0.4086 Acc: 0.6890
val Loss: 0.3483 Acc: 0.7500
Epoch 22/89
----------
train Loss: 0.4003 Acc: 0.6842
val Loss: 0.3423 Acc: 0.7500
Epoch 23/89
----------
train Loss: 0.3933 Acc: 0.7081
val Loss: 0.3333 Acc: 0.7955
Epoch 24/89
----------
train Loss: 0.3578 Acc: 0.7799
val Loss: 0.3189 Acc: 0.7955
Epoch 25/89
----------
train Loss: 0.3804 Acc: 0.7225
val Loss: 0.3220 Acc: 0.7955
Epoch 26/89
----------
train Loss: 0.3829 Acc: 0.7560
val Loss: 0.3214 Acc: 0.7955
Epoch 27/89
----------
train Loss: 0.3359 Acc: 0.8421
val Loss: 0.3184 Acc: 0.8182
Epoch 28/89
----------
train Loss: 0.3789 Acc: 0.7464
val Loss: 0.3159 Acc: 0.7955
Epoch 29/89
----------
train Loss: 0.3988 Acc: 0.6651
val Loss: 0.3151 Acc: 0.7955
Epoch 30/89
----------
train Loss: 0.3642 Acc: 0.7273
val Loss: 0.3100 Acc: 0.7727
Epoch 31/89
----------
train Loss: 0.3223 Acc: 0.8373
val Loss: 0.3004 Acc: 0.7727
Epoch 32/89
----------
train Loss: 0.3451 Acc: 0.7703
val Loss: 0.2935 Acc: 0.7727
Epoch 33/89
----------
train Loss: 0.3637 Acc: 0.7847
val Loss: 0.2926 Acc: 0.7727
Epoch 34/89
----------
train Loss: 0.3373 Acc: 0.8278
val Loss: 0.2907 Acc: 0.7727
Epoch 35/89
----------
train Loss: 0.2907 Acc: 0.8947
val Loss: 0.2933 Acc: 0.7955
Epoch 36/89
----------
train Loss: 0.3761 Acc: 0.7368
val Loss: 0.2903 Acc: 0.7955
Epoch 37/89
----------
train Loss: 0.3210 Acc: 0.7895
val Loss: 0.2964 Acc: 0.7500
Epoch 38/89
----------
train Loss: 0.3193 Acc: 0.9091
val Loss: 0.2913 Acc: 0.7727
Epoch 39/89
----------
train Loss: 0.3478 Acc: 0.7273
val Loss: 0.2984 Acc: 0.7500
Epoch 40/89
----------
train Loss: 0.2943 Acc: 0.8421
val Loss: 0.2948 Acc: 0.7727
Epoch 41/89
----------
train Loss: 0.3633 Acc: 0.7177
val Loss: 0.2877 Acc: 0.7955
Epoch 42/89
----------
train Loss: 0.2978 Acc: 0.8038
val Loss: 0.2791 Acc: 0.7955
Epoch 43/89
----------
train Loss: 0.3199 Acc: 0.8182
val Loss: 0.2756 Acc: 0.7955
Epoch 44/89
----------
train Loss: 0.2926 Acc: 0.8469
val Loss: 0.2746 Acc: 0.7955
Epoch 45/89
----------
train Loss: 0.1998 Acc: 0.9522
val Loss: 0.2722 Acc: 0.7955
Epoch 46/89
----------
train Loss: 0.3729 Acc: 0.8134
val Loss: 0.2750 Acc: 0.8182
Epoch 47/89
----------
train Loss: 0.2823 Acc: 0.8708
val Loss: 0.2716 Acc: 0.8182
Epoch 48/89
----------
train Loss: 0.3126 Acc: 0.8086
val Loss: 0.2739 Acc: 0.8182
Epoch 49/89
----------
train Loss: 0.2971 Acc: 0.8995
val Loss: 0.2728 Acc: 0.7955
Epoch 50/89
----------
train Loss: 0.2884 Acc: 0.8469
val Loss: 0.2742 Acc: 0.7955
Epoch 51/89
----------
train Loss: 0.2233 Acc: 0.9713
val Loss: 0.2679 Acc: 0.7955
Epoch 52/89
----------
train Loss: 0.3043 Acc: 0.7895
val Loss: 0.2695 Acc: 0.7727
Epoch 53/89
----------
train Loss: 0.3368 Acc: 0.8900
val Loss: 0.2675 Acc: 0.7727
Epoch 54/89
----------
train Loss: 0.2506 Acc: 0.9234
val Loss: 0.2618 Acc: 0.7955
Epoch 55/89
----------
train Loss: 0.2671 Acc: 0.9234
val Loss: 0.2617 Acc: 0.7955
Epoch 56/89
----------
train Loss: 0.3100 Acc: 0.8612
val Loss: 0.2624 Acc: 0.7727
Epoch 57/89
----------
train Loss: 0.3473 Acc: 0.7943
val Loss: 0.2606 Acc: 0.7955
Epoch 58/89
----------
train Loss: 0.2887 Acc: 0.7990
val Loss: 0.2589 Acc: 0.8182
Epoch 59/89
----------
train Loss: 0.3004 Acc: 0.8469
val Loss: 0.2588 Acc: 0.7955
Epoch 60/89
----------
train Loss: 0.2533 Acc: 0.8517
val Loss: 0.2615 Acc: 0.7955
Epoch 61/89
----------
train Loss: 0.3413 Acc: 0.7416
val Loss: 0.2626 Acc: 0.7955
Epoch 62/89
----------
train Loss: 0.3015 Acc: 0.9330
val Loss: 0.2613 Acc: 0.7727
Epoch 63/89
----------
train Loss: 0.2617 Acc: 0.9282
val Loss: 0.2613 Acc: 0.7727
Epoch 64/89
----------
train Loss: 0.2489 Acc: 0.9234
val Loss: 0.2594 Acc: 0.7955
Epoch 65/89
----------
train Loss: 0.2821 Acc: 0.8182
val Loss: 0.2617 Acc: 0.7955
Epoch 66/89
----------
train Loss: 0.2740 Acc: 0.8900
val Loss: 0.2661 Acc: 0.7955
Epoch 67/89
----------
train Loss: 0.3071 Acc: 0.8660
val Loss: 0.2595 Acc: 0.8182
Epoch 68/89
----------
train Loss: 0.2574 Acc: 0.8947
val Loss: 0.2629 Acc: 0.7955
Epoch 69/89
----------
train Loss: 0.2570 Acc: 0.8900
val Loss: 0.2603 Acc: 0.7727
Epoch 70/89
----------
train Loss: 0.2907 Acc: 0.8947
val Loss: 0.2625 Acc: 0.7955
Epoch 71/89
----------
train Loss: 0.3042 Acc: 0.9139
val Loss: 0.2609 Acc: 0.7727
Epoch 72/89
----------
train Loss: 0.3059 Acc: 0.8756
val Loss: 0.2673 Acc: 0.7727
Epoch 73/89
----------
train Loss: 0.2172 Acc: 0.9617
val Loss: 0.2704 Acc: 0.7955
Epoch 74/89
----------
train Loss: 0.3195 Acc: 0.8517
val Loss: 0.2638 Acc: 0.7727
Epoch 75/89
----------
train Loss: 0.2374 Acc: 0.9282
val Loss: 0.2621 Acc: 0.7500
Epoch 76/89
----------
train Loss: 0.2590 Acc: 0.8134
val Loss: 0.2589 Acc: 0.7727
Epoch 77/89
----------
train Loss: 0.2954 Acc: 0.8469
val Loss: 0.2584 Acc: 0.7727
Epoch 78/89
----------
train Loss: 0.2544 Acc: 0.8708
val Loss: 0.2592 Acc: 0.7955
Epoch 79/89
----------
train Loss: 0.3149 Acc: 0.8373
val Loss: 0.2560 Acc: 0.8182
Epoch 80/89
----------
train Loss: 0.2762 Acc: 0.8469
val Loss: 0.2559 Acc: 0.8636
Epoch 81/89
----------
train Loss: 0.3188 Acc: 0.7799
val Loss: 0.2651 Acc: 0.8182
Epoch 82/89
----------
train Loss: 0.2740 Acc: 0.8325
val Loss: 0.2683 Acc: 0.7955
Epoch 83/89
----------
train Loss: 0.2367 Acc: 0.9569
val Loss: 0.2689 Acc: 0.7955
Epoch 84/89
----------
train Loss: 0.3136 Acc: 0.7799
val Loss: 0.2647 Acc: 0.7727
Epoch 85/89
----------
train Loss: 0.2491 Acc: 0.8134
val Loss: 0.2623 Acc: 0.7727
Epoch 86/89
----------
train Loss: 0.2599 Acc: 0.8756
val Loss: 0.2520 Acc: 0.8636
Epoch 87/89
----------
train Loss: 0.2934 Acc: 0.8947
val Loss: 0.2493 Acc: 0.8182
Epoch 88/89
----------
train Loss: 0.3078 Acc: 0.8995
val Loss: 0.2474 Acc: 0.8636
Epoch 89/89
----------
train Loss: 0.3345 Acc: 0.8086
[32m[I 2025-06-28 03:16:36,330][0m Trial 16 finished with value: 0.8636363636363636 and parameters: {'batch_size': 10, 'lr': 5.426464313851003e-05, 'num_epochs': 89, 'weight_decay': 0.001075112814990915, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2480 Acc: 0.8636
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_10_lr_5.426464313851003e-05_epoch_89_wd_0.001075112814990915_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 0.6946 Acc: 0.2297
val Loss: 0.6760 Acc: 0.2500
Epoch 2/88
----------
train Loss: 0.6688 Acc: 0.2823
val Loss: 0.6564 Acc: 0.3182
Epoch 3/88
----------
train Loss: 0.6478 Acc: 0.3684
val Loss: 0.6289 Acc: 0.3636
Epoch 4/88
----------
train Loss: 0.6325 Acc: 0.3828
val Loss: 0.6105 Acc: 0.4318
Epoch 5/88
----------
train Loss: 0.6212 Acc: 0.4354
val Loss: 0.5987 Acc: 0.5000
Epoch 6/88
----------
train Loss: 0.6015 Acc: 0.4833
val Loss: 0.5817 Acc: 0.5682
Epoch 7/88
----------
train Loss: 0.5814 Acc: 0.5407
val Loss: 0.5616 Acc: 0.6364
Epoch 8/88
----------
train Loss: 0.5703 Acc: 0.5359
val Loss: 0.5433 Acc: 0.6136
Epoch 9/88
----------
train Loss: 0.5554 Acc: 0.5694
val Loss: 0.5241 Acc: 0.6364
Epoch 10/88
----------
train Loss: 0.5255 Acc: 0.5646
val Loss: 0.5030 Acc: 0.6591
Epoch 11/88
----------
train Loss: 0.5292 Acc: 0.5455
val Loss: 0.4889 Acc: 0.6591
Epoch 12/88
----------
train Loss: 0.5227 Acc: 0.5502
val Loss: 0.4796 Acc: 0.6818
Epoch 13/88
----------
train Loss: 0.4946 Acc: 0.5933
val Loss: 0.4604 Acc: 0.6591
Epoch 14/88
----------
train Loss: 0.4763 Acc: 0.5933
val Loss: 0.4498 Acc: 0.6591
Epoch 15/88
----------
train Loss: 0.4779 Acc: 0.5694
val Loss: 0.4382 Acc: 0.7045
Epoch 16/88
----------
train Loss: 0.4681 Acc: 0.5885
val Loss: 0.4259 Acc: 0.6818
Epoch 17/88
----------
train Loss: 0.4573 Acc: 0.5885
val Loss: 0.4145 Acc: 0.6591
Epoch 18/88
----------
train Loss: 0.4460 Acc: 0.6459
val Loss: 0.4026 Acc: 0.6591
Epoch 19/88
----------
train Loss: 0.4296 Acc: 0.6938
val Loss: 0.3948 Acc: 0.7500
Epoch 20/88
----------
train Loss: 0.4322 Acc: 0.6603
val Loss: 0.3834 Acc: 0.7273
Epoch 21/88
----------
train Loss: 0.4291 Acc: 0.6507
val Loss: 0.3748 Acc: 0.7500
Epoch 22/88
----------
train Loss: 0.4220 Acc: 0.6411
val Loss: 0.3676 Acc: 0.7727
Epoch 23/88
----------
train Loss: 0.4133 Acc: 0.6699
val Loss: 0.3583 Acc: 0.7500
Epoch 24/88
----------
train Loss: 0.3821 Acc: 0.7368
val Loss: 0.3435 Acc: 0.7500
Epoch 25/88
----------
train Loss: 0.4030 Acc: 0.6842
val Loss: 0.3455 Acc: 0.7500
Epoch 26/88
----------
train Loss: 0.4029 Acc: 0.7129
val Loss: 0.3437 Acc: 0.7955
Epoch 27/88
----------
train Loss: 0.3613 Acc: 0.7751
val Loss: 0.3374 Acc: 0.7955
Epoch 28/88
----------
train Loss: 0.3972 Acc: 0.7033
val Loss: 0.3339 Acc: 0.7955
Epoch 29/88
----------
train Loss: 0.4146 Acc: 0.6651
val Loss: 0.3315 Acc: 0.7955
Epoch 30/88
----------
train Loss: 0.3858 Acc: 0.6986
val Loss: 0.3280 Acc: 0.7955
Epoch 31/88
----------
train Loss: 0.3474 Acc: 0.8086
val Loss: 0.3191 Acc: 0.7955
Epoch 32/88
----------
train Loss: 0.3662 Acc: 0.7464
val Loss: 0.3107 Acc: 0.7955
Epoch 33/88
----------
train Loss: 0.3840 Acc: 0.7225
val Loss: 0.3095 Acc: 0.7955
Epoch 34/88
----------
train Loss: 0.3577 Acc: 0.7847
val Loss: 0.3060 Acc: 0.7727
Epoch 35/88
----------
train Loss: 0.3172 Acc: 0.8708
val Loss: 0.3061 Acc: 0.7727
Epoch 36/88
----------
train Loss: 0.3929 Acc: 0.7321
val Loss: 0.3015 Acc: 0.8182
Epoch 37/88
----------
train Loss: 0.3425 Acc: 0.7751
val Loss: 0.3076 Acc: 0.7955
Epoch 38/88
----------
train Loss: 0.3412 Acc: 0.8612
val Loss: 0.3044 Acc: 0.7955
Epoch 39/88
----------
train Loss: 0.3643 Acc: 0.7081
val Loss: 0.3118 Acc: 0.7273
Epoch 40/88
----------
train Loss: 0.3170 Acc: 0.8134
val Loss: 0.3079 Acc: 0.7727
Epoch 41/88
----------
train Loss: 0.3754 Acc: 0.7129
val Loss: 0.3021 Acc: 0.7955
Epoch 42/88
----------
train Loss: 0.3203 Acc: 0.7799
val Loss: 0.2937 Acc: 0.7955
Epoch 43/88
----------
train Loss: 0.3418 Acc: 0.7990
val Loss: 0.2889 Acc: 0.7955
Epoch 44/88
----------
train Loss: 0.3105 Acc: 0.8278
val Loss: 0.2866 Acc: 0.7955
Epoch 45/88
----------
train Loss: 0.2242 Acc: 0.9378
val Loss: 0.2826 Acc: 0.7955
Epoch 46/88
----------
train Loss: 0.3840 Acc: 0.7799
val Loss: 0.2845 Acc: 0.7955
Epoch 47/88
----------
train Loss: 0.3005 Acc: 0.8660
val Loss: 0.2808 Acc: 0.8182
Epoch 48/88
----------
train Loss: 0.3288 Acc: 0.7799
val Loss: 0.2836 Acc: 0.7955
Epoch 49/88
----------
train Loss: 0.3134 Acc: 0.8852
val Loss: 0.2809 Acc: 0.7955
Epoch 50/88
----------
train Loss: 0.3037 Acc: 0.8325
val Loss: 0.2815 Acc: 0.7955
Epoch 51/88
----------
train Loss: 0.2449 Acc: 0.9474
val Loss: 0.2753 Acc: 0.7955
Epoch 52/88
----------
train Loss: 0.3201 Acc: 0.7703
val Loss: 0.2774 Acc: 0.7727
Epoch 53/88
----------
train Loss: 0.3503 Acc: 0.8612
val Loss: 0.2749 Acc: 0.7727
Epoch 54/88
----------
train Loss: 0.2652 Acc: 0.9091
val Loss: 0.2687 Acc: 0.7955
Epoch 55/88
----------
train Loss: 0.2830 Acc: 0.9091
val Loss: 0.2672 Acc: 0.8182
Epoch 56/88
----------
train Loss: 0.3243 Acc: 0.8373
val Loss: 0.2678 Acc: 0.7955
Epoch 57/88
----------
train Loss: 0.3570 Acc: 0.7895
val Loss: 0.2664 Acc: 0.8409
Epoch 58/88
----------
train Loss: 0.2999 Acc: 0.7990
val Loss: 0.2643 Acc: 0.8182
Epoch 59/88
----------
train Loss: 0.3144 Acc: 0.8325
val Loss: 0.2634 Acc: 0.8182
Epoch 60/88
----------
train Loss: 0.2690 Acc: 0.8373
val Loss: 0.2660 Acc: 0.7955
Epoch 61/88
----------
train Loss: 0.3528 Acc: 0.7225
val Loss: 0.2671 Acc: 0.7955
Epoch 62/88
----------
train Loss: 0.3113 Acc: 0.9091
val Loss: 0.2658 Acc: 0.8182
Epoch 63/88
----------
train Loss: 0.2711 Acc: 0.9187
val Loss: 0.2659 Acc: 0.7955
Epoch 64/88
----------
train Loss: 0.2601 Acc: 0.9282
val Loss: 0.2636 Acc: 0.7955
Epoch 65/88
----------
train Loss: 0.2932 Acc: 0.7990
val Loss: 0.2641 Acc: 0.7955
Epoch 66/88
----------
train Loss: 0.2836 Acc: 0.8804
val Loss: 0.2676 Acc: 0.7955
Epoch 67/88
----------
train Loss: 0.3152 Acc: 0.8565
val Loss: 0.2610 Acc: 0.7955
Epoch 68/88
----------
train Loss: 0.2661 Acc: 0.8995
val Loss: 0.2638 Acc: 0.7955
Epoch 69/88
----------
train Loss: 0.2673 Acc: 0.8900
val Loss: 0.2631 Acc: 0.7955
Epoch 70/88
----------
train Loss: 0.2987 Acc: 0.8852
val Loss: 0.2655 Acc: 0.7955
Epoch 71/88
----------
train Loss: 0.3136 Acc: 0.8947
val Loss: 0.2634 Acc: 0.7955
Epoch 72/88
----------
train Loss: 0.3151 Acc: 0.8612
val Loss: 0.2685 Acc: 0.7955
Epoch 73/88
----------
train Loss: 0.2228 Acc: 0.9665
val Loss: 0.2710 Acc: 0.7727
Epoch 74/88
----------
train Loss: 0.3281 Acc: 0.8278
val Loss: 0.2652 Acc: 0.7500
Epoch 75/88
----------
train Loss: 0.2469 Acc: 0.9282
val Loss: 0.2657 Acc: 0.7500
Epoch 76/88
----------
train Loss: 0.2705 Acc: 0.7990
val Loss: 0.2627 Acc: 0.7727
Epoch 77/88
----------
train Loss: 0.3019 Acc: 0.8325
val Loss: 0.2606 Acc: 0.7727
Epoch 78/88
----------
train Loss: 0.2616 Acc: 0.8708
val Loss: 0.2589 Acc: 0.7955
Epoch 79/88
----------
train Loss: 0.3245 Acc: 0.8230
val Loss: 0.2548 Acc: 0.8182
Epoch 80/88
----------
train Loss: 0.2836 Acc: 0.8421
val Loss: 0.2536 Acc: 0.8409
Epoch 81/88
----------
train Loss: 0.3247 Acc: 0.7847
val Loss: 0.2620 Acc: 0.7955
Epoch 82/88
----------
train Loss: 0.2811 Acc: 0.8325
val Loss: 0.2638 Acc: 0.7727
Epoch 83/88
----------
train Loss: 0.2410 Acc: 0.9378
val Loss: 0.2648 Acc: 0.7955
Epoch 84/88
----------
train Loss: 0.3223 Acc: 0.7656
val Loss: 0.2633 Acc: 0.7500
Epoch 85/88
----------
train Loss: 0.2580 Acc: 0.8182
val Loss: 0.2642 Acc: 0.7500
Epoch 86/88
----------
train Loss: 0.2673 Acc: 0.8756
val Loss: 0.2556 Acc: 0.7955
Epoch 87/88
----------
train Loss: 0.3021 Acc: 0.8852
val Loss: 0.2531 Acc: 0.8182
Epoch 88/88
----------
train Loss: 0.3129 Acc: 0.8995
[32m[I 2025-06-28 03:36:38,748][0m Trial 17 finished with value: 0.8409090909090909 and parameters: {'batch_size': 15, 'lr': 4.3468210995140154e-05, 'num_epochs': 88, 'weight_decay': 0.0004947358770989871, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2502 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_15_lr_4.3468210995140154e-05_epoch_88_wd_0.0004947358770989871_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/58
----------
train Loss: 6.0104 Acc: 0.1722
val Loss: 5.1250 Acc: 0.2045
Epoch 2/58
----------
train Loss: 5.9070 Acc: 0.2632
val Loss: 5.0780 Acc: 0.3864
Epoch 3/58
----------
train Loss: 5.8644 Acc: 0.2440
val Loss: 5.1525 Acc: 0.2955
Epoch 4/58
----------
train Loss: 5.7953 Acc: 0.2871
val Loss: 5.1419 Acc: 0.2500
Epoch 5/58
----------
train Loss: 5.7556 Acc: 0.3158
val Loss: 5.1183 Acc: 0.2727
Epoch 6/58
----------
train Loss: 5.5686 Acc: 0.3301
val Loss: 5.1009 Acc: 0.2045
Epoch 7/58
----------
train Loss: 5.6164 Acc: 0.3206
[32m[I 2025-06-28 03:38:14,961][0m Trial 18 finished with value: 0.38636363636363635 and parameters: {'batch_size': 101, 'lr': 9.609811173669006e-06, 'num_epochs': 58, 'weight_decay': 0.00022717699448208243, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 5.0816 Acc: 0.2727
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.386364

Model weights saved at ./model_weights/efficientnetb0_bs_101_lr_9.609811173669006e-06_epoch_58_wd_0.00022717699448208243_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/73
----------
train Loss: 5.9206 Acc: 0.2057
val Loss: 5.0173 Acc: 0.3182
Epoch 2/73
----------
train Loss: 5.0938 Acc: 0.4785
val Loss: 4.7643 Acc: 0.4545
Epoch 3/73
----------
train Loss: 4.4901 Acc: 0.6316
val Loss: 4.6054 Acc: 0.5682
Epoch 4/73
----------
train Loss: 3.9464 Acc: 0.7464
val Loss: 4.4005 Acc: 0.5909
Epoch 5/73
----------
train Loss: 3.3806 Acc: 0.8469
val Loss: 4.2390 Acc: 0.5682
Epoch 6/73
----------
train Loss: 2.9196 Acc: 0.8421
val Loss: 4.0471 Acc: 0.6364
Epoch 7/73
----------
train Loss: 2.4030 Acc: 0.8947
val Loss: 3.8006 Acc: 0.6591
Epoch 8/73
----------
train Loss: 1.9333 Acc: 0.9474
val Loss: 3.5977 Acc: 0.7273
Epoch 9/73
----------
train Loss: 1.6257 Acc: 0.9522
val Loss: 3.4480 Acc: 0.7273
Epoch 10/73
----------
train Loss: 1.3413 Acc: 0.9569
val Loss: 3.2727 Acc: 0.7500
Epoch 11/73
----------
train Loss: 1.0983 Acc: 0.9761
val Loss: 3.1187 Acc: 0.7727
Epoch 12/73
----------
train Loss: 0.8761 Acc: 0.9522
val Loss: 3.0653 Acc: 0.7955
Epoch 13/73
----------
train Loss: 0.7583 Acc: 0.9617
val Loss: 3.0263 Acc: 0.7955
Epoch 14/73
----------
train Loss: 0.6518 Acc: 0.9809
val Loss: 3.0257 Acc: 0.7955
Epoch 15/73
----------
train Loss: 0.4767 Acc: 0.9952
val Loss: 2.9720 Acc: 0.7727
Epoch 16/73
----------
train Loss: 0.3276 Acc: 1.0000
val Loss: 2.9490 Acc: 0.8182
Epoch 17/73
----------
train Loss: 0.2769 Acc: 0.9904
val Loss: 2.9263 Acc: 0.8182
Epoch 18/73
----------
train Loss: 0.2413 Acc: 1.0000
val Loss: 2.8797 Acc: 0.8182
Epoch 19/73
----------
train Loss: 0.2601 Acc: 1.0000
val Loss: 2.8578 Acc: 0.7955
Epoch 20/73
----------
train Loss: 0.2577 Acc: 0.9952
val Loss: 2.9345 Acc: 0.7955
Epoch 21/73
----------
train Loss: 0.2112 Acc: 0.9952
val Loss: 2.9316 Acc: 0.7955
Epoch 22/73
----------
train Loss: 0.2137 Acc: 0.9952
val Loss: 3.1410 Acc: 0.7955
Epoch 23/73
----------
train Loss: 0.1424 Acc: 0.9952
val Loss: 3.2746 Acc: 0.7727
Epoch 24/73
----------
train Loss: 0.1253 Acc: 0.9904
val Loss: 3.2167 Acc: 0.7955
Epoch 25/73
----------
train Loss: 0.1251 Acc: 1.0000
val Loss: 3.1943 Acc: 0.8182
Epoch 26/73
----------
train Loss: 0.1094 Acc: 1.0000
val Loss: 3.2391 Acc: 0.8182
Epoch 27/73
----------
train Loss: 0.0859 Acc: 1.0000
val Loss: 3.2252 Acc: 0.8182
Epoch 28/73
----------
train Loss: 0.1302 Acc: 0.9904
val Loss: 3.3158 Acc: 0.8182
Epoch 29/73
----------
train Loss: 0.0917 Acc: 1.0000
val Loss: 3.1832 Acc: 0.8182
Epoch 30/73
----------
train Loss: 0.0574 Acc: 1.0000
val Loss: 3.1105 Acc: 0.8182
Epoch 31/73
----------
train Loss: 0.0947 Acc: 0.9952
val Loss: 3.1527 Acc: 0.8182
Epoch 32/73
----------
train Loss: 0.0580 Acc: 1.0000
val Loss: 3.1713 Acc: 0.7955
Epoch 33/73
----------
train Loss: 0.1151 Acc: 0.9904
val Loss: 3.1531 Acc: 0.8182
Epoch 34/73
----------
train Loss: 0.0719 Acc: 1.0000
val Loss: 3.0750 Acc: 0.8182
Epoch 35/73
----------
train Loss: 0.0599 Acc: 1.0000
val Loss: 3.0800 Acc: 0.7955
Epoch 36/73
----------
train Loss: 0.0987 Acc: 1.0000
val Loss: 3.1965 Acc: 0.7727
Epoch 37/73
----------
train Loss: 0.0776 Acc: 1.0000
val Loss: 3.3089 Acc: 0.7955
Epoch 38/73
----------
train Loss: 0.0886 Acc: 1.0000
val Loss: 3.3264 Acc: 0.7500
Epoch 39/73
----------
train Loss: 0.0411 Acc: 1.0000
val Loss: 3.3379 Acc: 0.7500
Epoch 40/73
----------
train Loss: 0.0653 Acc: 1.0000
val Loss: 3.4137 Acc: 0.7500
Epoch 41/73
----------
train Loss: 0.0606 Acc: 1.0000
val Loss: 3.3415 Acc: 0.7500
Epoch 42/73
----------
train Loss: 0.0478 Acc: 1.0000
val Loss: 3.3212 Acc: 0.7500
Epoch 43/73
----------
train Loss: 0.0530 Acc: 0.9952
val Loss: 3.3125 Acc: 0.7500
Epoch 44/73
----------
train Loss: 0.0672 Acc: 0.9952
val Loss: 3.3554 Acc: 0.7727
Epoch 45/73
----------
train Loss: 0.0343 Acc: 1.0000
val Loss: 3.3291 Acc: 0.7727
Epoch 46/73
----------
train Loss: 0.0206 Acc: 1.0000
val Loss: 3.3692 Acc: 0.7727
Epoch 47/73
----------
train Loss: 0.0391 Acc: 1.0000
val Loss: 3.3465 Acc: 0.7727
Epoch 48/73
----------
train Loss: 0.0268 Acc: 1.0000
val Loss: 3.4259 Acc: 0.7955
Epoch 49/73
----------
train Loss: 0.0993 Acc: 0.9952
val Loss: 3.5066 Acc: 0.7955
Epoch 50/73
----------
train Loss: 0.0358 Acc: 1.0000
val Loss: 3.4262 Acc: 0.7727
Epoch 51/73
----------
train Loss: 0.0344 Acc: 1.0000
val Loss: 3.5180 Acc: 0.7955
Epoch 52/73
----------
train Loss: 0.0790 Acc: 0.9952
val Loss: 3.4597 Acc: 0.7727
Epoch 53/73
----------
train Loss: 0.0357 Acc: 1.0000
val Loss: 3.2998 Acc: 0.7500
Epoch 54/73
----------
train Loss: 0.0630 Acc: 0.9952
val Loss: 3.3847 Acc: 0.7727
Epoch 55/73
----------
train Loss: 0.0406 Acc: 1.0000
val Loss: 3.8843 Acc: 0.7727
Epoch 56/73
----------
train Loss: 0.0352 Acc: 1.0000
val Loss: 4.1074 Acc: 0.7727
Epoch 57/73
----------
train Loss: 0.0783 Acc: 0.9952
val Loss: 4.1254 Acc: 0.7500
Epoch 58/73
----------
train Loss: 0.0606 Acc: 0.9952
val Loss: 3.8903 Acc: 0.7273
Epoch 59/73
----------
train Loss: 0.0358 Acc: 1.0000
val Loss: 3.8024 Acc: 0.7727
Epoch 60/73
----------
train Loss: 0.0235 Acc: 1.0000
val Loss: 3.6840 Acc: 0.7727
Epoch 61/73
----------
train Loss: 0.1267 Acc: 0.9952
val Loss: 3.7038 Acc: 0.7500
Epoch 62/73
----------
train Loss: 0.0226 Acc: 1.0000
val Loss: 3.4916 Acc: 0.7500
Epoch 63/73
----------
train Loss: 0.0464 Acc: 0.9952
val Loss: 3.3944 Acc: 0.7500
Epoch 64/73
----------
train Loss: 0.0677 Acc: 0.9904
val Loss: 3.1070 Acc: 0.7500
Epoch 65/73
----------
train Loss: 0.0629 Acc: 1.0000
val Loss: 2.9808 Acc: 0.7500
Epoch 66/73
----------
train Loss: 0.0190 Acc: 1.0000
val Loss: 3.0253 Acc: 0.7500
Epoch 67/73
----------
train Loss: 0.0305 Acc: 1.0000
val Loss: 3.0646 Acc: 0.7500
Epoch 68/73
----------
train Loss: 0.0281 Acc: 1.0000
val Loss: 3.2048 Acc: 0.7727
Epoch 69/73
----------
train Loss: 0.0348 Acc: 1.0000
val Loss: 3.3721 Acc: 0.7727
Epoch 70/73
----------
train Loss: 0.0392 Acc: 0.9952
val Loss: 3.3580 Acc: 0.7727
Epoch 71/73
----------
train Loss: 0.0197 Acc: 1.0000
val Loss: 3.3893 Acc: 0.7727
Epoch 72/73
----------
train Loss: 0.0336 Acc: 1.0000
val Loss: 3.3951 Acc: 0.7727
Epoch 73/73
----------
train Loss: 0.0422 Acc: 0.9952
[32m[I 2025-06-28 03:54:53,365][0m Trial 19 finished with value: 0.7727272727272727 and parameters: {'batch_size': 26, 'lr': 0.00011028138100031731, 'num_epochs': 73, 'weight_decay': 0.000788768714071309, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.3768 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_26_lr_0.00011028138100031731_epoch_73_wd_0.000788768714071309_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 3.6822 Acc: 0.2727
val Loss: 3.4610 Acc: 0.2955
Epoch 2/92
----------
train Loss: 3.3012 Acc: 0.4689
val Loss: 3.0805 Acc: 0.5227
Epoch 3/92
----------
train Loss: 2.9742 Acc: 0.4737
val Loss: 2.5754 Acc: 0.6364
Epoch 4/92
----------
train Loss: 2.7328 Acc: 0.5167
val Loss: 2.2673 Acc: 0.6364
Epoch 5/92
----------
train Loss: 2.5548 Acc: 0.5120
val Loss: 2.0948 Acc: 0.6364
Epoch 6/92
----------
train Loss: 2.3506 Acc: 0.5263
val Loss: 1.9505 Acc: 0.6364
Epoch 7/92
----------
train Loss: 2.2204 Acc: 0.5455
val Loss: 1.8541 Acc: 0.6591
Epoch 8/92
----------
train Loss: 2.2496 Acc: 0.5359
val Loss: 1.7744 Acc: 0.6591
Epoch 9/92
----------
train Loss: 2.1853 Acc: 0.5694
val Loss: 1.7519 Acc: 0.6591
Epoch 10/92
----------
train Loss: 1.8136 Acc: 0.6555
val Loss: 1.7188 Acc: 0.6818
Epoch 11/92
----------
train Loss: 2.0504 Acc: 0.5933
val Loss: 1.6693 Acc: 0.7045
Epoch 12/92
----------
train Loss: 2.0566 Acc: 0.5981
val Loss: 1.6504 Acc: 0.7500
Epoch 13/92
----------
train Loss: 1.8243 Acc: 0.7129
val Loss: 1.5732 Acc: 0.7273
Epoch 14/92
----------
train Loss: 1.7070 Acc: 0.7464
val Loss: 1.5361 Acc: 0.7500
Epoch 15/92
----------
train Loss: 1.8168 Acc: 0.7081
val Loss: 1.4806 Acc: 0.7727
Epoch 16/92
----------
train Loss: 1.7677 Acc: 0.7464
val Loss: 1.4388 Acc: 0.7727
Epoch 17/92
----------
train Loss: 1.6533 Acc: 0.7799
val Loss: 1.4164 Acc: 0.7955
Epoch 18/92
----------
train Loss: 1.5264 Acc: 0.8086
val Loss: 1.3344 Acc: 0.8182
Epoch 19/92
----------
train Loss: 1.4583 Acc: 0.8612
val Loss: 1.3025 Acc: 0.8409
Epoch 20/92
----------
train Loss: 1.5220 Acc: 0.8230
val Loss: 1.2793 Acc: 0.8409
Epoch 21/92
----------
train Loss: 1.5908 Acc: 0.7990
val Loss: 1.2541 Acc: 0.8636
Epoch 22/92
----------
train Loss: 1.4411 Acc: 0.8134
val Loss: 1.2533 Acc: 0.8182
Epoch 23/92
----------
train Loss: 1.5684 Acc: 0.8612
val Loss: 1.2202 Acc: 0.8636
Epoch 24/92
----------
train Loss: 1.1734 Acc: 0.9139
val Loss: 1.1578 Acc: 0.8409
Epoch 25/92
----------
train Loss: 1.3543 Acc: 0.9139
val Loss: 1.1613 Acc: 0.8182
Epoch 26/92
----------
train Loss: 1.4521 Acc: 0.9139
val Loss: 1.1825 Acc: 0.8636
Epoch 27/92
----------
train Loss: 1.1776 Acc: 0.9761
val Loss: 1.2432 Acc: 0.8409
Epoch 28/92
----------
train Loss: 1.4600 Acc: 0.8708
val Loss: 1.2803 Acc: 0.8182
Epoch 29/92
----------
train Loss: 1.5630 Acc: 0.7608
val Loss: 1.2567 Acc: 0.8409
Epoch 30/92
----------
train Loss: 1.3267 Acc: 0.8612
val Loss: 1.2247 Acc: 0.7955
Epoch 31/92
----------
train Loss: 1.1653 Acc: 0.9378
val Loss: 1.1936 Acc: 0.8409
Epoch 32/92
----------
train Loss: 1.3584 Acc: 0.8517
val Loss: 1.1630 Acc: 0.8182
Epoch 33/92
----------
train Loss: 1.3859 Acc: 0.8565
val Loss: 1.1973 Acc: 0.8182
Epoch 34/92
----------
train Loss: 1.3373 Acc: 0.9139
val Loss: 1.2425 Acc: 0.7955
Epoch 35/92
----------
train Loss: 1.0216 Acc: 0.9856
val Loss: 1.3143 Acc: 0.7727
Epoch 36/92
----------
train Loss: 1.5674 Acc: 0.8182
val Loss: 1.3314 Acc: 0.7500
Epoch 37/92
----------
train Loss: 1.2838 Acc: 0.8278
val Loss: 1.2992 Acc: 0.7500
Epoch 38/92
----------
train Loss: 1.3242 Acc: 0.9378
val Loss: 1.2434 Acc: 0.8182
Epoch 39/92
----------
train Loss: 1.4097 Acc: 0.7847
val Loss: 1.2530 Acc: 0.8182
Epoch 40/92
----------
train Loss: 1.1466 Acc: 0.8947
val Loss: 1.2867 Acc: 0.8182
Epoch 41/92
----------
train Loss: 1.6552 Acc: 0.7225
val Loss: 1.2826 Acc: 0.8636
Epoch 42/92
----------
train Loss: 1.1410 Acc: 0.8900
val Loss: 1.2974 Acc: 0.8182
Epoch 43/92
----------
train Loss: 1.3028 Acc: 0.8660
val Loss: 1.2649 Acc: 0.8182
Epoch 44/92
----------
train Loss: 1.2224 Acc: 0.8708
val Loss: 1.2825 Acc: 0.8409
Epoch 45/92
----------
train Loss: 0.7737 Acc: 0.9713
val Loss: 1.2536 Acc: 0.8409
Epoch 46/92
----------
train Loss: 1.6511 Acc: 0.7847
val Loss: 1.2524 Acc: 0.8182
Epoch 47/92
----------
train Loss: 1.1918 Acc: 0.8900
val Loss: 1.2355 Acc: 0.7955
Epoch 48/92
----------
train Loss: 1.3291 Acc: 0.8756
val Loss: 1.2468 Acc: 0.7955
Epoch 49/92
----------
train Loss: 1.2644 Acc: 0.9474
val Loss: 1.2817 Acc: 0.7727
Epoch 50/92
----------
train Loss: 1.2680 Acc: 0.8852
val Loss: 1.3166 Acc: 0.7727
Epoch 51/92
----------
train Loss: 0.9239 Acc: 0.9856
val Loss: 1.2667 Acc: 0.7727
Epoch 52/92
----------
train Loss: 1.3401 Acc: 0.8230
val Loss: 1.2473 Acc: 0.7955
Epoch 53/92
----------
train Loss: 1.5173 Acc: 0.8947
val Loss: 1.2373 Acc: 0.8182
Epoch 54/92
----------
train Loss: 1.1341 Acc: 0.9330
val Loss: 1.2533 Acc: 0.7955
Epoch 55/92
----------
train Loss: 1.1847 Acc: 0.9426
val Loss: 1.2754 Acc: 0.7955
Epoch 56/92
----------
train Loss: 1.3689 Acc: 0.9091
val Loss: 1.2871 Acc: 0.7727
Epoch 57/92
----------
train Loss: 1.5270 Acc: 0.8421
val Loss: 1.2925 Acc: 0.7955
Epoch 58/92
----------
train Loss: 1.2744 Acc: 0.7990
val Loss: 1.2853 Acc: 0.8182
Epoch 59/92
----------
train Loss: 1.2723 Acc: 0.9043
val Loss: 1.2959 Acc: 0.8182
Epoch 60/92
----------
train Loss: 1.0500 Acc: 0.8947
val Loss: 1.2893 Acc: 0.8636
Epoch 61/92
----------
train Loss: 1.4885 Acc: 0.7656
val Loss: 1.3019 Acc: 0.8182
Epoch 62/92
----------
train Loss: 1.3823 Acc: 0.9617
val Loss: 1.3023 Acc: 0.7955
Epoch 63/92
----------
train Loss: 1.1851 Acc: 0.9378
val Loss: 1.3052 Acc: 0.7727
Epoch 64/92
----------
train Loss: 1.0888 Acc: 0.9617
val Loss: 1.2966 Acc: 0.8182
Epoch 65/92
----------
train Loss: 1.2455 Acc: 0.8565
val Loss: 1.3186 Acc: 0.7727
Epoch 66/92
----------
train Loss: 1.2243 Acc: 0.9043
val Loss: 1.3071 Acc: 0.7500
Epoch 67/92
----------
train Loss: 1.4019 Acc: 0.8804
val Loss: 1.2971 Acc: 0.7500
Epoch 68/92
----------
train Loss: 1.1354 Acc: 0.9043
val Loss: 1.3283 Acc: 0.7727
Epoch 69/92
----------
train Loss: 1.1013 Acc: 0.8995
val Loss: 1.2832 Acc: 0.7955
Epoch 70/92
----------
train Loss: 1.2731 Acc: 0.8995
val Loss: 1.2655 Acc: 0.8182
Epoch 71/92
----------
train Loss: 1.3656 Acc: 0.9234
val Loss: 1.2699 Acc: 0.7955
Epoch 72/92
----------
train Loss: 1.3396 Acc: 0.8995
val Loss: 1.3237 Acc: 0.8182
Epoch 73/92
----------
train Loss: 0.9839 Acc: 0.9713
val Loss: 1.3074 Acc: 0.7955
Epoch 74/92
----------
train Loss: 1.3971 Acc: 0.8708
val Loss: 1.2681 Acc: 0.7500
Epoch 75/92
----------
train Loss: 1.0743 Acc: 0.9665
val Loss: 1.2526 Acc: 0.8182
Epoch 76/92
----------
train Loss: 1.1011 Acc: 0.8708
val Loss: 1.2399 Acc: 0.8409
Epoch 77/92
----------
train Loss: 1.2891 Acc: 0.8852
val Loss: 1.2453 Acc: 0.8409
Epoch 78/92
----------
train Loss: 1.1978 Acc: 0.9091
val Loss: 1.2831 Acc: 0.8409
Epoch 79/92
----------
train Loss: 1.3378 Acc: 0.8900
val Loss: 1.3041 Acc: 0.8409
Epoch 80/92
----------
train Loss: 1.2397 Acc: 0.8660
val Loss: 1.3301 Acc: 0.8409
Epoch 81/92
----------
train Loss: 1.4175 Acc: 0.8278
val Loss: 1.3687 Acc: 0.8409
Epoch 82/92
----------
train Loss: 1.1781 Acc: 0.8804
val Loss: 1.3737 Acc: 0.8182
Epoch 83/92
----------
train Loss: 1.1006 Acc: 0.9761
val Loss: 1.3620 Acc: 0.8182
Epoch 84/92
----------
train Loss: 1.3820 Acc: 0.7799
val Loss: 1.3557 Acc: 0.8182
Epoch 85/92
----------
train Loss: 1.1072 Acc: 0.8373
val Loss: 1.3816 Acc: 0.7727
Epoch 86/92
----------
train Loss: 1.1379 Acc: 0.8947
val Loss: 1.3340 Acc: 0.8182
Epoch 87/92
----------
train Loss: 1.2882 Acc: 0.9522
val Loss: 1.2860 Acc: 0.7955
Epoch 88/92
----------
train Loss: 1.3897 Acc: 0.9187
val Loss: 1.2756 Acc: 0.8409
Epoch 89/92
----------
train Loss: 1.4883 Acc: 0.8134
val Loss: 1.2703 Acc: 0.8636
Epoch 90/92
----------
train Loss: 1.2940 Acc: 0.8565
val Loss: 1.2631 Acc: 0.8182
Epoch 91/92
----------
train Loss: 1.0818 Acc: 0.9761
val Loss: 1.2633 Acc: 0.7955
Epoch 92/92
----------
train Loss: 1.2061 Acc: 0.9474
[32m[I 2025-06-28 04:15:50,371][0m Trial 20 finished with value: 0.8181818181818182 and parameters: {'batch_size': 35, 'lr': 0.00012656115762383228, 'num_epochs': 92, 'weight_decay': 0.004090454495173574, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.2960 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_35_lr_0.00012656115762383228_epoch_92_wd_0.004090454495173574_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/85
----------
train Loss: 0.5643 Acc: 0.4306
val Loss: 0.3566 Acc: 0.6364
Epoch 2/85
----------
train Loss: 0.4802 Acc: 0.6077
val Loss: 0.3993 Acc: 0.6591
Epoch 3/85
----------
train Loss: 0.4265 Acc: 0.6986
val Loss: 0.2968 Acc: 0.7045
Epoch 4/85
----------
train Loss: 0.4129 Acc: 0.6268
val Loss: 0.3843 Acc: 0.6136
Epoch 5/85
----------
train Loss: 0.3840 Acc: 0.7464
val Loss: 0.3467 Acc: 0.7045
Epoch 6/85
----------
train Loss: 0.3557 Acc: 0.7321
val Loss: 0.3243 Acc: 0.7273
Epoch 7/85
----------
train Loss: 0.3152 Acc: 0.8373
val Loss: 0.2973 Acc: 0.7727
Epoch 8/85
----------
train Loss: 0.3383 Acc: 0.7895
val Loss: 0.3122 Acc: 0.7045
Epoch 9/85
----------
train Loss: 0.3505 Acc: 0.7847
val Loss: 0.3232 Acc: 0.7045
Epoch 10/85
----------
train Loss: 0.2381 Acc: 0.9187
val Loss: 0.2237 Acc: 0.7955
Epoch 11/85
----------
train Loss: 0.3345 Acc: 0.8182
val Loss: 0.3015 Acc: 0.7727
Epoch 12/85
----------
train Loss: 0.2865 Acc: 0.7895
val Loss: 0.3226 Acc: 0.5909
Epoch 13/85
----------
train Loss: 0.2885 Acc: 0.8804
val Loss: 0.2899 Acc: 0.7500
Epoch 14/85
----------
train Loss: 0.2581 Acc: 0.8373
val Loss: 0.2722 Acc: 0.7500
Epoch 15/85
----------
train Loss: 0.3061 Acc: 0.8182
val Loss: 0.2742 Acc: 0.7955
Epoch 16/85
----------
train Loss: 0.3096 Acc: 0.7656
val Loss: 0.3664 Acc: 0.7727
Epoch 17/85
----------
train Loss: 0.2883 Acc: 0.8278
val Loss: 0.3168 Acc: 0.7045
Epoch 18/85
----------
train Loss: 0.2653 Acc: 0.8708
val Loss: 0.2647 Acc: 0.7955
Epoch 19/85
----------
train Loss: 0.2433 Acc: 0.9234
val Loss: 0.3244 Acc: 0.7045
Epoch 20/85
----------
train Loss: 0.2747 Acc: 0.8852
val Loss: 0.2821 Acc: 0.7500
Epoch 21/85
----------
train Loss: 0.2838 Acc: 0.9043
val Loss: 0.2809 Acc: 0.7727
Epoch 22/85
----------
train Loss: 0.2612 Acc: 0.8756
val Loss: 0.2646 Acc: 0.7500
Epoch 23/85
----------
train Loss: 0.3052 Acc: 0.8947
val Loss: 0.2446 Acc: 0.7955
Epoch 24/85
----------
train Loss: 0.2231 Acc: 0.8995
val Loss: 0.2429 Acc: 0.7727
Epoch 25/85
----------
train Loss: 0.2460 Acc: 0.9617
val Loss: 0.2696 Acc: 0.7500
Epoch 26/85
----------
train Loss: 0.2782 Acc: 0.9426
val Loss: 0.2903 Acc: 0.7273
Epoch 27/85
----------
train Loss: 0.2359 Acc: 0.9665
val Loss: 0.3024 Acc: 0.6591
Epoch 28/85
----------
train Loss: 0.2842 Acc: 0.8756
val Loss: 0.2813 Acc: 0.7500
Epoch 29/85
----------
train Loss: 0.2992 Acc: 0.8134
val Loss: 0.3104 Acc: 0.7727
Epoch 30/85
----------
train Loss: 0.2617 Acc: 0.8900
val Loss: 0.2838 Acc: 0.7045
Epoch 31/85
----------
train Loss: 0.2266 Acc: 0.9187
val Loss: 0.2656 Acc: 0.7273
Epoch 32/85
----------
train Loss: 0.2402 Acc: 0.9091
val Loss: 0.2910 Acc: 0.7273
Epoch 33/85
----------
train Loss: 0.2715 Acc: 0.9043
val Loss: 0.2929 Acc: 0.7273
Epoch 34/85
----------
train Loss: 0.2567 Acc: 0.9522
val Loss: 0.2981 Acc: 0.6818
Epoch 35/85
----------
train Loss: 0.1954 Acc: 0.9761
val Loss: 0.2975 Acc: 0.7045
Epoch 36/85
----------
train Loss: 0.3079 Acc: 0.8756
val Loss: 0.2652 Acc: 0.7727
Epoch 37/85
----------
train Loss: 0.2714 Acc: 0.8565
val Loss: 0.3497 Acc: 0.6591
Epoch 38/85
----------
train Loss: 0.2712 Acc: 0.9426
val Loss: 0.2726 Acc: 0.7727
Epoch 39/85
----------
train Loss: 0.2658 Acc: 0.8182
val Loss: 0.2919 Acc: 0.8182
Epoch 40/85
----------
train Loss: 0.2370 Acc: 0.9282
val Loss: 0.2925 Acc: 0.7727
Epoch 41/85
----------
train Loss: 0.3122 Acc: 0.7225
val Loss: 0.3016 Acc: 0.7273
Epoch 42/85
----------
train Loss: 0.2328 Acc: 0.8660
val Loss: 0.3117 Acc: 0.6818
Epoch 43/85
----------
train Loss: 0.2616 Acc: 0.8756
val Loss: 0.2798 Acc: 0.7045
Epoch 44/85
----------
train Loss: 0.2393 Acc: 0.8804
val Loss: 0.2995 Acc: 0.7273
Epoch 45/85
----------
train Loss: 0.1506 Acc: 0.9617
val Loss: 0.2651 Acc: 0.7727
Epoch 46/85
----------
train Loss: 0.3455 Acc: 0.8278
val Loss: 0.3408 Acc: 0.7045
Epoch 47/85
----------
train Loss: 0.2503 Acc: 0.8995
val Loss: 0.3606 Acc: 0.6136
Epoch 48/85
----------
train Loss: 0.2703 Acc: 0.8565
val Loss: 0.3317 Acc: 0.7273
Epoch 49/85
----------
train Loss: 0.2646 Acc: 0.9378
val Loss: 0.3214 Acc: 0.6591
Epoch 50/85
----------
train Loss: 0.2562 Acc: 0.8660
val Loss: 0.3250 Acc: 0.6364
Epoch 51/85
----------
train Loss: 0.1941 Acc: 0.9904
val Loss: 0.3225 Acc: 0.7500
Epoch 52/85
----------
train Loss: 0.2563 Acc: 0.8900
val Loss: 0.2769 Acc: 0.7727
Epoch 53/85
----------
train Loss: 0.2966 Acc: 0.9139
val Loss: 0.2910 Acc: 0.7045
Epoch 54/85
----------
train Loss: 0.2286 Acc: 0.9522
val Loss: 0.2932 Acc: 0.7727
Epoch 55/85
----------
train Loss: 0.2354 Acc: 0.9617
val Loss: 0.2880 Acc: 0.7727
Epoch 56/85
----------
train Loss: 0.2767 Acc: 0.9378
val Loss: 0.2920 Acc: 0.6364
Epoch 57/85
----------
train Loss: 0.3129 Acc: 0.8565
val Loss: 0.3736 Acc: 0.6364
Epoch 58/85
----------
train Loss: 0.2462 Acc: 0.8421
val Loss: 0.3650 Acc: 0.6818
Epoch 59/85
----------
train Loss: 0.2621 Acc: 0.9043
val Loss: 0.3551 Acc: 0.7045
Epoch 60/85
----------
train Loss: 0.2133 Acc: 0.9234
[32m[I 2025-06-28 04:29:31,933][0m Trial 21 finished with value: 0.7727272727272727 and parameters: {'batch_size': 71, 'lr': 0.0013830505210963842, 'num_epochs': 85, 'weight_decay': 0.0001390194102474774, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3304 Acc: 0.6591
Early stopping at epoch 60 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_71_lr_0.0013830505210963842_epoch_85_wd_0.0001390194102474774_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/91
----------
train Loss: 0.6234 Acc: 0.3732
val Loss: 0.5297 Acc: 0.6364
Epoch 2/91
----------
train Loss: 0.4930 Acc: 0.5742
val Loss: 0.3836 Acc: 0.6364
Epoch 3/91
----------
train Loss: 0.4382 Acc: 0.5933
val Loss: 0.3438 Acc: 0.7273
Epoch 4/91
----------
train Loss: 0.4140 Acc: 0.6124
val Loss: 0.3278 Acc: 0.7500
Epoch 5/91
----------
train Loss: 0.3990 Acc: 0.7464
val Loss: 0.3288 Acc: 0.7500
Epoch 6/91
----------
train Loss: 0.3648 Acc: 0.7225
val Loss: 0.2693 Acc: 0.8182
Epoch 7/91
----------
train Loss: 0.3201 Acc: 0.8852
val Loss: 0.2432 Acc: 0.8409
Epoch 8/91
----------
train Loss: 0.3408 Acc: 0.7990
val Loss: 0.2531 Acc: 0.7955
Epoch 9/91
----------
train Loss: 0.3465 Acc: 0.7703
val Loss: 0.3219 Acc: 0.7727
Epoch 10/91
----------
train Loss: 0.2216 Acc: 0.9474
val Loss: 0.2330 Acc: 0.7955
Epoch 11/91
----------
train Loss: 0.3365 Acc: 0.8086
val Loss: 0.2459 Acc: 0.8182
Epoch 12/91
----------
train Loss: 0.2909 Acc: 0.7990
val Loss: 0.3587 Acc: 0.7045
Epoch 13/91
----------
train Loss: 0.2803 Acc: 0.9091
val Loss: 0.3276 Acc: 0.7273
Epoch 14/91
----------
train Loss: 0.2536 Acc: 0.8373
val Loss: 0.2833 Acc: 0.7727
Epoch 15/91
----------
train Loss: 0.2887 Acc: 0.8421
val Loss: 0.2561 Acc: 0.7955
Epoch 16/91
----------
train Loss: 0.2894 Acc: 0.8230
val Loss: 0.2945 Acc: 0.7955
Epoch 17/91
----------
train Loss: 0.2890 Acc: 0.8469
val Loss: 0.3117 Acc: 0.7273
Epoch 18/91
----------
train Loss: 0.2664 Acc: 0.8565
val Loss: 0.3203 Acc: 0.7045
Epoch 19/91
----------
train Loss: 0.2537 Acc: 0.9282
val Loss: 0.3414 Acc: 0.7273
Epoch 20/91
----------
train Loss: 0.2765 Acc: 0.8804
val Loss: 0.3064 Acc: 0.7273
Epoch 21/91
----------
train Loss: 0.2928 Acc: 0.8756
val Loss: 0.2706 Acc: 0.8409
Epoch 22/91
----------
train Loss: 0.2583 Acc: 0.8708
val Loss: 0.2589 Acc: 0.8409
Epoch 23/91
----------
train Loss: 0.3004 Acc: 0.8660
val Loss: 0.2566 Acc: 0.7955
Epoch 24/91
----------
train Loss: 0.2342 Acc: 0.9043
val Loss: 0.2466 Acc: 0.7727
Epoch 25/91
----------
train Loss: 0.2547 Acc: 0.9282
val Loss: 0.2899 Acc: 0.7273
Epoch 26/91
----------
train Loss: 0.2854 Acc: 0.9330
val Loss: 0.2795 Acc: 0.7500
Epoch 27/91
----------
train Loss: 0.2411 Acc: 0.9617
val Loss: 0.3259 Acc: 0.7273
Epoch 28/91
----------
train Loss: 0.2807 Acc: 0.8517
val Loss: 0.3035 Acc: 0.7045
Epoch 29/91
----------
train Loss: 0.3084 Acc: 0.8038
val Loss: 0.3071 Acc: 0.8182
Epoch 30/91
----------
train Loss: 0.2603 Acc: 0.8852
val Loss: 0.2219 Acc: 0.8182
Epoch 31/91
----------
train Loss: 0.2279 Acc: 0.9474
val Loss: 0.2227 Acc: 0.7955
Epoch 32/91
----------
train Loss: 0.2411 Acc: 0.8995
val Loss: 0.2385 Acc: 0.8182
Epoch 33/91
----------
train Loss: 0.2745 Acc: 0.9043
val Loss: 0.2748 Acc: 0.7727
Epoch 34/91
----------
train Loss: 0.2612 Acc: 0.9474
val Loss: 0.3152 Acc: 0.7500
Epoch 35/91
----------
train Loss: 0.2099 Acc: 0.9665
val Loss: 0.2853 Acc: 0.7045
Epoch 36/91
----------
train Loss: 0.3180 Acc: 0.8804
val Loss: 0.2804 Acc: 0.7500
Epoch 37/91
----------
train Loss: 0.2714 Acc: 0.8421
val Loss: 0.3139 Acc: 0.7273
Epoch 38/91
----------
train Loss: 0.2765 Acc: 0.9282
val Loss: 0.2888 Acc: 0.7045
Epoch 39/91
----------
train Loss: 0.2767 Acc: 0.7895
val Loss: 0.2914 Acc: 0.7273
Epoch 40/91
----------
train Loss: 0.2376 Acc: 0.9282
val Loss: 0.2941 Acc: 0.7500
Epoch 41/91
----------
train Loss: 0.3156 Acc: 0.7225
val Loss: 0.2776 Acc: 0.7727
Epoch 42/91
----------
train Loss: 0.2352 Acc: 0.8947
val Loss: 0.3185 Acc: 0.7045
Epoch 43/91
----------
train Loss: 0.2588 Acc: 0.8756
val Loss: 0.2801 Acc: 0.7727
Epoch 44/91
----------
train Loss: 0.2510 Acc: 0.8804
val Loss: 0.3474 Acc: 0.7045
Epoch 45/91
----------
train Loss: 0.1632 Acc: 0.9665
val Loss: 0.2810 Acc: 0.7500
Epoch 46/91
----------
train Loss: 0.3458 Acc: 0.8278
val Loss: 0.3045 Acc: 0.7727
Epoch 47/91
----------
train Loss: 0.2507 Acc: 0.9091
val Loss: 0.3256 Acc: 0.7273
Epoch 48/91
----------
train Loss: 0.2743 Acc: 0.8565
val Loss: 0.3595 Acc: 0.6364
Epoch 49/91
----------
train Loss: 0.2653 Acc: 0.9234
val Loss: 0.3128 Acc: 0.6591
Epoch 50/91
----------
train Loss: 0.2599 Acc: 0.8612
val Loss: 0.3035 Acc: 0.7045
Epoch 51/91
----------
train Loss: 0.2030 Acc: 0.9809
val Loss: 0.2668 Acc: 0.7500
Epoch 52/91
----------
train Loss: 0.2652 Acc: 0.8612
val Loss: 0.3004 Acc: 0.7273
Epoch 53/91
----------
train Loss: 0.3062 Acc: 0.9091
val Loss: 0.3274 Acc: 0.6818
Epoch 54/91
----------
train Loss: 0.2340 Acc: 0.9378
val Loss: 0.2915 Acc: 0.7500
Epoch 55/91
----------
train Loss: 0.2475 Acc: 0.9569
val Loss: 0.2970 Acc: 0.7045
Epoch 56/91
----------
train Loss: 0.2832 Acc: 0.9282
val Loss: 0.2678 Acc: 0.7273
Epoch 57/91
----------
train Loss: 0.3197 Acc: 0.8565
val Loss: 0.2776 Acc: 0.7500
Epoch 58/91
----------
train Loss: 0.2579 Acc: 0.8373
val Loss: 0.3121 Acc: 0.7727
Epoch 59/91
----------
train Loss: 0.2650 Acc: 0.8995
val Loss: 0.3340 Acc: 0.6818
Epoch 60/91
----------
train Loss: 0.2230 Acc: 0.8900
val Loss: 0.3096 Acc: 0.7045
Epoch 61/91
----------
train Loss: 0.3113 Acc: 0.8230
val Loss: 0.3117 Acc: 0.7045
Epoch 62/91
----------
train Loss: 0.3058 Acc: 0.9139
val Loss: 0.3470 Acc: 0.5909
Epoch 63/91
----------
train Loss: 0.2582 Acc: 0.9426
[32m[I 2025-06-28 04:43:53,845][0m Trial 22 finished with value: 0.7727272727272727 and parameters: {'batch_size': 57, 'lr': 0.0005353754948116811, 'num_epochs': 91, 'weight_decay': 0.0014188652952479665, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3355 Acc: 0.6364
Early stopping at epoch 63 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_57_lr_0.0005353754948116811_epoch_91_wd_0.0014188652952479665_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/99
----------
train Loss: 0.7008 Acc: 0.2249
val Loss: 0.6859 Acc: 0.1591
Epoch 2/99
----------
train Loss: 0.6905 Acc: 0.2297
val Loss: 0.6804 Acc: 0.2273
Epoch 3/99
----------
train Loss: 0.6832 Acc: 0.2249
val Loss: 0.6699 Acc: 0.1818
Epoch 4/99
----------
train Loss: 0.6796 Acc: 0.2536
val Loss: 0.6647 Acc: 0.2045
Epoch 5/99
----------
train Loss: 0.6808 Acc: 0.2297
val Loss: 0.6636 Acc: 0.2500
Epoch 6/99
----------
train Loss: 0.6735 Acc: 0.2679
val Loss: 0.6599 Acc: 0.2273
Epoch 7/99
----------
train Loss: 0.6683 Acc: 0.2536
val Loss: 0.6560 Acc: 0.2727
Epoch 8/99
----------
train Loss: 0.6606 Acc: 0.3110
val Loss: 0.6536 Acc: 0.2727
Epoch 9/99
----------
train Loss: 0.6573 Acc: 0.3349
val Loss: 0.6496 Acc: 0.2955
Epoch 10/99
----------
train Loss: 0.6518 Acc: 0.3014
val Loss: 0.6444 Acc: 0.3182
Epoch 11/99
----------
train Loss: 0.6507 Acc: 0.2823
val Loss: 0.6419 Acc: 0.2955
Epoch 12/99
----------
train Loss: 0.6472 Acc: 0.3206
val Loss: 0.6399 Acc: 0.3636
Epoch 13/99
----------
train Loss: 0.6367 Acc: 0.4163
val Loss: 0.6337 Acc: 0.3409
Epoch 14/99
----------
train Loss: 0.6332 Acc: 0.3589
val Loss: 0.6309 Acc: 0.4318
Epoch 15/99
----------
train Loss: 0.6291 Acc: 0.4545
val Loss: 0.6294 Acc: 0.4091
Epoch 16/99
----------
train Loss: 0.6247 Acc: 0.4115
val Loss: 0.6222 Acc: 0.4545
Epoch 17/99
----------
train Loss: 0.6237 Acc: 0.4593
val Loss: 0.6190 Acc: 0.4545
Epoch 18/99
----------
train Loss: 0.6213 Acc: 0.4354
val Loss: 0.6131 Acc: 0.4545
Epoch 19/99
----------
train Loss: 0.6139 Acc: 0.4545
val Loss: 0.6089 Acc: 0.4773
Epoch 20/99
----------
train Loss: 0.6084 Acc: 0.4689
val Loss: 0.6068 Acc: 0.5000
Epoch 21/99
----------
train Loss: 0.6074 Acc: 0.4880
val Loss: 0.6067 Acc: 0.5227
Epoch 22/99
----------
train Loss: 0.6059 Acc: 0.4402
val Loss: 0.6035 Acc: 0.5227
Epoch 23/99
----------
train Loss: 0.5988 Acc: 0.4976
val Loss: 0.5983 Acc: 0.5227
Epoch 24/99
----------
train Loss: 0.5906 Acc: 0.4976
val Loss: 0.5887 Acc: 0.5455
Epoch 25/99
----------
train Loss: 0.5916 Acc: 0.4833
val Loss: 0.5908 Acc: 0.5227
Epoch 26/99
----------
train Loss: 0.5894 Acc: 0.4737
val Loss: 0.5898 Acc: 0.5227
Epoch 27/99
----------
train Loss: 0.5816 Acc: 0.5120
val Loss: 0.5812 Acc: 0.5455
Epoch 28/99
----------
train Loss: 0.5831 Acc: 0.4785
val Loss: 0.5788 Acc: 0.5682
Epoch 29/99
----------
train Loss: 0.5822 Acc: 0.4880
val Loss: 0.5753 Acc: 0.5682
Epoch 30/99
----------
train Loss: 0.5772 Acc: 0.4785
val Loss: 0.5744 Acc: 0.5455
Epoch 31/99
----------
train Loss: 0.5693 Acc: 0.5215
val Loss: 0.5691 Acc: 0.5682
Epoch 32/99
----------
train Loss: 0.5663 Acc: 0.5167
val Loss: 0.5668 Acc: 0.5682
Epoch 33/99
----------
train Loss: 0.5665 Acc: 0.5024
val Loss: 0.5638 Acc: 0.5909
Epoch 34/99
----------
train Loss: 0.5628 Acc: 0.5024
val Loss: 0.5615 Acc: 0.5909
Epoch 35/99
----------
train Loss: 0.5548 Acc: 0.5311
val Loss: 0.5560 Acc: 0.5909
Epoch 36/99
----------
train Loss: 0.5624 Acc: 0.5024
val Loss: 0.5543 Acc: 0.6136
Epoch 37/99
----------
train Loss: 0.5556 Acc: 0.5024
val Loss: 0.5479 Acc: 0.6136
Epoch 38/99
----------
train Loss: 0.5516 Acc: 0.5311
val Loss: 0.5436 Acc: 0.6136
Epoch 39/99
----------
train Loss: 0.5510 Acc: 0.5167
val Loss: 0.5448 Acc: 0.6136
Epoch 40/99
----------
train Loss: 0.5425 Acc: 0.5167
val Loss: 0.5414 Acc: 0.6136
Epoch 41/99
----------
train Loss: 0.5472 Acc: 0.4928
val Loss: 0.5365 Acc: 0.6136
Epoch 42/99
----------
train Loss: 0.5347 Acc: 0.5311
val Loss: 0.5338 Acc: 0.6136
Epoch 43/99
----------
train Loss: 0.5399 Acc: 0.5072
val Loss: 0.5317 Acc: 0.6136
Epoch 44/99
----------
train Loss: 0.5321 Acc: 0.5263
val Loss: 0.5235 Acc: 0.6136
Epoch 45/99
----------
train Loss: 0.5147 Acc: 0.5742
val Loss: 0.5159 Acc: 0.6136
Epoch 46/99
----------
train Loss: 0.5324 Acc: 0.5263
val Loss: 0.5189 Acc: 0.6136
Epoch 47/99
----------
train Loss: 0.5200 Acc: 0.5311
val Loss: 0.5140 Acc: 0.6136
Epoch 48/99
----------
train Loss: 0.5259 Acc: 0.5120
val Loss: 0.5067 Acc: 0.6136
Epoch 49/99
----------
train Loss: 0.5170 Acc: 0.5311
val Loss: 0.5040 Acc: 0.6136
Epoch 50/99
----------
train Loss: 0.5182 Acc: 0.5167
val Loss: 0.5067 Acc: 0.6136
Epoch 51/99
----------
train Loss: 0.5049 Acc: 0.5215
val Loss: 0.4942 Acc: 0.6136
Epoch 52/99
----------
train Loss: 0.5093 Acc: 0.5550
val Loss: 0.4965 Acc: 0.6364
Epoch 53/99
----------
train Loss: 0.5174 Acc: 0.4976
val Loss: 0.4955 Acc: 0.6591
Epoch 54/99
----------
train Loss: 0.4964 Acc: 0.5359
val Loss: 0.4947 Acc: 0.6364
Epoch 55/99
----------
train Loss: 0.5039 Acc: 0.5359
val Loss: 0.4860 Acc: 0.6591
Epoch 56/99
----------
train Loss: 0.5083 Acc: 0.5167
val Loss: 0.4888 Acc: 0.6591
Epoch 57/99
----------
train Loss: 0.5107 Acc: 0.4976
val Loss: 0.4851 Acc: 0.6591
Epoch 58/99
----------
train Loss: 0.4963 Acc: 0.5311
val Loss: 0.4866 Acc: 0.6591
Epoch 59/99
----------
train Loss: 0.4970 Acc: 0.5311
val Loss: 0.4838 Acc: 0.6591
Epoch 60/99
----------
train Loss: 0.4926 Acc: 0.5550
val Loss: 0.4799 Acc: 0.6591
Epoch 61/99
----------
train Loss: 0.5053 Acc: 0.5215
val Loss: 0.4761 Acc: 0.6591
Epoch 62/99
----------
train Loss: 0.4934 Acc: 0.5455
val Loss: 0.4746 Acc: 0.6591
Epoch 63/99
----------
train Loss: 0.4807 Acc: 0.5359
val Loss: 0.4709 Acc: 0.6591
Epoch 64/99
----------
train Loss: 0.4847 Acc: 0.5359
val Loss: 0.4704 Acc: 0.6364
Epoch 65/99
----------
train Loss: 0.4869 Acc: 0.5407
val Loss: 0.4650 Acc: 0.6591
Epoch 66/99
----------
train Loss: 0.4818 Acc: 0.5407
val Loss: 0.4593 Acc: 0.6364
Epoch 67/99
----------
train Loss: 0.4861 Acc: 0.5167
val Loss: 0.4544 Acc: 0.6591
Epoch 68/99
----------
train Loss: 0.4741 Acc: 0.5407
val Loss: 0.4487 Acc: 0.6591
Epoch 69/99
----------
train Loss: 0.4745 Acc: 0.5359
val Loss: 0.4489 Acc: 0.6591
Epoch 70/99
----------
train Loss: 0.4793 Acc: 0.5550
val Loss: 0.4482 Acc: 0.6591
Epoch 71/99
----------
train Loss: 0.4892 Acc: 0.5072
val Loss: 0.4451 Acc: 0.6591
Epoch 72/99
----------
train Loss: 0.4806 Acc: 0.5311
val Loss: 0.4487 Acc: 0.6591
Epoch 73/99
----------
train Loss: 0.4573 Acc: 0.5550
val Loss: 0.4415 Acc: 0.6364
Epoch 74/99
----------
train Loss: 0.4894 Acc: 0.5263
val Loss: 0.4392 Acc: 0.6591
Epoch 75/99
----------
train Loss: 0.4632 Acc: 0.5598
val Loss: 0.4388 Acc: 0.6591
Epoch 76/99
----------
train Loss: 0.4711 Acc: 0.5311
val Loss: 0.4364 Acc: 0.6591
Epoch 77/99
----------
train Loss: 0.4722 Acc: 0.5120
val Loss: 0.4350 Acc: 0.6591
Epoch 78/99
----------
train Loss: 0.4607 Acc: 0.5598
val Loss: 0.4325 Acc: 0.6818
Epoch 79/99
----------
train Loss: 0.4772 Acc: 0.5455
val Loss: 0.4290 Acc: 0.6818
Epoch 80/99
----------
train Loss: 0.4637 Acc: 0.5407
val Loss: 0.4278 Acc: 0.6818
Epoch 81/99
----------
train Loss: 0.4800 Acc: 0.5455
val Loss: 0.4304 Acc: 0.6818
Epoch 82/99
----------
train Loss: 0.4547 Acc: 0.5694
val Loss: 0.4287 Acc: 0.6818
Epoch 83/99
----------
train Loss: 0.4395 Acc: 0.6268
val Loss: 0.4253 Acc: 0.6818
Epoch 84/99
----------
train Loss: 0.4733 Acc: 0.5598
val Loss: 0.4266 Acc: 0.6818
Epoch 85/99
----------
train Loss: 0.4546 Acc: 0.5742
val Loss: 0.4209 Acc: 0.6818
Epoch 86/99
----------
train Loss: 0.4512 Acc: 0.5742
val Loss: 0.4155 Acc: 0.6818
Epoch 87/99
----------
train Loss: 0.4548 Acc: 0.5455
val Loss: 0.4141 Acc: 0.6818
Epoch 88/99
----------
train Loss: 0.4661 Acc: 0.5263
val Loss: 0.4106 Acc: 0.6818
Epoch 89/99
----------
train Loss: 0.4650 Acc: 0.5455
val Loss: 0.4120 Acc: 0.6818
Epoch 90/99
----------
train Loss: 0.4494 Acc: 0.5789
val Loss: 0.4115 Acc: 0.6818
Epoch 91/99
----------
train Loss: 0.4407 Acc: 0.6268
val Loss: 0.4115 Acc: 0.6818
Epoch 92/99
----------
train Loss: 0.4404 Acc: 0.5933
val Loss: 0.4086 Acc: 0.6818
Epoch 93/99
----------
train Loss: 0.4457 Acc: 0.5789
val Loss: 0.4063 Acc: 0.6818
Epoch 94/99
----------
train Loss: 0.4233 Acc: 0.6124
val Loss: 0.4014 Acc: 0.6818
Epoch 95/99
----------
train Loss: 0.4416 Acc: 0.5742
val Loss: 0.4017 Acc: 0.7045
Epoch 96/99
----------
train Loss: 0.4032 Acc: 0.6842
val Loss: 0.3986 Acc: 0.7045
Epoch 97/99
----------
train Loss: 0.4317 Acc: 0.5742
val Loss: 0.3941 Acc: 0.6818
Epoch 98/99
----------
train Loss: 0.4359 Acc: 0.6220
val Loss: 0.3945 Acc: 0.7045
Epoch 99/99
----------
train Loss: 0.4378 Acc: 0.6029
[32m[I 2025-06-28 05:06:26,018][0m Trial 23 finished with value: 0.7045454545454546 and parameters: {'batch_size': 113, 'lr': 1.4669583060976114e-05, 'num_epochs': 99, 'weight_decay': 0.007475275511705484, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3944 Acc: 0.7045
Best val Acc: 0.704545

Model weights saved at ./model_weights/efficientnetb0_bs_113_lr_1.4669583060976114e-05_epoch_99_wd_0.007475275511705484_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 0.5784 Acc: 0.4163
val Loss: 0.5069 Acc: 0.5455
Epoch 2/81
----------
train Loss: 0.5442 Acc: 0.5024
val Loss: 0.5908 Acc: 0.6591
Epoch 3/81
----------
train Loss: 0.4725 Acc: 0.5742
val Loss: 0.4578 Acc: 0.6591
Epoch 4/81
----------
train Loss: 0.4512 Acc: 0.6220
val Loss: 0.3776 Acc: 0.6818
Epoch 5/81
----------
train Loss: 0.4381 Acc: 0.6220
val Loss: 0.3273 Acc: 0.7045
Epoch 6/81
----------
train Loss: 0.4334 Acc: 0.5789
val Loss: 0.3672 Acc: 0.7500
Epoch 7/81
----------
train Loss: 0.3883 Acc: 0.7416
val Loss: 0.4046 Acc: 0.7045
Epoch 8/81
----------
train Loss: 0.4309 Acc: 0.6507
val Loss: 0.5304 Acc: 0.4773
Epoch 9/81
----------
train Loss: 0.4456 Acc: 0.5742
val Loss: 0.4939 Acc: 0.6591
Epoch 10/81
----------
train Loss: 0.3313 Acc: 0.8278
val Loss: 0.5201 Acc: 0.5455
Epoch 11/81
----------
train Loss: 0.4279 Acc: 0.6794
val Loss: 0.5619 Acc: 0.3182
Epoch 12/81
----------
train Loss: 0.4062 Acc: 0.6316
val Loss: 0.4796 Acc: 0.5000
Epoch 13/81
----------
train Loss: 0.4119 Acc: 0.7033
val Loss: 0.4630 Acc: 0.6818
Epoch 14/81
----------
train Loss: 0.3659 Acc: 0.6699
val Loss: 0.3862 Acc: 0.7273
Epoch 15/81
----------
train Loss: 0.4062 Acc: 0.6699
val Loss: 0.4050 Acc: 0.6364
Epoch 16/81
----------
train Loss: 0.3911 Acc: 0.6938
val Loss: 0.4274 Acc: 0.6591
Epoch 17/81
----------
train Loss: 0.3571 Acc: 0.7321
val Loss: 0.6216 Acc: 0.1818
Epoch 18/81
----------
train Loss: 0.3575 Acc: 0.7512
val Loss: 0.5458 Acc: 0.4545
Epoch 19/81
----------
train Loss: 0.3239 Acc: 0.8469
[32m[I 2025-06-28 05:10:45,805][0m Trial 24 finished with value: 0.7272727272727273 and parameters: {'batch_size': 94, 'lr': 0.003558262446500806, 'num_epochs': 81, 'weight_decay': 0.0006561642964263405, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.6812 Acc: 0.2500
Early stopping at epoch 19 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_94_lr_0.003558262446500806_epoch_81_wd_0.0006561642964263405_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/72
----------
train Loss: 0.6718 Acc: 0.2919
val Loss: 0.6413 Acc: 0.4318
Epoch 2/72
----------
train Loss: 0.6041 Acc: 0.4545
val Loss: 0.6024 Acc: 0.6136
Epoch 3/72
----------
train Loss: 0.5619 Acc: 0.4833
val Loss: 0.5605 Acc: 0.5909
Epoch 4/72
----------
train Loss: 0.5368 Acc: 0.4976
val Loss: 0.5422 Acc: 0.6136
Epoch 5/72
----------
train Loss: 0.5237 Acc: 0.4976
val Loss: 0.5329 Acc: 0.6136
Epoch 6/72
----------
train Loss: 0.5106 Acc: 0.5072
val Loss: 0.5139 Acc: 0.6136
Epoch 7/72
----------
train Loss: 0.4935 Acc: 0.4976
val Loss: 0.4924 Acc: 0.6364
Epoch 8/72
----------
train Loss: 0.4942 Acc: 0.5024
val Loss: 0.4729 Acc: 0.6364
Epoch 9/72
----------
train Loss: 0.4879 Acc: 0.5024
val Loss: 0.4629 Acc: 0.6364
Epoch 10/72
----------
train Loss: 0.4557 Acc: 0.5072
val Loss: 0.4578 Acc: 0.6591
Epoch 11/72
----------
train Loss: 0.4657 Acc: 0.5120
val Loss: 0.4425 Acc: 0.6591
Epoch 12/72
----------
train Loss: 0.4677 Acc: 0.5072
val Loss: 0.4542 Acc: 0.6591
Epoch 13/72
----------
train Loss: 0.4473 Acc: 0.5455
val Loss: 0.4210 Acc: 0.6818
Epoch 14/72
----------
train Loss: 0.4235 Acc: 0.5885
val Loss: 0.4003 Acc: 0.6818
Epoch 15/72
----------
train Loss: 0.4384 Acc: 0.5502
val Loss: 0.3944 Acc: 0.7273
Epoch 16/72
----------
train Loss: 0.4322 Acc: 0.5742
val Loss: 0.3984 Acc: 0.7045
Epoch 17/72
----------
train Loss: 0.4233 Acc: 0.5789
val Loss: 0.4085 Acc: 0.7727
Epoch 18/72
----------
train Loss: 0.4036 Acc: 0.6890
val Loss: 0.3971 Acc: 0.7500
Epoch 19/72
----------
train Loss: 0.3901 Acc: 0.6938
val Loss: 0.3740 Acc: 0.7273
Epoch 20/72
----------
train Loss: 0.3982 Acc: 0.6890
val Loss: 0.3474 Acc: 0.7273
Epoch 21/72
----------
train Loss: 0.3913 Acc: 0.6699
val Loss: 0.3301 Acc: 0.7045
Epoch 22/72
----------
train Loss: 0.3898 Acc: 0.6890
val Loss: 0.3383 Acc: 0.7045
Epoch 23/72
----------
train Loss: 0.3807 Acc: 0.7273
val Loss: 0.3481 Acc: 0.7045
Epoch 24/72
----------
train Loss: 0.3519 Acc: 0.7416
val Loss: 0.3361 Acc: 0.7045
Epoch 25/72
----------
train Loss: 0.3643 Acc: 0.7560
val Loss: 0.3821 Acc: 0.7727
Epoch 26/72
----------
train Loss: 0.3785 Acc: 0.7943
val Loss: 0.3631 Acc: 0.7273
Epoch 27/72
----------
train Loss: 0.3308 Acc: 0.8517
val Loss: 0.3407 Acc: 0.7273
Epoch 28/72
----------
train Loss: 0.3828 Acc: 0.7416
val Loss: 0.3404 Acc: 0.7727
Epoch 29/72
----------
train Loss: 0.3948 Acc: 0.6746
val Loss: 0.3566 Acc: 0.7727
Epoch 30/72
----------
train Loss: 0.3598 Acc: 0.7608
val Loss: 0.3313 Acc: 0.7500
Epoch 31/72
----------
train Loss: 0.3174 Acc: 0.8421
val Loss: 0.3170 Acc: 0.7955
Epoch 32/72
----------
train Loss: 0.3375 Acc: 0.7512
val Loss: 0.3186 Acc: 0.7727
Epoch 33/72
----------
train Loss: 0.3541 Acc: 0.7751
val Loss: 0.3196 Acc: 0.7500
Epoch 34/72
----------
train Loss: 0.3263 Acc: 0.8325
val Loss: 0.3190 Acc: 0.7500
Epoch 35/72
----------
train Loss: 0.2898 Acc: 0.8900
val Loss: 0.3137 Acc: 0.7273
Epoch 36/72
----------
train Loss: 0.3658 Acc: 0.7512
val Loss: 0.3161 Acc: 0.7500
Epoch 37/72
----------
train Loss: 0.3221 Acc: 0.7608
val Loss: 0.4198 Acc: 0.7500
Epoch 38/72
----------
train Loss: 0.3253 Acc: 0.8708
val Loss: 0.3813 Acc: 0.7500
Epoch 39/72
----------
train Loss: 0.3389 Acc: 0.7273
val Loss: 0.3676 Acc: 0.7273
Epoch 40/72
----------
train Loss: 0.3096 Acc: 0.8565
val Loss: 0.3263 Acc: 0.8182
Epoch 41/72
----------
train Loss: 0.3657 Acc: 0.6986
val Loss: 0.3435 Acc: 0.7500
Epoch 42/72
----------
train Loss: 0.3128 Acc: 0.8038
val Loss: 0.3550 Acc: 0.7045
Epoch 43/72
----------
train Loss: 0.3156 Acc: 0.8038
val Loss: 0.3147 Acc: 0.7500
Epoch 44/72
----------
train Loss: 0.2956 Acc: 0.8325
val Loss: 0.3143 Acc: 0.8182
Epoch 45/72
----------
train Loss: 0.2004 Acc: 0.9665
val Loss: 0.3102 Acc: 0.7500
Epoch 46/72
----------
train Loss: 0.3798 Acc: 0.7943
val Loss: 0.3671 Acc: 0.7273
Epoch 47/72
----------
train Loss: 0.2896 Acc: 0.8612
val Loss: 0.3008 Acc: 0.7727
Epoch 48/72
----------
train Loss: 0.3199 Acc: 0.8325
val Loss: 0.3061 Acc: 0.7500
Epoch 49/72
----------
train Loss: 0.3048 Acc: 0.8756
val Loss: 0.3149 Acc: 0.7273
Epoch 50/72
----------
train Loss: 0.2984 Acc: 0.8230
val Loss: 0.3118 Acc: 0.7727
Epoch 51/72
----------
train Loss: 0.2384 Acc: 0.9569
val Loss: 0.2711 Acc: 0.8182
Epoch 52/72
----------
train Loss: 0.3150 Acc: 0.7847
val Loss: 0.3572 Acc: 0.7273
Epoch 53/72
----------
train Loss: 0.3451 Acc: 0.8612
val Loss: 0.3556 Acc: 0.7727
Epoch 54/72
----------
train Loss: 0.2753 Acc: 0.8900
val Loss: 0.2973 Acc: 0.8182
Epoch 55/72
----------
train Loss: 0.2772 Acc: 0.9330
val Loss: 0.3068 Acc: 0.7955
Epoch 56/72
----------
train Loss: 0.3184 Acc: 0.8517
val Loss: 0.2794 Acc: 0.7727
Epoch 57/72
----------
train Loss: 0.3759 Acc: 0.7703
val Loss: 0.3156 Acc: 0.7273
Epoch 58/72
----------
train Loss: 0.3164 Acc: 0.7751
val Loss: 0.3256 Acc: 0.7727
Epoch 59/72
----------
train Loss: 0.3200 Acc: 0.8373
val Loss: 0.3244 Acc: 0.7727
Epoch 60/72
----------
train Loss: 0.2713 Acc: 0.8708
val Loss: 0.2904 Acc: 0.7500
Epoch 61/72
----------
train Loss: 0.3578 Acc: 0.7368
val Loss: 0.2984 Acc: 0.7727
Epoch 62/72
----------
train Loss: 0.3279 Acc: 0.8756
val Loss: 0.3136 Acc: 0.7500
Epoch 63/72
----------
train Loss: 0.2816 Acc: 0.8995
val Loss: 0.2724 Acc: 0.7273
Epoch 64/72
----------
train Loss: 0.2720 Acc: 0.9187
val Loss: 0.3133 Acc: 0.8182
Epoch 65/72
----------
train Loss: 0.3020 Acc: 0.8182
val Loss: 0.3082 Acc: 0.8409
Epoch 66/72
----------
train Loss: 0.3011 Acc: 0.8660
val Loss: 0.3286 Acc: 0.7500
Epoch 67/72
----------
train Loss: 0.3351 Acc: 0.8421
val Loss: 0.3726 Acc: 0.7273
Epoch 68/72
----------
train Loss: 0.2923 Acc: 0.8612
val Loss: 0.3170 Acc: 0.7500
Epoch 69/72
----------
train Loss: 0.2778 Acc: 0.8421
val Loss: 0.3115 Acc: 0.8409
Epoch 70/72
----------
train Loss: 0.3172 Acc: 0.8900
val Loss: 0.3182 Acc: 0.7955
Epoch 71/72
----------
train Loss: 0.3276 Acc: 0.8373
val Loss: 0.2935 Acc: 0.8182
Epoch 72/72
----------
train Loss: 0.3400 Acc: 0.7799
[32m[I 2025-06-28 05:27:09,504][0m Trial 25 finished with value: 0.7727272727272727 and parameters: {'batch_size': 75, 'lr': 0.00025650954588026344, 'num_epochs': 72, 'weight_decay': 0.04893192657893748, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3093 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_75_lr_0.00025650954588026344_epoch_72_wd_0.04893192657893748_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 1.4198 Acc: 0.1962
val Loss: 1.3551 Acc: 0.3409
Epoch 2/92
----------
train Loss: 1.3172 Acc: 0.3923
val Loss: 1.2897 Acc: 0.5227
Epoch 3/92
----------
train Loss: 1.2431 Acc: 0.5072
val Loss: 1.2536 Acc: 0.5227
Epoch 4/92
----------
train Loss: 1.1619 Acc: 0.6699
val Loss: 1.2057 Acc: 0.6136
Epoch 5/92
----------
train Loss: 1.0915 Acc: 0.7033
val Loss: 1.1648 Acc: 0.6136
Epoch 6/92
----------
train Loss: 1.0095 Acc: 0.7895
val Loss: 1.1146 Acc: 0.6364
Epoch 7/92
----------
train Loss: 0.9475 Acc: 0.7990
val Loss: 1.0632 Acc: 0.6364
Epoch 8/92
----------
train Loss: 0.8627 Acc: 0.8373
val Loss: 1.0123 Acc: 0.6364
Epoch 9/92
----------
train Loss: 0.8111 Acc: 0.8612
val Loss: 0.9705 Acc: 0.6591
Epoch 10/92
----------
train Loss: 0.7596 Acc: 0.8708
val Loss: 0.9459 Acc: 0.6591
Epoch 11/92
----------
train Loss: 0.6926 Acc: 0.9043
val Loss: 0.9206 Acc: 0.6591
Epoch 12/92
----------
train Loss: 0.6338 Acc: 0.9091
val Loss: 0.9030 Acc: 0.6591
Epoch 13/92
----------
train Loss: 0.5903 Acc: 0.9426
val Loss: 0.8793 Acc: 0.6818
Epoch 14/92
----------
train Loss: 0.5481 Acc: 0.9474
val Loss: 0.8593 Acc: 0.6818
Epoch 15/92
----------
train Loss: 0.5059 Acc: 0.9761
val Loss: 0.8230 Acc: 0.6818
Epoch 16/92
----------
train Loss: 0.4352 Acc: 0.9713
val Loss: 0.8095 Acc: 0.7273
Epoch 17/92
----------
train Loss: 0.3991 Acc: 0.9904
val Loss: 0.7927 Acc: 0.7273
Epoch 18/92
----------
train Loss: 0.3606 Acc: 0.9856
val Loss: 0.7782 Acc: 0.7727
Epoch 19/92
----------
train Loss: 0.3532 Acc: 0.9713
val Loss: 0.7742 Acc: 0.7727
Epoch 20/92
----------
train Loss: 0.3181 Acc: 0.9761
val Loss: 0.7576 Acc: 0.7727
Epoch 21/92
----------
train Loss: 0.2914 Acc: 0.9713
val Loss: 0.7467 Acc: 0.7500
Epoch 22/92
----------
train Loss: 0.2848 Acc: 0.9809
val Loss: 0.7412 Acc: 0.7500
Epoch 23/92
----------
train Loss: 0.2335 Acc: 0.9904
val Loss: 0.7372 Acc: 0.7727
Epoch 24/92
----------
train Loss: 0.2092 Acc: 0.9952
val Loss: 0.7206 Acc: 0.7727
Epoch 25/92
----------
train Loss: 0.2011 Acc: 0.9904
val Loss: 0.7129 Acc: 0.7955
Epoch 26/92
----------
train Loss: 0.1868 Acc: 0.9952
val Loss: 0.7100 Acc: 0.7955
Epoch 27/92
----------
train Loss: 0.1632 Acc: 0.9952
val Loss: 0.7042 Acc: 0.7955
Epoch 28/92
----------
train Loss: 0.1561 Acc: 0.9904
val Loss: 0.6921 Acc: 0.8182
Epoch 29/92
----------
train Loss: 0.1394 Acc: 0.9952
val Loss: 0.6928 Acc: 0.7955
Epoch 30/92
----------
train Loss: 0.1151 Acc: 0.9904
val Loss: 0.6898 Acc: 0.7955
Epoch 31/92
----------
train Loss: 0.1085 Acc: 0.9952
val Loss: 0.6905 Acc: 0.8182
Epoch 32/92
----------
train Loss: 0.0899 Acc: 1.0000
val Loss: 0.6815 Acc: 0.7955
Epoch 33/92
----------
train Loss: 0.1064 Acc: 0.9952
val Loss: 0.6765 Acc: 0.8182
Epoch 34/92
----------
train Loss: 0.0937 Acc: 0.9952
val Loss: 0.6630 Acc: 0.8182
Epoch 35/92
----------
train Loss: 0.0700 Acc: 0.9952
val Loss: 0.6654 Acc: 0.8182
Epoch 36/92
----------
train Loss: 0.0822 Acc: 0.9904
val Loss: 0.6690 Acc: 0.8182
Epoch 37/92
----------
train Loss: 0.0734 Acc: 0.9952
val Loss: 0.6695 Acc: 0.8182
Epoch 38/92
----------
train Loss: 0.0718 Acc: 1.0000
val Loss: 0.6564 Acc: 0.8182
Epoch 39/92
----------
train Loss: 0.0530 Acc: 1.0000
val Loss: 0.6582 Acc: 0.8182
Epoch 40/92
----------
train Loss: 0.0621 Acc: 1.0000
val Loss: 0.6546 Acc: 0.8182
Epoch 41/92
----------
train Loss: 0.0546 Acc: 1.0000
val Loss: 0.6478 Acc: 0.8182
Epoch 42/92
----------
train Loss: 0.0440 Acc: 1.0000
val Loss: 0.6461 Acc: 0.8182
Epoch 43/92
----------
train Loss: 0.0467 Acc: 1.0000
val Loss: 0.6490 Acc: 0.8182
Epoch 44/92
----------
train Loss: 0.0512 Acc: 0.9952
val Loss: 0.6544 Acc: 0.7955
Epoch 45/92
----------
train Loss: 0.0389 Acc: 1.0000
val Loss: 0.6422 Acc: 0.7955
Epoch 46/92
----------
train Loss: 0.0272 Acc: 1.0000
val Loss: 0.6542 Acc: 0.7955
Epoch 47/92
----------
train Loss: 0.0351 Acc: 1.0000
val Loss: 0.6596 Acc: 0.7955
Epoch 48/92
----------
train Loss: 0.0356 Acc: 0.9952
val Loss: 0.6606 Acc: 0.8182
Epoch 49/92
----------
train Loss: 0.0557 Acc: 0.9904
val Loss: 0.6647 Acc: 0.7955
Epoch 50/92
----------
train Loss: 0.0295 Acc: 1.0000
val Loss: 0.6723 Acc: 0.8182
Epoch 51/92
----------
train Loss: 0.0279 Acc: 1.0000
val Loss: 0.6628 Acc: 0.8182
Epoch 52/92
----------
train Loss: 0.0259 Acc: 0.9952
val Loss: 0.6579 Acc: 0.8182
Epoch 53/92
----------
train Loss: 0.0275 Acc: 1.0000
val Loss: 0.6523 Acc: 0.8182
Epoch 54/92
----------
train Loss: 0.0180 Acc: 1.0000
val Loss: 0.6457 Acc: 0.8182
Epoch 55/92
----------
train Loss: 0.0360 Acc: 1.0000
val Loss: 0.6599 Acc: 0.8182
Epoch 56/92
----------
train Loss: 0.0193 Acc: 1.0000
val Loss: 0.6554 Acc: 0.8182
Epoch 57/92
----------
train Loss: 0.0315 Acc: 1.0000
val Loss: 0.6660 Acc: 0.8182
Epoch 58/92
----------
train Loss: 0.0198 Acc: 0.9952
val Loss: 0.6549 Acc: 0.7955
Epoch 59/92
----------
train Loss: 0.0266 Acc: 1.0000
val Loss: 0.6664 Acc: 0.7955
Epoch 60/92
----------
train Loss: 0.0201 Acc: 0.9952
val Loss: 0.6633 Acc: 0.7955
Epoch 61/92
----------
train Loss: 0.0282 Acc: 0.9952
val Loss: 0.6529 Acc: 0.7955
Epoch 62/92
----------
train Loss: 0.0130 Acc: 1.0000
val Loss: 0.6366 Acc: 0.7727
Epoch 63/92
----------
train Loss: 0.0225 Acc: 1.0000
val Loss: 0.6174 Acc: 0.7727
Epoch 64/92
----------
train Loss: 0.0163 Acc: 1.0000
val Loss: 0.6355 Acc: 0.7727
Epoch 65/92
----------
train Loss: 0.0279 Acc: 1.0000
val Loss: 0.6312 Acc: 0.7955
Epoch 66/92
----------
train Loss: 0.0122 Acc: 1.0000
val Loss: 0.6301 Acc: 0.7955
Epoch 67/92
----------
train Loss: 0.0143 Acc: 1.0000
val Loss: 0.6253 Acc: 0.7955
Epoch 68/92
----------
train Loss: 0.0140 Acc: 1.0000
val Loss: 0.6249 Acc: 0.7955
Epoch 69/92
----------
train Loss: 0.0161 Acc: 1.0000
val Loss: 0.6334 Acc: 0.7955
Epoch 70/92
----------
train Loss: 0.0253 Acc: 0.9904
val Loss: 0.6287 Acc: 0.7955
Epoch 71/92
----------
train Loss: 0.0163 Acc: 1.0000
val Loss: 0.6117 Acc: 0.7955
Epoch 72/92
----------
train Loss: 0.0218 Acc: 1.0000
val Loss: 0.6116 Acc: 0.7955
Epoch 73/92
----------
train Loss: 0.0183 Acc: 0.9952
val Loss: 0.6273 Acc: 0.7955
Epoch 74/92
----------
train Loss: 0.0122 Acc: 1.0000
val Loss: 0.6443 Acc: 0.7955
Epoch 75/92
----------
train Loss: 0.0122 Acc: 0.9952
val Loss: 0.6433 Acc: 0.7955
Epoch 76/92
----------
train Loss: 0.0169 Acc: 1.0000
val Loss: 0.6283 Acc: 0.7955
Epoch 77/92
----------
train Loss: 0.0113 Acc: 1.0000
val Loss: 0.6285 Acc: 0.7955
Epoch 78/92
----------
train Loss: 0.0113 Acc: 1.0000
val Loss: 0.6358 Acc: 0.7955
Epoch 79/92
----------
train Loss: 0.0125 Acc: 1.0000
val Loss: 0.6313 Acc: 0.7955
Epoch 80/92
----------
train Loss: 0.0103 Acc: 1.0000
val Loss: 0.6421 Acc: 0.7955
Epoch 81/92
----------
train Loss: 0.0071 Acc: 1.0000
val Loss: 0.6319 Acc: 0.7727
Epoch 82/92
----------
train Loss: 0.0101 Acc: 0.9952
val Loss: 0.6305 Acc: 0.7955
Epoch 83/92
----------
train Loss: 0.0080 Acc: 1.0000
val Loss: 0.6320 Acc: 0.7955
Epoch 84/92
----------
train Loss: 0.0124 Acc: 1.0000
val Loss: 0.6394 Acc: 0.8182
Epoch 85/92
----------
train Loss: 0.0080 Acc: 1.0000
val Loss: 0.6379 Acc: 0.8182
Epoch 86/92
----------
train Loss: 0.0173 Acc: 1.0000
val Loss: 0.6336 Acc: 0.7955
Epoch 87/92
----------
train Loss: 0.0062 Acc: 1.0000
val Loss: 0.6450 Acc: 0.7727
Epoch 88/92
----------
train Loss: 0.0114 Acc: 1.0000
val Loss: 0.6318 Acc: 0.7727
Epoch 89/92
----------
train Loss: 0.0108 Acc: 1.0000
val Loss: 0.6505 Acc: 0.7727
Epoch 90/92
----------
train Loss: 0.0049 Acc: 1.0000
val Loss: 0.6584 Acc: 0.7727
Epoch 91/92
----------
train Loss: 0.0087 Acc: 1.0000
val Loss: 0.6693 Acc: 0.7727
Epoch 92/92
----------
train Loss: 0.0107 Acc: 0.9952
[32m[I 2025-06-28 05:48:06,697][0m Trial 26 finished with value: 0.7727272727272727 and parameters: {'batch_size': 29, 'lr': 4.8133253080179034e-05, 'num_epochs': 92, 'weight_decay': 0.001475809721958479, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.6684 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_29_lr_4.8133253080179034e-05_epoch_92_wd_0.001475809721958479_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/56
----------
train Loss: 0.7020 Acc: 0.2201
val Loss: 0.6885 Acc: 0.1591
Epoch 2/56
----------
train Loss: 0.6946 Acc: 0.2201
val Loss: 0.6857 Acc: 0.2045
Epoch 3/56
----------
train Loss: 0.6900 Acc: 0.2153
val Loss: 0.6783 Acc: 0.1591
Epoch 4/56
----------
train Loss: 0.6890 Acc: 0.2392
val Loss: 0.6751 Acc: 0.2045
Epoch 5/56
----------
train Loss: 0.6927 Acc: 0.1914
val Loss: 0.6758 Acc: 0.2045
Epoch 6/56
----------
train Loss: 0.6879 Acc: 0.2440
val Loss: 0.6739 Acc: 0.2273
Epoch 7/56
----------
train Loss: 0.6850 Acc: 0.2297
val Loss: 0.6720 Acc: 0.2045
Epoch 8/56
----------
train Loss: 0.6791 Acc: 0.2440
val Loss: 0.6712 Acc: 0.2273
Epoch 9/56
----------
train Loss: 0.6783 Acc: 0.2871
val Loss: 0.6692 Acc: 0.2273
Epoch 10/56
----------
train Loss: 0.6749 Acc: 0.2440
val Loss: 0.6675 Acc: 0.2045
Epoch 11/56
----------
train Loss: 0.6760 Acc: 0.2440
val Loss: 0.6657 Acc: 0.2045
Epoch 12/56
----------
train Loss: 0.6737 Acc: 0.2488
val Loss: 0.6653 Acc: 0.2045
Epoch 13/56
----------
train Loss: 0.6657 Acc: 0.3062
val Loss: 0.6618 Acc: 0.2273
Epoch 14/56
----------
train Loss: 0.6644 Acc: 0.3158
val Loss: 0.6596 Acc: 0.2273
Epoch 15/56
----------
train Loss: 0.6608 Acc: 0.3445
val Loss: 0.6603 Acc: 0.2273
Epoch 16/56
----------
train Loss: 0.6585 Acc: 0.3206
val Loss: 0.6545 Acc: 0.2500
Epoch 17/56
----------
train Loss: 0.6595 Acc: 0.3110
val Loss: 0.6542 Acc: 0.2955
Epoch 18/56
----------
train Loss: 0.6590 Acc: 0.3110
val Loss: 0.6505 Acc: 0.2727
Epoch 19/56
----------
train Loss: 0.6532 Acc: 0.3780
val Loss: 0.6479 Acc: 0.3182
Epoch 20/56
----------
train Loss: 0.6496 Acc: 0.3445
val Loss: 0.6476 Acc: 0.3182
Epoch 21/56
----------
train Loss: 0.6493 Acc: 0.3876
val Loss: 0.6473 Acc: 0.2955
Epoch 22/56
----------
train Loss: 0.6501 Acc: 0.3589
val Loss: 0.6463 Acc: 0.3182
Epoch 23/56
----------
train Loss: 0.6443 Acc: 0.3684
val Loss: 0.6430 Acc: 0.2727
Epoch 24/56
----------
train Loss: 0.6381 Acc: 0.4545
val Loss: 0.6370 Acc: 0.3636
Epoch 25/56
----------
train Loss: 0.6398 Acc: 0.4067
val Loss: 0.6396 Acc: 0.3409
Epoch 26/56
----------
train Loss: 0.6383 Acc: 0.3876
val Loss: 0.6391 Acc: 0.3182
Epoch 27/56
----------
train Loss: 0.6347 Acc: 0.4211
val Loss: 0.6330 Acc: 0.3409
Epoch 28/56
----------
train Loss: 0.6366 Acc: 0.4067
val Loss: 0.6313 Acc: 0.4091
Epoch 29/56
----------
train Loss: 0.6354 Acc: 0.3923
val Loss: 0.6299 Acc: 0.4091
Epoch 30/56
----------
train Loss: 0.6315 Acc: 0.4163
val Loss: 0.6290 Acc: 0.4091
Epoch 31/56
----------
train Loss: 0.6245 Acc: 0.4450
val Loss: 0.6260 Acc: 0.4318
Epoch 32/56
----------
train Loss: 0.6237 Acc: 0.4545
val Loss: 0.6259 Acc: 0.4091
Epoch 33/56
----------
train Loss: 0.6248 Acc: 0.4163
val Loss: 0.6249 Acc: 0.4545
Epoch 34/56
----------
train Loss: 0.6214 Acc: 0.4545
val Loss: 0.6246 Acc: 0.4091
Epoch 35/56
----------
train Loss: 0.6156 Acc: 0.4593
val Loss: 0.6209 Acc: 0.4773
Epoch 36/56
----------
train Loss: 0.6216 Acc: 0.4450
val Loss: 0.6191 Acc: 0.5000
Epoch 37/56
----------
train Loss: 0.6172 Acc: 0.4545
val Loss: 0.6143 Acc: 0.5000
Epoch 38/56
----------
train Loss: 0.6144 Acc: 0.4641
val Loss: 0.6119 Acc: 0.5000
Epoch 39/56
----------
train Loss: 0.6127 Acc: 0.4402
val Loss: 0.6134 Acc: 0.5000
Epoch 40/56
----------
train Loss: 0.6075 Acc: 0.5407
val Loss: 0.6105 Acc: 0.5000
Epoch 41/56
----------
train Loss: 0.6103 Acc: 0.4641
val Loss: 0.6069 Acc: 0.5227
Epoch 42/56
----------
train Loss: 0.6011 Acc: 0.5263
val Loss: 0.6053 Acc: 0.5227
Epoch 43/56
----------
train Loss: 0.6046 Acc: 0.4833
val Loss: 0.6039 Acc: 0.5227
Epoch 44/56
----------
train Loss: 0.5997 Acc: 0.4737
val Loss: 0.5981 Acc: 0.5455
Epoch 45/56
----------
train Loss: 0.5870 Acc: 0.5167
val Loss: 0.5914 Acc: 0.5455
Epoch 46/56
----------
train Loss: 0.5992 Acc: 0.5167
val Loss: 0.5951 Acc: 0.5909
Epoch 47/56
----------
train Loss: 0.5909 Acc: 0.5359
val Loss: 0.5915 Acc: 0.5909
Epoch 48/56
----------
train Loss: 0.5936 Acc: 0.5215
val Loss: 0.5847 Acc: 0.6136
Epoch 49/56
----------
train Loss: 0.5879 Acc: 0.5837
val Loss: 0.5838 Acc: 0.5909
Epoch 50/56
----------
train Loss: 0.5877 Acc: 0.5120
val Loss: 0.5864 Acc: 0.5909
Epoch 51/56
----------
train Loss: 0.5784 Acc: 0.5455
val Loss: 0.5765 Acc: 0.6136
Epoch 52/56
----------
train Loss: 0.5809 Acc: 0.5311
val Loss: 0.5783 Acc: 0.6136
Epoch 53/56
----------
train Loss: 0.5873 Acc: 0.4928
val Loss: 0.5789 Acc: 0.5682
Epoch 54/56
----------
train Loss: 0.5701 Acc: 0.5646
val Loss: 0.5784 Acc: 0.5909
Epoch 55/56
----------
train Loss: 0.5746 Acc: 0.5311
val Loss: 0.5709 Acc: 0.6136
Epoch 56/56
----------
train Loss: 0.5772 Acc: 0.5550
[32m[I 2025-06-28 06:00:51,970][0m Trial 27 finished with value: 0.6136363636363636 and parameters: {'batch_size': 83, 'lr': 5.243735542276216e-06, 'num_epochs': 56, 'weight_decay': 0.00023889172720590037, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.5751 Acc: 0.6136
Best val Acc: 0.613636

Model weights saved at ./model_weights/efficientnetb0_bs_83_lr_5.243735542276216e-06_epoch_56_wd_0.00023889172720590037_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 5.9477 Acc: 0.1962
val Loss: 5.0508 Acc: 0.3182
Epoch 2/86
----------
train Loss: 5.3265 Acc: 0.4211
val Loss: 4.8519 Acc: 0.4545
Epoch 3/86
----------
train Loss: 4.8750 Acc: 0.5646
val Loss: 4.7695 Acc: 0.4545
Epoch 4/86
----------
train Loss: 4.4445 Acc: 0.6603
val Loss: 4.6369 Acc: 0.5455
Epoch 5/86
----------
train Loss: 4.0184 Acc: 0.7273
val Loss: 4.5304 Acc: 0.5455
Epoch 6/86
----------
train Loss: 3.6253 Acc: 0.7847
val Loss: 4.4111 Acc: 0.5455
Epoch 7/86
----------
train Loss: 3.2396 Acc: 0.8517
val Loss: 4.2474 Acc: 0.5682
Epoch 8/86
----------
train Loss: 2.7960 Acc: 0.8756
val Loss: 4.1007 Acc: 0.5909
Epoch 9/86
----------
train Loss: 2.5091 Acc: 0.8756
val Loss: 3.9472 Acc: 0.6591
Epoch 10/86
----------
train Loss: 2.2122 Acc: 0.9234
val Loss: 3.8083 Acc: 0.6818
Epoch 11/86
----------
train Loss: 1.9325 Acc: 0.9330
val Loss: 3.6783 Acc: 0.7273
Epoch 12/86
----------
train Loss: 1.6596 Acc: 0.9187
val Loss: 3.5757 Acc: 0.7500
Epoch 13/86
----------
train Loss: 1.4506 Acc: 0.9474
val Loss: 3.4449 Acc: 0.7273
Epoch 14/86
----------
train Loss: 1.2619 Acc: 0.9665
val Loss: 3.3551 Acc: 0.7500
Epoch 15/86
----------
train Loss: 1.0485 Acc: 0.9665
val Loss: 3.2270 Acc: 0.7727
Epoch 16/86
----------
train Loss: 0.8135 Acc: 0.9809
val Loss: 3.1543 Acc: 0.7727
Epoch 17/86
----------
train Loss: 0.6942 Acc: 0.9809
val Loss: 3.0611 Acc: 0.7727
Epoch 18/86
----------
train Loss: 0.6096 Acc: 0.9952
val Loss: 2.9840 Acc: 0.7955
Epoch 19/86
----------
train Loss: 0.5894 Acc: 0.9856
val Loss: 2.9402 Acc: 0.7727
Epoch 20/86
----------
train Loss: 0.5456 Acc: 0.9904
val Loss: 2.9596 Acc: 0.7955
Epoch 21/86
----------
train Loss: 0.4481 Acc: 0.9952
val Loss: 2.9371 Acc: 0.7727
Epoch 22/86
----------
train Loss: 0.4558 Acc: 0.9856
val Loss: 3.0102 Acc: 0.7727
Epoch 23/86
----------
train Loss: 0.3224 Acc: 0.9952
val Loss: 3.0493 Acc: 0.7500
Epoch 24/86
----------
train Loss: 0.2806 Acc: 0.9904
val Loss: 2.9890 Acc: 0.7727
Epoch 25/86
----------
train Loss: 0.2826 Acc: 1.0000
val Loss: 2.9382 Acc: 0.7955
Epoch 26/86
----------
train Loss: 0.2388 Acc: 1.0000
val Loss: 2.9736 Acc: 0.7955
Epoch 27/86
----------
train Loss: 0.1924 Acc: 1.0000
val Loss: 2.9643 Acc: 0.7955
Epoch 28/86
----------
train Loss: 0.2343 Acc: 0.9952
val Loss: 3.0086 Acc: 0.8182
Epoch 29/86
----------
train Loss: 0.1917 Acc: 1.0000
val Loss: 2.9440 Acc: 0.7955
Epoch 30/86
----------
train Loss: 0.1328 Acc: 1.0000
val Loss: 2.9324 Acc: 0.7955
Epoch 31/86
----------
train Loss: 0.1512 Acc: 1.0000
val Loss: 2.9683 Acc: 0.7955
Epoch 32/86
----------
train Loss: 0.1168 Acc: 1.0000
val Loss: 2.9733 Acc: 0.7727
Epoch 33/86
----------
train Loss: 0.1774 Acc: 0.9904
val Loss: 2.9600 Acc: 0.7955
Epoch 34/86
----------
train Loss: 0.1364 Acc: 1.0000
val Loss: 2.8815 Acc: 0.7955
Epoch 35/86
----------
train Loss: 0.1110 Acc: 1.0000
val Loss: 2.8810 Acc: 0.7955
Epoch 36/86
----------
train Loss: 0.1436 Acc: 1.0000
val Loss: 2.9587 Acc: 0.7727
Epoch 37/86
----------
train Loss: 0.1559 Acc: 0.9952
val Loss: 2.9252 Acc: 0.7500
Epoch 38/86
----------
train Loss: 0.1344 Acc: 1.0000
val Loss: 2.8811 Acc: 0.7727
Epoch 39/86
----------
train Loss: 0.0807 Acc: 1.0000
val Loss: 2.8785 Acc: 0.7727
Epoch 40/86
----------
train Loss: 0.1222 Acc: 1.0000
val Loss: 2.9118 Acc: 0.7500
Epoch 41/86
----------
train Loss: 0.1005 Acc: 1.0000
val Loss: 2.8641 Acc: 0.7500
Epoch 42/86
----------
train Loss: 0.0771 Acc: 1.0000
val Loss: 2.8669 Acc: 0.7727
Epoch 43/86
----------
train Loss: 0.0961 Acc: 0.9952
val Loss: 2.8890 Acc: 0.7727
Epoch 44/86
----------
train Loss: 0.1133 Acc: 0.9952
val Loss: 2.9067 Acc: 0.7727
Epoch 45/86
----------
train Loss: 0.0688 Acc: 1.0000
val Loss: 2.8754 Acc: 0.7727
Epoch 46/86
----------
train Loss: 0.0415 Acc: 1.0000
val Loss: 2.9321 Acc: 0.7727
Epoch 47/86
----------
train Loss: 0.0676 Acc: 0.9952
val Loss: 2.9426 Acc: 0.7727
Epoch 48/86
----------
train Loss: 0.0593 Acc: 0.9952
val Loss: 2.9936 Acc: 0.7955
Epoch 49/86
----------
train Loss: 0.1324 Acc: 0.9952
val Loss: 3.1262 Acc: 0.7955
Epoch 50/86
----------
train Loss: 0.0584 Acc: 1.0000
val Loss: 3.1471 Acc: 0.7955
Epoch 51/86
----------
train Loss: 0.0549 Acc: 1.0000
val Loss: 3.1802 Acc: 0.7955
Epoch 52/86
----------
train Loss: 0.0882 Acc: 0.9952
val Loss: 3.1139 Acc: 0.7955
Epoch 53/86
----------
train Loss: 0.0565 Acc: 1.0000
val Loss: 2.9939 Acc: 0.8182
Epoch 54/86
----------
train Loss: 0.0372 Acc: 1.0000
val Loss: 3.0271 Acc: 0.7955
Epoch 55/86
----------
train Loss: 0.0645 Acc: 1.0000
val Loss: 3.1445 Acc: 0.7955
Epoch 56/86
----------
train Loss: 0.0463 Acc: 0.9952
val Loss: 3.1305 Acc: 0.7955
Epoch 57/86
----------
train Loss: 0.0734 Acc: 1.0000
val Loss: 3.1094 Acc: 0.7727
Epoch 58/86
----------
train Loss: 0.0586 Acc: 1.0000
val Loss: 3.0418 Acc: 0.7955
Epoch 59/86
----------
train Loss: 0.0527 Acc: 0.9952
val Loss: 3.0213 Acc: 0.7727
Epoch 60/86
----------
train Loss: 0.0395 Acc: 0.9952
val Loss: 2.9665 Acc: 0.7273
Epoch 61/86
----------
train Loss: 0.1119 Acc: 0.9952
val Loss: 2.9271 Acc: 0.7500
Epoch 62/86
----------
train Loss: 0.0286 Acc: 1.0000
val Loss: 2.8357 Acc: 0.7500
Epoch 63/86
----------
train Loss: 0.0592 Acc: 0.9952
val Loss: 2.8303 Acc: 0.7955
Epoch 64/86
----------
train Loss: 0.0432 Acc: 0.9952
val Loss: 2.7272 Acc: 0.7500
Epoch 65/86
----------
train Loss: 0.0803 Acc: 1.0000
val Loss: 2.7391 Acc: 0.7955
Epoch 66/86
----------
train Loss: 0.0255 Acc: 1.0000
val Loss: 2.7718 Acc: 0.8182
Epoch 67/86
----------
train Loss: 0.0371 Acc: 1.0000
val Loss: 2.7200 Acc: 0.8182
Epoch 68/86
----------
train Loss: 0.0345 Acc: 1.0000
val Loss: 2.7776 Acc: 0.8182
Epoch 69/86
----------
train Loss: 0.0448 Acc: 1.0000
val Loss: 2.8334 Acc: 0.8182
Epoch 70/86
----------
train Loss: 0.0711 Acc: 0.9904
val Loss: 2.7635 Acc: 0.7955
Epoch 71/86
----------
train Loss: 0.0342 Acc: 1.0000
val Loss: 2.7747 Acc: 0.7727
Epoch 72/86
----------
train Loss: 0.0489 Acc: 1.0000
val Loss: 2.7606 Acc: 0.7727
Epoch 73/86
----------
train Loss: 0.0472 Acc: 0.9952
val Loss: 2.7781 Acc: 0.8182
Epoch 74/86
----------
train Loss: 0.0235 Acc: 1.0000
val Loss: 2.7867 Acc: 0.7955
Epoch 75/86
----------
train Loss: 0.0228 Acc: 1.0000
val Loss: 2.8062 Acc: 0.7955
Epoch 76/86
----------
train Loss: 0.0548 Acc: 1.0000
val Loss: 2.8368 Acc: 0.7955
Epoch 77/86
----------
train Loss: 0.0234 Acc: 1.0000
val Loss: 2.9310 Acc: 0.7955
Epoch 78/86
----------
train Loss: 0.0207 Acc: 1.0000
val Loss: 2.8978 Acc: 0.7727
Epoch 79/86
----------
train Loss: 0.0362 Acc: 1.0000
val Loss: 2.8982 Acc: 0.8182
Epoch 80/86
----------
train Loss: 0.0231 Acc: 1.0000
val Loss: 2.9327 Acc: 0.7955
Epoch 81/86
----------
train Loss: 0.0148 Acc: 1.0000
val Loss: 2.8921 Acc: 0.8409
Epoch 82/86
----------
train Loss: 0.0346 Acc: 0.9952
val Loss: 2.9185 Acc: 0.8182
Epoch 83/86
----------
train Loss: 0.0171 Acc: 1.0000
val Loss: 3.0076 Acc: 0.8409
Epoch 84/86
----------
train Loss: 0.0245 Acc: 1.0000
val Loss: 2.9947 Acc: 0.8409
Epoch 85/86
----------
train Loss: 0.0202 Acc: 1.0000
val Loss: 2.9998 Acc: 0.7955
Epoch 86/86
----------
train Loss: 0.0373 Acc: 1.0000
[32m[I 2025-06-28 06:20:28,640][0m Trial 28 finished with value: 0.8409090909090909 and parameters: {'batch_size': 48, 'lr': 8.018685375889429e-05, 'num_epochs': 86, 'weight_decay': 0.007383503538135642, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.9883 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_48_lr_8.018685375889429e-05_epoch_86_wd_0.007383503538135642_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 0.7473 Acc: 0.3876
val Loss: 14.4841 Acc: 0.2045
Epoch 2/95
----------
train Loss: 0.5539 Acc: 0.4641
val Loss: 3.4328 Acc: 0.6364
Epoch 3/95
----------
train Loss: 0.5177 Acc: 0.4976
val Loss: 0.6330 Acc: 0.5227
Epoch 4/95
----------
train Loss: 0.4930 Acc: 0.5407
val Loss: 1.1379 Acc: 0.4545
Epoch 5/95
----------
train Loss: 0.4791 Acc: 0.5646
val Loss: 0.6297 Acc: 0.1364
Epoch 6/95
----------
train Loss: 0.4925 Acc: 0.5455
val Loss: 0.7319 Acc: 0.1364
Epoch 7/95
----------
train Loss: 0.4838 Acc: 0.5598
[32m[I 2025-06-28 06:22:04,229][0m Trial 29 finished with value: 0.6363636363636364 and parameters: {'batch_size': 14, 'lr': 0.009240317805560888, 'num_epochs': 95, 'weight_decay': 0.0008464033818042248, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.6797 Acc: 0.0909
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.636364

Model weights saved at ./model_weights/efficientnetb0_bs_14_lr_0.009240317805560888_epoch_95_wd_0.0008464033818042248_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/80
----------
train Loss: 0.6732 Acc: 0.2871
val Loss: 0.6387 Acc: 0.5227
Epoch 2/80
----------
train Loss: 0.6037 Acc: 0.4785
val Loss: 0.5752 Acc: 0.5909
Epoch 3/80
----------
train Loss: 0.5548 Acc: 0.4976
val Loss: 0.5049 Acc: 0.6364
Epoch 4/80
----------
train Loss: 0.5215 Acc: 0.5024
val Loss: 0.4632 Acc: 0.6364
Epoch 5/80
----------
train Loss: 0.4988 Acc: 0.5167
val Loss: 0.4421 Acc: 0.6591
Epoch 6/80
----------
train Loss: 0.4706 Acc: 0.5311
val Loss: 0.4136 Acc: 0.6591
Epoch 7/80
----------
train Loss: 0.4429 Acc: 0.5550
val Loss: 0.3926 Acc: 0.6818
Epoch 8/80
----------
train Loss: 0.4492 Acc: 0.5646
val Loss: 0.3659 Acc: 0.7045
Epoch 9/80
----------
train Loss: 0.4393 Acc: 0.6124
val Loss: 0.3531 Acc: 0.7273
Epoch 10/80
----------
train Loss: 0.3644 Acc: 0.7464
val Loss: 0.3399 Acc: 0.7273
Epoch 11/80
----------
train Loss: 0.4013 Acc: 0.6364
val Loss: 0.3235 Acc: 0.7500
Epoch 12/80
----------
train Loss: 0.4065 Acc: 0.6220
val Loss: 0.3464 Acc: 0.7500
Epoch 13/80
----------
train Loss: 0.3648 Acc: 0.7560
val Loss: 0.3196 Acc: 0.7273
Epoch 14/80
----------
train Loss: 0.3290 Acc: 0.7799
val Loss: 0.3010 Acc: 0.7500
Epoch 15/80
----------
train Loss: 0.3549 Acc: 0.7464
val Loss: 0.3009 Acc: 0.7727
Epoch 16/80
----------
train Loss: 0.3460 Acc: 0.7751
val Loss: 0.3219 Acc: 0.7273
Epoch 17/80
----------
train Loss: 0.3316 Acc: 0.8038
val Loss: 0.3373 Acc: 0.7955
Epoch 18/80
----------
train Loss: 0.3118 Acc: 0.7990
val Loss: 0.3080 Acc: 0.7500
Epoch 19/80
----------
train Loss: 0.2853 Acc: 0.8804
val Loss: 0.2840 Acc: 0.7955
Epoch 20/80
----------
train Loss: 0.3054 Acc: 0.8565
val Loss: 0.2668 Acc: 0.7727
Epoch 21/80
----------
train Loss: 0.3177 Acc: 0.8421
val Loss: 0.2605 Acc: 0.7955
Epoch 22/80
----------
train Loss: 0.2950 Acc: 0.8373
val Loss: 0.2656 Acc: 0.7727
Epoch 23/80
----------
train Loss: 0.3072 Acc: 0.8756
val Loss: 0.2645 Acc: 0.7955
Epoch 24/80
----------
train Loss: 0.2401 Acc: 0.9187
val Loss: 0.2469 Acc: 0.7955
Epoch 25/80
----------
train Loss: 0.2731 Acc: 0.9187
val Loss: 0.2652 Acc: 0.8182
Epoch 26/80
----------
train Loss: 0.2977 Acc: 0.9187
val Loss: 0.2733 Acc: 0.8182
Epoch 27/80
----------
train Loss: 0.2419 Acc: 0.9665
val Loss: 0.2897 Acc: 0.8182
Epoch 28/80
----------
train Loss: 0.3013 Acc: 0.8660
val Loss: 0.2697 Acc: 0.7500
Epoch 29/80
----------
train Loss: 0.3286 Acc: 0.7751
val Loss: 0.2814 Acc: 0.7727
Epoch 30/80
----------
train Loss: 0.2786 Acc: 0.8708
val Loss: 0.2685 Acc: 0.7500
Epoch 31/80
----------
train Loss: 0.2382 Acc: 0.9474
val Loss: 0.2479 Acc: 0.8182
Epoch 32/80
----------
train Loss: 0.2672 Acc: 0.8660
val Loss: 0.2417 Acc: 0.8182
Epoch 33/80
----------
train Loss: 0.2787 Acc: 0.8900
val Loss: 0.2524 Acc: 0.7727
Epoch 34/80
----------
train Loss: 0.2676 Acc: 0.9234
val Loss: 0.2636 Acc: 0.7500
Epoch 35/80
----------
train Loss: 0.2142 Acc: 0.9761
val Loss: 0.2897 Acc: 0.7273
Epoch 36/80
----------
train Loss: 0.3218 Acc: 0.8230
val Loss: 0.2847 Acc: 0.7727
Epoch 37/80
----------
train Loss: 0.2694 Acc: 0.8230
val Loss: 0.2817 Acc: 0.7500
Epoch 38/80
----------
train Loss: 0.2781 Acc: 0.9522
val Loss: 0.2679 Acc: 0.7727
Epoch 39/80
----------
train Loss: 0.2886 Acc: 0.7751
val Loss: 0.2903 Acc: 0.7500
Epoch 40/80
----------
train Loss: 0.2468 Acc: 0.8900
val Loss: 0.2773 Acc: 0.7273
Epoch 41/80
----------
train Loss: 0.3400 Acc: 0.7225
val Loss: 0.2627 Acc: 0.7727
Epoch 42/80
----------
train Loss: 0.2432 Acc: 0.8660
val Loss: 0.2711 Acc: 0.7955
Epoch 43/80
----------
train Loss: 0.2752 Acc: 0.8852
val Loss: 0.2560 Acc: 0.8182
Epoch 44/80
----------
train Loss: 0.2524 Acc: 0.8804
val Loss: 0.2690 Acc: 0.7727
Epoch 45/80
----------
train Loss: 0.1602 Acc: 0.9713
val Loss: 0.2514 Acc: 0.7727
Epoch 46/80
----------
train Loss: 0.3526 Acc: 0.8421
val Loss: 0.2723 Acc: 0.7955
Epoch 47/80
----------
train Loss: 0.2506 Acc: 0.8995
val Loss: 0.2663 Acc: 0.8182
Epoch 48/80
----------
train Loss: 0.2786 Acc: 0.8804
val Loss: 0.2593 Acc: 0.7727
Epoch 49/80
----------
train Loss: 0.2749 Acc: 0.9569
val Loss: 0.2721 Acc: 0.7727
Epoch 50/80
----------
train Loss: 0.2588 Acc: 0.8708
val Loss: 0.2755 Acc: 0.7955
Epoch 51/80
----------
train Loss: 0.2025 Acc: 0.9904
val Loss: 0.2483 Acc: 0.8409
Epoch 52/80
----------
train Loss: 0.2758 Acc: 0.8565
val Loss: 0.2530 Acc: 0.7955
Epoch 53/80
----------
train Loss: 0.3129 Acc: 0.9234
val Loss: 0.2776 Acc: 0.6818
Epoch 54/80
----------
train Loss: 0.2336 Acc: 0.9234
val Loss: 0.2782 Acc: 0.8182
Epoch 55/80
----------
train Loss: 0.2476 Acc: 0.9426
val Loss: 0.2954 Acc: 0.7500
Epoch 56/80
----------
train Loss: 0.2926 Acc: 0.9234
val Loss: 0.2654 Acc: 0.7955
Epoch 57/80
----------
train Loss: 0.3230 Acc: 0.8421
val Loss: 0.2691 Acc: 0.7727
Epoch 58/80
----------
train Loss: 0.2642 Acc: 0.7990
val Loss: 0.2675 Acc: 0.7500
Epoch 59/80
----------
train Loss: 0.2758 Acc: 0.8804
val Loss: 0.2804 Acc: 0.7045
Epoch 60/80
----------
train Loss: 0.2328 Acc: 0.8756
val Loss: 0.2743 Acc: 0.7273
Epoch 61/80
----------
train Loss: 0.3204 Acc: 0.7751
val Loss: 0.2589 Acc: 0.6818
Epoch 62/80
----------
train Loss: 0.2902 Acc: 0.9474
val Loss: 0.2723 Acc: 0.7500
Epoch 63/80
----------
train Loss: 0.2559 Acc: 0.9378
val Loss: 0.2853 Acc: 0.7500
Epoch 64/80
----------
train Loss: 0.2340 Acc: 0.9617
val Loss: 0.2702 Acc: 0.8409
Epoch 65/80
----------
train Loss: 0.2614 Acc: 0.8708
val Loss: 0.2948 Acc: 0.7500
Epoch 66/80
----------
train Loss: 0.2603 Acc: 0.8995
val Loss: 0.2984 Acc: 0.7500
Epoch 67/80
----------
train Loss: 0.2946 Acc: 0.8947
val Loss: 0.2855 Acc: 0.7045
Epoch 68/80
----------
train Loss: 0.2521 Acc: 0.9043
val Loss: 0.2977 Acc: 0.7500
Epoch 69/80
----------
train Loss: 0.2394 Acc: 0.8995
[32m[I 2025-06-28 06:37:46,354][0m Trial 30 finished with value: 0.8409090909090909 and parameters: {'batch_size': 114, 'lr': 0.00019626840549361542, 'num_epochs': 80, 'weight_decay': 0.004909169229530306, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2779 Acc: 0.7500
Early stopping at epoch 69 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_114_lr_0.00019626840549361542_epoch_80_wd_0.004909169229530306_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 1.2291 Acc: 0.4593
val Loss: 0.8832 Acc: 0.6364
Epoch 2/83
----------
train Loss: 0.5771 Acc: 0.8708
val Loss: 0.7308 Acc: 0.7500
Epoch 3/83
----------
train Loss: 0.2681 Acc: 0.9665
val Loss: 0.6005 Acc: 0.7955
Epoch 4/83
----------
train Loss: 0.1018 Acc: 0.9809
val Loss: 0.4800 Acc: 0.8182
Epoch 5/83
----------
train Loss: 0.0382 Acc: 0.9952
val Loss: 0.7130 Acc: 0.7500
Epoch 6/83
----------
train Loss: 0.0441 Acc: 0.9904
val Loss: 0.5891 Acc: 0.8409
Epoch 7/83
----------
train Loss: 0.0444 Acc: 0.9904
val Loss: 0.7103 Acc: 0.8182
Epoch 8/83
----------
train Loss: 0.0510 Acc: 0.9809
val Loss: 0.8069 Acc: 0.7727
Epoch 9/83
----------
train Loss: 0.1493 Acc: 0.9569
val Loss: 1.0137 Acc: 0.6591
Epoch 10/83
----------
train Loss: 0.1221 Acc: 0.9474
val Loss: 1.2206 Acc: 0.5909
Epoch 11/83
----------
train Loss: 0.1673 Acc: 0.9330
val Loss: 0.8413 Acc: 0.7045
Epoch 12/83
----------
train Loss: 0.1525 Acc: 0.9474
val Loss: 1.0120 Acc: 0.7273
Epoch 13/83
----------
train Loss: 0.1197 Acc: 0.9522
val Loss: 1.4815 Acc: 0.6818
Epoch 14/83
----------
train Loss: 0.1290 Acc: 0.9426
val Loss: 1.0621 Acc: 0.6364
Epoch 15/83
----------
train Loss: 0.1326 Acc: 0.9474
val Loss: 1.2958 Acc: 0.6136
Epoch 16/83
----------
train Loss: 0.1283 Acc: 0.9665
val Loss: 0.9465 Acc: 0.6818
Epoch 17/83
----------
train Loss: 0.1062 Acc: 0.9665
val Loss: 0.7029 Acc: 0.7500
Epoch 18/83
----------
train Loss: 0.0414 Acc: 0.9856
val Loss: 0.8445 Acc: 0.6591
Epoch 19/83
----------
train Loss: 0.0588 Acc: 0.9809
val Loss: 0.7957 Acc: 0.7045
Epoch 20/83
----------
train Loss: 0.0643 Acc: 0.9761
val Loss: 0.7514 Acc: 0.7500
Epoch 21/83
----------
train Loss: 0.0906 Acc: 0.9713
val Loss: 0.7359 Acc: 0.7500
Epoch 22/83
----------
train Loss: 0.1977 Acc: 0.9378
val Loss: 1.0022 Acc: 0.6818
Epoch 23/83
----------
train Loss: 0.1051 Acc: 0.9665
val Loss: 0.7635 Acc: 0.6591
Epoch 24/83
----------
train Loss: 0.0575 Acc: 0.9856
val Loss: 0.7266 Acc: 0.7955
Epoch 25/83
----------
train Loss: 0.0692 Acc: 0.9809
val Loss: 0.7668 Acc: 0.7500
Epoch 26/83
----------
train Loss: 0.0627 Acc: 0.9809
val Loss: 0.7517 Acc: 0.7500
Epoch 27/83
----------
train Loss: 0.0753 Acc: 0.9713
val Loss: 0.7985 Acc: 0.7727
Epoch 28/83
----------
train Loss: 0.1630 Acc: 0.9474
val Loss: 1.1868 Acc: 0.7273
Epoch 29/83
----------
train Loss: 0.1276 Acc: 0.9569
val Loss: 1.2437 Acc: 0.6591
Epoch 30/83
----------
train Loss: 0.1220 Acc: 0.9569
val Loss: 0.8738 Acc: 0.6818
Epoch 31/83
----------
train Loss: 0.0842 Acc: 0.9761
val Loss: 1.1947 Acc: 0.6364
Epoch 32/83
----------
train Loss: 0.0531 Acc: 0.9761
val Loss: 1.0931 Acc: 0.6591
Epoch 33/83
----------
train Loss: 0.0861 Acc: 0.9665
val Loss: 0.9231 Acc: 0.7727
Epoch 34/83
----------
train Loss: 0.1447 Acc: 0.9522
val Loss: 0.9918 Acc: 0.7500
Epoch 35/83
----------
train Loss: 0.0825 Acc: 0.9761
val Loss: 1.0267 Acc: 0.7500
Epoch 36/83
----------
train Loss: 0.1420 Acc: 0.9474
val Loss: 0.9771 Acc: 0.7273
Epoch 37/83
----------
train Loss: 0.1480 Acc: 0.9378
val Loss: 1.0385 Acc: 0.6364
Epoch 38/83
----------
train Loss: 0.1328 Acc: 0.9617
val Loss: 0.8925 Acc: 0.7273
Epoch 39/83
----------
train Loss: 0.0635 Acc: 0.9904
val Loss: 0.7940 Acc: 0.7273
Epoch 40/83
----------
train Loss: 0.0522 Acc: 0.9904
val Loss: 0.7914 Acc: 0.6591
Epoch 41/83
----------
train Loss: 0.0377 Acc: 0.9856
val Loss: 0.9506 Acc: 0.7045
Epoch 42/83
----------
train Loss: 0.0106 Acc: 1.0000
val Loss: 0.9205 Acc: 0.6818
Epoch 43/83
----------
train Loss: 0.0266 Acc: 0.9856
val Loss: 0.8327 Acc: 0.7500
Epoch 44/83
----------
train Loss: 0.0450 Acc: 0.9856
val Loss: 0.7643 Acc: 0.7727
Epoch 45/83
----------
train Loss: 0.0157 Acc: 0.9952
val Loss: 0.8611 Acc: 0.7045
Epoch 46/83
----------
train Loss: 0.0160 Acc: 0.9952
val Loss: 0.7954 Acc: 0.7273
Epoch 47/83
----------
train Loss: 0.0121 Acc: 1.0000
val Loss: 0.8142 Acc: 0.7273
Epoch 48/83
----------
train Loss: 0.0306 Acc: 0.9856
val Loss: 0.6968 Acc: 0.7955
Epoch 49/83
----------
train Loss: 0.1193 Acc: 0.9713
val Loss: 1.0572 Acc: 0.7045
Epoch 50/83
----------
train Loss: 0.1120 Acc: 0.9569
val Loss: 0.8856 Acc: 0.6818
Epoch 51/83
----------
train Loss: 0.0686 Acc: 0.9856
val Loss: 0.6837 Acc: 0.8182
Epoch 52/83
----------
train Loss: 0.0263 Acc: 0.9952
val Loss: 0.6765 Acc: 0.7273
Epoch 53/83
----------
train Loss: 0.0232 Acc: 1.0000
val Loss: 0.6433 Acc: 0.7955
Epoch 54/83
----------
train Loss: 0.0045 Acc: 1.0000
val Loss: 0.6025 Acc: 0.8182
Epoch 55/83
----------
train Loss: 0.0148 Acc: 0.9952
val Loss: 0.7062 Acc: 0.8182
Epoch 56/83
----------
train Loss: 0.0066 Acc: 1.0000
val Loss: 1.3048 Acc: 0.7727
Epoch 57/83
----------
train Loss: 0.0831 Acc: 0.9665
val Loss: 0.9420 Acc: 0.7500
Epoch 58/83
----------
train Loss: 0.0686 Acc: 0.9809
val Loss: 0.8328 Acc: 0.7727
Epoch 59/83
----------
train Loss: 0.1485 Acc: 0.9474
val Loss: 1.3437 Acc: 0.5682
Epoch 60/83
----------
train Loss: 0.0627 Acc: 0.9904
val Loss: 1.2912 Acc: 0.6591
Epoch 61/83
----------
train Loss: 0.1226 Acc: 0.9617
val Loss: 0.8136 Acc: 0.7955
Epoch 62/83
----------
train Loss: 0.0381 Acc: 0.9904
val Loss: 0.7726 Acc: 0.7500
Epoch 63/83
----------
train Loss: 0.0458 Acc: 0.9761
val Loss: 1.2894 Acc: 0.6591
Epoch 64/83
----------
train Loss: 0.0301 Acc: 0.9952
val Loss: 1.4167 Acc: 0.6364
Epoch 65/83
----------
train Loss: 0.0471 Acc: 0.9809
val Loss: 0.9933 Acc: 0.7727
Epoch 66/83
----------
train Loss: 0.0326 Acc: 0.9904
val Loss: 0.6576 Acc: 0.7955
Epoch 67/83
----------
train Loss: 0.0362 Acc: 0.9904
val Loss: 0.9051 Acc: 0.7500
Epoch 68/83
----------
train Loss: 0.0382 Acc: 0.9904
val Loss: 0.8213 Acc: 0.7727
Epoch 69/83
----------
train Loss: 0.0429 Acc: 0.9856
val Loss: 0.8329 Acc: 0.7273
Epoch 70/83
----------
train Loss: 0.0582 Acc: 0.9856
val Loss: 1.1245 Acc: 0.6818
Epoch 71/83
----------
train Loss: 0.0999 Acc: 0.9665
val Loss: 1.5809 Acc: 0.5227
Epoch 72/83
----------
train Loss: 0.1295 Acc: 0.9713
val Loss: 1.4240 Acc: 0.5000
Epoch 73/83
----------
train Loss: 0.1051 Acc: 0.9569
val Loss: 1.1406 Acc: 0.6591
Epoch 74/83
----------
train Loss: 0.0594 Acc: 0.9713
val Loss: 1.6355 Acc: 0.6136
Epoch 75/83
----------
train Loss: 0.0516 Acc: 0.9856
val Loss: 1.0065 Acc: 0.7045
Epoch 76/83
----------
train Loss: 0.3355 Acc: 0.9139
val Loss: 3.1418 Acc: 0.6591
Epoch 77/83
----------
train Loss: 0.2863 Acc: 0.9139
val Loss: 3.1141 Acc: 0.5227
Epoch 78/83
----------
train Loss: 0.2443 Acc: 0.9187
val Loss: 1.3682 Acc: 0.7500
Epoch 79/83
----------
train Loss: 0.2398 Acc: 0.9282
val Loss: 0.9034 Acc: 0.7955
Epoch 80/83
----------
train Loss: 0.1134 Acc: 0.9522
val Loss: 0.7675 Acc: 0.7955
Epoch 81/83
----------
train Loss: 0.0502 Acc: 0.9856
val Loss: 0.9900 Acc: 0.7273
Epoch 82/83
----------
train Loss: 0.0281 Acc: 0.9952
val Loss: 0.6812 Acc: 0.7727
Epoch 83/83
----------
train Loss: 0.0126 Acc: 1.0000
[32m[I 2025-06-28 06:56:39,677][0m Trial 31 finished with value: 0.7954545454545455 and parameters: {'batch_size': 100, 'lr': 0.0007937715113403579, 'num_epochs': 83, 'weight_decay': 0.0031512006542466085, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.6239 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_100_lr_0.0007937715113403579_epoch_83_wd_0.0031512006542466085_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 0.6932 Acc: 0.2392
val Loss: 0.6737 Acc: 0.2955
Epoch 2/90
----------
train Loss: 0.6641 Acc: 0.3062
val Loss: 0.6507 Acc: 0.3409
Epoch 3/90
----------
train Loss: 0.6403 Acc: 0.3732
val Loss: 0.6193 Acc: 0.4318
Epoch 4/90
----------
train Loss: 0.6226 Acc: 0.4163
val Loss: 0.5973 Acc: 0.4545
Epoch 5/90
----------
train Loss: 0.6090 Acc: 0.4737
val Loss: 0.5827 Acc: 0.5227
Epoch 6/90
----------
train Loss: 0.5866 Acc: 0.4976
val Loss: 0.5619 Acc: 0.6136
Epoch 7/90
----------
train Loss: 0.5636 Acc: 0.5502
val Loss: 0.5383 Acc: 0.6136
Epoch 8/90
----------
train Loss: 0.5525 Acc: 0.5359
val Loss: 0.5169 Acc: 0.6818
Epoch 9/90
----------
train Loss: 0.5364 Acc: 0.5694
val Loss: 0.4955 Acc: 0.6818
Epoch 10/90
----------
train Loss: 0.5017 Acc: 0.5789
val Loss: 0.4746 Acc: 0.6591
Epoch 11/90
----------
train Loss: 0.5077 Acc: 0.5550
val Loss: 0.4594 Acc: 0.6818
Epoch 12/90
----------
train Loss: 0.5028 Acc: 0.5646
val Loss: 0.4504 Acc: 0.6818
Epoch 13/90
----------
train Loss: 0.4720 Acc: 0.6124
val Loss: 0.4316 Acc: 0.6818
Epoch 14/90
----------
train Loss: 0.4522 Acc: 0.6077
val Loss: 0.4202 Acc: 0.6591
Epoch 15/90
----------
train Loss: 0.4569 Acc: 0.5981
val Loss: 0.4087 Acc: 0.7045
Epoch 16/90
----------
train Loss: 0.4475 Acc: 0.6220
val Loss: 0.3977 Acc: 0.7045
Epoch 17/90
----------
train Loss: 0.4364 Acc: 0.6077
val Loss: 0.3877 Acc: 0.7045
Epoch 18/90
----------
train Loss: 0.4237 Acc: 0.6651
val Loss: 0.3761 Acc: 0.7045
Epoch 19/90
----------
train Loss: 0.4060 Acc: 0.7129
val Loss: 0.3693 Acc: 0.7727
Epoch 20/90
----------
train Loss: 0.4121 Acc: 0.7033
val Loss: 0.3580 Acc: 0.7500
Epoch 21/90
----------
train Loss: 0.4096 Acc: 0.6890
val Loss: 0.3489 Acc: 0.7500
Epoch 22/90
----------
train Loss: 0.4013 Acc: 0.6699
val Loss: 0.3430 Acc: 0.7500
Epoch 23/90
----------
train Loss: 0.3950 Acc: 0.7081
val Loss: 0.3341 Acc: 0.7727
Epoch 24/90
----------
train Loss: 0.3592 Acc: 0.7799
val Loss: 0.3199 Acc: 0.7727
Epoch 25/90
----------
train Loss: 0.3815 Acc: 0.7081
val Loss: 0.3221 Acc: 0.7955
Epoch 26/90
----------
train Loss: 0.3839 Acc: 0.7560
val Loss: 0.3211 Acc: 0.7955
Epoch 27/90
----------
train Loss: 0.3374 Acc: 0.8421
val Loss: 0.3175 Acc: 0.8182
Epoch 28/90
----------
train Loss: 0.3802 Acc: 0.7512
val Loss: 0.3148 Acc: 0.7955
Epoch 29/90
----------
train Loss: 0.3997 Acc: 0.6651
val Loss: 0.3140 Acc: 0.8182
Epoch 30/90
----------
train Loss: 0.3654 Acc: 0.7177
val Loss: 0.3089 Acc: 0.7727
Epoch 31/90
----------
train Loss: 0.3241 Acc: 0.8421
val Loss: 0.2999 Acc: 0.7727
Epoch 32/90
----------
train Loss: 0.3467 Acc: 0.7656
val Loss: 0.2925 Acc: 0.7727
Epoch 33/90
----------
train Loss: 0.3658 Acc: 0.7751
val Loss: 0.2918 Acc: 0.7727
Epoch 34/90
----------
train Loss: 0.3388 Acc: 0.8325
val Loss: 0.2895 Acc: 0.7727
Epoch 35/90
----------
train Loss: 0.2928 Acc: 0.8947
val Loss: 0.2920 Acc: 0.7955
Epoch 36/90
----------
train Loss: 0.3780 Acc: 0.7321
val Loss: 0.2887 Acc: 0.7955
Epoch 37/90
----------
train Loss: 0.3230 Acc: 0.7895
val Loss: 0.2951 Acc: 0.7955
Epoch 38/90
----------
train Loss: 0.3215 Acc: 0.9043
val Loss: 0.2903 Acc: 0.7955
Epoch 39/90
----------
train Loss: 0.3490 Acc: 0.7273
val Loss: 0.2972 Acc: 0.7273
Epoch 40/90
----------
train Loss: 0.2961 Acc: 0.8278
val Loss: 0.2930 Acc: 0.7500
Epoch 41/90
----------
train Loss: 0.3635 Acc: 0.7225
val Loss: 0.2866 Acc: 0.7955
Epoch 42/90
----------
train Loss: 0.3001 Acc: 0.7990
val Loss: 0.2783 Acc: 0.7955
Epoch 43/90
----------
train Loss: 0.3224 Acc: 0.8182
val Loss: 0.2748 Acc: 0.7955
Epoch 44/90
----------
train Loss: 0.2939 Acc: 0.8421
val Loss: 0.2741 Acc: 0.8182
Epoch 45/90
----------
train Loss: 0.2019 Acc: 0.9569
val Loss: 0.2719 Acc: 0.7955
Epoch 46/90
----------
train Loss: 0.3742 Acc: 0.8086
val Loss: 0.2746 Acc: 0.8182
Epoch 47/90
----------
train Loss: 0.2841 Acc: 0.8756
val Loss: 0.2703 Acc: 0.8182
Epoch 48/90
----------
train Loss: 0.3151 Acc: 0.7943
val Loss: 0.2736 Acc: 0.8182
Epoch 49/90
----------
train Loss: 0.2989 Acc: 0.8947
val Loss: 0.2721 Acc: 0.7955
Epoch 50/90
----------
train Loss: 0.2903 Acc: 0.8421
val Loss: 0.2729 Acc: 0.7955
Epoch 51/90
----------
train Loss: 0.2254 Acc: 0.9761
val Loss: 0.2674 Acc: 0.7955
Epoch 52/90
----------
train Loss: 0.3063 Acc: 0.7751
val Loss: 0.2695 Acc: 0.7727
Epoch 53/90
----------
train Loss: 0.3383 Acc: 0.8852
val Loss: 0.2672 Acc: 0.7727
Epoch 54/90
----------
train Loss: 0.2522 Acc: 0.9187
val Loss: 0.2609 Acc: 0.7955
Epoch 55/90
----------
train Loss: 0.2689 Acc: 0.9234
val Loss: 0.2602 Acc: 0.8182
Epoch 56/90
----------
train Loss: 0.3122 Acc: 0.8565
val Loss: 0.2609 Acc: 0.7727
Epoch 57/90
----------
train Loss: 0.3476 Acc: 0.8038
val Loss: 0.2593 Acc: 0.8409
Epoch 58/90
----------
train Loss: 0.2894 Acc: 0.7990
val Loss: 0.2565 Acc: 0.8182
Epoch 59/90
----------
train Loss: 0.3014 Acc: 0.8421
val Loss: 0.2559 Acc: 0.7955
Epoch 60/90
----------
train Loss: 0.2550 Acc: 0.8565
val Loss: 0.2588 Acc: 0.7955
Epoch 61/90
----------
train Loss: 0.3425 Acc: 0.7368
val Loss: 0.2611 Acc: 0.7955
Epoch 62/90
----------
train Loss: 0.3034 Acc: 0.9187
val Loss: 0.2606 Acc: 0.7727
Epoch 63/90
----------
train Loss: 0.2622 Acc: 0.9330
val Loss: 0.2604 Acc: 0.7727
Epoch 64/90
----------
train Loss: 0.2497 Acc: 0.9282
val Loss: 0.2587 Acc: 0.7955
Epoch 65/90
----------
train Loss: 0.2840 Acc: 0.8182
val Loss: 0.2607 Acc: 0.7955
Epoch 66/90
----------
train Loss: 0.2754 Acc: 0.8947
val Loss: 0.2645 Acc: 0.7955
Epoch 67/90
----------
train Loss: 0.3086 Acc: 0.8612
val Loss: 0.2583 Acc: 0.8182
Epoch 68/90
----------
train Loss: 0.2581 Acc: 0.8947
val Loss: 0.2616 Acc: 0.7955
Epoch 69/90
----------
train Loss: 0.2582 Acc: 0.8852
val Loss: 0.2594 Acc: 0.8182
Epoch 70/90
----------
train Loss: 0.2908 Acc: 0.8995
val Loss: 0.2609 Acc: 0.7955
Epoch 71/90
----------
train Loss: 0.3053 Acc: 0.9091
val Loss: 0.2587 Acc: 0.7727
Epoch 72/90
----------
train Loss: 0.3071 Acc: 0.8708
val Loss: 0.2643 Acc: 0.7727
Epoch 73/90
----------
train Loss: 0.2174 Acc: 0.9617
val Loss: 0.2685 Acc: 0.7500
Epoch 74/90
----------
train Loss: 0.3203 Acc: 0.8517
val Loss: 0.2631 Acc: 0.7727
Epoch 75/90
----------
train Loss: 0.2388 Acc: 0.9330
val Loss: 0.2622 Acc: 0.7273
Epoch 76/90
----------
train Loss: 0.2609 Acc: 0.8182
val Loss: 0.2592 Acc: 0.7727
Epoch 77/90
----------
train Loss: 0.2960 Acc: 0.8517
val Loss: 0.2573 Acc: 0.7500
Epoch 78/90
----------
train Loss: 0.2561 Acc: 0.8756
val Loss: 0.2568 Acc: 0.7955
Epoch 79/90
----------
train Loss: 0.3155 Acc: 0.8421
val Loss: 0.2530 Acc: 0.8182
Epoch 80/90
----------
train Loss: 0.2768 Acc: 0.8421
val Loss: 0.2526 Acc: 0.8636
Epoch 81/90
----------
train Loss: 0.3187 Acc: 0.7847
val Loss: 0.2618 Acc: 0.7727
Epoch 82/90
----------
train Loss: 0.2755 Acc: 0.8373
val Loss: 0.2648 Acc: 0.7727
Epoch 83/90
----------
train Loss: 0.2371 Acc: 0.9569
val Loss: 0.2663 Acc: 0.7955
Epoch 84/90
----------
train Loss: 0.3155 Acc: 0.7703
val Loss: 0.2638 Acc: 0.7273
Epoch 85/90
----------
train Loss: 0.2503 Acc: 0.8086
[32m[I 2025-06-28 07:16:00,463][0m Trial 32 finished with value: 0.8636363636363636 and parameters: {'batch_size': 13, 'lr': 5.0717943637052973e-05, 'num_epochs': 90, 'weight_decay': 0.0004097064159583127, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2634 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_13_lr_5.0717943637052973e-05_epoch_90_wd_0.0004097064159583127_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/91
----------
train Loss: 0.6981 Acc: 0.2201
val Loss: 0.6818 Acc: 0.2500
Epoch 2/91
----------
train Loss: 0.6807 Acc: 0.2632
val Loss: 0.6701 Acc: 0.2500
Epoch 3/91
----------
train Loss: 0.6669 Acc: 0.2775
val Loss: 0.6519 Acc: 0.2500
Epoch 4/91
----------
train Loss: 0.6578 Acc: 0.3062
val Loss: 0.6409 Acc: 0.3636
Epoch 5/91
----------
train Loss: 0.6528 Acc: 0.3206
val Loss: 0.6354 Acc: 0.3409
Epoch 6/91
----------
train Loss: 0.6397 Acc: 0.3732
val Loss: 0.6264 Acc: 0.4318
Epoch 7/91
----------
train Loss: 0.6272 Acc: 0.4258
val Loss: 0.6161 Acc: 0.4773
Epoch 8/91
----------
train Loss: 0.6175 Acc: 0.4498
val Loss: 0.6071 Acc: 0.5000
Epoch 9/91
----------
train Loss: 0.6082 Acc: 0.4833
val Loss: 0.5958 Acc: 0.5227
Epoch 10/91
----------
train Loss: 0.5905 Acc: 0.5120
val Loss: 0.5818 Acc: 0.5682
Epoch 11/91
----------
train Loss: 0.5918 Acc: 0.4880
val Loss: 0.5742 Acc: 0.6136
Epoch 12/91
----------
train Loss: 0.5844 Acc: 0.4976
val Loss: 0.5671 Acc: 0.5909
Epoch 13/91
----------
train Loss: 0.5652 Acc: 0.5694
val Loss: 0.5511 Acc: 0.6364
Epoch 14/91
----------
train Loss: 0.5531 Acc: 0.5550
val Loss: 0.5441 Acc: 0.6818
Epoch 15/91
----------
train Loss: 0.5491 Acc: 0.5550
val Loss: 0.5356 Acc: 0.6591
Epoch 16/91
----------
train Loss: 0.5407 Acc: 0.5598
val Loss: 0.5224 Acc: 0.6364
Epoch 17/91
----------
train Loss: 0.5319 Acc: 0.5694
val Loss: 0.5111 Acc: 0.6364
Epoch 18/91
----------
train Loss: 0.5249 Acc: 0.5502
val Loss: 0.5003 Acc: 0.6591
Epoch 19/91
----------
train Loss: 0.5114 Acc: 0.5981
val Loss: 0.4909 Acc: 0.6364
Epoch 20/91
----------
train Loss: 0.5065 Acc: 0.5885
val Loss: 0.4807 Acc: 0.6591
Epoch 21/91
----------
train Loss: 0.5034 Acc: 0.5694
val Loss: 0.4751 Acc: 0.6591
Epoch 22/91
----------
train Loss: 0.4974 Acc: 0.5885
val Loss: 0.4663 Acc: 0.6591
Epoch 23/91
----------
train Loss: 0.4851 Acc: 0.5885
val Loss: 0.4576 Acc: 0.6818
Epoch 24/91
----------
train Loss: 0.4639 Acc: 0.6124
val Loss: 0.4410 Acc: 0.6818
Epoch 25/91
----------
train Loss: 0.4765 Acc: 0.5933
val Loss: 0.4409 Acc: 0.6818
Epoch 26/91
----------
train Loss: 0.4721 Acc: 0.5837
val Loss: 0.4376 Acc: 0.7045
Epoch 27/91
----------
train Loss: 0.4449 Acc: 0.6459
val Loss: 0.4259 Acc: 0.7045
Epoch 28/91
----------
train Loss: 0.4612 Acc: 0.5933
val Loss: 0.4202 Acc: 0.7500
Epoch 29/91
----------
train Loss: 0.4703 Acc: 0.5646
val Loss: 0.4141 Acc: 0.7273
Epoch 30/91
----------
train Loss: 0.4543 Acc: 0.5933
val Loss: 0.4110 Acc: 0.7273
Epoch 31/91
----------
train Loss: 0.4290 Acc: 0.6842
val Loss: 0.4027 Acc: 0.7273
Epoch 32/91
----------
train Loss: 0.4354 Acc: 0.6220
val Loss: 0.3943 Acc: 0.7500
Epoch 33/91
----------
train Loss: 0.4452 Acc: 0.6316
val Loss: 0.3903 Acc: 0.7273
Epoch 34/91
----------
train Loss: 0.4276 Acc: 0.6364
val Loss: 0.3843 Acc: 0.7273
Epoch 35/91
----------
train Loss: 0.4020 Acc: 0.6746
val Loss: 0.3790 Acc: 0.7273
Epoch 36/91
----------
train Loss: 0.4481 Acc: 0.6220
val Loss: 0.3707 Acc: 0.7273
Epoch 37/91
----------
train Loss: 0.4147 Acc: 0.6651
val Loss: 0.3736 Acc: 0.7273
Epoch 38/91
----------
train Loss: 0.4134 Acc: 0.6986
val Loss: 0.3684 Acc: 0.7273
Epoch 39/91
----------
train Loss: 0.4224 Acc: 0.6124
val Loss: 0.3731 Acc: 0.7273
Epoch 40/91
----------
train Loss: 0.3944 Acc: 0.6794
val Loss: 0.3670 Acc: 0.7273
Epoch 41/91
----------
train Loss: 0.4277 Acc: 0.6459
val Loss: 0.3623 Acc: 0.7500
Epoch 42/91
----------
train Loss: 0.3913 Acc: 0.6794
val Loss: 0.3560 Acc: 0.7500
Epoch 43/91
----------
train Loss: 0.4075 Acc: 0.6651
val Loss: 0.3496 Acc: 0.7727
Epoch 44/91
----------
train Loss: 0.3819 Acc: 0.7656
val Loss: 0.3460 Acc: 0.7727
Epoch 45/91
----------
train Loss: 0.3232 Acc: 0.8373
val Loss: 0.3411 Acc: 0.7727
Epoch 46/91
----------
train Loss: 0.4266 Acc: 0.7416
val Loss: 0.3420 Acc: 0.7727
Epoch 47/91
----------
train Loss: 0.3704 Acc: 0.7656
val Loss: 0.3387 Acc: 0.7955
Epoch 48/91
----------
train Loss: 0.3884 Acc: 0.7321
val Loss: 0.3377 Acc: 0.7500
Epoch 49/91
----------
train Loss: 0.3762 Acc: 0.7799
val Loss: 0.3317 Acc: 0.7955
Epoch 50/91
----------
train Loss: 0.3690 Acc: 0.7225
val Loss: 0.3320 Acc: 0.7727
Epoch 51/91
----------
train Loss: 0.3315 Acc: 0.8325
val Loss: 0.3236 Acc: 0.7727
Epoch 52/91
----------
train Loss: 0.3795 Acc: 0.7129
val Loss: 0.3259 Acc: 0.7955
Epoch 53/91
----------
train Loss: 0.3953 Acc: 0.7464
val Loss: 0.3241 Acc: 0.7955
Epoch 54/91
----------
train Loss: 0.3323 Acc: 0.8421
val Loss: 0.3195 Acc: 0.8182
Epoch 55/91
----------
train Loss: 0.3498 Acc: 0.8182
val Loss: 0.3145 Acc: 0.8182
Epoch 56/91
----------
train Loss: 0.3744 Acc: 0.7751
val Loss: 0.3145 Acc: 0.8182
Epoch 57/91
----------
train Loss: 0.4019 Acc: 0.7033
val Loss: 0.3128 Acc: 0.8182
Epoch 58/91
----------
train Loss: 0.3526 Acc: 0.7512
val Loss: 0.3114 Acc: 0.8182
Epoch 59/91
----------
train Loss: 0.3725 Acc: 0.7321
val Loss: 0.3085 Acc: 0.8182
Epoch 60/91
----------
train Loss: 0.3415 Acc: 0.7751
val Loss: 0.3077 Acc: 0.7955
Epoch 61/91
----------
train Loss: 0.3945 Acc: 0.6699
val Loss: 0.3072 Acc: 0.7955
Epoch 62/91
----------
train Loss: 0.3605 Acc: 0.8038
val Loss: 0.3064 Acc: 0.8182
Epoch 63/91
----------
train Loss: 0.3286 Acc: 0.8469
val Loss: 0.3048 Acc: 0.7955
Epoch 64/91
----------
train Loss: 0.3218 Acc: 0.8517
val Loss: 0.3016 Acc: 0.7955
Epoch 65/91
----------
train Loss: 0.3473 Acc: 0.7321
val Loss: 0.2975 Acc: 0.7955
Epoch 66/91
----------
train Loss: 0.3403 Acc: 0.8038
val Loss: 0.2999 Acc: 0.7727
Epoch 67/91
----------
train Loss: 0.3585 Acc: 0.7847
val Loss: 0.2943 Acc: 0.7955
Epoch 68/91
----------
train Loss: 0.3201 Acc: 0.8421
val Loss: 0.2945 Acc: 0.7955
Epoch 69/91
----------
train Loss: 0.3252 Acc: 0.8134
val Loss: 0.2938 Acc: 0.7955
Epoch 70/91
----------
train Loss: 0.3446 Acc: 0.8038
val Loss: 0.2976 Acc: 0.7955
Epoch 71/91
----------
train Loss: 0.3635 Acc: 0.7751
val Loss: 0.2947 Acc: 0.7955
Epoch 72/91
----------
train Loss: 0.3601 Acc: 0.7799
val Loss: 0.2978 Acc: 0.7955
Epoch 73/91
----------
train Loss: 0.2769 Acc: 0.9187
val Loss: 0.2973 Acc: 0.7955
Epoch 74/91
----------
train Loss: 0.3723 Acc: 0.7416
val Loss: 0.2927 Acc: 0.7955
Epoch 75/91
----------
train Loss: 0.3017 Acc: 0.8517
val Loss: 0.2927 Acc: 0.7955
Epoch 76/91
----------
train Loss: 0.3273 Acc: 0.7512
val Loss: 0.2896 Acc: 0.7955
Epoch 77/91
----------
train Loss: 0.3423 Acc: 0.8086
val Loss: 0.2879 Acc: 0.7955
Epoch 78/91
----------
train Loss: 0.3055 Acc: 0.8421
val Loss: 0.2853 Acc: 0.7955
Epoch 79/91
----------
train Loss: 0.3673 Acc: 0.7656
val Loss: 0.2800 Acc: 0.7955
Epoch 80/91
----------
train Loss: 0.3271 Acc: 0.8230
val Loss: 0.2795 Acc: 0.7955
Epoch 81/91
----------
train Loss: 0.3609 Acc: 0.7416
val Loss: 0.2854 Acc: 0.8182
Epoch 82/91
----------
train Loss: 0.3200 Acc: 0.8134
val Loss: 0.2857 Acc: 0.8182
Epoch 83/91
----------
train Loss: 0.2796 Acc: 0.9330
val Loss: 0.2854 Acc: 0.8182
Epoch 84/91
----------
train Loss: 0.3594 Acc: 0.7129
val Loss: 0.2858 Acc: 0.7955
Epoch 85/91
----------
train Loss: 0.3051 Acc: 0.7751
val Loss: 0.2835 Acc: 0.7955
Epoch 86/91
----------
train Loss: 0.3073 Acc: 0.8421
val Loss: 0.2778 Acc: 0.7955
Epoch 87/91
----------
train Loss: 0.3405 Acc: 0.8278
val Loss: 0.2775 Acc: 0.8182
Epoch 88/91
----------
train Loss: 0.3435 Acc: 0.8565
val Loss: 0.2749 Acc: 0.8182
Epoch 89/91
----------
train Loss: 0.3660 Acc: 0.7703
val Loss: 0.2746 Acc: 0.8182
Epoch 90/91
----------
train Loss: 0.3120 Acc: 0.8421
val Loss: 0.2741 Acc: 0.8182
Epoch 91/91
----------
train Loss: 0.2814 Acc: 0.8947
[32m[I 2025-06-28 07:36:42,988][0m Trial 33 finished with value: 0.7954545454545455 and parameters: {'batch_size': 9, 'lr': 2.4980694730050833e-05, 'num_epochs': 91, 'weight_decay': 0.00017664879070163544, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2777 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_9_lr_2.4980694730050833e-05_epoch_91_wd_0.00017664879070163544_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 0.6902 Acc: 0.2440
val Loss: 0.6685 Acc: 0.2955
Epoch 2/95
----------
train Loss: 0.6540 Acc: 0.3541
val Loss: 0.6384 Acc: 0.4091
Epoch 3/95
----------
train Loss: 0.6246 Acc: 0.4258
val Loss: 0.5974 Acc: 0.4318
Epoch 4/95
----------
train Loss: 0.6020 Acc: 0.4641
val Loss: 0.5678 Acc: 0.5682
Epoch 5/95
----------
train Loss: 0.5838 Acc: 0.5167
val Loss: 0.5472 Acc: 0.6136
Epoch 6/95
----------
train Loss: 0.5565 Acc: 0.5263
val Loss: 0.5189 Acc: 0.6591
Epoch 7/95
----------
train Loss: 0.5285 Acc: 0.5789
val Loss: 0.4908 Acc: 0.6591
Epoch 8/95
----------
train Loss: 0.5192 Acc: 0.5359
val Loss: 0.4657 Acc: 0.6818
Epoch 9/95
----------
train Loss: 0.5023 Acc: 0.5550
val Loss: 0.4441 Acc: 0.6818
Epoch 10/95
----------
train Loss: 0.4581 Acc: 0.5933
val Loss: 0.4254 Acc: 0.6818
Epoch 11/95
----------
train Loss: 0.4704 Acc: 0.5694
val Loss: 0.4097 Acc: 0.7045
Epoch 12/95
----------
train Loss: 0.4700 Acc: 0.5837
val Loss: 0.4025 Acc: 0.7045
Epoch 13/95
----------
train Loss: 0.4348 Acc: 0.6507
val Loss: 0.3857 Acc: 0.7045
Epoch 14/95
----------
train Loss: 0.4123 Acc: 0.6555
val Loss: 0.3727 Acc: 0.7273
Epoch 15/95
----------
train Loss: 0.4239 Acc: 0.6411
val Loss: 0.3625 Acc: 0.7727
Epoch 16/95
----------
train Loss: 0.4150 Acc: 0.6794
val Loss: 0.3553 Acc: 0.7500
Epoch 17/95
----------
train Loss: 0.4032 Acc: 0.7273
val Loss: 0.3486 Acc: 0.7500
Epoch 18/95
----------
train Loss: 0.3865 Acc: 0.7081
val Loss: 0.3376 Acc: 0.7727
Epoch 19/95
----------
train Loss: 0.3665 Acc: 0.7751
val Loss: 0.3319 Acc: 0.7727
Epoch 20/95
----------
train Loss: 0.3796 Acc: 0.7512
val Loss: 0.3207 Acc: 0.7727
Epoch 21/95
----------
train Loss: 0.3791 Acc: 0.7560
val Loss: 0.3106 Acc: 0.7955
Epoch 22/95
----------
train Loss: 0.3664 Acc: 0.7416
val Loss: 0.3072 Acc: 0.7955
Epoch 23/95
----------
train Loss: 0.3650 Acc: 0.7560
val Loss: 0.3000 Acc: 0.7955
Epoch 24/95
----------
train Loss: 0.3206 Acc: 0.8421
val Loss: 0.2858 Acc: 0.7955
Epoch 25/95
----------
train Loss: 0.3454 Acc: 0.7895
val Loss: 0.2889 Acc: 0.8182
Epoch 26/95
----------
train Loss: 0.3520 Acc: 0.8134
val Loss: 0.2892 Acc: 0.8409
Epoch 27/95
----------
train Loss: 0.2984 Acc: 0.9187
val Loss: 0.2918 Acc: 0.8182
Epoch 28/95
----------
train Loss: 0.3514 Acc: 0.7847
val Loss: 0.2903 Acc: 0.7500
Epoch 29/95
----------
train Loss: 0.3739 Acc: 0.7225
val Loss: 0.2912 Acc: 0.7727
Epoch 30/95
----------
train Loss: 0.3305 Acc: 0.7799
val Loss: 0.2815 Acc: 0.7955
Epoch 31/95
----------
train Loss: 0.2868 Acc: 0.9043
val Loss: 0.2713 Acc: 0.8182
Epoch 32/95
----------
train Loss: 0.3143 Acc: 0.8086
val Loss: 0.2668 Acc: 0.7955
Epoch 33/95
----------
train Loss: 0.3333 Acc: 0.8182
val Loss: 0.2662 Acc: 0.7955
Epoch 34/95
----------
train Loss: 0.3086 Acc: 0.8565
val Loss: 0.2674 Acc: 0.7955
Epoch 35/95
----------
train Loss: 0.2554 Acc: 0.9569
val Loss: 0.2744 Acc: 0.7500
Epoch 36/95
----------
train Loss: 0.3544 Acc: 0.7703
val Loss: 0.2736 Acc: 0.7727
Epoch 37/95
----------
train Loss: 0.2944 Acc: 0.8278
val Loss: 0.2787 Acc: 0.7500
Epoch 38/95
----------
train Loss: 0.2940 Acc: 0.9378
val Loss: 0.2701 Acc: 0.7727
Epoch 39/95
----------
train Loss: 0.3256 Acc: 0.7273
val Loss: 0.2754 Acc: 0.7727
Epoch 40/95
----------
train Loss: 0.2664 Acc: 0.8900
val Loss: 0.2729 Acc: 0.7955
Epoch 41/95
----------
train Loss: 0.3483 Acc: 0.7368
val Loss: 0.2664 Acc: 0.8182
Epoch 42/95
----------
train Loss: 0.2680 Acc: 0.8278
val Loss: 0.2596 Acc: 0.7955
Epoch 43/95
----------
train Loss: 0.2919 Acc: 0.8421
val Loss: 0.2577 Acc: 0.7955
Epoch 44/95
----------
train Loss: 0.2729 Acc: 0.8565
val Loss: 0.2609 Acc: 0.8182
Epoch 45/95
----------
train Loss: 0.1743 Acc: 0.9665
val Loss: 0.2624 Acc: 0.8409
Epoch 46/95
----------
train Loss: 0.3627 Acc: 0.8134
val Loss: 0.2670 Acc: 0.8182
Epoch 47/95
----------
train Loss: 0.2615 Acc: 0.8852
val Loss: 0.2613 Acc: 0.8182
Epoch 48/95
----------
train Loss: 0.2978 Acc: 0.8373
val Loss: 0.2645 Acc: 0.7727
Epoch 49/95
----------
train Loss: 0.2800 Acc: 0.9282
val Loss: 0.2648 Acc: 0.7955
Epoch 50/95
----------
train Loss: 0.2741 Acc: 0.8660
val Loss: 0.2646 Acc: 0.7727
Epoch 51/95
----------
train Loss: 0.2036 Acc: 0.9856
val Loss: 0.2577 Acc: 0.7727
Epoch 52/95
----------
train Loss: 0.2899 Acc: 0.8086
val Loss: 0.2587 Acc: 0.7500
Epoch 53/95
----------
train Loss: 0.3242 Acc: 0.9139
val Loss: 0.2561 Acc: 0.7727
Epoch 54/95
----------
train Loss: 0.2385 Acc: 0.9330
val Loss: 0.2520 Acc: 0.7955
Epoch 55/95
----------
train Loss: 0.2539 Acc: 0.9282
val Loss: 0.2547 Acc: 0.7727
Epoch 56/95
----------
train Loss: 0.2967 Acc: 0.8947
val Loss: 0.2571 Acc: 0.7727
Epoch 57/95
----------
train Loss: 0.3378 Acc: 0.8182
val Loss: 0.2559 Acc: 0.7727
Epoch 58/95
----------
train Loss: 0.2767 Acc: 0.7943
val Loss: 0.2505 Acc: 0.8182
Epoch 59/95
----------
train Loss: 0.2866 Acc: 0.8852
val Loss: 0.2513 Acc: 0.7955
Epoch 60/95
----------
train Loss: 0.2385 Acc: 0.8756
val Loss: 0.2532 Acc: 0.7727
Epoch 61/95
----------
train Loss: 0.3284 Acc: 0.7703
val Loss: 0.2582 Acc: 0.7727
Epoch 62/95
----------
train Loss: 0.2951 Acc: 0.9569
val Loss: 0.2585 Acc: 0.7727
Epoch 63/95
----------
train Loss: 0.2534 Acc: 0.9378
val Loss: 0.2574 Acc: 0.7727
Epoch 64/95
----------
train Loss: 0.2383 Acc: 0.9474
val Loss: 0.2556 Acc: 0.7955
Epoch 65/95
----------
train Loss: 0.2734 Acc: 0.8278
val Loss: 0.2595 Acc: 0.7727
Epoch 66/95
----------
train Loss: 0.2667 Acc: 0.9043
val Loss: 0.2656 Acc: 0.7727
Epoch 67/95
----------
train Loss: 0.2995 Acc: 0.8708
val Loss: 0.2607 Acc: 0.7727
Epoch 68/95
----------
train Loss: 0.2505 Acc: 0.8947
val Loss: 0.2643 Acc: 0.7955
Epoch 69/95
----------
train Loss: 0.2485 Acc: 0.8900
val Loss: 0.2585 Acc: 0.7727
Epoch 70/95
----------
train Loss: 0.2809 Acc: 0.9091
val Loss: 0.2590 Acc: 0.7727
Epoch 71/95
----------
train Loss: 0.2964 Acc: 0.9091
val Loss: 0.2567 Acc: 0.7500
Epoch 72/95
----------
train Loss: 0.2955 Acc: 0.8947
val Loss: 0.2636 Acc: 0.7500
Epoch 73/95
----------
train Loss: 0.2123 Acc: 0.9617
val Loss: 0.2690 Acc: 0.7500
Epoch 74/95
----------
train Loss: 0.3103 Acc: 0.8660
val Loss: 0.2631 Acc: 0.7500
Epoch 75/95
----------
train Loss: 0.2303 Acc: 0.9569
val Loss: 0.2594 Acc: 0.7500
Epoch 76/95
----------
train Loss: 0.2483 Acc: 0.8278
val Loss: 0.2569 Acc: 0.7500
Epoch 77/95
----------
train Loss: 0.2867 Acc: 0.8612
val Loss: 0.2573 Acc: 0.7727
Epoch 78/95
----------
train Loss: 0.2492 Acc: 0.8900
val Loss: 0.2585 Acc: 0.7727
Epoch 79/95
----------
train Loss: 0.3021 Acc: 0.8708
val Loss: 0.2551 Acc: 0.7955
Epoch 80/95
----------
train Loss: 0.2683 Acc: 0.8421
val Loss: 0.2560 Acc: 0.8636
Epoch 81/95
----------
train Loss: 0.3093 Acc: 0.8086
val Loss: 0.2671 Acc: 0.7955
Epoch 82/95
----------
train Loss: 0.2672 Acc: 0.8469
val Loss: 0.2712 Acc: 0.7727
Epoch 83/95
----------
train Loss: 0.2325 Acc: 0.9761
val Loss: 0.2719 Acc: 0.7955
Epoch 84/95
----------
train Loss: 0.3048 Acc: 0.7751
val Loss: 0.2676 Acc: 0.7727
Epoch 85/95
----------
train Loss: 0.2400 Acc: 0.8325
[32m[I 2025-06-28 07:56:05,012][0m Trial 34 finished with value: 0.8636363636363636 and parameters: {'batch_size': 21, 'lr': 6.690801138692313e-05, 'num_epochs': 95, 'weight_decay': 0.00041814493754095125, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2638 Acc: 0.7727
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_21_lr_6.690801138692313e-05_epoch_95_wd_0.00041814493754095125_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 0.6874 Acc: 0.2584
val Loss: 0.6635 Acc: 0.2955
Epoch 2/88
----------
train Loss: 0.6448 Acc: 0.3876
val Loss: 0.6261 Acc: 0.4545
Epoch 3/88
----------
train Loss: 0.6104 Acc: 0.4737
val Loss: 0.5757 Acc: 0.5455
Epoch 4/88
----------
train Loss: 0.5835 Acc: 0.4928
val Loss: 0.5385 Acc: 0.6136
Epoch 5/88
----------
train Loss: 0.5617 Acc: 0.5359
val Loss: 0.5127 Acc: 0.6364
Epoch 6/88
----------
train Loss: 0.5307 Acc: 0.5550
val Loss: 0.4809 Acc: 0.6591
Epoch 7/88
----------
train Loss: 0.5000 Acc: 0.5742
val Loss: 0.4525 Acc: 0.6818
Epoch 8/88
----------
train Loss: 0.4941 Acc: 0.5455
val Loss: 0.4266 Acc: 0.6818
Epoch 9/88
----------
train Loss: 0.4780 Acc: 0.5646
val Loss: 0.4066 Acc: 0.7045
Epoch 10/88
----------
train Loss: 0.4247 Acc: 0.6459
val Loss: 0.3909 Acc: 0.7045
Epoch 11/88
----------
train Loss: 0.4443 Acc: 0.5933
val Loss: 0.3763 Acc: 0.7273
Epoch 12/88
----------
train Loss: 0.4474 Acc: 0.6077
val Loss: 0.3712 Acc: 0.7045
Epoch 13/88
----------
train Loss: 0.4095 Acc: 0.6794
val Loss: 0.3553 Acc: 0.7045
Epoch 14/88
----------
train Loss: 0.3842 Acc: 0.6938
val Loss: 0.3427 Acc: 0.7273
Epoch 15/88
----------
train Loss: 0.4011 Acc: 0.6842
val Loss: 0.3333 Acc: 0.7727
Epoch 16/88
----------
train Loss: 0.3924 Acc: 0.7321
val Loss: 0.3294 Acc: 0.7727
Epoch 17/88
----------
train Loss: 0.3799 Acc: 0.7321
val Loss: 0.3268 Acc: 0.7727
Epoch 18/88
----------
train Loss: 0.3600 Acc: 0.7512
val Loss: 0.3165 Acc: 0.7727
Epoch 19/88
----------
train Loss: 0.3384 Acc: 0.8038
val Loss: 0.3098 Acc: 0.7955
Epoch 20/88
----------
train Loss: 0.3565 Acc: 0.7703
val Loss: 0.2981 Acc: 0.7955
Epoch 21/88
----------
train Loss: 0.3589 Acc: 0.7799
val Loss: 0.2871 Acc: 0.7955
Epoch 22/88
----------
train Loss: 0.3409 Acc: 0.7943
val Loss: 0.2848 Acc: 0.7955
Epoch 23/88
----------
train Loss: 0.3444 Acc: 0.8134
val Loss: 0.2794 Acc: 0.8182
Epoch 24/88
----------
train Loss: 0.2926 Acc: 0.8660
val Loss: 0.2647 Acc: 0.8409
Epoch 25/88
----------
train Loss: 0.3196 Acc: 0.8804
val Loss: 0.2693 Acc: 0.7955
Epoch 26/88
----------
train Loss: 0.3295 Acc: 0.8612
val Loss: 0.2718 Acc: 0.8182
Epoch 27/88
----------
train Loss: 0.2728 Acc: 0.9522
val Loss: 0.2797 Acc: 0.8182
Epoch 28/88
----------
train Loss: 0.3311 Acc: 0.8373
val Loss: 0.2784 Acc: 0.7500
Epoch 29/88
----------
train Loss: 0.3553 Acc: 0.7416
val Loss: 0.2794 Acc: 0.7955
Epoch 30/88
----------
train Loss: 0.3071 Acc: 0.8325
val Loss: 0.2651 Acc: 0.8182
Epoch 31/88
----------
train Loss: 0.2633 Acc: 0.9139
val Loss: 0.2545 Acc: 0.8182
Epoch 32/88
----------
train Loss: 0.2935 Acc: 0.8278
val Loss: 0.2513 Acc: 0.7955
Epoch 33/88
----------
train Loss: 0.3111 Acc: 0.8278
val Loss: 0.2510 Acc: 0.7955
Epoch 34/88
----------
train Loss: 0.2901 Acc: 0.8804
val Loss: 0.2548 Acc: 0.7727
Epoch 35/88
----------
train Loss: 0.2346 Acc: 0.9713
val Loss: 0.2656 Acc: 0.7500
Epoch 36/88
----------
train Loss: 0.3403 Acc: 0.7895
val Loss: 0.2692 Acc: 0.7500
Epoch 37/88
----------
train Loss: 0.2793 Acc: 0.8325
val Loss: 0.2707 Acc: 0.7500
Epoch 38/88
----------
train Loss: 0.2809 Acc: 0.9378
val Loss: 0.2602 Acc: 0.7727
Epoch 39/88
----------
train Loss: 0.3111 Acc: 0.7751
val Loss: 0.2652 Acc: 0.7727
Epoch 40/88
----------
train Loss: 0.2521 Acc: 0.8900
val Loss: 0.2639 Acc: 0.7727
Epoch 41/88
----------
train Loss: 0.3410 Acc: 0.7368
val Loss: 0.2572 Acc: 0.7955
Epoch 42/88
----------
train Loss: 0.2510 Acc: 0.8612
val Loss: 0.2520 Acc: 0.7955
Epoch 43/88
----------
train Loss: 0.2765 Acc: 0.8373
val Loss: 0.2504 Acc: 0.7955
Epoch 44/88
----------
train Loss: 0.2641 Acc: 0.8708
val Loss: 0.2567 Acc: 0.8409
Epoch 45/88
----------
train Loss: 0.1639 Acc: 0.9713
val Loss: 0.2602 Acc: 0.8182
Epoch 46/88
----------
train Loss: 0.3592 Acc: 0.8086
val Loss: 0.2641 Acc: 0.7955
Epoch 47/88
----------
train Loss: 0.2514 Acc: 0.8947
val Loss: 0.2565 Acc: 0.7955
Epoch 48/88
----------
train Loss: 0.2893 Acc: 0.8517
val Loss: 0.2592 Acc: 0.7500
Epoch 49/88
----------
train Loss: 0.2720 Acc: 0.9474
val Loss: 0.2614 Acc: 0.7727
Epoch 50/88
----------
train Loss: 0.2668 Acc: 0.8900
val Loss: 0.2615 Acc: 0.7727
Epoch 51/88
----------
train Loss: 0.1967 Acc: 0.9856
val Loss: 0.2534 Acc: 0.7727
Epoch 52/88
----------
train Loss: 0.2826 Acc: 0.8230
val Loss: 0.2523 Acc: 0.7727
Epoch 53/88
----------
train Loss: 0.3188 Acc: 0.9043
val Loss: 0.2495 Acc: 0.7727
Epoch 54/88
----------
train Loss: 0.2328 Acc: 0.9330
val Loss: 0.2484 Acc: 0.7955
Epoch 55/88
----------
train Loss: 0.2482 Acc: 0.9330
val Loss: 0.2552 Acc: 0.7727
Epoch 56/88
----------
train Loss: 0.2909 Acc: 0.9091
val Loss: 0.2580 Acc: 0.7500
Epoch 57/88
----------
train Loss: 0.3323 Acc: 0.8230
val Loss: 0.2585 Acc: 0.7955
Epoch 58/88
----------
train Loss: 0.2701 Acc: 0.7990
val Loss: 0.2518 Acc: 0.8182
Epoch 59/88
----------
train Loss: 0.2786 Acc: 0.8995
val Loss: 0.2545 Acc: 0.7955
Epoch 60/88
----------
train Loss: 0.2300 Acc: 0.8900
val Loss: 0.2554 Acc: 0.7955
Epoch 61/88
----------
train Loss: 0.3215 Acc: 0.7799
val Loss: 0.2606 Acc: 0.7727
Epoch 62/88
----------
train Loss: 0.2909 Acc: 0.9569
val Loss: 0.2607 Acc: 0.7727
Epoch 63/88
----------
train Loss: 0.2490 Acc: 0.9378
val Loss: 0.2593 Acc: 0.7955
Epoch 64/88
----------
train Loss: 0.2334 Acc: 0.9474
val Loss: 0.2566 Acc: 0.7955
Epoch 65/88
----------
train Loss: 0.2673 Acc: 0.8278
val Loss: 0.2608 Acc: 0.7955
Epoch 66/88
----------
train Loss: 0.2613 Acc: 0.9043
val Loss: 0.2679 Acc: 0.7955
Epoch 67/88
----------
train Loss: 0.2942 Acc: 0.8708
val Loss: 0.2633 Acc: 0.7727
Epoch 68/88
----------
train Loss: 0.2479 Acc: 0.8947
val Loss: 0.2676 Acc: 0.7500
Epoch 69/88
----------
train Loss: 0.2430 Acc: 0.9091
val Loss: 0.2610 Acc: 0.7727
Epoch 70/88
----------
train Loss: 0.2758 Acc: 0.9139
val Loss: 0.2600 Acc: 0.7727
Epoch 71/88
----------
train Loss: 0.2905 Acc: 0.9187
val Loss: 0.2548 Acc: 0.7727
Epoch 72/88
----------
train Loss: 0.2883 Acc: 0.9091
val Loss: 0.2613 Acc: 0.7955
Epoch 73/88
----------
train Loss: 0.2096 Acc: 0.9665
val Loss: 0.2680 Acc: 0.7727
Epoch 74/88
----------
train Loss: 0.3050 Acc: 0.8756
val Loss: 0.2635 Acc: 0.7500
Epoch 75/88
----------
train Loss: 0.2268 Acc: 0.9713
val Loss: 0.2585 Acc: 0.7500
Epoch 76/88
----------
train Loss: 0.2412 Acc: 0.8469
val Loss: 0.2560 Acc: 0.7500
Epoch 77/88
----------
train Loss: 0.2809 Acc: 0.8660
val Loss: 0.2577 Acc: 0.7727
Epoch 78/88
----------
train Loss: 0.2450 Acc: 0.8947
val Loss: 0.2598 Acc: 0.7955
Epoch 79/88
----------
train Loss: 0.2934 Acc: 0.8708
val Loss: 0.2573 Acc: 0.7955
Epoch 80/88
----------
train Loss: 0.2638 Acc: 0.8565
val Loss: 0.2584 Acc: 0.8409
Epoch 81/88
----------
train Loss: 0.3028 Acc: 0.8230
val Loss: 0.2697 Acc: 0.7955
Epoch 82/88
----------
train Loss: 0.2621 Acc: 0.8756
val Loss: 0.2735 Acc: 0.8182
Epoch 83/88
----------
train Loss: 0.2295 Acc: 0.9761
val Loss: 0.2740 Acc: 0.7727
Epoch 84/88
----------
train Loss: 0.2971 Acc: 0.7751
val Loss: 0.2691 Acc: 0.7955
Epoch 85/88
----------
train Loss: 0.2349 Acc: 0.8325
val Loss: 0.2649 Acc: 0.7955
Epoch 86/88
----------
train Loss: 0.2483 Acc: 0.8852
val Loss: 0.2532 Acc: 0.8182
Epoch 87/88
----------
train Loss: 0.2821 Acc: 0.9330
val Loss: 0.2512 Acc: 0.7955
Epoch 88/88
----------
train Loss: 0.2985 Acc: 0.9043
[32m[I 2025-06-28 08:16:07,495][0m Trial 35 finished with value: 0.8181818181818182 and parameters: {'batch_size': 20, 'lr': 8.218903370379789e-05, 'num_epochs': 88, 'weight_decay': 0.0003911194439439742, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2511 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_20_lr_8.218903370379789e-05_epoch_88_wd_0.0003911194439439742_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/30
----------
train Loss: 0.7015 Acc: 0.2249
val Loss: 0.6878 Acc: 0.1591
Epoch 2/30
----------
train Loss: 0.6930 Acc: 0.2201
val Loss: 0.6839 Acc: 0.2273
Epoch 3/30
----------
train Loss: 0.6873 Acc: 0.2201
val Loss: 0.6752 Acc: 0.1818
Epoch 4/30
----------
train Loss: 0.6853 Acc: 0.2344
val Loss: 0.6711 Acc: 0.2045
Epoch 5/30
----------
train Loss: 0.6879 Acc: 0.2153
val Loss: 0.6711 Acc: 0.2273
Epoch 6/30
----------
train Loss: 0.6821 Acc: 0.2536
val Loss: 0.6684 Acc: 0.2273
Epoch 7/30
----------
train Loss: 0.6780 Acc: 0.2344
val Loss: 0.6658 Acc: 0.2045
Epoch 8/30
----------
train Loss: 0.6715 Acc: 0.2536
val Loss: 0.6642 Acc: 0.2273
Epoch 9/30
----------
train Loss: 0.6697 Acc: 0.3110
val Loss: 0.6613 Acc: 0.2500
Epoch 10/30
----------
train Loss: 0.6646 Acc: 0.2775
val Loss: 0.6582 Acc: 0.2045
Epoch 11/30
----------
train Loss: 0.6656 Acc: 0.2632
val Loss: 0.6560 Acc: 0.2727
Epoch 12/30
----------
train Loss: 0.6626 Acc: 0.3014
val Loss: 0.6549 Acc: 0.2727
Epoch 13/30
----------
train Loss: 0.6533 Acc: 0.3732
val Loss: 0.6500 Acc: 0.2955
Epoch 14/30
----------
train Loss: 0.6507 Acc: 0.3445
val Loss: 0.6479 Acc: 0.2955
Epoch 15/30
----------
train Loss: 0.6470 Acc: 0.4019
val Loss: 0.6476 Acc: 0.2955
Epoch 16/30
----------
train Loss: 0.6439 Acc: 0.3780
val Loss: 0.6410 Acc: 0.3409
Epoch 17/30
----------
train Loss: 0.6434 Acc: 0.3923
val Loss: 0.6393 Acc: 0.3409
Epoch 18/30
----------
train Loss: 0.6422 Acc: 0.4163
val Loss: 0.6344 Acc: 0.3636
Epoch 19/30
----------
train Loss: 0.6355 Acc: 0.4258
val Loss: 0.6310 Acc: 0.4545
Epoch 20/30
----------
train Loss: 0.6312 Acc: 0.4258
val Loss: 0.6296 Acc: 0.3636
Epoch 21/30
----------
train Loss: 0.6307 Acc: 0.4689
val Loss: 0.6294 Acc: 0.3864
Epoch 22/30
----------
train Loss: 0.6301 Acc: 0.4115
val Loss: 0.6274 Acc: 0.3636
Epoch 23/30
----------
train Loss: 0.6237 Acc: 0.4689
val Loss: 0.6231 Acc: 0.4773
Epoch 24/30
----------
train Loss: 0.6152 Acc: 0.5359
val Loss: 0.6150 Acc: 0.5227
Epoch 25/30
----------
train Loss: 0.6177 Acc: 0.4545
val Loss: 0.6171 Acc: 0.4318
Epoch 26/30
----------
train Loss: 0.6154 Acc: 0.4593
val Loss: 0.6162 Acc: 0.4545
Epoch 27/30
----------
train Loss: 0.6089 Acc: 0.5072
val Loss: 0.6084 Acc: 0.5000
Epoch 28/30
----------
train Loss: 0.6116 Acc: 0.4833
val Loss: 0.6064 Acc: 0.5455
Epoch 29/30
----------
train Loss: 0.6108 Acc: 0.4498
val Loss: 0.6041 Acc: 0.5455
Epoch 30/30
----------
train Loss: 0.6056 Acc: 0.4689
[32m[I 2025-06-28 08:22:58,472][0m Trial 36 finished with value: 0.5227272727272727 and parameters: {'batch_size': 35, 'lr': 7.486065255624699e-06, 'num_epochs': 30, 'weight_decay': 0.0002958780565962714, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.6027 Acc: 0.5227
Best val Acc: 0.522727

Model weights saved at ./model_weights/efficientnetb0_bs_35_lr_7.486065255624699e-06_epoch_30_wd_0.0002958780565962714_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/74
----------
train Loss: 0.6404 Acc: 0.3541
val Loss: 0.5633 Acc: 0.5909
Epoch 2/74
----------
train Loss: 0.5184 Acc: 0.5789
val Loss: 0.4033 Acc: 0.6364
Epoch 3/74
----------
train Loss: 0.4561 Acc: 0.5789
val Loss: 0.3565 Acc: 0.6818
Epoch 4/74
----------
train Loss: 0.4291 Acc: 0.5694
val Loss: 0.3258 Acc: 0.7500
Epoch 5/74
----------
train Loss: 0.4107 Acc: 0.7129
val Loss: 0.2984 Acc: 0.7273
Epoch 6/74
----------
train Loss: 0.3742 Acc: 0.6890
val Loss: 0.2730 Acc: 0.8182
Epoch 7/74
----------
train Loss: 0.3332 Acc: 0.8134
val Loss: 0.2527 Acc: 0.7955
Epoch 8/74
----------
train Loss: 0.3561 Acc: 0.7799
val Loss: 0.2303 Acc: 0.8182
Epoch 9/74
----------
train Loss: 0.3606 Acc: 0.7608
val Loss: 0.2704 Acc: 0.8182
Epoch 10/74
----------
train Loss: 0.2297 Acc: 0.9522
val Loss: 0.2497 Acc: 0.7727
Epoch 11/74
----------
train Loss: 0.3342 Acc: 0.7943
val Loss: 0.2324 Acc: 0.7727
Epoch 12/74
----------
train Loss: 0.2992 Acc: 0.7751
val Loss: 0.3184 Acc: 0.7045
Epoch 13/74
----------
train Loss: 0.2763 Acc: 0.9091
val Loss: 0.2764 Acc: 0.7500
Epoch 14/74
----------
train Loss: 0.2562 Acc: 0.8469
val Loss: 0.2723 Acc: 0.7500
Epoch 15/74
----------
train Loss: 0.2804 Acc: 0.8373
val Loss: 0.2607 Acc: 0.7500
Epoch 16/74
----------
train Loss: 0.2948 Acc: 0.7799
val Loss: 0.3029 Acc: 0.7955
Epoch 17/74
----------
train Loss: 0.2750 Acc: 0.8660
val Loss: 0.3208 Acc: 0.8182
Epoch 18/74
----------
train Loss: 0.2601 Acc: 0.8660
val Loss: 0.2842 Acc: 0.7727
Epoch 19/74
----------
train Loss: 0.2463 Acc: 0.9187
val Loss: 0.2620 Acc: 0.8182
Epoch 20/74
----------
train Loss: 0.2707 Acc: 0.9091
val Loss: 0.2480 Acc: 0.8636
Epoch 21/74
----------
train Loss: 0.2868 Acc: 0.8995
val Loss: 0.2446 Acc: 0.7727
Epoch 22/74
----------
train Loss: 0.2571 Acc: 0.8804
val Loss: 0.2271 Acc: 0.7727
Epoch 23/74
----------
train Loss: 0.2957 Acc: 0.8804
val Loss: 0.2126 Acc: 0.8409
Epoch 24/74
----------
train Loss: 0.2147 Acc: 0.9330
val Loss: 0.2160 Acc: 0.8636
Epoch 25/74
----------
train Loss: 0.2497 Acc: 0.9426
val Loss: 0.2416 Acc: 0.7955
Epoch 26/74
----------
train Loss: 0.2802 Acc: 0.9474
val Loss: 0.2521 Acc: 0.7955
Epoch 27/74
----------
train Loss: 0.2284 Acc: 0.9713
val Loss: 0.2713 Acc: 0.7955
Epoch 28/74
----------
train Loss: 0.2790 Acc: 0.8612
val Loss: 0.2609 Acc: 0.7955
Epoch 29/74
----------
train Loss: 0.2969 Acc: 0.7990
val Loss: 0.2281 Acc: 0.8182
Epoch 30/74
----------
train Loss: 0.2591 Acc: 0.8756
val Loss: 0.2108 Acc: 0.7955
Epoch 31/74
----------
train Loss: 0.2272 Acc: 0.9474
val Loss: 0.2259 Acc: 0.8182
Epoch 32/74
----------
train Loss: 0.2412 Acc: 0.9043
val Loss: 0.2312 Acc: 0.8182
Epoch 33/74
----------
train Loss: 0.2635 Acc: 0.9043
val Loss: 0.2129 Acc: 0.8409
Epoch 34/74
----------
train Loss: 0.2553 Acc: 0.9617
val Loss: 0.2263 Acc: 0.8409
Epoch 35/74
----------
train Loss: 0.1990 Acc: 0.9761
val Loss: 0.2490 Acc: 0.7500
Epoch 36/74
----------
train Loss: 0.3043 Acc: 0.8612
val Loss: 0.2360 Acc: 0.8182
Epoch 37/74
----------
train Loss: 0.2618 Acc: 0.8373
val Loss: 0.2444 Acc: 0.8636
Epoch 38/74
----------
train Loss: 0.2705 Acc: 0.9569
val Loss: 0.2388 Acc: 0.8409
Epoch 39/74
----------
train Loss: 0.2654 Acc: 0.8038
val Loss: 0.2548 Acc: 0.8182
Epoch 40/74
----------
train Loss: 0.2352 Acc: 0.9378
val Loss: 0.2537 Acc: 0.7955
Epoch 41/74
----------
train Loss: 0.3130 Acc: 0.7177
val Loss: 0.2284 Acc: 0.8182
Epoch 42/74
----------
train Loss: 0.2200 Acc: 0.9091
val Loss: 0.2333 Acc: 0.7045
Epoch 43/74
----------
train Loss: 0.2511 Acc: 0.9043
val Loss: 0.2286 Acc: 0.7727
Epoch 44/74
----------
train Loss: 0.2380 Acc: 0.8947
val Loss: 0.2390 Acc: 0.7955
Epoch 45/74
----------
train Loss: 0.1481 Acc: 0.9713
val Loss: 0.2324 Acc: 0.8182
Epoch 46/74
----------
train Loss: 0.3295 Acc: 0.8278
val Loss: 0.2459 Acc: 0.8182
Epoch 47/74
----------
train Loss: 0.2322 Acc: 0.9426
val Loss: 0.2624 Acc: 0.7955
Epoch 48/74
----------
train Loss: 0.2580 Acc: 0.8804
val Loss: 0.2841 Acc: 0.7045
Epoch 49/74
----------
train Loss: 0.2533 Acc: 0.9713
val Loss: 0.2706 Acc: 0.7727
Epoch 50/74
----------
train Loss: 0.2396 Acc: 0.8995
val Loss: 0.2552 Acc: 0.7727
Epoch 51/74
----------
train Loss: 0.1919 Acc: 0.9952
val Loss: 0.2476 Acc: 0.7500
Epoch 52/74
----------
train Loss: 0.2543 Acc: 0.9043
val Loss: 0.2405 Acc: 0.7500
Epoch 53/74
----------
train Loss: 0.2951 Acc: 0.9474
val Loss: 0.2477 Acc: 0.7273
Epoch 54/74
----------
train Loss: 0.2170 Acc: 0.9474
val Loss: 0.2589 Acc: 0.7500
Epoch 55/74
----------
train Loss: 0.2295 Acc: 0.9617
val Loss: 0.2884 Acc: 0.7045
Epoch 56/74
----------
train Loss: 0.2763 Acc: 0.9522
val Loss: 0.2598 Acc: 0.7500
Epoch 57/74
----------
train Loss: 0.2999 Acc: 0.8612
val Loss: 0.2724 Acc: 0.7273
Epoch 58/74
----------
train Loss: 0.2314 Acc: 0.8469
val Loss: 0.2656 Acc: 0.7045
Epoch 59/74
----------
train Loss: 0.2517 Acc: 0.9330
val Loss: 0.2864 Acc: 0.7045
Epoch 60/74
----------
train Loss: 0.2089 Acc: 0.9330
val Loss: 0.2812 Acc: 0.7273
Epoch 61/74
----------
train Loss: 0.2899 Acc: 0.8086
val Loss: 0.2689 Acc: 0.7273
Epoch 62/74
----------
train Loss: 0.2812 Acc: 0.9282
val Loss: 0.2658 Acc: 0.7727
Epoch 63/74
----------
train Loss: 0.2375 Acc: 0.9474
val Loss: 0.2809 Acc: 0.7273
Epoch 64/74
----------
train Loss: 0.2189 Acc: 0.9378
val Loss: 0.2751 Acc: 0.7727
Epoch 65/74
----------
train Loss: 0.2439 Acc: 0.8995
val Loss: 0.2723 Acc: 0.7500
Epoch 66/74
----------
train Loss: 0.2402 Acc: 0.9426
val Loss: 0.2901 Acc: 0.7500
Epoch 67/74
----------
train Loss: 0.2735 Acc: 0.8947
val Loss: 0.2729 Acc: 0.7955
Epoch 68/74
----------
train Loss: 0.2383 Acc: 0.9139
val Loss: 0.2817 Acc: 0.7727
Epoch 69/74
----------
train Loss: 0.2214 Acc: 0.9187
val Loss: 0.2775 Acc: 0.7955
Epoch 70/74
----------
train Loss: 0.2629 Acc: 0.9139
val Loss: 0.2896 Acc: 0.7273
Epoch 71/74
----------
train Loss: 0.2659 Acc: 0.9426
val Loss: 0.2679 Acc: 0.7500
Epoch 72/74
----------
train Loss: 0.2657 Acc: 0.8756
val Loss: 0.2778 Acc: 0.7273
Epoch 73/74
----------
train Loss: 0.1982 Acc: 0.9713
val Loss: 0.2907 Acc: 0.7500
Epoch 74/74
----------
train Loss: 0.2771 Acc: 0.9187
[32m[I 2025-06-28 08:39:52,559][0m Trial 37 finished with value: 0.7272727272727273 and parameters: {'batch_size': 8, 'lr': 0.0003735942959216403, 'num_epochs': 74, 'weight_decay': 0.00011074000781188425, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2950 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_8_lr_0.0003735942959216403_epoch_74_wd_0.00011074000781188425_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 3.6985 Acc: 0.2632
val Loss: 3.4934 Acc: 0.3182
Epoch 2/95
----------
train Loss: 3.3736 Acc: 0.4163
val Loss: 3.2817 Acc: 0.5000
Epoch 3/95
----------
train Loss: 3.1135 Acc: 0.4498
val Loss: 3.0142 Acc: 0.5455
Epoch 4/95
----------
train Loss: 2.9343 Acc: 0.4880
val Loss: 2.8624 Acc: 0.6364
Epoch 5/95
----------
train Loss: 2.7998 Acc: 0.4785
val Loss: 2.7603 Acc: 0.6136
Epoch 6/95
----------
train Loss: 2.6701 Acc: 0.5072
val Loss: 2.6101 Acc: 0.6364
Epoch 7/95
----------
train Loss: 2.5548 Acc: 0.5024
val Loss: 2.4757 Acc: 0.6364
Epoch 8/95
----------
train Loss: 2.5158 Acc: 0.5024
val Loss: 2.3509 Acc: 0.6364
Epoch 9/95
----------
train Loss: 2.4623 Acc: 0.5024
val Loss: 2.2672 Acc: 0.6364
Epoch 10/95
----------
train Loss: 2.2832 Acc: 0.5072
val Loss: 2.2012 Acc: 0.6364
Epoch 11/95
----------
train Loss: 2.3402 Acc: 0.5024
val Loss: 2.1429 Acc: 0.6364
Epoch 12/95
----------
train Loss: 2.3516 Acc: 0.5072
val Loss: 2.1665 Acc: 0.6364
Epoch 13/95
----------
train Loss: 2.2202 Acc: 0.5215
val Loss: 2.0941 Acc: 0.6364
Epoch 14/95
----------
train Loss: 2.1365 Acc: 0.5120
val Loss: 2.0600 Acc: 0.6591
Epoch 15/95
----------
train Loss: 2.2239 Acc: 0.5072
val Loss: 2.0177 Acc: 0.6591
Epoch 16/95
----------
train Loss: 2.1934 Acc: 0.5215
val Loss: 2.0088 Acc: 0.6591
Epoch 17/95
----------
train Loss: 2.1434 Acc: 0.5072
val Loss: 1.9681 Acc: 0.6591
Epoch 18/95
----------
train Loss: 2.0721 Acc: 0.5837
val Loss: 1.9460 Acc: 0.6591
Epoch 19/95
----------
train Loss: 2.0126 Acc: 0.5789
val Loss: 1.9723 Acc: 0.6364
Epoch 20/95
----------
train Loss: 2.0302 Acc: 0.5598
val Loss: 1.9564 Acc: 0.7273
Epoch 21/95
----------
train Loss: 2.0668 Acc: 0.6029
val Loss: 1.8963 Acc: 0.7273
Epoch 22/95
----------
train Loss: 2.0351 Acc: 0.6268
val Loss: 1.8207 Acc: 0.7273
Epoch 23/95
----------
train Loss: 1.9629 Acc: 0.6316
val Loss: 1.7712 Acc: 0.7045
Epoch 24/95
----------
train Loss: 1.8072 Acc: 0.6699
val Loss: 1.7007 Acc: 0.7500
Epoch 25/95
----------
train Loss: 1.8914 Acc: 0.6794
val Loss: 1.7723 Acc: 0.7500
Epoch 26/95
----------
train Loss: 1.9761 Acc: 0.6890
val Loss: 1.7635 Acc: 0.7727
Epoch 27/95
----------
train Loss: 1.7141 Acc: 0.8134
val Loss: 1.7375 Acc: 0.7500
Epoch 28/95
----------
train Loss: 1.9143 Acc: 0.6746
val Loss: 1.7040 Acc: 0.7500
Epoch 29/95
----------
train Loss: 1.9432 Acc: 0.6507
val Loss: 1.7229 Acc: 0.7727
Epoch 30/95
----------
train Loss: 1.7931 Acc: 0.7225
val Loss: 1.6829 Acc: 0.7273
Epoch 31/95
----------
train Loss: 1.6070 Acc: 0.8134
val Loss: 1.5857 Acc: 0.7273
Epoch 32/95
----------
train Loss: 1.7001 Acc: 0.7512
val Loss: 1.5349 Acc: 0.7500
Epoch 33/95
----------
train Loss: 1.7538 Acc: 0.7895
val Loss: 1.5578 Acc: 0.7273
Epoch 34/95
----------
train Loss: 1.6588 Acc: 0.8278
val Loss: 1.5263 Acc: 0.7273
Epoch 35/95
----------
train Loss: 1.3898 Acc: 0.8852
val Loss: 1.5586 Acc: 0.7500
Epoch 36/95
----------
train Loss: 1.8093 Acc: 0.7225
val Loss: 1.5591 Acc: 0.7727
Epoch 37/95
----------
train Loss: 1.5413 Acc: 0.7703
val Loss: 1.6371 Acc: 0.7727
Epoch 38/95
----------
train Loss: 1.5688 Acc: 0.8947
val Loss: 1.5612 Acc: 0.7727
Epoch 39/95
----------
train Loss: 1.6717 Acc: 0.7225
val Loss: 1.6268 Acc: 0.7500
Epoch 40/95
----------
train Loss: 1.4186 Acc: 0.8421
val Loss: 1.5645 Acc: 0.7500
Epoch 41/95
----------
train Loss: 1.8334 Acc: 0.7081
val Loss: 1.5553 Acc: 0.7500
Epoch 42/95
----------
train Loss: 1.4548 Acc: 0.8325
val Loss: 1.6526 Acc: 0.7727
Epoch 43/95
----------
train Loss: 1.5213 Acc: 0.7990
val Loss: 1.6433 Acc: 0.7500
Epoch 44/95
----------
train Loss: 1.3764 Acc: 0.8660
val Loss: 1.5832 Acc: 0.7727
Epoch 45/95
----------
train Loss: 0.9685 Acc: 0.9617
val Loss: 1.4618 Acc: 0.7955
Epoch 46/95
----------
train Loss: 1.7513 Acc: 0.8134
val Loss: 1.5574 Acc: 0.7955
Epoch 47/95
----------
train Loss: 1.4000 Acc: 0.8612
val Loss: 1.6026 Acc: 0.7727
Epoch 48/95
----------
train Loss: 1.4997 Acc: 0.8038
val Loss: 1.5141 Acc: 0.7955
Epoch 49/95
----------
train Loss: 1.4053 Acc: 0.8995
val Loss: 1.5088 Acc: 0.7727
Epoch 50/95
----------
train Loss: 1.4126 Acc: 0.8325
val Loss: 1.5490 Acc: 0.7955
Epoch 51/95
----------
train Loss: 1.0859 Acc: 0.9665
val Loss: 1.4141 Acc: 0.7727
Epoch 52/95
----------
train Loss: 1.4928 Acc: 0.7847
val Loss: 1.4544 Acc: 0.7727
Epoch 53/95
----------
train Loss: 1.6441 Acc: 0.8565
val Loss: 1.5418 Acc: 0.7500
Epoch 54/95
----------
train Loss: 1.2894 Acc: 0.9091
val Loss: 1.5178 Acc: 0.7273
Epoch 55/95
----------
train Loss: 1.3080 Acc: 0.9378
val Loss: 1.4837 Acc: 0.7273
Epoch 56/95
----------
train Loss: 1.5224 Acc: 0.8708
val Loss: 1.3788 Acc: 0.7500
Epoch 57/95
----------
train Loss: 1.7454 Acc: 0.7512
val Loss: 1.4757 Acc: 0.7727
Epoch 58/95
----------
train Loss: 1.4674 Acc: 0.8134
val Loss: 1.4452 Acc: 0.7955
Epoch 59/95
----------
train Loss: 1.4626 Acc: 0.8565
val Loss: 1.4776 Acc: 0.7955
Epoch 60/95
----------
train Loss: 1.2498 Acc: 0.8565
val Loss: 1.4508 Acc: 0.7955
Epoch 61/95
----------
train Loss: 1.6710 Acc: 0.7177
val Loss: 1.4220 Acc: 0.7955
Epoch 62/95
----------
train Loss: 1.4940 Acc: 0.9139
val Loss: 1.3700 Acc: 0.7955
Epoch 63/95
----------
train Loss: 1.3018 Acc: 0.9187
val Loss: 1.4093 Acc: 0.7955
Epoch 64/95
----------
train Loss: 1.2218 Acc: 0.9522
val Loss: 1.4009 Acc: 0.7727
Epoch 65/95
----------
train Loss: 1.3968 Acc: 0.8325
val Loss: 1.4499 Acc: 0.7955
Epoch 66/95
----------
train Loss: 1.3455 Acc: 0.8900
val Loss: 1.5056 Acc: 0.7727
Epoch 67/95
----------
train Loss: 1.5731 Acc: 0.8708
val Loss: 1.6128 Acc: 0.7727
Epoch 68/95
----------
train Loss: 1.2806 Acc: 0.8995
val Loss: 1.4866 Acc: 0.7500
Epoch 69/95
----------
train Loss: 1.2662 Acc: 0.8708
val Loss: 1.3187 Acc: 0.7955
Epoch 70/95
----------
train Loss: 1.4290 Acc: 0.8995
val Loss: 1.3257 Acc: 0.8182
Epoch 71/95
----------
train Loss: 1.5529 Acc: 0.8995
val Loss: 1.3577 Acc: 0.8182
Epoch 72/95
----------
train Loss: 1.5165 Acc: 0.8517
val Loss: 1.4473 Acc: 0.8182
Epoch 73/95
----------
train Loss: 1.1231 Acc: 0.9474
val Loss: 1.2586 Acc: 0.8182
Epoch 74/95
----------
train Loss: 1.5888 Acc: 0.8086
val Loss: 1.2195 Acc: 0.8182
Epoch 75/95
----------
train Loss: 1.2082 Acc: 0.9378
val Loss: 1.3368 Acc: 0.7500
Epoch 76/95
----------
train Loss: 1.2787 Acc: 0.8134
val Loss: 1.4146 Acc: 0.7955
Epoch 77/95
----------
train Loss: 1.4775 Acc: 0.8230
val Loss: 1.4863 Acc: 0.7727
Epoch 78/95
----------
train Loss: 1.3068 Acc: 0.8852
val Loss: 1.4990 Acc: 0.7500
Epoch 79/95
----------
train Loss: 1.5113 Acc: 0.7990
val Loss: 1.3259 Acc: 0.7727
Epoch 80/95
----------
train Loss: 1.4116 Acc: 0.8373
val Loss: 1.3618 Acc: 0.7727
Epoch 81/95
----------
train Loss: 1.6091 Acc: 0.7990
val Loss: 1.4570 Acc: 0.7727
Epoch 82/95
----------
train Loss: 1.3318 Acc: 0.8469
val Loss: 1.4918 Acc: 0.7727
Epoch 83/95
----------
train Loss: 1.2350 Acc: 0.9665
val Loss: 1.3858 Acc: 0.7955
Epoch 84/95
----------
train Loss: 1.6253 Acc: 0.7321
val Loss: 1.2992 Acc: 0.8409
Epoch 85/95
----------
train Loss: 1.2476 Acc: 0.8421
val Loss: 1.4036 Acc: 0.7955
Epoch 86/95
----------
train Loss: 1.2760 Acc: 0.8612
val Loss: 1.3772 Acc: 0.7955
Epoch 87/95
----------
train Loss: 1.4049 Acc: 0.8947
val Loss: 1.4362 Acc: 0.8182
Epoch 88/95
----------
train Loss: 1.5598 Acc: 0.8900
val Loss: 1.3078 Acc: 0.8409
Epoch 89/95
----------
train Loss: 1.7700 Acc: 0.8230
val Loss: 1.3889 Acc: 0.8409
Epoch 90/95
----------
train Loss: 1.4265 Acc: 0.8612
val Loss: 1.5498 Acc: 0.7727
Epoch 91/95
----------
train Loss: 1.2567 Acc: 0.9282
val Loss: 1.3973 Acc: 0.8182
Epoch 92/95
----------
train Loss: 1.2895 Acc: 0.9234
val Loss: 1.3264 Acc: 0.8182
Epoch 93/95
----------
train Loss: 1.4444 Acc: 0.8325
val Loss: 1.2683 Acc: 0.8182
Epoch 94/95
----------
train Loss: 1.1324 Acc: 0.9617
val Loss: 1.3257 Acc: 0.7500
Epoch 95/95
----------
train Loss: 1.3195 Acc: 0.9139
[32m[I 2025-06-28 09:01:28,635][0m Trial 38 finished with value: 0.8181818181818182 and parameters: {'batch_size': 85, 'lr': 0.0001563590407738466, 'num_epochs': 95, 'weight_decay': 0.11469273402529295, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.3466 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_85_lr_0.0001563590407738466_epoch_95_wd_0.11469273402529295_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 3.7672 Acc: 0.2249
val Loss: 3.5993 Acc: 0.2727
Epoch 2/95
----------
train Loss: 3.5745 Acc: 0.3254
val Loss: 3.4559 Acc: 0.2955
Epoch 3/95
----------
train Loss: 3.3994 Acc: 0.3589
val Loss: 3.2497 Acc: 0.4318
Epoch 4/95
----------
train Loss: 3.2745 Acc: 0.3971
val Loss: 3.1109 Acc: 0.5227
Epoch 5/95
----------
train Loss: 3.1599 Acc: 0.4402
val Loss: 2.9962 Acc: 0.5682
Epoch 6/95
----------
train Loss: 3.0127 Acc: 0.4928
val Loss: 2.8471 Acc: 0.6136
Epoch 7/95
----------
train Loss: 2.8755 Acc: 0.5215
val Loss: 2.6854 Acc: 0.6136
Epoch 8/95
----------
train Loss: 2.7915 Acc: 0.5167
val Loss: 2.5533 Acc: 0.6364
Epoch 9/95
----------
train Loss: 2.6957 Acc: 0.5120
val Loss: 2.4210 Acc: 0.6364
Epoch 10/95
----------
train Loss: 2.4905 Acc: 0.5167
val Loss: 2.3124 Acc: 0.6364
Epoch 11/95
----------
train Loss: 2.5172 Acc: 0.5072
val Loss: 2.2427 Acc: 0.6591
Epoch 12/95
----------
train Loss: 2.4972 Acc: 0.5167
val Loss: 2.2020 Acc: 0.6818
Epoch 13/95
----------
train Loss: 2.3331 Acc: 0.5359
val Loss: 2.1090 Acc: 0.6591
Epoch 14/95
----------
train Loss: 2.2464 Acc: 0.5263
val Loss: 2.0735 Acc: 0.6818
Epoch 15/95
----------
train Loss: 2.2975 Acc: 0.5359
val Loss: 2.0348 Acc: 0.6818
Epoch 16/95
----------
train Loss: 2.2511 Acc: 0.5455
val Loss: 1.9879 Acc: 0.6818
Epoch 17/95
----------
train Loss: 2.1855 Acc: 0.5598
val Loss: 1.9424 Acc: 0.6818
Epoch 18/95
----------
train Loss: 2.1145 Acc: 0.5694
val Loss: 1.8929 Acc: 0.6818
Epoch 19/95
----------
train Loss: 2.0629 Acc: 0.6029
val Loss: 1.8713 Acc: 0.6818
Epoch 20/95
----------
train Loss: 2.0708 Acc: 0.5694
val Loss: 1.8273 Acc: 0.6818
Epoch 21/95
----------
train Loss: 2.0891 Acc: 0.5789
val Loss: 1.7986 Acc: 0.6818
Epoch 22/95
----------
train Loss: 2.0516 Acc: 0.6077
val Loss: 1.7658 Acc: 0.6818
Epoch 23/95
----------
train Loss: 2.0069 Acc: 0.6220
val Loss: 1.7224 Acc: 0.7045
Epoch 24/95
----------
train Loss: 1.8286 Acc: 0.6699
val Loss: 1.6649 Acc: 0.7273
Epoch 25/95
----------
train Loss: 1.9470 Acc: 0.6411
val Loss: 1.6707 Acc: 0.7273
Epoch 26/95
----------
train Loss: 1.9667 Acc: 0.6555
val Loss: 1.6812 Acc: 0.7500
Epoch 27/95
----------
train Loss: 1.7568 Acc: 0.7368
val Loss: 1.6635 Acc: 0.7727
Epoch 28/95
----------
train Loss: 1.9380 Acc: 0.6459
val Loss: 1.6419 Acc: 0.7727
Epoch 29/95
----------
train Loss: 1.9864 Acc: 0.6316
val Loss: 1.6235 Acc: 0.8182
Epoch 30/95
----------
train Loss: 1.8535 Acc: 0.6699
val Loss: 1.6239 Acc: 0.7955
Epoch 31/95
----------
train Loss: 1.6809 Acc: 0.7943
val Loss: 1.5852 Acc: 0.7955
Epoch 32/95
----------
train Loss: 1.8025 Acc: 0.6890
val Loss: 1.5451 Acc: 0.7955
Epoch 33/95
----------
train Loss: 1.8243 Acc: 0.7416
val Loss: 1.5377 Acc: 0.7955
Epoch 34/95
----------
train Loss: 1.7362 Acc: 0.7847
val Loss: 1.5203 Acc: 0.7955
Epoch 35/95
----------
train Loss: 1.4929 Acc: 0.8612
val Loss: 1.4991 Acc: 0.7955
Epoch 36/95
----------
train Loss: 1.8912 Acc: 0.7273
val Loss: 1.4757 Acc: 0.7500
Epoch 37/95
----------
train Loss: 1.6100 Acc: 0.7751
val Loss: 1.4838 Acc: 0.7727
Epoch 38/95
----------
train Loss: 1.6305 Acc: 0.8804
val Loss: 1.4614 Acc: 0.7955
Epoch 39/95
----------
train Loss: 1.7552 Acc: 0.6986
val Loss: 1.5154 Acc: 0.8182
Epoch 40/95
----------
train Loss: 1.4760 Acc: 0.8086
val Loss: 1.5226 Acc: 0.8182
Epoch 41/95
----------
train Loss: 1.8588 Acc: 0.7129
val Loss: 1.4865 Acc: 0.8182
Epoch 42/95
----------
train Loss: 1.5034 Acc: 0.8086
val Loss: 1.4501 Acc: 0.8182
Epoch 43/95
----------
train Loss: 1.6055 Acc: 0.7990
val Loss: 1.4354 Acc: 0.7955
Epoch 44/95
----------
train Loss: 1.4421 Acc: 0.8373
val Loss: 1.4036 Acc: 0.8409
Epoch 45/95
----------
train Loss: 1.0222 Acc: 0.9617
val Loss: 1.3735 Acc: 0.8409
Epoch 46/95
----------
train Loss: 1.7945 Acc: 0.7847
val Loss: 1.3918 Acc: 0.8409
Epoch 47/95
----------
train Loss: 1.4279 Acc: 0.8565
val Loss: 1.3791 Acc: 0.8182
Epoch 48/95
----------
train Loss: 1.4988 Acc: 0.8230
val Loss: 1.3689 Acc: 0.8409
Epoch 49/95
----------
train Loss: 1.4508 Acc: 0.8852
val Loss: 1.3667 Acc: 0.7955
Epoch 50/95
----------
train Loss: 1.4289 Acc: 0.8469
val Loss: 1.4013 Acc: 0.7955
Epoch 51/95
----------
train Loss: 1.0939 Acc: 0.9713
val Loss: 1.3560 Acc: 0.7955
Epoch 52/95
----------
train Loss: 1.4921 Acc: 0.7943
val Loss: 1.3503 Acc: 0.7955
Epoch 53/95
----------
train Loss: 1.6522 Acc: 0.8804
val Loss: 1.3438 Acc: 0.8182
Epoch 54/95
----------
train Loss: 1.2732 Acc: 0.9091
val Loss: 1.3252 Acc: 0.8182
Epoch 55/95
----------
train Loss: 1.3238 Acc: 0.9234
val Loss: 1.3073 Acc: 0.8636
Epoch 56/95
----------
train Loss: 1.4940 Acc: 0.8612
val Loss: 1.3187 Acc: 0.8182
Epoch 57/95
----------
train Loss: 1.6923 Acc: 0.7751
val Loss: 1.2945 Acc: 0.8182
Epoch 58/95
----------
train Loss: 1.4235 Acc: 0.8086
val Loss: 1.2955 Acc: 0.8409
Epoch 59/95
----------
train Loss: 1.4600 Acc: 0.8517
val Loss: 1.3040 Acc: 0.8182
Epoch 60/95
----------
train Loss: 1.2066 Acc: 0.8565
val Loss: 1.3196 Acc: 0.7955
Epoch 61/95
----------
train Loss: 1.6523 Acc: 0.7416
val Loss: 1.3254 Acc: 0.7727
Epoch 62/95
----------
train Loss: 1.4641 Acc: 0.9234
val Loss: 1.3132 Acc: 0.8409
Epoch 63/95
----------
train Loss: 1.2899 Acc: 0.9139
val Loss: 1.3141 Acc: 0.8182
Epoch 64/95
----------
train Loss: 1.2037 Acc: 0.9378
val Loss: 1.3032 Acc: 0.8182
Epoch 65/95
----------
train Loss: 1.3917 Acc: 0.8086
val Loss: 1.3234 Acc: 0.8182
Epoch 66/95
----------
train Loss: 1.3271 Acc: 0.8756
val Loss: 1.3130 Acc: 0.8182
Epoch 67/95
----------
train Loss: 1.5181 Acc: 0.8708
val Loss: 1.2975 Acc: 0.8409
Epoch 68/95
----------
train Loss: 1.2340 Acc: 0.8995
val Loss: 1.3036 Acc: 0.8636
Epoch 69/95
----------
train Loss: 1.2441 Acc: 0.8852
val Loss: 1.2940 Acc: 0.8409
Epoch 70/95
----------
train Loss: 1.4083 Acc: 0.8708
val Loss: 1.2867 Acc: 0.8182
Epoch 71/95
----------
train Loss: 1.4952 Acc: 0.8947
val Loss: 1.2970 Acc: 0.8182
Epoch 72/95
----------
train Loss: 1.5025 Acc: 0.8756
val Loss: 1.3483 Acc: 0.8182
Epoch 73/95
----------
train Loss: 1.0649 Acc: 0.9569
val Loss: 1.3338 Acc: 0.8182
Epoch 74/95
----------
train Loss: 1.5404 Acc: 0.8278
val Loss: 1.2887 Acc: 0.7955
Epoch 75/95
----------
train Loss: 1.1617 Acc: 0.9234
val Loss: 1.2752 Acc: 0.8182
Epoch 76/95
----------
train Loss: 1.2741 Acc: 0.7943
val Loss: 1.2812 Acc: 0.8182
Epoch 77/95
----------
train Loss: 1.4178 Acc: 0.8182
val Loss: 1.2915 Acc: 0.8182
Epoch 78/95
----------
train Loss: 1.2628 Acc: 0.8660
val Loss: 1.3046 Acc: 0.8409
Epoch 79/95
----------
train Loss: 1.5110 Acc: 0.8373
val Loss: 1.3083 Acc: 0.8636
Epoch 80/95
----------
train Loss: 1.3526 Acc: 0.8421
val Loss: 1.3079 Acc: 0.8636
Epoch 81/95
----------
train Loss: 1.5480 Acc: 0.7895
val Loss: 1.3420 Acc: 0.8182
Epoch 82/95
----------
train Loss: 1.2971 Acc: 0.8278
val Loss: 1.3426 Acc: 0.8409
Epoch 83/95
----------
train Loss: 1.1594 Acc: 0.9617
val Loss: 1.3181 Acc: 0.7955
Epoch 84/95
----------
train Loss: 1.5270 Acc: 0.7656
val Loss: 1.3215 Acc: 0.8409
Epoch 85/95
----------
train Loss: 1.2128 Acc: 0.8182
val Loss: 1.3350 Acc: 0.8182
Epoch 86/95
----------
train Loss: 1.2451 Acc: 0.8756
val Loss: 1.2996 Acc: 0.8409
Epoch 87/95
----------
train Loss: 1.3942 Acc: 0.9187
val Loss: 1.2626 Acc: 0.8409
Epoch 88/95
----------
train Loss: 1.4871 Acc: 0.9187
val Loss: 1.2615 Acc: 0.8409
Epoch 89/95
----------
train Loss: 1.6438 Acc: 0.7847
val Loss: 1.2796 Acc: 0.8409
Epoch 90/95
----------
train Loss: 1.3690 Acc: 0.8612
val Loss: 1.2745 Acc: 0.8636
Epoch 91/95
----------
train Loss: 1.1750 Acc: 0.9330
val Loss: 1.2806 Acc: 0.8182
Epoch 92/95
----------
train Loss: 1.2848 Acc: 0.9330
val Loss: 1.2762 Acc: 0.8182
Epoch 93/95
----------
train Loss: 1.3744 Acc: 0.8469
val Loss: 1.2347 Acc: 0.8182
Epoch 94/95
----------
train Loss: 1.0705 Acc: 0.9761
val Loss: 1.2398 Acc: 0.8182
Epoch 95/95
----------
train Loss: 1.2601 Acc: 0.9187
[32m[I 2025-06-28 09:23:06,076][0m Trial 39 finished with value: 0.8636363636363636 and parameters: {'batch_size': 23, 'lr': 6.058481214574367e-05, 'num_epochs': 95, 'weight_decay': 0.013286458480009485, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.2418 Acc: 0.8636
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_23_lr_6.058481214574367e-05_epoch_95_wd_0.013286458480009485_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/49
----------
train Loss: 0.6933 Acc: 0.2392
val Loss: 0.6718 Acc: 0.2727
Epoch 2/49
----------
train Loss: 0.6656 Acc: 0.3062
val Loss: 0.6519 Acc: 0.2955
Epoch 3/49
----------
train Loss: 0.6433 Acc: 0.3254
val Loss: 0.6257 Acc: 0.4091
Epoch 4/49
----------
train Loss: 0.6267 Acc: 0.3732
val Loss: 0.6106 Acc: 0.4318
Epoch 5/49
----------
train Loss: 0.6160 Acc: 0.4019
val Loss: 0.6017 Acc: 0.4773
Epoch 6/49
----------
train Loss: 0.5980 Acc: 0.4593
val Loss: 0.5886 Acc: 0.5000
Epoch 7/49
----------
train Loss: 0.5824 Acc: 0.4928
val Loss: 0.5745 Acc: 0.5682
Epoch 8/49
----------
train Loss: 0.5707 Acc: 0.5024
val Loss: 0.5615 Acc: 0.5909
Epoch 9/49
----------
train Loss: 0.5588 Acc: 0.5120
val Loss: 0.5484 Acc: 0.6136
Epoch 10/49
----------
train Loss: 0.5421 Acc: 0.4928
val Loss: 0.5309 Acc: 0.6136
Epoch 11/49
----------
train Loss: 0.5398 Acc: 0.4976
val Loss: 0.5210 Acc: 0.6136
Epoch 12/49
----------
train Loss: 0.5347 Acc: 0.5024
val Loss: 0.5154 Acc: 0.6364
Epoch 13/49
----------
train Loss: 0.5156 Acc: 0.5167
val Loss: 0.5007 Acc: 0.6364
Epoch 14/49
----------
train Loss: 0.5036 Acc: 0.5167
val Loss: 0.4923 Acc: 0.6364
Epoch 15/49
----------
train Loss: 0.5056 Acc: 0.4833
val Loss: 0.4828 Acc: 0.6364
Epoch 16/49
----------
train Loss: 0.4975 Acc: 0.5024
val Loss: 0.4735 Acc: 0.6364
Epoch 17/49
----------
train Loss: 0.4918 Acc: 0.4976
val Loss: 0.4655 Acc: 0.6364
Epoch 18/49
----------
train Loss: 0.4827 Acc: 0.5120
val Loss: 0.4531 Acc: 0.6364
Epoch 19/49
----------
train Loss: 0.4718 Acc: 0.5167
val Loss: 0.4458 Acc: 0.6591
Epoch 20/49
----------
train Loss: 0.4711 Acc: 0.5215
val Loss: 0.4409 Acc: 0.6591
Epoch 21/49
----------
train Loss: 0.4725 Acc: 0.5167
val Loss: 0.4373 Acc: 0.6591
Epoch 22/49
----------
train Loss: 0.4654 Acc: 0.5359
val Loss: 0.4310 Acc: 0.6591
Epoch 23/49
----------
train Loss: 0.4552 Acc: 0.5311
val Loss: 0.4238 Acc: 0.6591
Epoch 24/49
----------
train Loss: 0.4388 Acc: 0.5407
val Loss: 0.4087 Acc: 0.6591
Epoch 25/49
----------
train Loss: 0.4531 Acc: 0.5263
val Loss: 0.4103 Acc: 0.6591
Epoch 26/49
----------
train Loss: 0.4535 Acc: 0.5359
val Loss: 0.4068 Acc: 0.7045
Epoch 27/49
----------
train Loss: 0.4240 Acc: 0.6077
val Loss: 0.4026 Acc: 0.6818
Epoch 28/49
----------
train Loss: 0.4446 Acc: 0.5502
val Loss: 0.3978 Acc: 0.7045
Epoch 29/49
----------
train Loss: 0.4551 Acc: 0.5598
val Loss: 0.3960 Acc: 0.7045
Epoch 30/49
----------
train Loss: 0.4419 Acc: 0.5598
val Loss: 0.3903 Acc: 0.7045
Epoch 31/49
----------
train Loss: 0.4145 Acc: 0.6077
val Loss: 0.3797 Acc: 0.7045
Epoch 32/49
----------
train Loss: 0.4189 Acc: 0.6029
val Loss: 0.3725 Acc: 0.7045
Epoch 33/49
----------
train Loss: 0.4329 Acc: 0.6029
val Loss: 0.3720 Acc: 0.7045
Epoch 34/49
----------
train Loss: 0.4191 Acc: 0.5981
val Loss: 0.3670 Acc: 0.7045
Epoch 35/49
----------
train Loss: 0.3925 Acc: 0.6220
val Loss: 0.3620 Acc: 0.7273
Epoch 36/49
----------
train Loss: 0.4371 Acc: 0.5789
val Loss: 0.3572 Acc: 0.7273
Epoch 37/49
----------
train Loss: 0.4058 Acc: 0.6507
val Loss: 0.3599 Acc: 0.7273
Epoch 38/49
----------
train Loss: 0.4046 Acc: 0.6746
val Loss: 0.3580 Acc: 0.7500
Epoch 39/49
----------
train Loss: 0.4130 Acc: 0.6268
val Loss: 0.3659 Acc: 0.7500
Epoch 40/49
----------
train Loss: 0.3854 Acc: 0.6651
val Loss: 0.3620 Acc: 0.7500
Epoch 41/49
----------
train Loss: 0.4230 Acc: 0.6220
val Loss: 0.3544 Acc: 0.7500
Epoch 42/49
----------
train Loss: 0.3840 Acc: 0.6890
val Loss: 0.3509 Acc: 0.7500
Epoch 43/49
----------
train Loss: 0.3964 Acc: 0.6507
val Loss: 0.3482 Acc: 0.7500
Epoch 44/49
----------
train Loss: 0.3761 Acc: 0.7512
val Loss: 0.3473 Acc: 0.7727
Epoch 45/49
----------
train Loss: 0.3104 Acc: 0.8469
val Loss: 0.3367 Acc: 0.7273
Epoch 46/49
----------
train Loss: 0.4166 Acc: 0.7273
val Loss: 0.3332 Acc: 0.7273
Epoch 47/49
----------
train Loss: 0.3597 Acc: 0.7416
val Loss: 0.3307 Acc: 0.7273
Epoch 48/49
----------
train Loss: 0.3730 Acc: 0.7225
val Loss: 0.3232 Acc: 0.7273
Epoch 49/49
----------
train Loss: 0.3693 Acc: 0.7464
[32m[I 2025-06-28 09:34:09,848][0m Trial 40 finished with value: 0.7272727272727273 and parameters: {'batch_size': 21, 'lr': 7.019792590135443e-05, 'num_epochs': 49, 'weight_decay': 0.015076161188595064, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3210 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_21_lr_7.019792590135443e-05_epoch_49_wd_0.015076161188595064_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/100
----------
train Loss: 0.6974 Acc: 0.2201
val Loss: 0.6807 Acc: 0.2500
Epoch 2/100
----------
train Loss: 0.6783 Acc: 0.2632
val Loss: 0.6673 Acc: 0.2500
Epoch 3/100
----------
train Loss: 0.6630 Acc: 0.2871
val Loss: 0.6473 Acc: 0.2955
Epoch 4/100
----------
train Loss: 0.6526 Acc: 0.3206
val Loss: 0.6350 Acc: 0.3864
Epoch 5/100
----------
train Loss: 0.6462 Acc: 0.3301
val Loss: 0.6283 Acc: 0.3864
Epoch 6/100
----------
train Loss: 0.6318 Acc: 0.3971
val Loss: 0.6179 Acc: 0.4545
Epoch 7/100
----------
train Loss: 0.6178 Acc: 0.4450
val Loss: 0.6058 Acc: 0.5000
Epoch 8/100
----------
train Loss: 0.6077 Acc: 0.4833
val Loss: 0.5950 Acc: 0.5227
Epoch 9/100
----------
train Loss: 0.5970 Acc: 0.5024
val Loss: 0.5819 Acc: 0.5909
Epoch 10/100
----------
train Loss: 0.5770 Acc: 0.5455
val Loss: 0.5658 Acc: 0.6136
Epoch 11/100
----------
train Loss: 0.5784 Acc: 0.5072
val Loss: 0.5566 Acc: 0.6591
Epoch 12/100
----------
train Loss: 0.5708 Acc: 0.5167
val Loss: 0.5487 Acc: 0.6136
Epoch 13/100
----------
train Loss: 0.5495 Acc: 0.5789
val Loss: 0.5313 Acc: 0.6364
Epoch 14/100
----------
train Loss: 0.5358 Acc: 0.5694
val Loss: 0.5233 Acc: 0.6591
Epoch 15/100
----------
train Loss: 0.5325 Acc: 0.5502
val Loss: 0.5134 Acc: 0.6364
Epoch 16/100
----------
train Loss: 0.5235 Acc: 0.5694
val Loss: 0.4997 Acc: 0.6364
Epoch 17/100
----------
train Loss: 0.5140 Acc: 0.5646
val Loss: 0.4881 Acc: 0.6591
Epoch 18/100
----------
train Loss: 0.5057 Acc: 0.5598
val Loss: 0.4768 Acc: 0.6591
Epoch 19/100
----------
train Loss: 0.4917 Acc: 0.6124
val Loss: 0.4674 Acc: 0.6591
Epoch 20/100
----------
train Loss: 0.4878 Acc: 0.5885
val Loss: 0.4562 Acc: 0.6591
Epoch 21/100
----------
train Loss: 0.4845 Acc: 0.5933
val Loss: 0.4498 Acc: 0.6591
Epoch 22/100
----------
train Loss: 0.4784 Acc: 0.5981
val Loss: 0.4410 Acc: 0.6818
Epoch 23/100
----------
train Loss: 0.4661 Acc: 0.5933
val Loss: 0.4319 Acc: 0.6818
Epoch 24/100
----------
train Loss: 0.4431 Acc: 0.6411
val Loss: 0.4154 Acc: 0.6818
Epoch 25/100
----------
train Loss: 0.4580 Acc: 0.6172
val Loss: 0.4156 Acc: 0.7273
Epoch 26/100
----------
train Loss: 0.4542 Acc: 0.6029
val Loss: 0.4125 Acc: 0.7273
Epoch 27/100
----------
train Loss: 0.4239 Acc: 0.6651
val Loss: 0.4019 Acc: 0.7273
Epoch 28/100
----------
train Loss: 0.4441 Acc: 0.6172
val Loss: 0.3962 Acc: 0.7500
Epoch 29/100
----------
train Loss: 0.4555 Acc: 0.5885
val Loss: 0.3910 Acc: 0.7273
Epoch 30/100
----------
train Loss: 0.4373 Acc: 0.6220
val Loss: 0.3882 Acc: 0.7273
Epoch 31/100
----------
train Loss: 0.4089 Acc: 0.7225
val Loss: 0.3798 Acc: 0.7273
Epoch 32/100
----------
train Loss: 0.4179 Acc: 0.6316
val Loss: 0.3710 Acc: 0.7500
Epoch 33/100
----------
train Loss: 0.4297 Acc: 0.6507
val Loss: 0.3674 Acc: 0.7500
Epoch 34/100
----------
train Loss: 0.4096 Acc: 0.7033
val Loss: 0.3619 Acc: 0.7273
Epoch 35/100
----------
train Loss: 0.3811 Acc: 0.7321
val Loss: 0.3576 Acc: 0.7500
Epoch 36/100
----------
train Loss: 0.4341 Acc: 0.6316
val Loss: 0.3501 Acc: 0.7500
Epoch 37/100
----------
train Loss: 0.3967 Acc: 0.6842
val Loss: 0.3540 Acc: 0.7727
Epoch 38/100
----------
train Loss: 0.3954 Acc: 0.7321
val Loss: 0.3499 Acc: 0.7727
Epoch 39/100
----------
train Loss: 0.4074 Acc: 0.6220
val Loss: 0.3554 Acc: 0.7727
Epoch 40/100
----------
train Loss: 0.3751 Acc: 0.7273
val Loss: 0.3502 Acc: 0.7955
Epoch 41/100
----------
train Loss: 0.4137 Acc: 0.6699
val Loss: 0.3458 Acc: 0.7955
Epoch 42/100
----------
train Loss: 0.3733 Acc: 0.7033
val Loss: 0.3391 Acc: 0.7955
Epoch 43/100
----------
train Loss: 0.3909 Acc: 0.7033
val Loss: 0.3331 Acc: 0.7955
Epoch 44/100
----------
train Loss: 0.3635 Acc: 0.7943
val Loss: 0.3294 Acc: 0.7955
Epoch 45/100
----------
train Loss: 0.2970 Acc: 0.8804
val Loss: 0.3242 Acc: 0.7955
Epoch 46/100
----------
train Loss: 0.4150 Acc: 0.7464
val Loss: 0.3252 Acc: 0.7727
Epoch 47/100
----------
train Loss: 0.3515 Acc: 0.8038
val Loss: 0.3221 Acc: 0.7955
Epoch 48/100
----------
train Loss: 0.3724 Acc: 0.7608
val Loss: 0.3222 Acc: 0.7727
Epoch 49/100
----------
train Loss: 0.3592 Acc: 0.8134
val Loss: 0.3169 Acc: 0.7955
Epoch 50/100
----------
train Loss: 0.3505 Acc: 0.7560
val Loss: 0.3171 Acc: 0.7955
Epoch 51/100
----------
train Loss: 0.3085 Acc: 0.8756
val Loss: 0.3094 Acc: 0.7955
Epoch 52/100
----------
train Loss: 0.3642 Acc: 0.7416
val Loss: 0.3117 Acc: 0.7727
Epoch 53/100
----------
train Loss: 0.3838 Acc: 0.7703
val Loss: 0.3098 Acc: 0.7955
Epoch 54/100
----------
train Loss: 0.3134 Acc: 0.8565
val Loss: 0.3047 Acc: 0.7955
Epoch 55/100
----------
train Loss: 0.3317 Acc: 0.8421
val Loss: 0.3003 Acc: 0.7955
Epoch 56/100
----------
train Loss: 0.3601 Acc: 0.7895
val Loss: 0.3007 Acc: 0.7955
Epoch 57/100
----------
train Loss: 0.3905 Acc: 0.7416
val Loss: 0.2992 Acc: 0.7955
Epoch 58/100
----------
train Loss: 0.3373 Acc: 0.7560
val Loss: 0.2976 Acc: 0.7955
Epoch 59/100
----------
train Loss: 0.3575 Acc: 0.7751
val Loss: 0.2956 Acc: 0.7955
Epoch 60/100
----------
train Loss: 0.3212 Acc: 0.8038
val Loss: 0.2951 Acc: 0.7955
Epoch 61/100
----------
train Loss: 0.3832 Acc: 0.6794
val Loss: 0.2950 Acc: 0.7955
Epoch 62/100
----------
train Loss: 0.3458 Acc: 0.8278
val Loss: 0.2940 Acc: 0.7955
Epoch 63/100
----------
train Loss: 0.3111 Acc: 0.8756
val Loss: 0.2929 Acc: 0.7955
Epoch 64/100
----------
train Loss: 0.3034 Acc: 0.8612
val Loss: 0.2895 Acc: 0.7955
Epoch 65/100
----------
train Loss: 0.3312 Acc: 0.7608
val Loss: 0.2866 Acc: 0.7955
Epoch 66/100
----------
train Loss: 0.3232 Acc: 0.8421
val Loss: 0.2893 Acc: 0.7955
Epoch 67/100
----------
train Loss: 0.3444 Acc: 0.8134
val Loss: 0.2832 Acc: 0.8182
Epoch 68/100
----------
train Loss: 0.3032 Acc: 0.8660
val Loss: 0.2845 Acc: 0.7955
Epoch 69/100
----------
train Loss: 0.3078 Acc: 0.8325
val Loss: 0.2832 Acc: 0.8182
Epoch 70/100
----------
train Loss: 0.3304 Acc: 0.8230
val Loss: 0.2872 Acc: 0.7955
Epoch 71/100
----------
train Loss: 0.3493 Acc: 0.8086
val Loss: 0.2846 Acc: 0.8182
Epoch 72/100
----------
train Loss: 0.3464 Acc: 0.8134
val Loss: 0.2885 Acc: 0.8182
Epoch 73/100
----------
train Loss: 0.2581 Acc: 0.9234
val Loss: 0.2880 Acc: 0.8182
Epoch 74/100
----------
train Loss: 0.3592 Acc: 0.7608
val Loss: 0.2831 Acc: 0.7955
Epoch 75/100
----------
train Loss: 0.2844 Acc: 0.8708
val Loss: 0.2837 Acc: 0.7955
Epoch 76/100
----------
train Loss: 0.3104 Acc: 0.7464
val Loss: 0.2807 Acc: 0.7955
Epoch 77/100
----------
train Loss: 0.3283 Acc: 0.8086
val Loss: 0.2791 Acc: 0.7955
Epoch 78/100
----------
train Loss: 0.2902 Acc: 0.8469
val Loss: 0.2763 Acc: 0.7955
Epoch 79/100
----------
train Loss: 0.3547 Acc: 0.7847
val Loss: 0.2708 Acc: 0.8182
Epoch 80/100
----------
train Loss: 0.3131 Acc: 0.8517
val Loss: 0.2700 Acc: 0.8409
Epoch 81/100
----------
train Loss: 0.3489 Acc: 0.7608
val Loss: 0.2766 Acc: 0.8182
Epoch 82/100
----------
train Loss: 0.3064 Acc: 0.8182
val Loss: 0.2769 Acc: 0.8182
Epoch 83/100
----------
train Loss: 0.2648 Acc: 0.9378
val Loss: 0.2768 Acc: 0.8182
Epoch 84/100
----------
train Loss: 0.3477 Acc: 0.7177
val Loss: 0.2773 Acc: 0.8182
Epoch 85/100
----------
train Loss: 0.2893 Acc: 0.8134
val Loss: 0.2759 Acc: 0.7955
Epoch 86/100
----------
train Loss: 0.2934 Acc: 0.8517
val Loss: 0.2696 Acc: 0.8182
Epoch 87/100
----------
train Loss: 0.3273 Acc: 0.8469
val Loss: 0.2687 Acc: 0.8182
Epoch 88/100
----------
train Loss: 0.3321 Acc: 0.8708
val Loss: 0.2660 Acc: 0.8409
Epoch 89/100
----------
train Loss: 0.3577 Acc: 0.7895
val Loss: 0.2653 Acc: 0.8636
Epoch 90/100
----------
train Loss: 0.3007 Acc: 0.8469
val Loss: 0.2659 Acc: 0.7955
Epoch 91/100
----------
train Loss: 0.2680 Acc: 0.9043
val Loss: 0.2699 Acc: 0.7955
Epoch 92/100
----------
train Loss: 0.2868 Acc: 0.9043
val Loss: 0.2711 Acc: 0.8182
Epoch 93/100
----------
train Loss: 0.3117 Acc: 0.8278
val Loss: 0.2620 Acc: 0.8182
Epoch 94/100
----------
train Loss: 0.2440 Acc: 0.9665
val Loss: 0.2596 Acc: 0.8182
Epoch 95/100
----------
train Loss: 0.2886 Acc: 0.8995
val Loss: 0.2602 Acc: 0.8182
Epoch 96/100
----------
train Loss: 0.2097 Acc: 0.9904
val Loss: 0.2597 Acc: 0.8182
Epoch 97/100
----------
train Loss: 0.2637 Acc: 0.9187
val Loss: 0.2573 Acc: 0.7955
Epoch 98/100
----------
train Loss: 0.2902 Acc: 0.8708
val Loss: 0.2578 Acc: 0.8182
Epoch 99/100
----------
train Loss: 0.2885 Acc: 0.8708
val Loss: 0.2603 Acc: 0.8182
Epoch 100/100
----------
train Loss: 0.2451 Acc: 0.8660
[32m[I 2025-06-28 09:56:55,703][0m Trial 41 finished with value: 0.7727272727272727 and parameters: {'batch_size': 19, 'lr': 2.915071046539509e-05, 'num_epochs': 100, 'weight_decay': 0.0005666137482126648, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2635 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_19_lr_2.915071046539509e-05_epoch_100_wd_0.0005666137482126648_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 3.8227 Acc: 0.2201
val Loss: 3.6925 Acc: 0.1818
Epoch 2/95
----------
train Loss: 3.7632 Acc: 0.2249
val Loss: 3.6632 Acc: 0.2273
Epoch 3/95
----------
train Loss: 3.7061 Acc: 0.2297
val Loss: 3.5923 Acc: 0.2045
Epoch 4/95
----------
train Loss: 3.6829 Acc: 0.2584
val Loss: 3.5686 Acc: 0.2273
Epoch 5/95
----------
train Loss: 3.6653 Acc: 0.2344
val Loss: 3.5613 Acc: 0.2273
Epoch 6/95
----------
train Loss: 3.6167 Acc: 0.2679
val Loss: 3.5411 Acc: 0.2273
Epoch 7/95
----------
train Loss: 3.5828 Acc: 0.2632
val Loss: 3.5059 Acc: 0.2727
Epoch 8/95
----------
train Loss: 3.5327 Acc: 0.3110
val Loss: 3.4938 Acc: 0.3182
Epoch 9/95
----------
train Loss: 3.5113 Acc: 0.3541
val Loss: 3.4555 Acc: 0.3409
Epoch 10/95
----------
train Loss: 3.4446 Acc: 0.3206
val Loss: 3.4109 Acc: 0.3409
Epoch 11/95
----------
train Loss: 3.4385 Acc: 0.2919
val Loss: 3.3987 Acc: 0.3409
Epoch 12/95
----------
train Loss: 3.4128 Acc: 0.3158
val Loss: 3.3763 Acc: 0.3864
Epoch 13/95
----------
train Loss: 3.3533 Acc: 0.4498
val Loss: 3.3186 Acc: 0.3864
Epoch 14/95
----------
train Loss: 3.3259 Acc: 0.3876
val Loss: 3.3090 Acc: 0.5000
Epoch 15/95
----------
train Loss: 3.2961 Acc: 0.4545
val Loss: 3.2939 Acc: 0.4545
Epoch 16/95
----------
train Loss: 3.2616 Acc: 0.4258
val Loss: 3.2359 Acc: 0.4545
Epoch 17/95
----------
train Loss: 3.2330 Acc: 0.5024
val Loss: 3.2050 Acc: 0.5227
Epoch 18/95
----------
train Loss: 3.2244 Acc: 0.4450
val Loss: 3.1572 Acc: 0.5000
Epoch 19/95
----------
train Loss: 3.1678 Acc: 0.4785
val Loss: 3.1180 Acc: 0.5000
Epoch 20/95
----------
train Loss: 3.1268 Acc: 0.4833
val Loss: 3.0978 Acc: 0.5455
Epoch 21/95
----------
train Loss: 3.1187 Acc: 0.4928
val Loss: 3.0967 Acc: 0.5455
Epoch 22/95
----------
train Loss: 3.0944 Acc: 0.4641
val Loss: 3.0693 Acc: 0.5227
Epoch 23/95
----------
train Loss: 3.0528 Acc: 0.5024
val Loss: 3.0209 Acc: 0.5682
Epoch 24/95
----------
train Loss: 2.9831 Acc: 0.4928
val Loss: 2.9435 Acc: 0.5909
Epoch 25/95
----------
train Loss: 2.9940 Acc: 0.5024
val Loss: 2.9549 Acc: 0.5909
Epoch 26/95
----------
train Loss: 2.9817 Acc: 0.4737
val Loss: 2.9492 Acc: 0.5682
Epoch 27/95
----------
train Loss: 2.9097 Acc: 0.5359
val Loss: 2.8810 Acc: 0.5682
Epoch 28/95
----------
train Loss: 2.9359 Acc: 0.4833
val Loss: 2.8666 Acc: 0.5909
Epoch 29/95
----------
train Loss: 2.9132 Acc: 0.4833
val Loss: 2.8410 Acc: 0.5909
Epoch 30/95
----------
train Loss: 2.8929 Acc: 0.4976
val Loss: 2.8317 Acc: 0.6136
Epoch 31/95
----------
train Loss: 2.8237 Acc: 0.5215
val Loss: 2.7836 Acc: 0.5909
Epoch 32/95
----------
train Loss: 2.8025 Acc: 0.5359
val Loss: 2.7633 Acc: 0.5909
Epoch 33/95
----------
train Loss: 2.7913 Acc: 0.5120
val Loss: 2.7377 Acc: 0.6136
Epoch 34/95
----------
train Loss: 2.7643 Acc: 0.5024
val Loss: 2.7217 Acc: 0.6364
Epoch 35/95
----------
train Loss: 2.7042 Acc: 0.5311
val Loss: 2.6757 Acc: 0.6364
Epoch 36/95
----------
train Loss: 2.7760 Acc: 0.4928
val Loss: 2.6580 Acc: 0.6136
Epoch 37/95
----------
train Loss: 2.7090 Acc: 0.5072
val Loss: 2.6132 Acc: 0.6364
Epoch 38/95
----------
train Loss: 2.6829 Acc: 0.5263
val Loss: 2.5830 Acc: 0.6364
Epoch 39/95
----------
train Loss: 2.6949 Acc: 0.5263
val Loss: 2.5989 Acc: 0.6591
Epoch 40/95
----------
train Loss: 2.6228 Acc: 0.5120
val Loss: 2.5711 Acc: 0.6591
Epoch 41/95
----------
train Loss: 2.6776 Acc: 0.5072
val Loss: 2.5371 Acc: 0.6591
Epoch 42/95
----------
train Loss: 2.5753 Acc: 0.5167
val Loss: 2.5108 Acc: 0.6591
Epoch 43/95
----------
train Loss: 2.6142 Acc: 0.5072
val Loss: 2.4990 Acc: 0.6364
Epoch 44/95
----------
train Loss: 2.5296 Acc: 0.5263
val Loss: 2.4512 Acc: 0.6818
Epoch 45/95
----------
train Loss: 2.4450 Acc: 0.5598
val Loss: 2.4127 Acc: 0.6364
Epoch 46/95
----------
train Loss: 2.5875 Acc: 0.5263
val Loss: 2.4357 Acc: 0.6591
Epoch 47/95
----------
train Loss: 2.4794 Acc: 0.5263
val Loss: 2.4046 Acc: 0.6818
Epoch 48/95
----------
train Loss: 2.5042 Acc: 0.5120
val Loss: 2.3603 Acc: 0.6591
Epoch 49/95
----------
train Loss: 2.4590 Acc: 0.5263
val Loss: 2.3428 Acc: 0.6591
Epoch 50/95
----------
train Loss: 2.4771 Acc: 0.5167
val Loss: 2.3629 Acc: 0.6818
Epoch 51/95
----------
train Loss: 2.3820 Acc: 0.5263
val Loss: 2.2836 Acc: 0.6818
Epoch 52/95
----------
train Loss: 2.4334 Acc: 0.5263
val Loss: 2.3018 Acc: 0.6818
Epoch 53/95
----------
train Loss: 2.4836 Acc: 0.5072
val Loss: 2.2963 Acc: 0.6818
Epoch 54/95
----------
train Loss: 2.3561 Acc: 0.5215
val Loss: 2.2920 Acc: 0.6818
Epoch 55/95
----------
train Loss: 2.3849 Acc: 0.5263
val Loss: 2.2438 Acc: 0.6818
Epoch 56/95
----------
train Loss: 2.4245 Acc: 0.5120
val Loss: 2.2567 Acc: 0.6818
Epoch 57/95
----------
train Loss: 2.4497 Acc: 0.5024
val Loss: 2.2335 Acc: 0.6818
Epoch 58/95
----------
train Loss: 2.3514 Acc: 0.5311
val Loss: 2.2523 Acc: 0.6818
Epoch 59/95
----------
train Loss: 2.3786 Acc: 0.5120
val Loss: 2.2341 Acc: 0.6818
Epoch 60/95
----------
train Loss: 2.3321 Acc: 0.5550
val Loss: 2.2194 Acc: 0.6818
Epoch 61/95
----------
train Loss: 2.4317 Acc: 0.5215
val Loss: 2.1847 Acc: 0.6818
Epoch 62/95
----------
train Loss: 2.3334 Acc: 0.5311
val Loss: 2.1782 Acc: 0.6818
Epoch 63/95
----------
train Loss: 2.2733 Acc: 0.5263
val Loss: 2.1505 Acc: 0.6818
Epoch 64/95
----------
train Loss: 2.2839 Acc: 0.5263
val Loss: 2.1589 Acc: 0.6818
Epoch 65/95
----------
train Loss: 2.3172 Acc: 0.5455
val Loss: 2.1320 Acc: 0.6818
Epoch 66/95
----------
train Loss: 2.2822 Acc: 0.5215
val Loss: 2.1095 Acc: 0.6818
Epoch 67/95
----------
train Loss: 2.3179 Acc: 0.5215
val Loss: 2.0817 Acc: 0.6818
Epoch 68/95
----------
train Loss: 2.2382 Acc: 0.5407
val Loss: 2.0542 Acc: 0.6818
Epoch 69/95
----------
train Loss: 2.2450 Acc: 0.5311
val Loss: 2.0723 Acc: 0.6818
Epoch 70/95
----------
train Loss: 2.2772 Acc: 0.5407
val Loss: 2.0740 Acc: 0.6818
Epoch 71/95
----------
train Loss: 2.3428 Acc: 0.4976
val Loss: 2.0513 Acc: 0.6818
Epoch 72/95
----------
train Loss: 2.2911 Acc: 0.5311
val Loss: 2.0689 Acc: 0.6818
Epoch 73/95
----------
train Loss: 2.1422 Acc: 0.5455
val Loss: 2.0397 Acc: 0.6818
Epoch 74/95
----------
train Loss: 2.3578 Acc: 0.5215
val Loss: 2.0270 Acc: 0.6818
Epoch 75/95
----------
train Loss: 2.1786 Acc: 0.5694
val Loss: 2.0275 Acc: 0.6818
Epoch 76/95
----------
train Loss: 2.2545 Acc: 0.5215
val Loss: 2.0138 Acc: 0.6818
Epoch 77/95
----------
train Loss: 2.2282 Acc: 0.5311
val Loss: 2.0060 Acc: 0.6818
Epoch 78/95
----------
train Loss: 2.1911 Acc: 0.5502
val Loss: 2.0029 Acc: 0.6818
Epoch 79/95
----------
train Loss: 2.2760 Acc: 0.5407
val Loss: 1.9922 Acc: 0.7045
Epoch 80/95
----------
train Loss: 2.2034 Acc: 0.5311
val Loss: 1.9901 Acc: 0.7045
Epoch 81/95
----------
train Loss: 2.2877 Acc: 0.5215
val Loss: 1.9961 Acc: 0.7045
Epoch 82/95
----------
train Loss: 2.1601 Acc: 0.5789
val Loss: 1.9887 Acc: 0.7045
Epoch 83/95
----------
train Loss: 2.0798 Acc: 0.6077
val Loss: 1.9699 Acc: 0.7045
Epoch 84/95
----------
train Loss: 2.2692 Acc: 0.5359
val Loss: 1.9877 Acc: 0.7045
Epoch 85/95
----------
train Loss: 2.1452 Acc: 0.5455
val Loss: 1.9648 Acc: 0.7045
Epoch 86/95
----------
train Loss: 2.1340 Acc: 0.5598
val Loss: 1.9370 Acc: 0.7045
Epoch 87/95
----------
train Loss: 2.1733 Acc: 0.5502
val Loss: 1.9319 Acc: 0.7045
Epoch 88/95
----------
train Loss: 2.2278 Acc: 0.5359
val Loss: 1.9204 Acc: 0.7045
Epoch 89/95
----------
train Loss: 2.2516 Acc: 0.5407
val Loss: 1.9332 Acc: 0.7045
Epoch 90/95
----------
train Loss: 2.1289 Acc: 0.5742
val Loss: 1.9273 Acc: 0.7045
Epoch 91/95
----------
train Loss: 2.0694 Acc: 0.6172
val Loss: 1.9268 Acc: 0.7045
Epoch 92/95
----------
train Loss: 2.0890 Acc: 0.5885
val Loss: 1.9165 Acc: 0.7045
Epoch 93/95
----------
train Loss: 2.1201 Acc: 0.5742
val Loss: 1.9108 Acc: 0.7045
Epoch 94/95
----------
train Loss: 1.9786 Acc: 0.5885
val Loss: 1.8849 Acc: 0.7045
Epoch 95/95
----------
train Loss: 2.1051 Acc: 0.5789
[32m[I 2025-06-28 10:18:29,241][0m Trial 42 finished with value: 0.7045454545454546 and parameters: {'batch_size': 36, 'lr': 1.57944696544565e-05, 'num_epochs': 95, 'weight_decay': 0.030257968469773307, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.8833 Acc: 0.7045
Best val Acc: 0.704545

Model weights saved at ./model_weights/efficientnetb0_bs_36_lr_1.57944696544565e-05_epoch_95_wd_0.030257968469773307_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/89
----------
train Loss: 2.9818 Acc: 0.4498
val Loss: 4.5437 Acc: 0.1591
Epoch 2/89
----------
train Loss: 2.6161 Acc: 0.5359
val Loss: 6.4108 Acc: 0.2045
Epoch 3/89
----------
train Loss: 2.2823 Acc: 0.6268
val Loss: 6.6861 Acc: 0.2500
Epoch 4/89
----------
train Loss: 2.2612 Acc: 0.5933
val Loss: 4.3825 Acc: 0.1364
Epoch 5/89
----------
train Loss: 2.2237 Acc: 0.6124
val Loss: 5.6911 Acc: 0.1364
Epoch 6/89
----------
train Loss: 2.1493 Acc: 0.6507
val Loss: 6.6883 Acc: 0.1364
Epoch 7/89
----------
train Loss: 1.9946 Acc: 0.6842
val Loss: 5.2906 Acc: 0.1364
Epoch 8/89
----------
train Loss: 2.1932 Acc: 0.6172
[32m[I 2025-06-28 10:20:18,843][0m Trial 43 finished with value: 0.25 and parameters: {'batch_size': 40, 'lr': 0.0026958323134049817, 'num_epochs': 89, 'weight_decay': 0.021272727804572778, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.7980 Acc: 0.0909
Early stopping at epoch 8 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.250000

Model weights saved at ./model_weights/efficientnetb0_bs_40_lr_0.0026958323134049817_epoch_89_wd_0.021272727804572778_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/85
----------
train Loss: 5.3748 Acc: 0.3493
val Loss: 4.5195 Acc: 0.6364
Epoch 2/85
----------
train Loss: 2.4188 Acc: 0.8278
val Loss: 9.0970 Acc: 0.6591
Epoch 3/85
----------
train Loss: 0.7466 Acc: 0.9522
val Loss: 8.7237 Acc: 0.6136
Epoch 4/85
----------
train Loss: 0.5075 Acc: 0.9522
val Loss: 5.0134 Acc: 0.7273
Epoch 5/85
----------
train Loss: 0.5544 Acc: 0.9522
val Loss: 4.4927 Acc: 0.7955
Epoch 6/85
----------
train Loss: 1.0772 Acc: 0.9330
val Loss: 3.2058 Acc: 0.8182
Epoch 7/85
----------
train Loss: 1.3767 Acc: 0.8995
val Loss: 3.5739 Acc: 0.7045
Epoch 8/85
----------
train Loss: 0.8328 Acc: 0.9378
val Loss: 3.8213 Acc: 0.6818
Epoch 9/85
----------
train Loss: 1.0759 Acc: 0.8947
val Loss: 2.7781 Acc: 0.8182
Epoch 10/85
----------
train Loss: 0.8846 Acc: 0.8852
val Loss: 4.2960 Acc: 0.5227
Epoch 11/85
----------
train Loss: 1.1294 Acc: 0.8421
val Loss: 3.9767 Acc: 0.6818
Epoch 12/85
----------
train Loss: 1.1889 Acc: 0.8565
val Loss: 3.0548 Acc: 0.7273
Epoch 13/85
----------
train Loss: 0.5658 Acc: 0.9522
val Loss: 3.2966 Acc: 0.8409
Epoch 14/85
----------
train Loss: 0.6783 Acc: 0.9569
val Loss: 3.5436 Acc: 0.8636
Epoch 15/85
----------
train Loss: 0.2078 Acc: 0.9904
val Loss: 2.9012 Acc: 0.7273
Epoch 16/85
----------
train Loss: 0.3629 Acc: 0.9713
val Loss: 2.7816 Acc: 0.7955
Epoch 17/85
----------
train Loss: 0.2689 Acc: 0.9809
val Loss: 4.7279 Acc: 0.7955
Epoch 18/85
----------
train Loss: 0.2710 Acc: 0.9809
val Loss: 4.0261 Acc: 0.7273
Epoch 19/85
----------
train Loss: 0.4401 Acc: 0.9378
[32m[I 2025-06-28 10:24:38,837][0m Trial 44 finished with value: 0.8636363636363636 and parameters: {'batch_size': 29, 'lr': 0.0010711481425281944, 'num_epochs': 85, 'weight_decay': 0.012938177092352048, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.6915 Acc: 0.7727
Early stopping at epoch 19 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_29_lr_0.0010711481425281944_epoch_85_wd_0.012938177092352048_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/77
----------
train Loss: 3.7842 Acc: 0.2297
val Loss: 3.6276 Acc: 0.2727
Epoch 2/77
----------
train Loss: 3.6305 Acc: 0.2871
val Loss: 3.5194 Acc: 0.2727
Epoch 3/77
----------
train Loss: 3.4884 Acc: 0.3349
val Loss: 3.3550 Acc: 0.3636
Epoch 4/77
----------
train Loss: 3.3916 Acc: 0.3445
val Loss: 3.2542 Acc: 0.4318
Epoch 5/77
----------
train Loss: 3.3024 Acc: 0.3971
val Loss: 3.1745 Acc: 0.4773
Epoch 6/77
----------
train Loss: 3.1826 Acc: 0.4258
val Loss: 3.0678 Acc: 0.4773
Epoch 7/77
----------
train Loss: 3.0697 Acc: 0.4737
val Loss: 2.9399 Acc: 0.6136
Epoch 8/77
----------
train Loss: 2.9859 Acc: 0.5024
val Loss: 2.8324 Acc: 0.5909
Epoch 9/77
----------
train Loss: 2.8989 Acc: 0.5263
val Loss: 2.7048 Acc: 0.6136
Epoch 10/77
----------
train Loss: 2.7259 Acc: 0.5120
val Loss: 2.5804 Acc: 0.6136
Epoch 11/77
----------
train Loss: 2.7264 Acc: 0.5024
val Loss: 2.5107 Acc: 0.6364
Epoch 12/77
----------
train Loss: 2.6846 Acc: 0.5167
val Loss: 2.4558 Acc: 0.6591
Epoch 13/77
----------
train Loss: 2.5360 Acc: 0.5263
val Loss: 2.3420 Acc: 0.6591
Epoch 14/77
----------
train Loss: 2.4515 Acc: 0.5359
val Loss: 2.3005 Acc: 0.6818
Epoch 15/77
----------
train Loss: 2.4628 Acc: 0.5311
val Loss: 2.2465 Acc: 0.6818
Epoch 16/77
----------
train Loss: 2.4087 Acc: 0.5311
val Loss: 2.1798 Acc: 0.6818
Epoch 17/77
----------
train Loss: 2.3441 Acc: 0.5311
val Loss: 2.1202 Acc: 0.6818
Epoch 18/77
----------
train Loss: 2.2824 Acc: 0.5311
val Loss: 2.0647 Acc: 0.6818
Epoch 19/77
----------
train Loss: 2.2314 Acc: 0.5502
val Loss: 2.0333 Acc: 0.6818
Epoch 20/77
----------
train Loss: 2.2189 Acc: 0.5215
val Loss: 1.9837 Acc: 0.6818
Epoch 21/77
----------
train Loss: 2.2267 Acc: 0.5502
val Loss: 1.9610 Acc: 0.6818
Epoch 22/77
----------
train Loss: 2.1953 Acc: 0.5789
val Loss: 1.9253 Acc: 0.6818
Epoch 23/77
----------
train Loss: 2.1375 Acc: 0.5742
val Loss: 1.8828 Acc: 0.6818
Epoch 24/77
----------
train Loss: 1.9999 Acc: 0.5789
val Loss: 1.8252 Acc: 0.6818
Epoch 25/77
----------
train Loss: 2.1048 Acc: 0.5694
val Loss: 1.8313 Acc: 0.6818
Epoch 26/77
----------
train Loss: 2.1121 Acc: 0.5837
val Loss: 1.8370 Acc: 0.7045
Epoch 27/77
----------
train Loss: 1.9430 Acc: 0.6220
val Loss: 1.8126 Acc: 0.7273
Epoch 28/77
----------
train Loss: 2.0830 Acc: 0.5885
val Loss: 1.7941 Acc: 0.7273
Epoch 29/77
----------
train Loss: 2.1274 Acc: 0.5742
val Loss: 1.7777 Acc: 0.7273
Epoch 30/77
----------
train Loss: 2.0297 Acc: 0.6029
val Loss: 1.7821 Acc: 0.7500
Epoch 31/77
----------
train Loss: 1.8831 Acc: 0.6986
val Loss: 1.7438 Acc: 0.7500
Epoch 32/77
----------
train Loss: 1.9665 Acc: 0.6316
val Loss: 1.7063 Acc: 0.7500
Epoch 33/77
----------
train Loss: 1.9942 Acc: 0.6507
val Loss: 1.7026 Acc: 0.7727
Epoch 34/77
----------
train Loss: 1.9256 Acc: 0.6938
val Loss: 1.6840 Acc: 0.7727
Epoch 35/77
----------
train Loss: 1.7370 Acc: 0.7321
val Loss: 1.6617 Acc: 0.7727
Epoch 36/77
----------
train Loss: 2.0570 Acc: 0.6077
val Loss: 1.6327 Acc: 0.7727
Epoch 37/77
----------
train Loss: 1.8300 Acc: 0.6986
val Loss: 1.6410 Acc: 0.7727
Epoch 38/77
----------
train Loss: 1.8371 Acc: 0.7560
val Loss: 1.6242 Acc: 0.7727
Epoch 39/77
----------
train Loss: 1.9297 Acc: 0.6507
val Loss: 1.6718 Acc: 0.7727
Epoch 40/77
----------
train Loss: 1.7055 Acc: 0.7321
val Loss: 1.6694 Acc: 0.7727
Epoch 41/77
----------
train Loss: 2.0028 Acc: 0.6555
val Loss: 1.6351 Acc: 0.7727
Epoch 42/77
----------
train Loss: 1.7321 Acc: 0.7321
val Loss: 1.5950 Acc: 0.7727
Epoch 43/77
----------
train Loss: 1.8192 Acc: 0.7129
val Loss: 1.5777 Acc: 0.7500
Epoch 44/77
----------
train Loss: 1.6361 Acc: 0.7847
val Loss: 1.5447 Acc: 0.7727
Epoch 45/77
----------
train Loss: 1.2944 Acc: 0.9139
val Loss: 1.5043 Acc: 0.8409
Epoch 46/77
----------
train Loss: 1.9219 Acc: 0.7656
val Loss: 1.5068 Acc: 0.8182
Epoch 47/77
----------
train Loss: 1.6086 Acc: 0.8182
val Loss: 1.4874 Acc: 0.8409
Epoch 48/77
----------
train Loss: 1.6515 Acc: 0.7751
val Loss: 1.4674 Acc: 0.8182
Epoch 49/77
----------
train Loss: 1.6301 Acc: 0.8325
val Loss: 1.4498 Acc: 0.8182
Epoch 50/77
----------
train Loss: 1.5975 Acc: 0.7990
val Loss: 1.4804 Acc: 0.7955
Epoch 51/77
----------
train Loss: 1.3085 Acc: 0.9234
val Loss: 1.4329 Acc: 0.7955
Epoch 52/77
----------
train Loss: 1.6445 Acc: 0.7464
val Loss: 1.4334 Acc: 0.8409
Epoch 53/77
----------
train Loss: 1.7734 Acc: 0.7990
val Loss: 1.4288 Acc: 0.8409
Epoch 54/77
----------
train Loss: 1.4192 Acc: 0.9091
val Loss: 1.4044 Acc: 0.8636
Epoch 55/77
----------
train Loss: 1.4746 Acc: 0.8852
val Loss: 1.3769 Acc: 0.8636
Epoch 56/77
----------
train Loss: 1.6235 Acc: 0.8325
val Loss: 1.3823 Acc: 0.8409
Epoch 57/77
----------
train Loss: 1.7844 Acc: 0.7608
val Loss: 1.3641 Acc: 0.8409
Epoch 58/77
----------
train Loss: 1.5323 Acc: 0.8134
val Loss: 1.3725 Acc: 0.8409
Epoch 59/77
----------
train Loss: 1.5819 Acc: 0.8325
val Loss: 1.3729 Acc: 0.8182
Epoch 60/77
----------
train Loss: 1.3439 Acc: 0.8182
val Loss: 1.3875 Acc: 0.8409
Epoch 61/77
----------
train Loss: 1.7567 Acc: 0.6986
val Loss: 1.3780 Acc: 0.8182
Epoch 62/77
----------
train Loss: 1.5518 Acc: 0.8900
val Loss: 1.3640 Acc: 0.8182
Epoch 63/77
----------
train Loss: 1.3793 Acc: 0.8852
val Loss: 1.3614 Acc: 0.8182
Epoch 64/77
----------
train Loss: 1.3125 Acc: 0.9234
val Loss: 1.3539 Acc: 0.8409
Epoch 65/77
----------
train Loss: 1.4804 Acc: 0.7799
val Loss: 1.3621 Acc: 0.8409
Epoch 66/77
----------
train Loss: 1.4156 Acc: 0.8565
val Loss: 1.3519 Acc: 0.8409
Epoch 67/77
----------
train Loss: 1.5878 Acc: 0.8517
val Loss: 1.3348 Acc: 0.8636
Epoch 68/77
----------
train Loss: 1.3213 Acc: 0.8900
val Loss: 1.3399 Acc: 0.8636
Epoch 69/77
----------
train Loss: 1.3394 Acc: 0.8708
val Loss: 1.3429 Acc: 0.8636
Epoch 70/77
----------
train Loss: 1.4877 Acc: 0.8612
val Loss: 1.3380 Acc: 0.8409
Epoch 71/77
----------
train Loss: 1.5741 Acc: 0.8804
val Loss: 1.3297 Acc: 0.8636
Epoch 72/77
----------
train Loss: 1.5834 Acc: 0.8230
val Loss: 1.3636 Acc: 0.8409
Epoch 73/77
----------
train Loss: 1.1241 Acc: 0.9474
val Loss: 1.3501 Acc: 0.8182
Epoch 74/77
----------
train Loss: 1.6143 Acc: 0.8086
val Loss: 1.3200 Acc: 0.8409
Epoch 75/77
----------
train Loss: 1.2420 Acc: 0.9139
val Loss: 1.3230 Acc: 0.7955
Epoch 76/77
----------
train Loss: 1.3695 Acc: 0.7751
val Loss: 1.3286 Acc: 0.8182
Epoch 77/77
----------
train Loss: 1.4742 Acc: 0.8134
[32m[I 2025-06-28 10:42:09,561][0m Trial 45 finished with value: 0.8409090909090909 and parameters: {'batch_size': 27, 'lr': 4.6221594504676794e-05, 'num_epochs': 77, 'weight_decay': 0.013289160464562919, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.3350 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_27_lr_4.6221594504676794e-05_epoch_77_wd_0.013289160464562919_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/37
----------
train Loss: 5.9634 Acc: 0.1962
val Loss: 5.0702 Acc: 0.3182
Epoch 2/37
----------
train Loss: 5.4662 Acc: 0.3876
val Loss: 4.9085 Acc: 0.4318
Epoch 3/37
----------
train Loss: 5.1090 Acc: 0.5215
val Loss: 4.8661 Acc: 0.4318
Epoch 4/37
----------
train Loss: 4.7531 Acc: 0.6077
val Loss: 4.7662 Acc: 0.4318
Epoch 5/37
----------
train Loss: 4.4131 Acc: 0.6507
val Loss: 4.6876 Acc: 0.4545
Epoch 6/37
----------
train Loss: 4.0677 Acc: 0.7225
val Loss: 4.6047 Acc: 0.4773
Epoch 7/37
----------
train Loss: 3.7773 Acc: 0.7751
val Loss: 4.4905 Acc: 0.5000
Epoch 8/37
----------
train Loss: 3.3852 Acc: 0.8230
val Loss: 4.3872 Acc: 0.5682
Epoch 9/37
----------
train Loss: 3.1375 Acc: 0.8373
val Loss: 4.2712 Acc: 0.5909
Epoch 10/37
----------
train Loss: 2.8842 Acc: 0.8612
val Loss: 4.1716 Acc: 0.6364
Epoch 11/37
----------
train Loss: 2.6146 Acc: 0.9091
val Loss: 4.0724 Acc: 0.6591
Epoch 12/37
----------
train Loss: 2.3473 Acc: 0.8660
val Loss: 3.9786 Acc: 0.6591
Epoch 13/37
----------
train Loss: 2.1055 Acc: 0.9139
val Loss: 3.8665 Acc: 0.7045
Epoch 14/37
----------
train Loss: 1.9154 Acc: 0.9330
val Loss: 3.7711 Acc: 0.7273
Epoch 15/37
----------
train Loss: 1.6814 Acc: 0.9474
val Loss: 3.6416 Acc: 0.7500
Epoch 16/37
----------
train Loss: 1.4059 Acc: 0.9569
val Loss: 3.5672 Acc: 0.7500
Epoch 17/37
----------
train Loss: 1.2453 Acc: 0.9713
val Loss: 3.4643 Acc: 0.7500
Epoch 18/37
----------
train Loss: 1.1152 Acc: 0.9761
val Loss: 3.3663 Acc: 0.7273
Epoch 19/37
----------
train Loss: 1.0553 Acc: 0.9761
val Loss: 3.2930 Acc: 0.7727
Epoch 20/37
----------
train Loss: 0.9749 Acc: 0.9761
val Loss: 3.2730 Acc: 0.7273
Epoch 21/37
----------
train Loss: 0.8355 Acc: 0.9713
val Loss: 3.2065 Acc: 0.7500
Epoch 22/37
----------
train Loss: 0.8337 Acc: 0.9809
val Loss: 3.1780 Acc: 0.7500
Epoch 23/37
----------
train Loss: 0.6334 Acc: 0.9856
val Loss: 3.1626 Acc: 0.7500
Epoch 24/37
----------
train Loss: 0.5575 Acc: 0.9856
val Loss: 3.0821 Acc: 0.7500
Epoch 25/37
----------
train Loss: 0.5553 Acc: 1.0000
val Loss: 3.0174 Acc: 0.7727
Epoch 26/37
----------
train Loss: 0.4788 Acc: 1.0000
val Loss: 3.0539 Acc: 0.7273
Epoch 27/37
----------
train Loss: 0.3940 Acc: 1.0000
val Loss: 3.0336 Acc: 0.7500
Epoch 28/37
----------
train Loss: 0.4274 Acc: 0.9856
val Loss: 3.0536 Acc: 0.7727
Epoch 29/37
----------
train Loss: 0.3630 Acc: 0.9904
val Loss: 3.0072 Acc: 0.7727
Epoch 30/37
----------
train Loss: 0.2772 Acc: 1.0000
val Loss: 3.0114 Acc: 0.7727
Epoch 31/37
----------
train Loss: 0.2727 Acc: 0.9952
val Loss: 3.0394 Acc: 0.7727
Epoch 32/37
----------
train Loss: 0.2240 Acc: 0.9952
val Loss: 3.0318 Acc: 0.7500
Epoch 33/37
----------
train Loss: 0.2829 Acc: 0.9856
val Loss: 3.0290 Acc: 0.7500
Epoch 34/37
----------
train Loss: 0.2435 Acc: 1.0000
val Loss: 2.9560 Acc: 0.7500
Epoch 35/37
----------
train Loss: 0.2002 Acc: 1.0000
val Loss: 2.9683 Acc: 0.7955
Epoch 36/37
----------
train Loss: 0.2224 Acc: 1.0000
val Loss: 3.0501 Acc: 0.7727
Epoch 37/37
----------
train Loss: 0.2484 Acc: 0.9952
[32m[I 2025-06-28 10:50:35,318][0m Trial 46 finished with value: 0.7954545454545455 and parameters: {'batch_size': 15, 'lr': 6.100562337823365e-05, 'num_epochs': 37, 'weight_decay': 0.0019854440063154307, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.0049 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_15_lr_6.100562337823365e-05_epoch_37_wd_0.0019854440063154307_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 3.5245 Acc: 0.3254
val Loss: 3.2724 Acc: 0.5682
Epoch 2/84
----------
train Loss: 2.9070 Acc: 0.5120
val Loss: 2.7037 Acc: 0.6364
Epoch 3/84
----------
train Loss: 2.5386 Acc: 0.4928
val Loss: 2.2330 Acc: 0.6364
Epoch 4/84
----------
train Loss: 2.3754 Acc: 0.4976
val Loss: 2.0904 Acc: 0.6364
Epoch 5/84
----------
train Loss: 2.3022 Acc: 0.5167
val Loss: 2.0368 Acc: 0.6818
Epoch 6/84
----------
train Loss: 2.1767 Acc: 0.5407
val Loss: 1.9967 Acc: 0.7045
Epoch 7/84
----------
train Loss: 2.0610 Acc: 0.5742
val Loss: 2.0677 Acc: 0.7273
Epoch 8/84
----------
train Loss: 2.1099 Acc: 0.5885
val Loss: 1.8931 Acc: 0.7727
Epoch 9/84
----------
train Loss: 2.0383 Acc: 0.6555
val Loss: 1.8525 Acc: 0.7727
Epoch 10/84
----------
train Loss: 1.6055 Acc: 0.8278
val Loss: 1.6641 Acc: 0.7045
Epoch 11/84
----------
train Loss: 1.8676 Acc: 0.6986
val Loss: 1.5089 Acc: 0.7727
Epoch 12/84
----------
train Loss: 1.8107 Acc: 0.6794
val Loss: 1.6586 Acc: 0.7727
Epoch 13/84
----------
train Loss: 1.5496 Acc: 0.8421
val Loss: 1.4938 Acc: 0.7500
Epoch 14/84
----------
train Loss: 1.4053 Acc: 0.7943
val Loss: 1.5659 Acc: 0.6818
Epoch 15/84
----------
train Loss: 1.5628 Acc: 0.7656
val Loss: 1.5055 Acc: 0.7500
Epoch 16/84
----------
train Loss: 1.5334 Acc: 0.7703
val Loss: 1.6750 Acc: 0.7727
Epoch 17/84
----------
train Loss: 1.4689 Acc: 0.8182
val Loss: 1.8264 Acc: 0.7955
Epoch 18/84
----------
train Loss: 1.4147 Acc: 0.8421
val Loss: 1.5912 Acc: 0.7727
Epoch 19/84
----------
train Loss: 1.2973 Acc: 0.9187
val Loss: 1.4030 Acc: 0.7727
Epoch 20/84
----------
train Loss: 1.4022 Acc: 0.8517
val Loss: 1.3608 Acc: 0.7727
Epoch 21/84
----------
train Loss: 1.4734 Acc: 0.8756
val Loss: 1.3692 Acc: 0.7500
Epoch 22/84
----------
train Loss: 1.3400 Acc: 0.8565
val Loss: 1.4981 Acc: 0.7727
Epoch 23/84
----------
train Loss: 1.5098 Acc: 0.8660
val Loss: 1.5708 Acc: 0.7955
Epoch 24/84
----------
train Loss: 1.1426 Acc: 0.8947
val Loss: 1.4818 Acc: 0.7955
Epoch 25/84
----------
train Loss: 1.3552 Acc: 0.9330
val Loss: 1.6894 Acc: 0.7727
Epoch 26/84
----------
train Loss: 1.4918 Acc: 0.9091
val Loss: 1.4349 Acc: 0.7955
Epoch 27/84
----------
train Loss: 1.2279 Acc: 0.9665
val Loss: 1.5217 Acc: 0.7727
Epoch 28/84
----------
train Loss: 1.4412 Acc: 0.8756
val Loss: 1.4021 Acc: 0.8182
Epoch 29/84
----------
train Loss: 1.5307 Acc: 0.7799
val Loss: 1.5193 Acc: 0.7955
Epoch 30/84
----------
train Loss: 1.3407 Acc: 0.8612
val Loss: 1.3953 Acc: 0.7045
Epoch 31/84
----------
train Loss: 1.1600 Acc: 0.9330
val Loss: 1.3177 Acc: 0.7500
Epoch 32/84
----------
train Loss: 1.3261 Acc: 0.8900
val Loss: 1.2325 Acc: 0.7955
Epoch 33/84
----------
train Loss: 1.4179 Acc: 0.8756
val Loss: 1.3040 Acc: 0.7955
Epoch 34/84
----------
train Loss: 1.3260 Acc: 0.9426
val Loss: 1.5475 Acc: 0.7045
Epoch 35/84
----------
train Loss: 1.0310 Acc: 0.9522
val Loss: 1.4589 Acc: 0.7727
Epoch 36/84
----------
train Loss: 1.6408 Acc: 0.8469
val Loss: 1.5488 Acc: 0.7045
Epoch 37/84
----------
train Loss: 1.4187 Acc: 0.7895
val Loss: 2.0434 Acc: 0.6818
Epoch 38/84
----------
train Loss: 1.4858 Acc: 0.9234
val Loss: 1.6505 Acc: 0.7273
Epoch 39/84
----------
train Loss: 1.4579 Acc: 0.7608
val Loss: 2.0278 Acc: 0.7955
Epoch 40/84
----------
train Loss: 1.2969 Acc: 0.9091
val Loss: 1.4360 Acc: 0.6818
Epoch 41/84
----------
train Loss: 1.6545 Acc: 0.6986
val Loss: 1.4151 Acc: 0.7500
Epoch 42/84
----------
train Loss: 1.2964 Acc: 0.8517
val Loss: 1.5883 Acc: 0.6364
Epoch 43/84
----------
train Loss: 1.3724 Acc: 0.8517
val Loss: 1.4251 Acc: 0.7273
Epoch 44/84
----------
train Loss: 1.2878 Acc: 0.8612
val Loss: 1.4578 Acc: 0.7500
Epoch 45/84
----------
train Loss: 0.8407 Acc: 0.9713
val Loss: 1.2130 Acc: 0.7727
Epoch 46/84
----------
train Loss: 1.7311 Acc: 0.8134
val Loss: 1.5420 Acc: 0.7273
Epoch 47/84
----------
train Loss: 1.2934 Acc: 0.8708
val Loss: 1.4349 Acc: 0.7273
Epoch 48/84
----------
train Loss: 1.3707 Acc: 0.8421
val Loss: 1.5078 Acc: 0.7955
Epoch 49/84
----------
train Loss: 1.3469 Acc: 0.9330
val Loss: 1.5556 Acc: 0.7955
Epoch 50/84
----------
train Loss: 1.3349 Acc: 0.8565
val Loss: 1.4994 Acc: 0.7045
Epoch 51/84
----------
train Loss: 1.0400 Acc: 0.9904
val Loss: 1.4936 Acc: 0.7500
Epoch 52/84
----------
train Loss: 1.3434 Acc: 0.8373
val Loss: 1.3546 Acc: 0.7500
Epoch 53/84
----------
train Loss: 1.5339 Acc: 0.9139
val Loss: 1.4030 Acc: 0.7500
Epoch 54/84
----------
train Loss: 1.2610 Acc: 0.9330
val Loss: 1.4765 Acc: 0.7727
Epoch 55/84
----------
train Loss: 1.2322 Acc: 0.9665
val Loss: 1.6883 Acc: 0.7273
Epoch 56/84
----------
train Loss: 1.4580 Acc: 0.8995
val Loss: 1.3950 Acc: 0.7273
Epoch 57/84
----------
train Loss: 1.6750 Acc: 0.7990
val Loss: 1.5468 Acc: 0.7273
Epoch 58/84
----------
train Loss: 1.3614 Acc: 0.8230
val Loss: 1.6030 Acc: 0.6818
Epoch 59/84
----------
train Loss: 1.3860 Acc: 0.8612
val Loss: 1.5322 Acc: 0.7045
Epoch 60/84
----------
train Loss: 1.1533 Acc: 0.8995
val Loss: 1.2393 Acc: 0.7273
Epoch 61/84
----------
train Loss: 1.5891 Acc: 0.7368
val Loss: 1.3057 Acc: 0.7273
Epoch 62/84
----------
train Loss: 1.5728 Acc: 0.9091
val Loss: 1.5619 Acc: 0.7045
Epoch 63/84
----------
train Loss: 1.3881 Acc: 0.9043
val Loss: 1.7262 Acc: 0.7273
Epoch 64/84
----------
train Loss: 1.2129 Acc: 0.9522
val Loss: 1.3583 Acc: 0.7727
Epoch 65/84
----------
train Loss: 1.3373 Acc: 0.8804
val Loss: 1.4947 Acc: 0.6591
Epoch 66/84
----------
train Loss: 1.3302 Acc: 0.8995
val Loss: 1.4959 Acc: 0.7500
Epoch 67/84
----------
train Loss: 1.4901 Acc: 0.8660
val Loss: 1.4703 Acc: 0.7727
Epoch 68/84
----------
train Loss: 1.2475 Acc: 0.8756
val Loss: 1.7676 Acc: 0.7727
Epoch 69/84
----------
train Loss: 1.2482 Acc: 0.8469
val Loss: 1.3270 Acc: 0.7727
Epoch 70/84
----------
train Loss: 1.3877 Acc: 0.9043
val Loss: 1.3908 Acc: 0.7955
Epoch 71/84
----------
train Loss: 1.4890 Acc: 0.9091
val Loss: 1.3789 Acc: 0.8182
Epoch 72/84
----------
train Loss: 1.4902 Acc: 0.8660
val Loss: 1.3879 Acc: 0.7955
Epoch 73/84
----------
train Loss: 1.0729 Acc: 0.9426
val Loss: 1.4575 Acc: 0.7727
Epoch 74/84
----------
train Loss: 1.5108 Acc: 0.8182
val Loss: 1.4386 Acc: 0.7273
Epoch 75/84
----------
train Loss: 1.2356 Acc: 0.9378
val Loss: 1.7094 Acc: 0.7727
Epoch 76/84
----------
train Loss: 1.1750 Acc: 0.8756
val Loss: 1.5758 Acc: 0.7273
Epoch 77/84
----------
train Loss: 1.4724 Acc: 0.8373
val Loss: 1.7008 Acc: 0.6818
Epoch 78/84
----------
train Loss: 1.3359 Acc: 0.8612
val Loss: 1.6141 Acc: 0.7045
Epoch 79/84
----------
train Loss: 1.4509 Acc: 0.8612
val Loss: 1.3772 Acc: 0.7727
Epoch 80/84
----------
train Loss: 1.3846 Acc: 0.8565
val Loss: 1.5920 Acc: 0.7045
Epoch 81/84
----------
train Loss: 1.5971 Acc: 0.7799
val Loss: 1.7036 Acc: 0.6136
Epoch 82/84
----------
train Loss: 1.3173 Acc: 0.8278
val Loss: 1.4051 Acc: 0.7045
Epoch 83/84
----------
train Loss: 1.1563 Acc: 0.9474
val Loss: 1.5207 Acc: 0.7955
Epoch 84/84
----------
train Loss: 1.5481 Acc: 0.7799
[32m[I 2025-06-28 11:09:41,595][0m Trial 47 finished with value: 0.7954545454545455 and parameters: {'batch_size': 23, 'lr': 0.00033634925323073196, 'num_epochs': 84, 'weight_decay': 0.04115534174280694, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.6627 Acc: 0.7273
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_23_lr_0.00033634925323073196_epoch_84_wd_0.04115534174280694_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/69
----------
train Loss: 6.0163 Acc: 0.1722
val Loss: 5.1310 Acc: 0.1818
Epoch 2/69
----------
train Loss: 5.9619 Acc: 0.2488
val Loss: 5.0996 Acc: 0.3636
Epoch 3/69
----------
train Loss: 5.9615 Acc: 0.2057
val Loss: 5.1887 Acc: 0.2727
Epoch 4/69
----------
train Loss: 5.9360 Acc: 0.2297
val Loss: 5.1907 Acc: 0.1818
Epoch 5/69
----------
train Loss: 5.9410 Acc: 0.2488
val Loss: 5.1717 Acc: 0.2045
Epoch 6/69
----------
train Loss: 5.7782 Acc: 0.2679
val Loss: 5.1595 Acc: 0.1818
Epoch 7/69
----------
train Loss: 5.8764 Acc: 0.2488
[32m[I 2025-06-28 11:11:17,558][0m Trial 48 finished with value: 0.36363636363636365 and parameters: {'batch_size': 32, 'lr': 3.63342473681518e-06, 'num_epochs': 69, 'weight_decay': 0.0009602645212357795, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 5.1495 Acc: 0.2273
Early stopping at epoch 7 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.363636

Model weights saved at ./model_weights/efficientnetb0_bs_32_lr_3.63342473681518e-06_epoch_69_wd_0.0009602645212357795_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/97
----------
train Loss: 5.8529 Acc: 0.2536
val Loss: 4.9230 Acc: 0.4545
Epoch 2/97
----------
train Loss: 4.5726 Acc: 0.5981
val Loss: 4.5232 Acc: 0.5682
Epoch 3/97
----------
train Loss: 3.6304 Acc: 0.7751
val Loss: 4.1525 Acc: 0.6591
Epoch 4/97
----------
train Loss: 2.8247 Acc: 0.8660
val Loss: 3.7601 Acc: 0.6591
Epoch 5/97
----------
train Loss: 2.0047 Acc: 0.9187
val Loss: 3.4266 Acc: 0.7273
Epoch 6/97
----------
train Loss: 1.4542 Acc: 0.9426
val Loss: 3.0611 Acc: 0.7500
Epoch 7/97
----------
train Loss: 0.9242 Acc: 0.9569
val Loss: 2.8482 Acc: 0.7955
Epoch 8/97
----------
train Loss: 0.6377 Acc: 0.9856
val Loss: 2.7924 Acc: 0.7955
Epoch 9/97
----------
train Loss: 0.4805 Acc: 0.9904
val Loss: 2.8722 Acc: 0.7955
Epoch 10/97
----------
train Loss: 0.3510 Acc: 1.0000
val Loss: 2.8021 Acc: 0.7955
Epoch 11/97
----------
train Loss: 0.2679 Acc: 1.0000
val Loss: 2.8099 Acc: 0.8182
Epoch 12/97
----------
train Loss: 0.1940 Acc: 0.9904
val Loss: 2.9111 Acc: 0.8182
Epoch 13/97
----------
train Loss: 0.2255 Acc: 0.9904
val Loss: 3.0131 Acc: 0.8182
Epoch 14/97
----------
train Loss: 0.2410 Acc: 0.9904
val Loss: 2.9325 Acc: 0.8182
Epoch 15/97
----------
train Loss: 0.1353 Acc: 1.0000
val Loss: 2.7928 Acc: 0.7955
Epoch 16/97
----------
train Loss: 0.0806 Acc: 1.0000
val Loss: 2.6904 Acc: 0.7955
Epoch 17/97
----------
train Loss: 0.0997 Acc: 0.9952
val Loss: 2.6377 Acc: 0.8409
Epoch 18/97
----------
train Loss: 0.0607 Acc: 1.0000
val Loss: 2.7094 Acc: 0.8182
Epoch 19/97
----------
train Loss: 0.1119 Acc: 1.0000
val Loss: 2.7528 Acc: 0.7955
Epoch 20/97
----------
train Loss: 0.1305 Acc: 0.9952
val Loss: 2.8236 Acc: 0.7955
Epoch 21/97
----------
train Loss: 0.0966 Acc: 0.9952
val Loss: 2.9124 Acc: 0.7955
Epoch 22/97
----------
train Loss: 0.0764 Acc: 1.0000
val Loss: 3.3955 Acc: 0.7500
Epoch 23/97
----------
train Loss: 0.0722 Acc: 1.0000
val Loss: 3.6818 Acc: 0.7273
Epoch 24/97
----------
train Loss: 0.0620 Acc: 1.0000
val Loss: 3.4992 Acc: 0.7273
Epoch 25/97
----------
train Loss: 0.0512 Acc: 1.0000
val Loss: 3.3069 Acc: 0.7727
Epoch 26/97
----------
train Loss: 0.0625 Acc: 1.0000
val Loss: 3.3042 Acc: 0.7955
Epoch 27/97
----------
train Loss: 0.0628 Acc: 1.0000
val Loss: 3.2816 Acc: 0.8182
Epoch 28/97
----------
train Loss: 0.0798 Acc: 0.9952
val Loss: 3.3963 Acc: 0.8182
Epoch 29/97
----------
train Loss: 0.0932 Acc: 0.9904
val Loss: 3.0129 Acc: 0.8409
Epoch 30/97
----------
train Loss: 0.0585 Acc: 0.9952
val Loss: 2.9356 Acc: 0.8182
Epoch 31/97
----------
train Loss: 0.1246 Acc: 0.9904
val Loss: 3.5548 Acc: 0.7727
Epoch 32/97
----------
train Loss: 0.0493 Acc: 1.0000
val Loss: 3.8236 Acc: 0.7273
Epoch 33/97
----------
train Loss: 0.0949 Acc: 0.9952
val Loss: 3.6397 Acc: 0.7727
Epoch 34/97
----------
train Loss: 0.1201 Acc: 0.9904
val Loss: 3.2299 Acc: 0.7727
Epoch 35/97
----------
train Loss: 0.0732 Acc: 1.0000
val Loss: 3.2794 Acc: 0.7727
Epoch 36/97
----------
train Loss: 0.1820 Acc: 0.9904
val Loss: 3.2068 Acc: 0.7955
Epoch 37/97
----------
train Loss: 0.0993 Acc: 0.9952
val Loss: 3.4345 Acc: 0.7955
Epoch 38/97
----------
train Loss: 0.1416 Acc: 0.9904
val Loss: 3.6553 Acc: 0.7500
Epoch 39/97
----------
train Loss: 0.0891 Acc: 0.9952
val Loss: 3.6137 Acc: 0.7273
Epoch 40/97
----------
train Loss: 0.0863 Acc: 1.0000
val Loss: 3.5786 Acc: 0.7273
Epoch 41/97
----------
train Loss: 0.0915 Acc: 0.9952
val Loss: 3.4998 Acc: 0.7045
Epoch 42/97
----------
train Loss: 0.0335 Acc: 1.0000
val Loss: 3.5643 Acc: 0.7045
Epoch 43/97
----------
train Loss: 0.0528 Acc: 0.9952
val Loss: 3.7026 Acc: 0.7273
Epoch 44/97
----------
train Loss: 0.0351 Acc: 1.0000
val Loss: 3.6426 Acc: 0.7273
Epoch 45/97
----------
train Loss: 0.0222 Acc: 1.0000
val Loss: 3.5095 Acc: 0.7273
Epoch 46/97
----------
train Loss: 0.0137 Acc: 1.0000
val Loss: 3.3960 Acc: 0.7045
Epoch 47/97
----------
train Loss: 0.0276 Acc: 1.0000
val Loss: 3.4280 Acc: 0.7045
Epoch 48/97
----------
train Loss: 0.0492 Acc: 0.9904
val Loss: 3.5157 Acc: 0.7273
Epoch 49/97
----------
train Loss: 0.1066 Acc: 0.9904
val Loss: 3.3923 Acc: 0.7273
Epoch 50/97
----------
train Loss: 0.1557 Acc: 0.9856
val Loss: 3.1989 Acc: 0.7045
Epoch 51/97
----------
train Loss: 0.1423 Acc: 0.9809
val Loss: 2.5993 Acc: 0.7500
Epoch 52/97
----------
train Loss: 0.0508 Acc: 1.0000
val Loss: 2.4361 Acc: 0.7273
Epoch 53/97
----------
train Loss: 0.0697 Acc: 0.9952
val Loss: 2.4710 Acc: 0.7273
Epoch 54/97
----------
train Loss: 0.0338 Acc: 1.0000
val Loss: 2.5624 Acc: 0.7273
Epoch 55/97
----------
train Loss: 0.0579 Acc: 0.9904
val Loss: 2.9916 Acc: 0.7045
Epoch 56/97
----------
train Loss: 0.0400 Acc: 1.0000
val Loss: 2.9909 Acc: 0.7273
Epoch 57/97
----------
train Loss: 0.0564 Acc: 0.9952
val Loss: 2.9574 Acc: 0.7273
Epoch 58/97
----------
train Loss: 0.0528 Acc: 0.9952
val Loss: 2.6769 Acc: 0.7500
Epoch 59/97
----------
train Loss: 0.0306 Acc: 1.0000
val Loss: 2.7037 Acc: 0.7727
Epoch 60/97
----------
train Loss: 0.0221 Acc: 1.0000
val Loss: 2.7126 Acc: 0.7727
Epoch 61/97
----------
train Loss: 0.0980 Acc: 0.9904
val Loss: 2.6230 Acc: 0.7500
Epoch 62/97
----------
train Loss: 0.0241 Acc: 0.9952
val Loss: 2.6617 Acc: 0.7045
Epoch 63/97
----------
train Loss: 0.0943 Acc: 0.9904
val Loss: 2.4692 Acc: 0.7273
Epoch 64/97
----------
train Loss: 0.0247 Acc: 1.0000
val Loss: 2.2942 Acc: 0.7273
Epoch 65/97
----------
train Loss: 0.0776 Acc: 1.0000
val Loss: 2.3607 Acc: 0.7727
Epoch 66/97
----------
train Loss: 0.0170 Acc: 1.0000
val Loss: 2.4566 Acc: 0.7500
Epoch 67/97
----------
train Loss: 0.1356 Acc: 0.9856
val Loss: 2.3906 Acc: 0.7727
Epoch 68/97
----------
train Loss: 0.0342 Acc: 1.0000
val Loss: 2.6564 Acc: 0.7500
Epoch 69/97
----------
train Loss: 0.0553 Acc: 1.0000
val Loss: 2.6669 Acc: 0.7500
Epoch 70/97
----------
train Loss: 0.1020 Acc: 0.9904
val Loss: 2.4731 Acc: 0.7727
Epoch 71/97
----------
train Loss: 0.0372 Acc: 1.0000
val Loss: 2.9266 Acc: 0.7273
Epoch 72/97
----------
train Loss: 0.0618 Acc: 0.9952
val Loss: 3.2755 Acc: 0.7727
Epoch 73/97
----------
train Loss: 0.0215 Acc: 1.0000
val Loss: 3.5710 Acc: 0.7500
Epoch 74/97
----------
train Loss: 0.0105 Acc: 1.0000
val Loss: 3.4382 Acc: 0.7500
Epoch 75/97
----------
train Loss: 0.0105 Acc: 1.0000
val Loss: 3.0975 Acc: 0.7727
Epoch 76/97
----------
train Loss: 0.0229 Acc: 0.9952
val Loss: 2.9238 Acc: 0.7955
Epoch 77/97
----------
train Loss: 0.0105 Acc: 1.0000
val Loss: 2.9888 Acc: 0.7500
Epoch 78/97
----------
train Loss: 0.0145 Acc: 1.0000
val Loss: 2.7032 Acc: 0.7727
Epoch 79/97
----------
train Loss: 0.0118 Acc: 1.0000
val Loss: 2.6573 Acc: 0.7727
Epoch 80/97
----------
train Loss: 0.0117 Acc: 1.0000
val Loss: 2.7539 Acc: 0.7955
Epoch 81/97
----------
train Loss: 0.0049 Acc: 1.0000
val Loss: 2.8805 Acc: 0.7727
Epoch 82/97
----------
train Loss: 0.0059 Acc: 1.0000
val Loss: 2.7973 Acc: 0.7955
Epoch 83/97
----------
train Loss: 0.0060 Acc: 1.0000
val Loss: 2.8552 Acc: 0.7955
Epoch 84/97
----------
train Loss: 0.0085 Acc: 1.0000
val Loss: 2.9204 Acc: 0.7955
Epoch 85/97
----------
train Loss: 0.0096 Acc: 1.0000
val Loss: 2.9759 Acc: 0.7955
Epoch 86/97
----------
train Loss: 0.0264 Acc: 1.0000
val Loss: 2.8731 Acc: 0.7727
Epoch 87/97
----------
train Loss: 0.0031 Acc: 1.0000
val Loss: 3.0057 Acc: 0.7727
Epoch 88/97
----------
train Loss: 0.0124 Acc: 1.0000
val Loss: 3.1497 Acc: 0.7955
Epoch 89/97
----------
train Loss: 0.0068 Acc: 1.0000
val Loss: 3.3512 Acc: 0.7500
Epoch 90/97
----------
train Loss: 0.0025 Acc: 1.0000
val Loss: 3.2691 Acc: 0.7727
Epoch 91/97
----------
train Loss: 0.0041 Acc: 1.0000
val Loss: 3.3396 Acc: 0.7727
Epoch 92/97
----------
train Loss: 0.0512 Acc: 0.9952
val Loss: 3.0870 Acc: 0.7727
Epoch 93/97
----------
train Loss: 0.1233 Acc: 0.9904
val Loss: 2.8722 Acc: 0.7273
Epoch 94/97
----------
train Loss: 0.3348 Acc: 0.9809
val Loss: 2.7378 Acc: 0.7500
Epoch 95/97
----------
train Loss: 0.2720 Acc: 0.9761
val Loss: 2.7576 Acc: 0.7727
Epoch 96/97
----------
train Loss: 0.2872 Acc: 0.9761
val Loss: 4.2858 Acc: 0.7727
Epoch 97/97
----------
train Loss: 0.1294 Acc: 0.9952
[32m[I 2025-06-28 11:33:22,218][0m Trial 49 finished with value: 0.8181818181818182 and parameters: {'batch_size': 58, 'lr': 0.0001987856378663648, 'num_epochs': 97, 'weight_decay': 0.008679897399236811, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 5.5735 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_58_lr_0.0001987856378663648_epoch_97_wd_0.008679897399236811_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/93
----------
train Loss: 5.7762 Acc: 0.2679
val Loss: 4.7625 Acc: 0.6364
Epoch 2/93
----------
train Loss: 4.1569 Acc: 0.6699
val Loss: 4.4139 Acc: 0.6591
Epoch 3/93
----------
train Loss: 2.8787 Acc: 0.8038
val Loss: 3.8690 Acc: 0.6364
Epoch 4/93
----------
train Loss: 1.8300 Acc: 0.9043
val Loss: 3.3087 Acc: 0.7273
Epoch 5/93
----------
train Loss: 0.9414 Acc: 0.9761
val Loss: 3.2620 Acc: 0.8182
Epoch 6/93
----------
train Loss: 0.5439 Acc: 0.9904
val Loss: 2.8674 Acc: 0.8182
Epoch 7/93
----------
train Loss: 0.3248 Acc: 0.9809
val Loss: 2.7594 Acc: 0.7500
Epoch 8/93
----------
train Loss: 0.2860 Acc: 0.9856
val Loss: 2.9546 Acc: 0.7273
Epoch 9/93
----------
train Loss: 0.3049 Acc: 0.9856
val Loss: 3.0076 Acc: 0.7500
Epoch 10/93
----------
train Loss: 0.2505 Acc: 0.9904
val Loss: 2.8802 Acc: 0.7500
Epoch 11/93
----------
train Loss: 0.3206 Acc: 0.9904
[32m[I 2025-06-28 11:35:52,473][0m Trial 50 finished with value: 0.8181818181818182 and parameters: {'batch_size': 50, 'lr': 0.00044931649750969794, 'num_epochs': 93, 'weight_decay': 0.0768857066245912, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.8715 Acc: 0.7500
Early stopping at epoch 11 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_50_lr_0.00044931649750969794_epoch_93_wd_0.0768857066245912_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 5.3544 Acc: 0.3684
val Loss: 4.5158 Acc: 0.6591
Epoch 2/88
----------
train Loss: 2.4686 Acc: 0.8278
val Loss: 9.6432 Acc: 0.6591
Epoch 3/88
----------
train Loss: 0.6678 Acc: 0.9617
val Loss: 13.3908 Acc: 0.6364
Epoch 4/88
----------
train Loss: 0.8171 Acc: 0.9378
val Loss: 8.0245 Acc: 0.6364
Epoch 5/88
----------
train Loss: 0.4636 Acc: 0.9522
val Loss: 5.4768 Acc: 0.5909
Epoch 6/88
----------
train Loss: 1.1208 Acc: 0.9378
val Loss: 4.0213 Acc: 0.7273
Epoch 7/88
----------
train Loss: 1.2110 Acc: 0.8756
val Loss: 6.6601 Acc: 0.5227
Epoch 8/88
----------
train Loss: 0.8852 Acc: 0.9187
val Loss: 3.8075 Acc: 0.6364
Epoch 9/88
----------
train Loss: 1.0355 Acc: 0.9091
val Loss: 3.8928 Acc: 0.7273
Epoch 10/88
----------
train Loss: 0.9642 Acc: 0.8900
val Loss: 3.6249 Acc: 0.5909
Epoch 11/88
----------
train Loss: 0.9511 Acc: 0.9139
val Loss: 4.0992 Acc: 0.6818
Epoch 12/88
----------
train Loss: 0.7807 Acc: 0.9378
val Loss: 4.0289 Acc: 0.6591
Epoch 13/88
----------
train Loss: 0.7169 Acc: 0.9378
val Loss: 4.3142 Acc: 0.7045
Epoch 14/88
----------
train Loss: 0.4726 Acc: 0.9474
val Loss: 5.0799 Acc: 0.7045
Epoch 15/88
----------
train Loss: 0.3847 Acc: 0.9761
val Loss: 3.9036 Acc: 0.7273
Epoch 16/88
----------
train Loss: 0.1236 Acc: 0.9809
val Loss: 3.8811 Acc: 0.7500
Epoch 17/88
----------
train Loss: 0.0404 Acc: 1.0000
val Loss: 3.8183 Acc: 0.7955
Epoch 18/88
----------
train Loss: 0.0600 Acc: 1.0000
val Loss: 3.7801 Acc: 0.7500
Epoch 19/88
----------
train Loss: 0.0765 Acc: 0.9952
val Loss: 3.6096 Acc: 0.7273
Epoch 20/88
----------
train Loss: 0.1687 Acc: 0.9809
val Loss: 3.7586 Acc: 0.7273
Epoch 21/88
----------
train Loss: 0.1500 Acc: 0.9904
val Loss: 4.3916 Acc: 0.7500
Epoch 22/88
----------
train Loss: 0.4864 Acc: 0.9378
val Loss: 3.5665 Acc: 0.6818
Epoch 23/88
----------
train Loss: 0.2092 Acc: 0.9952
val Loss: 3.2292 Acc: 0.7500
Epoch 24/88
----------
train Loss: 0.0583 Acc: 1.0000
val Loss: 4.6416 Acc: 0.6818
Epoch 25/88
----------
train Loss: 0.2404 Acc: 0.9904
val Loss: 3.9697 Acc: 0.6591
Epoch 26/88
----------
train Loss: 0.2673 Acc: 0.9809
val Loss: 6.4338 Acc: 0.4773
Epoch 27/88
----------
train Loss: 0.3560 Acc: 0.9569
val Loss: 4.3432 Acc: 0.7045
Epoch 28/88
----------
train Loss: 0.4090 Acc: 0.9713
val Loss: 5.7398 Acc: 0.6136
Epoch 29/88
----------
train Loss: 0.8426 Acc: 0.9043
val Loss: 4.8904 Acc: 0.6136
Epoch 30/88
----------
train Loss: 0.5647 Acc: 0.9569
val Loss: 5.6055 Acc: 0.7273
Epoch 31/88
----------
train Loss: 1.1248 Acc: 0.9617
val Loss: 5.1187 Acc: 0.6818
Epoch 32/88
----------
train Loss: 1.1957 Acc: 0.9378
val Loss: 4.3456 Acc: 0.6591
Epoch 33/88
----------
train Loss: 0.8270 Acc: 0.9426
val Loss: 4.8760 Acc: 0.5682
Epoch 34/88
----------
train Loss: 0.7141 Acc: 0.9378
val Loss: 3.7415 Acc: 0.5909
Epoch 35/88
----------
train Loss: 0.4890 Acc: 0.9665
val Loss: 4.6224 Acc: 0.5227
Epoch 36/88
----------
train Loss: 0.3836 Acc: 0.9522
val Loss: 2.5043 Acc: 0.7045
Epoch 37/88
----------
train Loss: 0.1459 Acc: 0.9904
val Loss: 2.3138 Acc: 0.7955
Epoch 38/88
----------
train Loss: 0.0734 Acc: 1.0000
val Loss: 2.9629 Acc: 0.6591
Epoch 39/88
----------
train Loss: 0.1393 Acc: 0.9904
val Loss: 2.5462 Acc: 0.7955
Epoch 40/88
----------
train Loss: 0.0824 Acc: 0.9904
val Loss: 3.7418 Acc: 0.7955
Epoch 41/88
----------
train Loss: 0.0709 Acc: 0.9952
val Loss: 2.9556 Acc: 0.8182
Epoch 42/88
----------
train Loss: 0.1215 Acc: 0.9809
val Loss: 3.3881 Acc: 0.8409
Epoch 43/88
----------
train Loss: 0.0187 Acc: 1.0000
val Loss: 3.7235 Acc: 0.7955
Epoch 44/88
----------
train Loss: 0.0201 Acc: 1.0000
val Loss: 3.4258 Acc: 0.7955
Epoch 45/88
----------
train Loss: 0.2389 Acc: 0.9665
val Loss: 3.0147 Acc: 0.7727
Epoch 46/88
----------
train Loss: 0.1101 Acc: 0.9856
val Loss: 4.0679 Acc: 0.6818
Epoch 47/88
----------
train Loss: 0.1094 Acc: 0.9809
val Loss: 4.2669 Acc: 0.7500
Epoch 48/88
----------
train Loss: 0.3568 Acc: 0.9761
val Loss: 4.3718 Acc: 0.7045
Epoch 49/88
----------
train Loss: 0.3394 Acc: 0.9617
val Loss: 3.9310 Acc: 0.6591
Epoch 50/88
----------
train Loss: 0.2941 Acc: 0.9522
val Loss: 2.3804 Acc: 0.7045
Epoch 51/88
----------
train Loss: 0.2401 Acc: 0.9761
val Loss: 2.1892 Acc: 0.7955
Epoch 52/88
----------
train Loss: 0.1092 Acc: 0.9904
val Loss: 2.5010 Acc: 0.7955
Epoch 53/88
----------
train Loss: 0.0489 Acc: 1.0000
val Loss: 3.1401 Acc: 0.7500
Epoch 54/88
----------
train Loss: 0.0304 Acc: 1.0000
val Loss: 2.8506 Acc: 0.7500
Epoch 55/88
----------
train Loss: 0.0473 Acc: 1.0000
val Loss: 2.8298 Acc: 0.7273
Epoch 56/88
----------
train Loss: 0.0161 Acc: 1.0000
val Loss: 2.5708 Acc: 0.7727
Epoch 57/88
----------
train Loss: 0.1150 Acc: 0.9904
val Loss: 2.7800 Acc: 0.7273
Epoch 58/88
----------
train Loss: 0.2473 Acc: 0.9856
val Loss: 4.9778 Acc: 0.7727
Epoch 59/88
----------
train Loss: 0.2942 Acc: 0.9665
val Loss: 4.1918 Acc: 0.7955
Epoch 60/88
----------
train Loss: 0.3338 Acc: 0.9904
val Loss: 4.0481 Acc: 0.7500
Epoch 61/88
----------
train Loss: 0.7534 Acc: 0.9617
val Loss: 4.5166 Acc: 0.7500
Epoch 62/88
----------
train Loss: 0.3118 Acc: 0.9904
val Loss: 5.4807 Acc: 0.7500
Epoch 63/88
----------
train Loss: 0.4002 Acc: 0.9761
val Loss: 6.2406 Acc: 0.5227
Epoch 64/88
----------
train Loss: 0.5326 Acc: 0.9330
val Loss: 6.0855 Acc: 0.6136
Epoch 65/88
----------
train Loss: 0.4674 Acc: 0.9569
val Loss: 7.8792 Acc: 0.7273
Epoch 66/88
----------
train Loss: 0.2163 Acc: 0.9761
val Loss: 3.3134 Acc: 0.7273
Epoch 67/88
----------
train Loss: 0.4224 Acc: 0.9665
val Loss: 3.4571 Acc: 0.8182
Epoch 68/88
----------
train Loss: 0.1095 Acc: 1.0000
val Loss: 2.9329 Acc: 0.8182
Epoch 69/88
----------
train Loss: 0.4553 Acc: 0.9856
val Loss: 3.4878 Acc: 0.7955
Epoch 70/88
----------
train Loss: 0.3297 Acc: 0.9713
val Loss: 4.8138 Acc: 0.6818
Epoch 71/88
----------
train Loss: 0.5474 Acc: 0.9617
val Loss: 3.5662 Acc: 0.7500
Epoch 72/88
----------
train Loss: 0.3758 Acc: 0.9617
val Loss: 3.2765 Acc: 0.7727
Epoch 73/88
----------
train Loss: 0.1921 Acc: 0.9761
val Loss: 2.7526 Acc: 0.7273
Epoch 74/88
----------
train Loss: 0.0522 Acc: 1.0000
val Loss: 2.9762 Acc: 0.7045
Epoch 75/88
----------
train Loss: 0.0253 Acc: 1.0000
val Loss: 2.8340 Acc: 0.7727
Epoch 76/88
----------
train Loss: 0.0532 Acc: 1.0000
val Loss: 2.8006 Acc: 0.7727
Epoch 77/88
----------
train Loss: 0.0145 Acc: 1.0000
val Loss: 3.0925 Acc: 0.7500
Epoch 78/88
----------
train Loss: 0.0221 Acc: 1.0000
val Loss: 3.4165 Acc: 0.7045
Epoch 79/88
----------
train Loss: 0.3992 Acc: 0.9761
val Loss: 3.6655 Acc: 0.6818
Epoch 80/88
----------
train Loss: 0.3410 Acc: 0.9617
val Loss: 4.9272 Acc: 0.6364
Epoch 81/88
----------
train Loss: 0.3704 Acc: 0.9809
val Loss: 3.8384 Acc: 0.7045
Epoch 82/88
----------
train Loss: 0.1660 Acc: 0.9761
val Loss: 8.2450 Acc: 0.6136
Epoch 83/88
----------
train Loss: 0.1542 Acc: 0.9904
val Loss: 4.0841 Acc: 0.7273
Epoch 84/88
----------
train Loss: 0.0972 Acc: 0.9952
val Loss: 3.8590 Acc: 0.7955
Epoch 85/88
----------
train Loss: 0.0184 Acc: 1.0000
val Loss: 4.0410 Acc: 0.7500
Epoch 86/88
----------
train Loss: 0.0913 Acc: 0.9952
val Loss: 3.9443 Acc: 0.7273
Epoch 87/88
----------
train Loss: 0.1341 Acc: 0.9761
val Loss: 3.9381 Acc: 0.7273
Epoch 88/88
----------
train Loss: 0.2148 Acc: 0.9809
[32m[I 2025-06-28 11:55:54,550][0m Trial 51 finished with value: 0.7727272727272727 and parameters: {'batch_size': 91, 'lr': 0.0011439368179765768, 'num_epochs': 88, 'weight_decay': 0.005122755609862233, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.9617 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_91_lr_0.0011439368179765768_epoch_88_wd_0.005122755609862233_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 5.3573 Acc: 0.3828
val Loss: 4.5264 Acc: 0.6591
Epoch 2/86
----------
train Loss: 2.4979 Acc: 0.8230
val Loss: 8.1473 Acc: 0.6818
Epoch 3/86
----------
train Loss: 0.7449 Acc: 0.9426
val Loss: 10.6144 Acc: 0.6364
Epoch 4/86
----------
train Loss: 0.9479 Acc: 0.9426
val Loss: 7.0390 Acc: 0.6818
Epoch 5/86
----------
train Loss: 0.5046 Acc: 0.9522
val Loss: 3.9582 Acc: 0.7045
Epoch 6/86
----------
train Loss: 1.1399 Acc: 0.9139
val Loss: 3.8225 Acc: 0.6591
Epoch 7/86
----------
train Loss: 1.0530 Acc: 0.8995
val Loss: 4.4507 Acc: 0.7500
Epoch 8/86
----------
train Loss: 1.2144 Acc: 0.8852
val Loss: 5.5036 Acc: 0.5682
Epoch 9/86
----------
train Loss: 1.0112 Acc: 0.9043
val Loss: 5.0959 Acc: 0.6364
Epoch 10/86
----------
train Loss: 0.8544 Acc: 0.8995
val Loss: 3.2826 Acc: 0.6818
Epoch 11/86
----------
train Loss: 0.5247 Acc: 0.9665
val Loss: 2.5756 Acc: 0.7273
Epoch 12/86
----------
train Loss: 0.3069 Acc: 0.9665
val Loss: 3.9495 Acc: 0.7045
Epoch 13/86
----------
train Loss: 0.8661 Acc: 0.9282
val Loss: 4.6727 Acc: 0.7045
Epoch 14/86
----------
train Loss: 0.7651 Acc: 0.9522
val Loss: 4.8849 Acc: 0.5227
Epoch 15/86
----------
train Loss: 1.0946 Acc: 0.9139
val Loss: 4.3066 Acc: 0.7500
Epoch 16/86
----------
train Loss: 0.5733 Acc: 0.9569
val Loss: 3.9509 Acc: 0.7500
Epoch 17/86
----------
train Loss: 0.7105 Acc: 0.9569
val Loss: 6.0458 Acc: 0.7273
Epoch 18/86
----------
train Loss: 0.4744 Acc: 0.9474
val Loss: 7.0810 Acc: 0.6364
Epoch 19/86
----------
train Loss: 0.9167 Acc: 0.8756
val Loss: 6.6588 Acc: 0.6136
Epoch 20/86
----------
train Loss: 0.5159 Acc: 0.9474
val Loss: 5.5212 Acc: 0.7500
Epoch 21/86
----------
train Loss: 0.5008 Acc: 0.9617
val Loss: 3.6860 Acc: 0.7273
Epoch 22/86
----------
train Loss: 0.7971 Acc: 0.9474
val Loss: 2.8785 Acc: 0.7045
Epoch 23/86
----------
train Loss: 0.5114 Acc: 0.9569
val Loss: 2.7767 Acc: 0.7045
Epoch 24/86
----------
train Loss: 0.6051 Acc: 0.9474
val Loss: 5.0017 Acc: 0.7045
Epoch 25/86
----------
train Loss: 0.3117 Acc: 0.9761
val Loss: 4.4332 Acc: 0.7045
Epoch 26/86
----------
train Loss: 0.3518 Acc: 0.9665
val Loss: 2.7989 Acc: 0.7955
Epoch 27/86
----------
train Loss: 0.2122 Acc: 0.9856
val Loss: 2.9289 Acc: 0.7727
Epoch 28/86
----------
train Loss: 0.1479 Acc: 0.9856
val Loss: 3.4273 Acc: 0.7273
Epoch 29/86
----------
train Loss: 0.8134 Acc: 0.9569
val Loss: 7.5954 Acc: 0.6364
Epoch 30/86
----------
train Loss: 1.5713 Acc: 0.9139
val Loss: 4.4449 Acc: 0.5909
Epoch 31/86
----------
train Loss: 0.5725 Acc: 0.9378
val Loss: 6.7093 Acc: 0.6136
Epoch 32/86
----------
train Loss: 0.5675 Acc: 0.9426
val Loss: 5.8919 Acc: 0.6136
Epoch 33/86
----------
train Loss: 0.4379 Acc: 0.9378
[32m[I 2025-06-28 12:03:25,270][0m Trial 52 finished with value: 0.7272727272727273 and parameters: {'batch_size': 11, 'lr': 0.0012201319964486594, 'num_epochs': 86, 'weight_decay': 0.011116143098681785, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 5.8962 Acc: 0.5455
Early stopping at epoch 33 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_11_lr_0.0012201319964486594_epoch_86_wd_0.011116143098681785_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/100
----------
train Loss: 6.0058 Acc: 0.3158
val Loss: 20.1139 Acc: 0.6364
Epoch 2/100
----------
train Loss: 5.8085 Acc: 0.4115
val Loss: 21.8999 Acc: 0.3182
Epoch 3/100
----------
train Loss: 4.8084 Acc: 0.5550
val Loss: 5.3173 Acc: 0.5455
Epoch 4/100
----------
train Loss: 4.4393 Acc: 0.5646
val Loss: 8.2980 Acc: 0.4318
Epoch 5/100
----------
train Loss: 3.3903 Acc: 0.6890
val Loss: 5.0235 Acc: 0.5682
Epoch 6/100
----------
train Loss: 3.1807 Acc: 0.6986
[32m[I 2025-06-28 12:04:47,321][0m Trial 53 finished with value: 0.6363636363636364 and parameters: {'batch_size': 67, 'lr': 0.004214458175406669, 'num_epochs': 100, 'weight_decay': 0.020725510126860018, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 5.5819 Acc: 0.1818
Early stopping at epoch 6 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.636364

Model weights saved at ./model_weights/efficientnetb0_bs_67_lr_0.004214458175406669_epoch_100_wd_0.020725510126860018_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/96
----------
train Loss: 5.3092 Acc: 0.4211
val Loss: 4.5979 Acc: 0.6818
Epoch 2/96
----------
train Loss: 2.7109 Acc: 0.7895
val Loss: 11.1417 Acc: 0.6591
Epoch 3/96
----------
train Loss: 1.6218 Acc: 0.8565
val Loss: 9.0623 Acc: 0.5227
Epoch 4/96
----------
train Loss: 2.2417 Acc: 0.7943
val Loss: 7.0369 Acc: 0.6818
Epoch 5/96
----------
train Loss: 2.0468 Acc: 0.8421
val Loss: 3.4515 Acc: 0.7045
Epoch 6/96
----------
train Loss: 1.4742 Acc: 0.8660
val Loss: 3.4414 Acc: 0.8182
Epoch 7/96
----------
train Loss: 1.0250 Acc: 0.9043
val Loss: 3.8751 Acc: 0.7727
Epoch 8/96
----------
train Loss: 1.1720 Acc: 0.9043
val Loss: 4.3777 Acc: 0.6818
Epoch 9/96
----------
train Loss: 1.3270 Acc: 0.8612
val Loss: 4.1793 Acc: 0.4773
Epoch 10/96
----------
train Loss: 1.9918 Acc: 0.8230
val Loss: 5.0165 Acc: 0.3636
Epoch 11/96
----------
train Loss: 1.9672 Acc: 0.8038
val Loss: 4.1239 Acc: 0.4318
Epoch 12/96
----------
train Loss: 2.1661 Acc: 0.7943
[32m[I 2025-06-28 12:07:31,482][0m Trial 54 finished with value: 0.7727272727272727 and parameters: {'batch_size': 121, 'lr': 0.0018600444264337743, 'num_epochs': 96, 'weight_decay': 0.028384735541993136, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 4.1766 Acc: 0.3636
Early stopping at epoch 12 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_121_lr_0.0018600444264337743_epoch_96_wd_0.028384735541993136_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/79
----------
train Loss: 0.6818 Acc: 0.2584
val Loss: 0.6538 Acc: 0.3182
Epoch 2/79
----------
train Loss: 0.6267 Acc: 0.4545
val Loss: 0.5995 Acc: 0.5000
Epoch 3/79
----------
train Loss: 0.5834 Acc: 0.4593
val Loss: 0.5293 Acc: 0.6136
Epoch 4/79
----------
train Loss: 0.5491 Acc: 0.5167
val Loss: 0.4811 Acc: 0.6591
Epoch 5/79
----------
train Loss: 0.5229 Acc: 0.5550
val Loss: 0.4511 Acc: 0.6591
Epoch 6/79
----------
train Loss: 0.4883 Acc: 0.5550
val Loss: 0.4199 Acc: 0.6818
Epoch 7/79
----------
train Loss: 0.4563 Acc: 0.6077
val Loss: 0.3951 Acc: 0.7045
Epoch 8/79
----------
train Loss: 0.4587 Acc: 0.5694
val Loss: 0.3704 Acc: 0.7045
Epoch 9/79
----------
train Loss: 0.4453 Acc: 0.6220
val Loss: 0.3561 Acc: 0.7273
Epoch 10/79
----------
train Loss: 0.3734 Acc: 0.7512
val Loss: 0.3444 Acc: 0.6818
Epoch 11/79
----------
train Loss: 0.4083 Acc: 0.6029
val Loss: 0.3329 Acc: 0.7500
Epoch 12/79
----------
train Loss: 0.4145 Acc: 0.6316
val Loss: 0.3340 Acc: 0.7500
Epoch 13/79
----------
train Loss: 0.3731 Acc: 0.7512
val Loss: 0.3153 Acc: 0.7273
Epoch 14/79
----------
train Loss: 0.3424 Acc: 0.7703
val Loss: 0.3035 Acc: 0.7500
Epoch 15/79
----------
train Loss: 0.3663 Acc: 0.7321
val Loss: 0.2973 Acc: 0.7727
Epoch 16/79
----------
train Loss: 0.3591 Acc: 0.7464
val Loss: 0.3015 Acc: 0.7727
Epoch 17/79
----------
train Loss: 0.3438 Acc: 0.7895
val Loss: 0.3060 Acc: 0.7955
Epoch 18/79
----------
train Loss: 0.3232 Acc: 0.7943
val Loss: 0.2935 Acc: 0.7955
Epoch 19/79
----------
train Loss: 0.2997 Acc: 0.8469
val Loss: 0.2823 Acc: 0.7955
Epoch 20/79
----------
train Loss: 0.3222 Acc: 0.8469
val Loss: 0.2690 Acc: 0.7727
Epoch 21/79
----------
train Loss: 0.3302 Acc: 0.7990
val Loss: 0.2589 Acc: 0.7955
Epoch 22/79
----------
train Loss: 0.3044 Acc: 0.8421
val Loss: 0.2574 Acc: 0.7955
Epoch 23/79
----------
train Loss: 0.3181 Acc: 0.8517
val Loss: 0.2542 Acc: 0.7955
Epoch 24/79
----------
train Loss: 0.2535 Acc: 0.9139
val Loss: 0.2385 Acc: 0.8182
Epoch 25/79
----------
train Loss: 0.2856 Acc: 0.9234
val Loss: 0.2439 Acc: 0.7955
Epoch 26/79
----------
train Loss: 0.3009 Acc: 0.9139
val Loss: 0.2515 Acc: 0.7955
Epoch 27/79
----------
train Loss: 0.2433 Acc: 0.9713
val Loss: 0.2697 Acc: 0.7955
Epoch 28/79
----------
train Loss: 0.3074 Acc: 0.8660
val Loss: 0.2681 Acc: 0.7500
Epoch 29/79
----------
train Loss: 0.3330 Acc: 0.7560
val Loss: 0.2615 Acc: 0.7500
Epoch 30/79
----------
train Loss: 0.2820 Acc: 0.8660
val Loss: 0.2445 Acc: 0.7727
Epoch 31/79
----------
train Loss: 0.2403 Acc: 0.9234
val Loss: 0.2340 Acc: 0.7955
Epoch 32/79
----------
train Loss: 0.2733 Acc: 0.8565
val Loss: 0.2335 Acc: 0.8182
Epoch 33/79
----------
train Loss: 0.2865 Acc: 0.8708
val Loss: 0.2363 Acc: 0.7500
Epoch 34/79
----------
train Loss: 0.2750 Acc: 0.9091
val Loss: 0.2445 Acc: 0.7273
Epoch 35/79
----------
train Loss: 0.2173 Acc: 0.9809
val Loss: 0.2618 Acc: 0.7273
Epoch 36/79
----------
train Loss: 0.3284 Acc: 0.8230
val Loss: 0.2693 Acc: 0.7273
Epoch 37/79
----------
train Loss: 0.2680 Acc: 0.8182
[32m[I 2025-06-28 12:15:57,026][0m Trial 55 finished with value: 0.8181818181818182 and parameters: {'batch_size': 43, 'lr': 0.00011391163371021991, 'num_epochs': 79, 'weight_decay': 0.00040516942470311023, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2648 Acc: 0.7273
Early stopping at epoch 37 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_43_lr_0.00011391163371021991_epoch_79_wd_0.00040516942470311023_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 0.6968 Acc: 0.2153
val Loss: 0.6795 Acc: 0.2500
Epoch 2/90
----------
train Loss: 0.6761 Acc: 0.2632
val Loss: 0.6648 Acc: 0.2727
Epoch 3/90
----------
train Loss: 0.6595 Acc: 0.3110
val Loss: 0.6431 Acc: 0.3409
Epoch 4/90
----------
train Loss: 0.6480 Acc: 0.3397
val Loss: 0.6295 Acc: 0.3409
Epoch 5/90
----------
train Loss: 0.6405 Acc: 0.3541
val Loss: 0.6216 Acc: 0.4318
Epoch 6/90
----------
train Loss: 0.6248 Acc: 0.4211
val Loss: 0.6098 Acc: 0.5000
Epoch 7/90
----------
train Loss: 0.6093 Acc: 0.4689
val Loss: 0.5958 Acc: 0.5455
Epoch 8/90
----------
train Loss: 0.5989 Acc: 0.4928
val Loss: 0.5835 Acc: 0.5455
Epoch 9/90
----------
train Loss: 0.5871 Acc: 0.5120
val Loss: 0.5688 Acc: 0.5909
Epoch 10/90
----------
train Loss: 0.5646 Acc: 0.5455
val Loss: 0.5508 Acc: 0.6364
Epoch 11/90
----------
train Loss: 0.5664 Acc: 0.5311
val Loss: 0.5405 Acc: 0.6818
Epoch 12/90
----------
train Loss: 0.5587 Acc: 0.5263
val Loss: 0.5316 Acc: 0.6364
Epoch 13/90
----------
train Loss: 0.5358 Acc: 0.5885
val Loss: 0.5133 Acc: 0.6364
Epoch 14/90
----------
train Loss: 0.5207 Acc: 0.5742
val Loss: 0.5043 Acc: 0.6591
Epoch 15/90
----------
train Loss: 0.5182 Acc: 0.5502
val Loss: 0.4939 Acc: 0.6591
Epoch 16/90
----------
train Loss: 0.5088 Acc: 0.5789
val Loss: 0.4802 Acc: 0.6591
Epoch 17/90
----------
train Loss: 0.4987 Acc: 0.5742
val Loss: 0.4685 Acc: 0.6591
Epoch 18/90
----------
train Loss: 0.4899 Acc: 0.5694
val Loss: 0.4567 Acc: 0.6591
Epoch 19/90
----------
train Loss: 0.4752 Acc: 0.6172
val Loss: 0.4475 Acc: 0.6591
Epoch 20/90
----------
train Loss: 0.4727 Acc: 0.6029
val Loss: 0.4363 Acc: 0.6591
Epoch 21/90
----------
train Loss: 0.4692 Acc: 0.5981
val Loss: 0.4291 Acc: 0.6591
Epoch 22/90
----------
train Loss: 0.4630 Acc: 0.5981
val Loss: 0.4204 Acc: 0.7045
Epoch 23/90
----------
train Loss: 0.4514 Acc: 0.6077
val Loss: 0.4110 Acc: 0.6818
Epoch 24/90
----------
train Loss: 0.4264 Acc: 0.6555
val Loss: 0.3951 Acc: 0.6818
Epoch 25/90
----------
train Loss: 0.4433 Acc: 0.6459
val Loss: 0.3956 Acc: 0.7500
Epoch 26/90
----------
train Loss: 0.4400 Acc: 0.6364
val Loss: 0.3930 Acc: 0.7500
Epoch 27/90
----------
train Loss: 0.4071 Acc: 0.6986
val Loss: 0.3829 Acc: 0.7273
Epoch 28/90
----------
train Loss: 0.4310 Acc: 0.6268
val Loss: 0.3776 Acc: 0.7500
Epoch 29/90
----------
train Loss: 0.4440 Acc: 0.6220
val Loss: 0.3730 Acc: 0.7500
Epoch 30/90
----------
train Loss: 0.4234 Acc: 0.6268
val Loss: 0.3701 Acc: 0.7500
Epoch 31/90
----------
train Loss: 0.3928 Acc: 0.7656
val Loss: 0.3618 Acc: 0.7727
Epoch 32/90
----------
train Loss: 0.4040 Acc: 0.6651
val Loss: 0.3528 Acc: 0.7727
Epoch 33/90
----------
train Loss: 0.4178 Acc: 0.6603
val Loss: 0.3500 Acc: 0.7500
Epoch 34/90
----------
train Loss: 0.3956 Acc: 0.7129
val Loss: 0.3449 Acc: 0.7500
Epoch 35/90
----------
train Loss: 0.3643 Acc: 0.7608
val Loss: 0.3416 Acc: 0.7500
Epoch 36/90
----------
train Loss: 0.4232 Acc: 0.6794
val Loss: 0.3346 Acc: 0.7955
Epoch 37/90
----------
train Loss: 0.3824 Acc: 0.7177
val Loss: 0.3392 Acc: 0.7727
Epoch 38/90
----------
train Loss: 0.3813 Acc: 0.7608
val Loss: 0.3355 Acc: 0.7955
Epoch 39/90
----------
train Loss: 0.3957 Acc: 0.6316
val Loss: 0.3418 Acc: 0.7955
Epoch 40/90
----------
train Loss: 0.3597 Acc: 0.7560
val Loss: 0.3370 Acc: 0.7955
Epoch 41/90
----------
train Loss: 0.4027 Acc: 0.6746
val Loss: 0.3329 Acc: 0.7955
Epoch 42/90
----------
train Loss: 0.3595 Acc: 0.7225
val Loss: 0.3259 Acc: 0.7955
Epoch 43/90
----------
train Loss: 0.3783 Acc: 0.7273
val Loss: 0.3202 Acc: 0.7955
Epoch 44/90
----------
train Loss: 0.3488 Acc: 0.7990
val Loss: 0.3166 Acc: 0.7955
Epoch 45/90
----------
train Loss: 0.2770 Acc: 0.9043
val Loss: 0.3118 Acc: 0.7955
Epoch 46/90
----------
train Loss: 0.4065 Acc: 0.7560
val Loss: 0.3131 Acc: 0.7955
Epoch 47/90
----------
train Loss: 0.3377 Acc: 0.7990
val Loss: 0.3100 Acc: 0.7955
Epoch 48/90
----------
train Loss: 0.3610 Acc: 0.7656
val Loss: 0.3114 Acc: 0.7727
Epoch 49/90
----------
train Loss: 0.3464 Acc: 0.8325
val Loss: 0.3066 Acc: 0.7955
Epoch 50/90
----------
train Loss: 0.3374 Acc: 0.7703
val Loss: 0.3059 Acc: 0.7955
Epoch 51/90
----------
train Loss: 0.2916 Acc: 0.9043
val Loss: 0.2989 Acc: 0.7727
Epoch 52/90
----------
train Loss: 0.3526 Acc: 0.7416
val Loss: 0.3015 Acc: 0.7727
Epoch 53/90
----------
train Loss: 0.3753 Acc: 0.7799
val Loss: 0.2993 Acc: 0.7727
Epoch 54/90
----------
train Loss: 0.2999 Acc: 0.8900
val Loss: 0.2937 Acc: 0.7955
Epoch 55/90
----------
train Loss: 0.3187 Acc: 0.8708
val Loss: 0.2899 Acc: 0.7955
Epoch 56/90
----------
train Loss: 0.3509 Acc: 0.7943
val Loss: 0.2905 Acc: 0.7955
Epoch 57/90
----------
train Loss: 0.3816 Acc: 0.7464
val Loss: 0.2895 Acc: 0.8182
Epoch 58/90
----------
train Loss: 0.3267 Acc: 0.7656
val Loss: 0.2866 Acc: 0.8182
Epoch 59/90
----------
train Loss: 0.3458 Acc: 0.8134
val Loss: 0.2853 Acc: 0.7955
Epoch 60/90
----------
train Loss: 0.3069 Acc: 0.8182
val Loss: 0.2854 Acc: 0.7955
Epoch 61/90
----------
train Loss: 0.3754 Acc: 0.6842
val Loss: 0.2861 Acc: 0.7955
Epoch 62/90
----------
train Loss: 0.3364 Acc: 0.8469
val Loss: 0.2852 Acc: 0.8182
Epoch 63/90
----------
train Loss: 0.2994 Acc: 0.8900
val Loss: 0.2846 Acc: 0.8182
Epoch 64/90
----------
train Loss: 0.2906 Acc: 0.8852
val Loss: 0.2813 Acc: 0.7955
Epoch 65/90
----------
train Loss: 0.3204 Acc: 0.7895
val Loss: 0.2789 Acc: 0.7955
Epoch 66/90
----------
train Loss: 0.3121 Acc: 0.8517
val Loss: 0.2823 Acc: 0.8182
Epoch 67/90
----------
train Loss: 0.3357 Acc: 0.8182
val Loss: 0.2760 Acc: 0.7955
Epoch 68/90
----------
train Loss: 0.2924 Acc: 0.8852
val Loss: 0.2784 Acc: 0.7955
Epoch 69/90
----------
train Loss: 0.2963 Acc: 0.8469
val Loss: 0.2769 Acc: 0.8182
Epoch 70/90
----------
train Loss: 0.3208 Acc: 0.8469
val Loss: 0.2808 Acc: 0.7955
Epoch 71/90
----------
train Loss: 0.3393 Acc: 0.8469
val Loss: 0.2782 Acc: 0.8182
Epoch 72/90
----------
train Loss: 0.3375 Acc: 0.8278
val Loss: 0.2819 Acc: 0.7955
Epoch 73/90
----------
train Loss: 0.2463 Acc: 0.9378
val Loss: 0.2825 Acc: 0.7955
Epoch 74/90
----------
train Loss: 0.3500 Acc: 0.7943
val Loss: 0.2773 Acc: 0.7955
Epoch 75/90
----------
train Loss: 0.2734 Acc: 0.8947
val Loss: 0.2784 Acc: 0.7955
Epoch 76/90
----------
train Loss: 0.2990 Acc: 0.7656
val Loss: 0.2754 Acc: 0.7955
Epoch 77/90
----------
train Loss: 0.3194 Acc: 0.8182
val Loss: 0.2731 Acc: 0.7955
Epoch 78/90
----------
train Loss: 0.2813 Acc: 0.8469
val Loss: 0.2703 Acc: 0.7727
Epoch 79/90
----------
train Loss: 0.3461 Acc: 0.7943
val Loss: 0.2646 Acc: 0.8182
Epoch 80/90
----------
train Loss: 0.3042 Acc: 0.8469
val Loss: 0.2636 Acc: 0.8409
Epoch 81/90
----------
train Loss: 0.3410 Acc: 0.7656
val Loss: 0.2709 Acc: 0.8409
Epoch 82/90
----------
train Loss: 0.2988 Acc: 0.8278
val Loss: 0.2712 Acc: 0.7955
Epoch 83/90
----------
train Loss: 0.2566 Acc: 0.9378
val Loss: 0.2712 Acc: 0.8182
Epoch 84/90
----------
train Loss: 0.3409 Acc: 0.7368
val Loss: 0.2715 Acc: 0.7955
Epoch 85/90
----------
train Loss: 0.2795 Acc: 0.8134
val Loss: 0.2714 Acc: 0.7955
Epoch 86/90
----------
train Loss: 0.2856 Acc: 0.8660
val Loss: 0.2647 Acc: 0.7727
Epoch 87/90
----------
train Loss: 0.3211 Acc: 0.8517
val Loss: 0.2637 Acc: 0.8409
Epoch 88/90
----------
train Loss: 0.3261 Acc: 0.8947
val Loss: 0.2611 Acc: 0.8182
Epoch 89/90
----------
train Loss: 0.3537 Acc: 0.7943
val Loss: 0.2602 Acc: 0.8409
Epoch 90/90
----------
train Loss: 0.2950 Acc: 0.8421
[32m[I 2025-06-28 12:36:25,352][0m Trial 56 finished with value: 0.8181818181818182 and parameters: {'batch_size': 16, 'lr': 3.167860488035217e-05, 'num_epochs': 90, 'weight_decay': 0.00017260845536943152, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2607 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_16_lr_3.167860488035217e-05_epoch_90_wd_0.00017260845536943152_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/93
----------
train Loss: 5.5893 Acc: 0.3397
val Loss: 4.3891 Acc: 0.6818
Epoch 2/93
----------
train Loss: 3.2449 Acc: 0.7703
val Loss: 3.7528 Acc: 0.7500
Epoch 3/93
----------
train Loss: 1.5010 Acc: 0.8947
val Loss: 3.4442 Acc: 0.7727
Epoch 4/93
----------
train Loss: 0.5660 Acc: 0.9809
val Loss: 3.6385 Acc: 0.7727
Epoch 5/93
----------
train Loss: 0.2631 Acc: 0.9856
val Loss: 3.7598 Acc: 0.7045
Epoch 6/93
----------
train Loss: 0.1982 Acc: 0.9952
val Loss: 3.3382 Acc: 0.7045
Epoch 7/93
----------
train Loss: 0.1285 Acc: 1.0000
val Loss: 3.0971 Acc: 0.7045
Epoch 8/93
----------
train Loss: 0.1471 Acc: 1.0000
val Loss: 3.1186 Acc: 0.6136
Epoch 9/93
----------
train Loss: 0.2119 Acc: 0.9856
[32m[I 2025-06-28 12:38:28,590][0m Trial 57 finished with value: 0.7727272727272727 and parameters: {'batch_size': 30, 'lr': 0.0006763780059437863, 'num_epochs': 93, 'weight_decay': 0.041145638986031796, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.3196 Acc: 0.5682
Early stopping at epoch 9 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_30_lr_0.0006763780059437863_epoch_93_wd_0.041145638986031796_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/98
----------
train Loss: 0.7001 Acc: 0.2249
val Loss: 0.6853 Acc: 0.2045
Epoch 2/98
----------
train Loss: 0.6879 Acc: 0.2344
val Loss: 0.6783 Acc: 0.2273
Epoch 3/98
----------
train Loss: 0.6788 Acc: 0.2536
val Loss: 0.6656 Acc: 0.2273
Epoch 4/98
----------
train Loss: 0.6738 Acc: 0.2775
val Loss: 0.6587 Acc: 0.2955
Epoch 5/98
----------
train Loss: 0.6731 Acc: 0.2440
val Loss: 0.6565 Acc: 0.3182
Epoch 6/98
----------
train Loss: 0.6642 Acc: 0.3014
val Loss: 0.6513 Acc: 0.3182
Epoch 7/98
----------
train Loss: 0.6565 Acc: 0.2967
val Loss: 0.6458 Acc: 0.3636
Epoch 8/98
----------
train Loss: 0.6485 Acc: 0.3828
val Loss: 0.6417 Acc: 0.3636
Epoch 9/98
----------
train Loss: 0.6434 Acc: 0.3828
val Loss: 0.6356 Acc: 0.3636
Epoch 10/98
----------
train Loss: 0.6332 Acc: 0.3828
val Loss: 0.6280 Acc: 0.4545
Epoch 11/98
----------
train Loss: 0.6341 Acc: 0.3636
val Loss: 0.6243 Acc: 0.4545
Epoch 12/98
----------
train Loss: 0.6289 Acc: 0.3828
val Loss: 0.6208 Acc: 0.4318
Epoch 13/98
----------
train Loss: 0.6157 Acc: 0.5072
val Loss: 0.6113 Acc: 0.5000
Epoch 14/98
----------
train Loss: 0.6091 Acc: 0.4833
val Loss: 0.6079 Acc: 0.5455
Epoch 15/98
----------
train Loss: 0.6050 Acc: 0.5311
val Loss: 0.6044 Acc: 0.5227
Epoch 16/98
----------
train Loss: 0.5995 Acc: 0.4976
val Loss: 0.5947 Acc: 0.5455
Epoch 17/98
----------
train Loss: 0.5949 Acc: 0.5598
val Loss: 0.5884 Acc: 0.5682
Epoch 18/98
----------
train Loss: 0.5913 Acc: 0.5072
val Loss: 0.5800 Acc: 0.5682
Epoch 19/98
----------
train Loss: 0.5814 Acc: 0.5646
val Loss: 0.5737 Acc: 0.5909
Epoch 20/98
----------
train Loss: 0.5756 Acc: 0.5550
val Loss: 0.5679 Acc: 0.6364
Epoch 21/98
----------
train Loss: 0.5740 Acc: 0.5646
val Loss: 0.5658 Acc: 0.6364
Epoch 22/98
----------
train Loss: 0.5700 Acc: 0.5742
val Loss: 0.5603 Acc: 0.6591
Epoch 23/98
----------
train Loss: 0.5606 Acc: 0.5646
val Loss: 0.5536 Acc: 0.6591
Epoch 24/98
----------
train Loss: 0.5457 Acc: 0.5933
val Loss: 0.5396 Acc: 0.6591
Epoch 25/98
----------
train Loss: 0.5513 Acc: 0.5598
val Loss: 0.5396 Acc: 0.6364
Epoch 26/98
----------
train Loss: 0.5470 Acc: 0.5598
val Loss: 0.5369 Acc: 0.6364
Epoch 27/98
----------
train Loss: 0.5305 Acc: 0.6268
val Loss: 0.5255 Acc: 0.6591
Epoch 28/98
----------
train Loss: 0.5374 Acc: 0.5455
val Loss: 0.5210 Acc: 0.6818
Epoch 29/98
----------
train Loss: 0.5391 Acc: 0.5407
val Loss: 0.5159 Acc: 0.6818
Epoch 30/98
----------
train Loss: 0.5298 Acc: 0.5550
val Loss: 0.5124 Acc: 0.6591
Epoch 31/98
----------
train Loss: 0.5135 Acc: 0.5981
val Loss: 0.5049 Acc: 0.6591
Epoch 32/98
----------
train Loss: 0.5126 Acc: 0.5981
val Loss: 0.5001 Acc: 0.6364
Epoch 33/98
----------
train Loss: 0.5156 Acc: 0.5789
val Loss: 0.4947 Acc: 0.6591
Epoch 34/98
----------
train Loss: 0.5064 Acc: 0.5407
val Loss: 0.4906 Acc: 0.6591
Epoch 35/98
----------
train Loss: 0.4910 Acc: 0.5885
val Loss: 0.4831 Acc: 0.7045
Epoch 36/98
----------
train Loss: 0.5126 Acc: 0.5359
val Loss: 0.4762 Acc: 0.6591
Epoch 37/98
----------
train Loss: 0.4937 Acc: 0.5981
val Loss: 0.4731 Acc: 0.7045
Epoch 38/98
----------
train Loss: 0.4904 Acc: 0.6029
val Loss: 0.4667 Acc: 0.7045
Epoch 39/98
----------
train Loss: 0.4927 Acc: 0.5742
val Loss: 0.4686 Acc: 0.7045
Epoch 40/98
----------
train Loss: 0.4758 Acc: 0.6077
val Loss: 0.4607 Acc: 0.7273
Epoch 41/98
----------
train Loss: 0.4926 Acc: 0.5550
val Loss: 0.4540 Acc: 0.7045
Epoch 42/98
----------
train Loss: 0.4687 Acc: 0.5933
val Loss: 0.4484 Acc: 0.6818
Epoch 43/98
----------
train Loss: 0.4792 Acc: 0.5646
val Loss: 0.4431 Acc: 0.7045
Epoch 44/98
----------
train Loss: 0.4603 Acc: 0.6172
val Loss: 0.4384 Acc: 0.7045
Epoch 45/98
----------
train Loss: 0.4277 Acc: 0.7081
val Loss: 0.4317 Acc: 0.7045
Epoch 46/98
----------
train Loss: 0.4807 Acc: 0.5933
val Loss: 0.4337 Acc: 0.7045
Epoch 47/98
----------
train Loss: 0.4492 Acc: 0.6172
val Loss: 0.4289 Acc: 0.7273
Epoch 48/98
----------
train Loss: 0.4573 Acc: 0.6077
val Loss: 0.4228 Acc: 0.7045
Epoch 49/98
----------
train Loss: 0.4488 Acc: 0.6411
val Loss: 0.4158 Acc: 0.6818
Epoch 50/98
----------
train Loss: 0.4480 Acc: 0.5933
val Loss: 0.4173 Acc: 0.7273
Epoch 51/98
----------
train Loss: 0.4224 Acc: 0.6746
val Loss: 0.4059 Acc: 0.7273
Epoch 52/98
----------
train Loss: 0.4440 Acc: 0.6172
val Loss: 0.4072 Acc: 0.7500
Epoch 53/98
----------
train Loss: 0.4537 Acc: 0.6077
val Loss: 0.4050 Acc: 0.7727
Epoch 54/98
----------
train Loss: 0.4154 Acc: 0.7129
val Loss: 0.4022 Acc: 0.7500
Epoch 55/98
----------
train Loss: 0.4266 Acc: 0.6459
val Loss: 0.3939 Acc: 0.7727
Epoch 56/98
----------
train Loss: 0.4377 Acc: 0.6316
val Loss: 0.3941 Acc: 0.7727
Epoch 57/98
----------
train Loss: 0.4516 Acc: 0.5933
val Loss: 0.3898 Acc: 0.7500
Epoch 58/98
----------
train Loss: 0.4210 Acc: 0.6699
val Loss: 0.3909 Acc: 0.7500
Epoch 59/98
----------
train Loss: 0.4333 Acc: 0.6316
val Loss: 0.3872 Acc: 0.7500
Epoch 60/98
----------
train Loss: 0.4189 Acc: 0.6555
val Loss: 0.3838 Acc: 0.7500
Epoch 61/98
----------
train Loss: 0.4459 Acc: 0.6077
val Loss: 0.3802 Acc: 0.7273
Epoch 62/98
----------
train Loss: 0.4231 Acc: 0.6842
val Loss: 0.3787 Acc: 0.7273
Epoch 63/98
----------
train Loss: 0.4018 Acc: 0.7273
val Loss: 0.3745 Acc: 0.7500
Epoch 64/98
----------
train Loss: 0.4025 Acc: 0.6986
val Loss: 0.3731 Acc: 0.7500
Epoch 65/98
----------
train Loss: 0.4161 Acc: 0.6746
val Loss: 0.3665 Acc: 0.7727
Epoch 66/98
----------
train Loss: 0.4077 Acc: 0.6842
val Loss: 0.3649 Acc: 0.7500
Epoch 67/98
----------
train Loss: 0.4191 Acc: 0.7081
val Loss: 0.3610 Acc: 0.7500
Epoch 68/98
----------
train Loss: 0.3941 Acc: 0.7177
val Loss: 0.3554 Acc: 0.7500
Epoch 69/98
----------
train Loss: 0.3952 Acc: 0.7416
val Loss: 0.3567 Acc: 0.7727
Epoch 70/98
----------
train Loss: 0.4069 Acc: 0.7033
val Loss: 0.3570 Acc: 0.7727
Epoch 71/98
----------
train Loss: 0.4222 Acc: 0.6651
val Loss: 0.3548 Acc: 0.7500
Epoch 72/98
----------
train Loss: 0.4163 Acc: 0.6699
val Loss: 0.3572 Acc: 0.7500
Epoch 73/98
----------
train Loss: 0.3637 Acc: 0.7895
val Loss: 0.3535 Acc: 0.7727
Epoch 74/98
----------
train Loss: 0.4270 Acc: 0.6651
val Loss: 0.3488 Acc: 0.7727
Epoch 75/98
----------
train Loss: 0.3772 Acc: 0.7368
val Loss: 0.3486 Acc: 0.7727
Epoch 76/98
----------
train Loss: 0.3936 Acc: 0.6746
val Loss: 0.3443 Acc: 0.7727
Epoch 77/98
----------
train Loss: 0.4040 Acc: 0.7321
val Loss: 0.3428 Acc: 0.7500
Epoch 78/98
----------
train Loss: 0.3783 Acc: 0.7464
val Loss: 0.3409 Acc: 0.7727
Epoch 79/98
----------
train Loss: 0.4179 Acc: 0.6411
val Loss: 0.3368 Acc: 0.7727
Epoch 80/98
----------
train Loss: 0.3905 Acc: 0.6938
val Loss: 0.3350 Acc: 0.7727
Epoch 81/98
----------
train Loss: 0.4163 Acc: 0.6842
val Loss: 0.3387 Acc: 0.7955
Epoch 82/98
----------
train Loss: 0.3794 Acc: 0.7321
val Loss: 0.3382 Acc: 0.7955
Epoch 83/98
----------
train Loss: 0.3507 Acc: 0.8134
val Loss: 0.3363 Acc: 0.8182
Epoch 84/98
----------
train Loss: 0.4098 Acc: 0.6603
val Loss: 0.3371 Acc: 0.8182
Epoch 85/98
----------
train Loss: 0.3751 Acc: 0.7081
val Loss: 0.3329 Acc: 0.8182
Epoch 86/98
----------
train Loss: 0.3706 Acc: 0.7464
val Loss: 0.3281 Acc: 0.8182
Epoch 87/98
----------
train Loss: 0.3900 Acc: 0.7321
val Loss: 0.3280 Acc: 0.8182
Epoch 88/98
----------
train Loss: 0.3986 Acc: 0.7368
val Loss: 0.3248 Acc: 0.8182
Epoch 89/98
----------
train Loss: 0.4076 Acc: 0.7033
val Loss: 0.3258 Acc: 0.7955
Epoch 90/98
----------
train Loss: 0.3742 Acc: 0.7608
val Loss: 0.3250 Acc: 0.8182
Epoch 91/98
----------
train Loss: 0.3523 Acc: 0.8038
val Loss: 0.3267 Acc: 0.8182
Epoch 92/98
----------
train Loss: 0.3584 Acc: 0.8038
val Loss: 0.3262 Acc: 0.7955
Epoch 93/98
----------
train Loss: 0.3756 Acc: 0.7368
val Loss: 0.3205 Acc: 0.8182
Epoch 94/98
----------
train Loss: 0.3294 Acc: 0.8756
val Loss: 0.3172 Acc: 0.8182
Epoch 95/98
----------
train Loss: 0.3645 Acc: 0.7990
val Loss: 0.3184 Acc: 0.8182
Epoch 96/98
----------
train Loss: 0.2979 Acc: 0.9091
val Loss: 0.3153 Acc: 0.8182
Epoch 97/98
----------
train Loss: 0.3443 Acc: 0.7895
val Loss: 0.3108 Acc: 0.8182
Epoch 98/98
----------
train Loss: 0.3583 Acc: 0.8134
[32m[I 2025-06-28 13:00:45,246][0m Trial 58 finished with value: 0.8181818181818182 and parameters: {'batch_size': 76, 'lr': 1.4646694406590443e-05, 'num_epochs': 98, 'weight_decay': 0.0002736112761080469, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3115 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_76_lr_1.4646694406590443e-05_epoch_98_wd_0.0002736112761080469_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 3.1886 Acc: 0.3876
val Loss: 3.4258 Acc: 0.5455
Epoch 2/83
----------
train Loss: 2.5237 Acc: 0.4976
val Loss: 3.8196 Acc: 0.3864
Epoch 3/83
----------
train Loss: 2.3880 Acc: 0.5072
val Loss: 5.0854 Acc: 0.1364
Epoch 4/83
----------
train Loss: 2.2715 Acc: 0.5215
val Loss: 6.1038 Acc: 0.1364
Epoch 5/83
----------
train Loss: 2.2401 Acc: 0.5598
val Loss: 6.7594 Acc: 0.1364
Epoch 6/83
----------
train Loss: 2.1389 Acc: 0.6124
[32m[I 2025-06-28 13:02:08,110][0m Trial 59 finished with value: 0.5454545454545454 and parameters: {'batch_size': 24, 'lr': 0.0009697440151078916, 'num_epochs': 83, 'weight_decay': 0.1919688862935219, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 6.7637 Acc: 0.1364
Early stopping at epoch 6 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.545455

Model weights saved at ./model_weights/efficientnetb0_bs_24_lr_0.0009697440151078916_epoch_83_wd_0.1919688862935219_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 5.5387 Acc: 0.3732
val Loss: 4.6645 Acc: 0.7045
Epoch 2/86
----------
train Loss: 3.0269 Acc: 0.7321
val Loss: 5.1106 Acc: 0.1364
Epoch 3/86
----------
train Loss: 2.3327 Acc: 0.7751
val Loss: 5.3639 Acc: 0.1364
Epoch 4/86
----------
train Loss: 4.1333 Acc: 0.6077
val Loss: 5.5414 Acc: 0.1364
Epoch 5/86
----------
train Loss: 4.5891 Acc: 0.5072
val Loss: 5.4563 Acc: 0.1364
Epoch 6/86
----------
train Loss: 4.0056 Acc: 0.5694
[32m[I 2025-06-28 13:03:29,983][0m Trial 60 finished with value: 0.7045454545454546 and parameters: {'batch_size': 98, 'lr': 0.002466072486886152, 'num_epochs': 86, 'weight_decay': 0.31214224262918044, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 5.2110 Acc: 0.1136
Early stopping at epoch 6 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.704545

Model weights saved at ./model_weights/efficientnetb0_bs_98_lr_0.002466072486886152_epoch_86_wd_0.31214224262918044_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/94
----------
train Loss: 0.6767 Acc: 0.2775
val Loss: 0.6451 Acc: 0.3636
Epoch 2/94
----------
train Loss: 0.6117 Acc: 0.4928
val Loss: 0.5766 Acc: 0.5455
Epoch 3/94
----------
train Loss: 0.5621 Acc: 0.5024
val Loss: 0.4943 Acc: 0.6591
Epoch 4/94
----------
train Loss: 0.5244 Acc: 0.5311
val Loss: 0.4449 Acc: 0.6591
Epoch 5/94
----------
train Loss: 0.4977 Acc: 0.5598
val Loss: 0.4164 Acc: 0.6818
Epoch 6/94
----------
train Loss: 0.4639 Acc: 0.5646
val Loss: 0.3884 Acc: 0.6818
Epoch 7/94
----------
train Loss: 0.4321 Acc: 0.6316
val Loss: 0.3661 Acc: 0.7273
Epoch 8/94
----------
train Loss: 0.4399 Acc: 0.5933
val Loss: 0.3412 Acc: 0.7273
Epoch 9/94
----------
train Loss: 0.4284 Acc: 0.6459
val Loss: 0.3308 Acc: 0.7500
Epoch 10/94
----------
train Loss: 0.3432 Acc: 0.7847
val Loss: 0.3229 Acc: 0.7273
Epoch 11/94
----------
train Loss: 0.3901 Acc: 0.6603
val Loss: 0.3125 Acc: 0.7500
Epoch 12/94
----------
train Loss: 0.3947 Acc: 0.6364
val Loss: 0.3207 Acc: 0.7500
Epoch 13/94
----------
train Loss: 0.3520 Acc: 0.7943
val Loss: 0.2978 Acc: 0.7500
Epoch 14/94
----------
train Loss: 0.3182 Acc: 0.7895
val Loss: 0.2859 Acc: 0.7273
Epoch 15/94
----------
train Loss: 0.3459 Acc: 0.7512
val Loss: 0.2860 Acc: 0.7045
Epoch 16/94
----------
train Loss: 0.3399 Acc: 0.7656
val Loss: 0.2996 Acc: 0.7727
Epoch 17/94
----------
train Loss: 0.3227 Acc: 0.8230
val Loss: 0.3088 Acc: 0.7955
Epoch 18/94
----------
train Loss: 0.3045 Acc: 0.8230
val Loss: 0.2859 Acc: 0.8182
Epoch 19/94
----------
train Loss: 0.2789 Acc: 0.8900
val Loss: 0.2659 Acc: 0.8182
Epoch 20/94
----------
train Loss: 0.3029 Acc: 0.8565
val Loss: 0.2545 Acc: 0.8182
Epoch 21/94
----------
train Loss: 0.3131 Acc: 0.8421
val Loss: 0.2513 Acc: 0.8182
Epoch 22/94
----------
train Loss: 0.2861 Acc: 0.8517
val Loss: 0.2500 Acc: 0.7727
Epoch 23/94
----------
train Loss: 0.3064 Acc: 0.8660
val Loss: 0.2443 Acc: 0.7955
Epoch 24/94
----------
train Loss: 0.2354 Acc: 0.9282
val Loss: 0.2270 Acc: 0.7955
Epoch 25/94
----------
train Loss: 0.2720 Acc: 0.9330
val Loss: 0.2353 Acc: 0.7955
Epoch 26/94
----------
train Loss: 0.2907 Acc: 0.9282
val Loss: 0.2487 Acc: 0.7955
Epoch 27/94
----------
train Loss: 0.2353 Acc: 0.9809
val Loss: 0.2716 Acc: 0.7955
Epoch 28/94
----------
train Loss: 0.2973 Acc: 0.8708
val Loss: 0.2656 Acc: 0.7273
Epoch 29/94
----------
train Loss: 0.3253 Acc: 0.7608
val Loss: 0.2517 Acc: 0.7500
Epoch 30/94
----------
train Loss: 0.2752 Acc: 0.8756
val Loss: 0.2372 Acc: 0.7955
Epoch 31/94
----------
train Loss: 0.2345 Acc: 0.9234
val Loss: 0.2290 Acc: 0.7955
Epoch 32/94
----------
train Loss: 0.2655 Acc: 0.8660
val Loss: 0.2295 Acc: 0.8182
Epoch 33/94
----------
train Loss: 0.2766 Acc: 0.8900
val Loss: 0.2351 Acc: 0.7955
Epoch 34/94
----------
train Loss: 0.2696 Acc: 0.9234
val Loss: 0.2430 Acc: 0.7500
Epoch 35/94
----------
train Loss: 0.2106 Acc: 0.9904
val Loss: 0.2640 Acc: 0.7273
Epoch 36/94
----------
train Loss: 0.3220 Acc: 0.8230
val Loss: 0.2708 Acc: 0.7273
Epoch 37/94
----------
train Loss: 0.2643 Acc: 0.8230
val Loss: 0.2644 Acc: 0.7500
Epoch 38/94
----------
train Loss: 0.2683 Acc: 0.9426
val Loss: 0.2507 Acc: 0.8409
Epoch 39/94
----------
train Loss: 0.2886 Acc: 0.8086
val Loss: 0.2530 Acc: 0.7727
Epoch 40/94
----------
train Loss: 0.2362 Acc: 0.9091
val Loss: 0.2554 Acc: 0.7955
Epoch 41/94
----------
train Loss: 0.3318 Acc: 0.7273
val Loss: 0.2480 Acc: 0.8182
Epoch 42/94
----------
train Loss: 0.2315 Acc: 0.8852
val Loss: 0.2502 Acc: 0.7727
Epoch 43/94
----------
train Loss: 0.2632 Acc: 0.8756
val Loss: 0.2453 Acc: 0.8182
Epoch 44/94
----------
train Loss: 0.2523 Acc: 0.8900
val Loss: 0.2576 Acc: 0.8182
Epoch 45/94
----------
train Loss: 0.1547 Acc: 0.9809
val Loss: 0.2539 Acc: 0.7500
Epoch 46/94
----------
train Loss: 0.3473 Acc: 0.8182
val Loss: 0.2568 Acc: 0.7955
Epoch 47/94
----------
train Loss: 0.2386 Acc: 0.9330
val Loss: 0.2497 Acc: 0.7955
Epoch 48/94
----------
train Loss: 0.2751 Acc: 0.8660
val Loss: 0.2544 Acc: 0.7727
Epoch 49/94
----------
train Loss: 0.2658 Acc: 0.9665
val Loss: 0.2662 Acc: 0.7727
Epoch 50/94
----------
train Loss: 0.2534 Acc: 0.9043
val Loss: 0.2699 Acc: 0.7500
Epoch 51/94
----------
train Loss: 0.1932 Acc: 0.9952
val Loss: 0.2541 Acc: 0.7500
Epoch 52/94
----------
train Loss: 0.2725 Acc: 0.8373
val Loss: 0.2459 Acc: 0.7727
Epoch 53/94
----------
train Loss: 0.3112 Acc: 0.9139
val Loss: 0.2423 Acc: 0.7727
Epoch 54/94
----------
train Loss: 0.2250 Acc: 0.9474
val Loss: 0.2491 Acc: 0.7727
Epoch 55/94
----------
train Loss: 0.2380 Acc: 0.9330
val Loss: 0.2686 Acc: 0.7500
Epoch 56/94
----------
train Loss: 0.2847 Acc: 0.9234
val Loss: 0.2667 Acc: 0.7500
Epoch 57/94
----------
train Loss: 0.3144 Acc: 0.8565
val Loss: 0.2683 Acc: 0.7500
Epoch 58/94
----------
train Loss: 0.2557 Acc: 0.8086
val Loss: 0.2606 Acc: 0.8182
Epoch 59/94
----------
train Loss: 0.2645 Acc: 0.9091
val Loss: 0.2713 Acc: 0.7727
Epoch 60/94
----------
train Loss: 0.2166 Acc: 0.9139
val Loss: 0.2727 Acc: 0.7727
Epoch 61/94
----------
train Loss: 0.3108 Acc: 0.7799
val Loss: 0.2729 Acc: 0.7273
Epoch 62/94
----------
train Loss: 0.2818 Acc: 0.9569
val Loss: 0.2703 Acc: 0.7500
Epoch 63/94
----------
train Loss: 0.2422 Acc: 0.9426
val Loss: 0.2737 Acc: 0.7500
Epoch 64/94
----------
train Loss: 0.2249 Acc: 0.9617
val Loss: 0.2718 Acc: 0.7727
Epoch 65/94
----------
train Loss: 0.2535 Acc: 0.8756
val Loss: 0.2770 Acc: 0.7273
Epoch 66/94
----------
train Loss: 0.2530 Acc: 0.9091
val Loss: 0.2813 Acc: 0.7727
Epoch 67/94
----------
train Loss: 0.2838 Acc: 0.8852
val Loss: 0.2689 Acc: 0.7727
Epoch 68/94
----------
train Loss: 0.2410 Acc: 0.9043
val Loss: 0.2692 Acc: 0.7500
Epoch 69/94
----------
train Loss: 0.2328 Acc: 0.9043
val Loss: 0.2664 Acc: 0.7727
Epoch 70/94
----------
train Loss: 0.2681 Acc: 0.9043
val Loss: 0.2715 Acc: 0.7500
Epoch 71/94
----------
train Loss: 0.2806 Acc: 0.9426
val Loss: 0.2618 Acc: 0.7727
Epoch 72/94
----------
train Loss: 0.2778 Acc: 0.8804
val Loss: 0.2661 Acc: 0.7955
Epoch 73/94
----------
train Loss: 0.2035 Acc: 0.9713
val Loss: 0.2702 Acc: 0.7955
Epoch 74/94
----------
train Loss: 0.2907 Acc: 0.9139
val Loss: 0.2698 Acc: 0.7727
Epoch 75/94
----------
train Loss: 0.2179 Acc: 0.9809
val Loss: 0.2654 Acc: 0.7955
Epoch 76/94
----------
train Loss: 0.2249 Acc: 0.8900
val Loss: 0.2586 Acc: 0.7500
Epoch 77/94
----------
train Loss: 0.2726 Acc: 0.8900
val Loss: 0.2674 Acc: 0.7500
Epoch 78/94
----------
train Loss: 0.2393 Acc: 0.9139
val Loss: 0.2867 Acc: 0.7955
Epoch 79/94
----------
train Loss: 0.2796 Acc: 0.9139
val Loss: 0.2770 Acc: 0.8182
Epoch 80/94
----------
train Loss: 0.2564 Acc: 0.8756
val Loss: 0.2784 Acc: 0.7955
Epoch 81/94
----------
train Loss: 0.2944 Acc: 0.8373
val Loss: 0.2892 Acc: 0.8182
Epoch 82/94
----------
train Loss: 0.2489 Acc: 0.8947
val Loss: 0.2960 Acc: 0.7273
Epoch 83/94
----------
train Loss: 0.2260 Acc: 0.9665
val Loss: 0.2916 Acc: 0.7273
Epoch 84/94
----------
train Loss: 0.2836 Acc: 0.8134
val Loss: 0.2797 Acc: 0.7045
Epoch 85/94
----------
train Loss: 0.2270 Acc: 0.8900
val Loss: 0.2806 Acc: 0.7273
Epoch 86/94
----------
train Loss: 0.2386 Acc: 0.9043
[32m[I 2025-06-28 13:23:03,605][0m Trial 61 finished with value: 0.8181818181818182 and parameters: {'batch_size': 16, 'lr': 0.00014653705897717004, 'num_epochs': 94, 'weight_decay': 0.0010305871486245382, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2682 Acc: 0.7500
Early stopping at epoch 86 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_16_lr_0.00014653705897717004_epoch_94_wd_0.0010305871486245382_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 0.6930 Acc: 0.2344
val Loss: 0.6733 Acc: 0.2955
Epoch 2/90
----------
train Loss: 0.6634 Acc: 0.3110
val Loss: 0.6500 Acc: 0.3409
Epoch 3/90
----------
train Loss: 0.6392 Acc: 0.3828
val Loss: 0.6178 Acc: 0.4318
Epoch 4/90
----------
train Loss: 0.6212 Acc: 0.4306
val Loss: 0.5954 Acc: 0.4545
Epoch 5/90
----------
train Loss: 0.6073 Acc: 0.4737
val Loss: 0.5806 Acc: 0.5227
Epoch 6/90
----------
train Loss: 0.5846 Acc: 0.4976
val Loss: 0.5591 Acc: 0.6136
Epoch 7/90
----------
train Loss: 0.5612 Acc: 0.5598
val Loss: 0.5350 Acc: 0.6136
Epoch 8/90
----------
train Loss: 0.5502 Acc: 0.5359
val Loss: 0.5133 Acc: 0.6818
Epoch 9/90
----------
train Loss: 0.5339 Acc: 0.5694
val Loss: 0.4919 Acc: 0.6818
Epoch 10/90
----------
train Loss: 0.4986 Acc: 0.5789
val Loss: 0.4709 Acc: 0.6591
Epoch 11/90
----------
train Loss: 0.5049 Acc: 0.5550
val Loss: 0.4556 Acc: 0.6818
Epoch 12/90
----------
train Loss: 0.5003 Acc: 0.5646
val Loss: 0.4466 Acc: 0.6818
Epoch 13/90
----------
train Loss: 0.4692 Acc: 0.6172
val Loss: 0.4282 Acc: 0.6818
Epoch 14/90
----------
train Loss: 0.4492 Acc: 0.6124
val Loss: 0.4165 Acc: 0.6818
Epoch 15/90
----------
train Loss: 0.4544 Acc: 0.5981
val Loss: 0.4054 Acc: 0.7273
Epoch 16/90
----------
train Loss: 0.4450 Acc: 0.6220
val Loss: 0.3943 Acc: 0.7045
Epoch 17/90
----------
train Loss: 0.4339 Acc: 0.6220
val Loss: 0.3847 Acc: 0.7045
Epoch 18/90
----------
train Loss: 0.4209 Acc: 0.6651
val Loss: 0.3731 Acc: 0.7273
Epoch 19/90
----------
train Loss: 0.4030 Acc: 0.7177
val Loss: 0.3664 Acc: 0.7500
Epoch 20/90
----------
train Loss: 0.4096 Acc: 0.7081
val Loss: 0.3550 Acc: 0.7500
Epoch 21/90
----------
train Loss: 0.4072 Acc: 0.6938
val Loss: 0.3460 Acc: 0.7500
Epoch 22/90
----------
train Loss: 0.3987 Acc: 0.6842
val Loss: 0.3401 Acc: 0.7500
Epoch 23/90
----------
train Loss: 0.3926 Acc: 0.7129
val Loss: 0.3311 Acc: 0.7955
Epoch 24/90
----------
train Loss: 0.3563 Acc: 0.7847
val Loss: 0.3172 Acc: 0.7727
Epoch 25/90
----------
train Loss: 0.3788 Acc: 0.7177
val Loss: 0.3195 Acc: 0.7955
Epoch 26/90
----------
train Loss: 0.3815 Acc: 0.7656
val Loss: 0.3183 Acc: 0.7955
Epoch 27/90
----------
train Loss: 0.3344 Acc: 0.8565
val Loss: 0.3153 Acc: 0.8182
Epoch 28/90
----------
train Loss: 0.3780 Acc: 0.7560
val Loss: 0.3129 Acc: 0.7955
Epoch 29/90
----------
train Loss: 0.3978 Acc: 0.6794
val Loss: 0.3120 Acc: 0.8182
Epoch 30/90
----------
train Loss: 0.3628 Acc: 0.7225
val Loss: 0.3067 Acc: 0.7955
Epoch 31/90
----------
train Loss: 0.3212 Acc: 0.8469
val Loss: 0.2976 Acc: 0.7727
Epoch 32/90
----------
train Loss: 0.3442 Acc: 0.7656
val Loss: 0.2904 Acc: 0.7727
Epoch 33/90
----------
train Loss: 0.3633 Acc: 0.7751
val Loss: 0.2899 Acc: 0.7727
Epoch 34/90
----------
train Loss: 0.3365 Acc: 0.8325
val Loss: 0.2879 Acc: 0.7727
Epoch 35/90
----------
train Loss: 0.2897 Acc: 0.9043
val Loss: 0.2905 Acc: 0.7955
Epoch 36/90
----------
train Loss: 0.3761 Acc: 0.7321
val Loss: 0.2873 Acc: 0.7955
Epoch 37/90
----------
train Loss: 0.3206 Acc: 0.7895
val Loss: 0.2937 Acc: 0.7727
Epoch 38/90
----------
train Loss: 0.3191 Acc: 0.9139
val Loss: 0.2887 Acc: 0.7955
Epoch 39/90
----------
train Loss: 0.3471 Acc: 0.7321
val Loss: 0.2955 Acc: 0.7500
Epoch 40/90
----------
train Loss: 0.2935 Acc: 0.8373
val Loss: 0.2914 Acc: 0.7500
Epoch 41/90
----------
train Loss: 0.3622 Acc: 0.7273
val Loss: 0.2850 Acc: 0.7955
Epoch 42/90
----------
train Loss: 0.2975 Acc: 0.8038
val Loss: 0.2766 Acc: 0.7955
Epoch 43/90
----------
train Loss: 0.3199 Acc: 0.8182
val Loss: 0.2731 Acc: 0.7955
Epoch 44/90
----------
train Loss: 0.2920 Acc: 0.8517
val Loss: 0.2727 Acc: 0.8182
Epoch 45/90
----------
train Loss: 0.1993 Acc: 0.9569
val Loss: 0.2710 Acc: 0.7955
Epoch 46/90
----------
train Loss: 0.3730 Acc: 0.8086
val Loss: 0.2737 Acc: 0.8182
Epoch 47/90
----------
train Loss: 0.2821 Acc: 0.8708
val Loss: 0.2693 Acc: 0.8182
Epoch 48/90
----------
train Loss: 0.3134 Acc: 0.7943
val Loss: 0.2725 Acc: 0.8182
Epoch 49/90
----------
train Loss: 0.2971 Acc: 0.8947
val Loss: 0.2712 Acc: 0.7955
Epoch 50/90
----------
train Loss: 0.2888 Acc: 0.8421
val Loss: 0.2720 Acc: 0.7955
Epoch 51/90
----------
train Loss: 0.2232 Acc: 0.9761
val Loss: 0.2664 Acc: 0.7955
Epoch 52/90
----------
train Loss: 0.3047 Acc: 0.7751
val Loss: 0.2686 Acc: 0.7727
Epoch 53/90
----------
train Loss: 0.3369 Acc: 0.8900
val Loss: 0.2664 Acc: 0.7727
Epoch 54/90
----------
train Loss: 0.2507 Acc: 0.9234
val Loss: 0.2599 Acc: 0.7955
Epoch 55/90
----------
train Loss: 0.2673 Acc: 0.9234
val Loss: 0.2598 Acc: 0.7955
Epoch 56/90
----------
train Loss: 0.3107 Acc: 0.8612
val Loss: 0.2603 Acc: 0.7727
Epoch 57/90
----------
train Loss: 0.3466 Acc: 0.8038
val Loss: 0.2585 Acc: 0.8182
Epoch 58/90
----------
train Loss: 0.2883 Acc: 0.7943
val Loss: 0.2559 Acc: 0.8182
Epoch 59/90
----------
train Loss: 0.2999 Acc: 0.8469
val Loss: 0.2552 Acc: 0.7955
Epoch 60/90
----------
train Loss: 0.2534 Acc: 0.8565
val Loss: 0.2581 Acc: 0.7955
Epoch 61/90
----------
train Loss: 0.3412 Acc: 0.7368
val Loss: 0.2606 Acc: 0.7955
Epoch 62/90
----------
train Loss: 0.3025 Acc: 0.9282
val Loss: 0.2603 Acc: 0.7727
Epoch 63/90
----------
train Loss: 0.2613 Acc: 0.9330
val Loss: 0.2601 Acc: 0.7727
Epoch 64/90
----------
train Loss: 0.2486 Acc: 0.9234
val Loss: 0.2582 Acc: 0.7955
Epoch 65/90
----------
train Loss: 0.2829 Acc: 0.8182
val Loss: 0.2605 Acc: 0.7955
Epoch 66/90
----------
train Loss: 0.2745 Acc: 0.8947
val Loss: 0.2644 Acc: 0.7955
Epoch 67/90
----------
train Loss: 0.3078 Acc: 0.8565
val Loss: 0.2583 Acc: 0.8182
Epoch 68/90
----------
train Loss: 0.2574 Acc: 0.8947
val Loss: 0.2614 Acc: 0.7955
Epoch 69/90
----------
train Loss: 0.2572 Acc: 0.8852
val Loss: 0.2590 Acc: 0.8182
Epoch 70/90
----------
train Loss: 0.2900 Acc: 0.8995
val Loss: 0.2605 Acc: 0.7955
Epoch 71/90
----------
train Loss: 0.3044 Acc: 0.9091
val Loss: 0.2584 Acc: 0.7727
Epoch 72/90
----------
train Loss: 0.3062 Acc: 0.8756
val Loss: 0.2640 Acc: 0.7727
Epoch 73/90
----------
train Loss: 0.2169 Acc: 0.9617
val Loss: 0.2683 Acc: 0.7500
Epoch 74/90
----------
train Loss: 0.3194 Acc: 0.8517
val Loss: 0.2626 Acc: 0.7727
Epoch 75/90
----------
train Loss: 0.2379 Acc: 0.9330
val Loss: 0.2617 Acc: 0.7273
Epoch 76/90
----------
train Loss: 0.2597 Acc: 0.8182
val Loss: 0.2587 Acc: 0.7727
Epoch 77/90
----------
train Loss: 0.2953 Acc: 0.8517
val Loss: 0.2569 Acc: 0.7727
Epoch 78/90
----------
train Loss: 0.2554 Acc: 0.8756
val Loss: 0.2568 Acc: 0.7955
Epoch 79/90
----------
train Loss: 0.3145 Acc: 0.8421
val Loss: 0.2531 Acc: 0.8182
Epoch 80/90
----------
train Loss: 0.2760 Acc: 0.8325
val Loss: 0.2526 Acc: 0.8636
Epoch 81/90
----------
train Loss: 0.3180 Acc: 0.7847
val Loss: 0.2621 Acc: 0.7727
Epoch 82/90
----------
train Loss: 0.2747 Acc: 0.8373
val Loss: 0.2652 Acc: 0.7727
Epoch 83/90
----------
train Loss: 0.2367 Acc: 0.9569
val Loss: 0.2666 Acc: 0.7955
Epoch 84/90
----------
train Loss: 0.3146 Acc: 0.7751
val Loss: 0.2639 Acc: 0.7273
Epoch 85/90
----------
train Loss: 0.2493 Acc: 0.8086
[32m[I 2025-06-28 13:42:21,705][0m Trial 62 finished with value: 0.8636363636363636 and parameters: {'batch_size': 18, 'lr': 5.185476384791358e-05, 'num_epochs': 90, 'weight_decay': 0.0004388404118506364, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2633 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_18_lr_5.185476384791358e-05_epoch_90_wd_0.0004388404118506364_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 0.6926 Acc: 0.2392
val Loss: 0.6726 Acc: 0.2955
Epoch 2/90
----------
train Loss: 0.6619 Acc: 0.3110
val Loss: 0.6481 Acc: 0.3409
Epoch 3/90
----------
train Loss: 0.6368 Acc: 0.3876
val Loss: 0.6145 Acc: 0.4318
Epoch 4/90
----------
train Loss: 0.6181 Acc: 0.4402
val Loss: 0.5914 Acc: 0.4773
Epoch 5/90
----------
train Loss: 0.6034 Acc: 0.4833
val Loss: 0.5753 Acc: 0.5682
Epoch 6/90
----------
train Loss: 0.5800 Acc: 0.5072
val Loss: 0.5528 Acc: 0.6136
Epoch 7/90
----------
train Loss: 0.5558 Acc: 0.5646
val Loss: 0.5274 Acc: 0.6136
Epoch 8/90
----------
train Loss: 0.5449 Acc: 0.5359
val Loss: 0.5054 Acc: 0.6818
Epoch 9/90
----------
train Loss: 0.5284 Acc: 0.5694
val Loss: 0.4835 Acc: 0.6818
Epoch 10/90
----------
train Loss: 0.4917 Acc: 0.5789
val Loss: 0.4627 Acc: 0.6591
Epoch 11/90
----------
train Loss: 0.4987 Acc: 0.5598
val Loss: 0.4474 Acc: 0.6818
Epoch 12/90
----------
train Loss: 0.4948 Acc: 0.5646
val Loss: 0.4386 Acc: 0.6818
Epoch 13/90
----------
train Loss: 0.4629 Acc: 0.6172
val Loss: 0.4204 Acc: 0.6591
Epoch 14/90
----------
train Loss: 0.4425 Acc: 0.6124
val Loss: 0.4084 Acc: 0.6818
Epoch 15/90
----------
train Loss: 0.4488 Acc: 0.5981
val Loss: 0.3975 Acc: 0.7273
Epoch 16/90
----------
train Loss: 0.4395 Acc: 0.6316
val Loss: 0.3870 Acc: 0.7273
Epoch 17/90
----------
train Loss: 0.4283 Acc: 0.6316
val Loss: 0.3776 Acc: 0.7273
Epoch 18/90
----------
train Loss: 0.4147 Acc: 0.6699
val Loss: 0.3663 Acc: 0.7273
Epoch 19/90
----------
train Loss: 0.3964 Acc: 0.7416
val Loss: 0.3598 Acc: 0.7500
Epoch 20/90
----------
train Loss: 0.4041 Acc: 0.7081
val Loss: 0.3485 Acc: 0.7500
Epoch 21/90
----------
train Loss: 0.4020 Acc: 0.7129
val Loss: 0.3392 Acc: 0.7727
Epoch 22/90
----------
train Loss: 0.3930 Acc: 0.7081
val Loss: 0.3337 Acc: 0.7500
Epoch 23/90
----------
train Loss: 0.3876 Acc: 0.7273
val Loss: 0.3253 Acc: 0.7955
Epoch 24/90
----------
train Loss: 0.3500 Acc: 0.7943
val Loss: 0.3112 Acc: 0.7727
Epoch 25/90
----------
train Loss: 0.3728 Acc: 0.7177
val Loss: 0.3136 Acc: 0.7955
Epoch 26/90
----------
train Loss: 0.3762 Acc: 0.7895
val Loss: 0.3129 Acc: 0.7955
Epoch 27/90
----------
train Loss: 0.3278 Acc: 0.8565
val Loss: 0.3106 Acc: 0.8182
Epoch 28/90
----------
train Loss: 0.3732 Acc: 0.7608
val Loss: 0.3084 Acc: 0.7955
Epoch 29/90
----------
train Loss: 0.3936 Acc: 0.6890
val Loss: 0.3081 Acc: 0.8182
Epoch 30/90
----------
train Loss: 0.3570 Acc: 0.7273
val Loss: 0.3022 Acc: 0.7955
Epoch 31/90
----------
train Loss: 0.3148 Acc: 0.8469
val Loss: 0.2928 Acc: 0.7727
Epoch 32/90
----------
train Loss: 0.3388 Acc: 0.7703
val Loss: 0.2859 Acc: 0.7727
Epoch 33/90
----------
train Loss: 0.3580 Acc: 0.7799
val Loss: 0.2854 Acc: 0.7955
Epoch 34/90
----------
train Loss: 0.3313 Acc: 0.8373
val Loss: 0.2840 Acc: 0.7727
Epoch 35/90
----------
train Loss: 0.2831 Acc: 0.9234
val Loss: 0.2874 Acc: 0.7955
Epoch 36/90
----------
train Loss: 0.3720 Acc: 0.7368
val Loss: 0.2847 Acc: 0.7955
Epoch 37/90
----------
train Loss: 0.3155 Acc: 0.7943
val Loss: 0.2908 Acc: 0.7727
Epoch 38/90
----------
train Loss: 0.3140 Acc: 0.9234
val Loss: 0.2851 Acc: 0.7727
Epoch 39/90
----------
train Loss: 0.3430 Acc: 0.7273
val Loss: 0.2916 Acc: 0.7500
Epoch 40/90
----------
train Loss: 0.2880 Acc: 0.8421
val Loss: 0.2877 Acc: 0.7727
Epoch 41/90
----------
train Loss: 0.3594 Acc: 0.7321
val Loss: 0.2811 Acc: 0.7955
Epoch 42/90
----------
train Loss: 0.2919 Acc: 0.8182
val Loss: 0.2728 Acc: 0.7955
Epoch 43/90
----------
train Loss: 0.3145 Acc: 0.8230
val Loss: 0.2701 Acc: 0.7955
Epoch 44/90
----------
train Loss: 0.2881 Acc: 0.8469
val Loss: 0.2700 Acc: 0.8182
Epoch 45/90
----------
train Loss: 0.1939 Acc: 0.9617
val Loss: 0.2689 Acc: 0.7955
Epoch 46/90
----------
train Loss: 0.3706 Acc: 0.8182
val Loss: 0.2718 Acc: 0.8182
Epoch 47/90
----------
train Loss: 0.2778 Acc: 0.8708
val Loss: 0.2673 Acc: 0.8182
Epoch 48/90
----------
train Loss: 0.3100 Acc: 0.8086
val Loss: 0.2706 Acc: 0.8182
Epoch 49/90
----------
train Loss: 0.2934 Acc: 0.9043
val Loss: 0.2697 Acc: 0.7955
Epoch 50/90
----------
train Loss: 0.2855 Acc: 0.8612
val Loss: 0.2706 Acc: 0.7955
Epoch 51/90
----------
train Loss: 0.2186 Acc: 0.9761
val Loss: 0.2648 Acc: 0.7955
Epoch 52/90
----------
train Loss: 0.3014 Acc: 0.7895
val Loss: 0.2668 Acc: 0.7727
Epoch 53/90
----------
train Loss: 0.3340 Acc: 0.8947
val Loss: 0.2646 Acc: 0.7727
Epoch 54/90
----------
train Loss: 0.2479 Acc: 0.9234
val Loss: 0.2584 Acc: 0.7955
Epoch 55/90
----------
train Loss: 0.2642 Acc: 0.9234
val Loss: 0.2586 Acc: 0.7955
Epoch 56/90
----------
train Loss: 0.3076 Acc: 0.8612
val Loss: 0.2594 Acc: 0.7727
Epoch 57/90
----------
train Loss: 0.3447 Acc: 0.7990
val Loss: 0.2576 Acc: 0.8182
Epoch 58/90
----------
train Loss: 0.2859 Acc: 0.7990
val Loss: 0.2545 Acc: 0.8182
Epoch 59/90
----------
train Loss: 0.2970 Acc: 0.8565
val Loss: 0.2541 Acc: 0.7955
Epoch 60/90
----------
train Loss: 0.2502 Acc: 0.8565
val Loss: 0.2569 Acc: 0.7955
Epoch 61/90
----------
train Loss: 0.3386 Acc: 0.7416
val Loss: 0.2597 Acc: 0.7955
Epoch 62/90
----------
train Loss: 0.3007 Acc: 0.9426
val Loss: 0.2596 Acc: 0.7727
Epoch 63/90
----------
train Loss: 0.2596 Acc: 0.9330
val Loss: 0.2593 Acc: 0.7727
Epoch 64/90
----------
train Loss: 0.2462 Acc: 0.9282
val Loss: 0.2574 Acc: 0.7955
Epoch 65/90
----------
train Loss: 0.2809 Acc: 0.8182
val Loss: 0.2602 Acc: 0.7955
Epoch 66/90
----------
train Loss: 0.2728 Acc: 0.8947
val Loss: 0.2640 Acc: 0.7955
Epoch 67/90
----------
train Loss: 0.3060 Acc: 0.8565
val Loss: 0.2580 Acc: 0.8182
Epoch 68/90
----------
train Loss: 0.2558 Acc: 0.8947
val Loss: 0.2616 Acc: 0.7955
Epoch 69/90
----------
train Loss: 0.2552 Acc: 0.8852
val Loss: 0.2585 Acc: 0.7955
Epoch 70/90
----------
train Loss: 0.2881 Acc: 0.8947
val Loss: 0.2596 Acc: 0.7955
Epoch 71/90
----------
train Loss: 0.3027 Acc: 0.9091
val Loss: 0.2577 Acc: 0.7727
Epoch 72/90
----------
train Loss: 0.3040 Acc: 0.8852
val Loss: 0.2638 Acc: 0.7500
Epoch 73/90
----------
train Loss: 0.2159 Acc: 0.9665
val Loss: 0.2681 Acc: 0.7727
Epoch 74/90
----------
train Loss: 0.3176 Acc: 0.8517
val Loss: 0.2629 Acc: 0.7727
Epoch 75/90
----------
train Loss: 0.2361 Acc: 0.9426
val Loss: 0.2614 Acc: 0.7273
Epoch 76/90
----------
train Loss: 0.2574 Acc: 0.8230
val Loss: 0.2581 Acc: 0.7727
Epoch 77/90
----------
train Loss: 0.2937 Acc: 0.8517
val Loss: 0.2571 Acc: 0.7727
Epoch 78/90
----------
train Loss: 0.2541 Acc: 0.8756
val Loss: 0.2573 Acc: 0.7955
Epoch 79/90
----------
train Loss: 0.3120 Acc: 0.8517
val Loss: 0.2533 Acc: 0.8182
Epoch 80/90
----------
train Loss: 0.2743 Acc: 0.8469
val Loss: 0.2530 Acc: 0.8636
Epoch 81/90
----------
train Loss: 0.3165 Acc: 0.7895
val Loss: 0.2626 Acc: 0.7955
Epoch 82/90
----------
train Loss: 0.2731 Acc: 0.8325
val Loss: 0.2661 Acc: 0.7727
Epoch 83/90
----------
train Loss: 0.2359 Acc: 0.9617
val Loss: 0.2675 Acc: 0.7727
Epoch 84/90
----------
train Loss: 0.3129 Acc: 0.7751
val Loss: 0.2647 Acc: 0.7500
Epoch 85/90
----------
train Loss: 0.2474 Acc: 0.8134
[32m[I 2025-06-28 14:01:39,638][0m Trial 63 finished with value: 0.8636363636363636 and parameters: {'batch_size': 12, 'lr': 5.439425381077976e-05, 'num_epochs': 90, 'weight_decay': 0.000481424068069914, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2631 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_5.439425381077976e-05_epoch_90_wd_0.000481424068069914_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 0.6920 Acc: 0.2440
val Loss: 0.6716 Acc: 0.2955
Epoch 2/90
----------
train Loss: 0.6600 Acc: 0.3158
val Loss: 0.6459 Acc: 0.3864
Epoch 3/90
----------
train Loss: 0.6339 Acc: 0.3971
val Loss: 0.6106 Acc: 0.4318
Epoch 4/90
----------
train Loss: 0.6142 Acc: 0.4593
val Loss: 0.5858 Acc: 0.5227
Epoch 5/90
----------
train Loss: 0.5986 Acc: 0.4976
val Loss: 0.5686 Acc: 0.5909
Epoch 6/90
----------
train Loss: 0.5742 Acc: 0.5215
val Loss: 0.5447 Acc: 0.6136
Epoch 7/90
----------
train Loss: 0.5490 Acc: 0.5694
val Loss: 0.5182 Acc: 0.6364
Epoch 8/90
----------
train Loss: 0.5384 Acc: 0.5455
val Loss: 0.4953 Acc: 0.6818
Epoch 9/90
----------
train Loss: 0.5216 Acc: 0.5598
val Loss: 0.4734 Acc: 0.6818
Epoch 10/90
----------
train Loss: 0.4831 Acc: 0.5789
val Loss: 0.4530 Acc: 0.6591
Epoch 11/90
----------
train Loss: 0.4913 Acc: 0.5598
val Loss: 0.4374 Acc: 0.6818
Epoch 12/90
----------
train Loss: 0.4883 Acc: 0.5646
val Loss: 0.4290 Acc: 0.6818
Epoch 13/90
----------
train Loss: 0.4554 Acc: 0.6268
val Loss: 0.4110 Acc: 0.6591
Epoch 14/90
----------
train Loss: 0.4346 Acc: 0.6268
val Loss: 0.3987 Acc: 0.7045
Epoch 15/90
----------
train Loss: 0.4421 Acc: 0.5981
val Loss: 0.3879 Acc: 0.7045
Epoch 16/90
----------
train Loss: 0.4329 Acc: 0.6364
val Loss: 0.3783 Acc: 0.7500
Epoch 17/90
----------
train Loss: 0.4217 Acc: 0.6507
val Loss: 0.3696 Acc: 0.7500
Epoch 18/90
----------
train Loss: 0.4074 Acc: 0.6842
val Loss: 0.3582 Acc: 0.7273
Epoch 19/90
----------
train Loss: 0.3886 Acc: 0.7656
val Loss: 0.3521 Acc: 0.7500
Epoch 20/90
----------
train Loss: 0.3977 Acc: 0.7129
val Loss: 0.3407 Acc: 0.7500
Epoch 21/90
----------
train Loss: 0.3959 Acc: 0.7225
val Loss: 0.3315 Acc: 0.7727
Epoch 22/90
----------
train Loss: 0.3861 Acc: 0.7273
val Loss: 0.3264 Acc: 0.7955
Epoch 23/90
----------
train Loss: 0.3816 Acc: 0.7321
val Loss: 0.3182 Acc: 0.7955
Epoch 24/90
----------
train Loss: 0.3424 Acc: 0.7990
val Loss: 0.3044 Acc: 0.7727
Epoch 25/90
----------
train Loss: 0.3656 Acc: 0.7321
val Loss: 0.3069 Acc: 0.7955
Epoch 26/90
----------
train Loss: 0.3699 Acc: 0.7943
val Loss: 0.3063 Acc: 0.8182
Epoch 27/90
----------
train Loss: 0.3200 Acc: 0.8804
val Loss: 0.3051 Acc: 0.8182
Epoch 28/90
----------
train Loss: 0.3676 Acc: 0.7608
val Loss: 0.3032 Acc: 0.7955
Epoch 29/90
----------
train Loss: 0.3885 Acc: 0.6938
val Loss: 0.3036 Acc: 0.7955
Epoch 30/90
----------
train Loss: 0.3501 Acc: 0.7416
val Loss: 0.2963 Acc: 0.8182
Epoch 31/90
----------
train Loss: 0.3073 Acc: 0.8660
val Loss: 0.2869 Acc: 0.8182
Epoch 32/90
----------
train Loss: 0.3324 Acc: 0.7799
val Loss: 0.2806 Acc: 0.7727
Epoch 33/90
----------
train Loss: 0.3516 Acc: 0.7799
val Loss: 0.2802 Acc: 0.7955
Epoch 34/90
----------
train Loss: 0.3252 Acc: 0.8517
val Loss: 0.2793 Acc: 0.7955
Epoch 35/90
----------
train Loss: 0.2754 Acc: 0.9282
val Loss: 0.2837 Acc: 0.7955
Epoch 36/90
----------
train Loss: 0.3673 Acc: 0.7416
val Loss: 0.2814 Acc: 0.7955
Epoch 37/90
----------
train Loss: 0.3096 Acc: 0.8038
val Loss: 0.2873 Acc: 0.7727
Epoch 38/90
----------
train Loss: 0.3083 Acc: 0.9282
val Loss: 0.2812 Acc: 0.7955
Epoch 39/90
----------
train Loss: 0.3383 Acc: 0.7273
val Loss: 0.2868 Acc: 0.7500
Epoch 40/90
----------
train Loss: 0.2819 Acc: 0.8612
val Loss: 0.2833 Acc: 0.7727
Epoch 41/90
----------
train Loss: 0.3562 Acc: 0.7273
val Loss: 0.2767 Acc: 0.7955
Epoch 42/90
----------
train Loss: 0.2854 Acc: 0.8230
val Loss: 0.2689 Acc: 0.7955
Epoch 43/90
----------
train Loss: 0.3083 Acc: 0.8469
val Loss: 0.2664 Acc: 0.7955
Epoch 44/90
----------
train Loss: 0.2837 Acc: 0.8565
val Loss: 0.2674 Acc: 0.8182
Epoch 45/90
----------
train Loss: 0.1880 Acc: 0.9665
val Loss: 0.2667 Acc: 0.8182
Epoch 46/90
----------
train Loss: 0.3681 Acc: 0.8230
val Loss: 0.2700 Acc: 0.8182
Epoch 47/90
----------
train Loss: 0.2731 Acc: 0.8708
val Loss: 0.2653 Acc: 0.8182
Epoch 48/90
----------
train Loss: 0.3064 Acc: 0.8230
val Loss: 0.2686 Acc: 0.7955
Epoch 49/90
----------
train Loss: 0.2894 Acc: 0.9139
val Loss: 0.2679 Acc: 0.7955
Epoch 50/90
----------
train Loss: 0.2821 Acc: 0.8612
val Loss: 0.2687 Acc: 0.7955
Epoch 51/90
----------
train Loss: 0.2139 Acc: 0.9856
val Loss: 0.2629 Acc: 0.7955
Epoch 52/90
----------
train Loss: 0.2980 Acc: 0.7943
val Loss: 0.2649 Acc: 0.7727
Epoch 53/90
----------
train Loss: 0.3310 Acc: 0.9091
val Loss: 0.2625 Acc: 0.7727
Epoch 54/90
----------
train Loss: 0.2449 Acc: 0.9282
val Loss: 0.2565 Acc: 0.7955
Epoch 55/90
----------
train Loss: 0.2609 Acc: 0.9330
val Loss: 0.2573 Acc: 0.7727
Epoch 56/90
----------
train Loss: 0.3042 Acc: 0.8708
val Loss: 0.2585 Acc: 0.7727
Epoch 57/90
----------
train Loss: 0.3426 Acc: 0.8038
val Loss: 0.2569 Acc: 0.8182
Epoch 58/90
----------
train Loss: 0.2832 Acc: 0.7943
val Loss: 0.2530 Acc: 0.8182
Epoch 59/90
----------
train Loss: 0.2938 Acc: 0.8756
val Loss: 0.2531 Acc: 0.7955
Epoch 60/90
----------
train Loss: 0.2467 Acc: 0.8660
val Loss: 0.2554 Acc: 0.7955
Epoch 61/90
----------
train Loss: 0.3357 Acc: 0.7416
val Loss: 0.2589 Acc: 0.7955
Epoch 62/90
----------
train Loss: 0.2990 Acc: 0.9474
val Loss: 0.2587 Acc: 0.7727
Epoch 63/90
----------
train Loss: 0.2577 Acc: 0.9330
val Loss: 0.2583 Acc: 0.7727
Epoch 64/90
----------
train Loss: 0.2438 Acc: 0.9378
val Loss: 0.2567 Acc: 0.7955
Epoch 65/90
----------
train Loss: 0.2787 Acc: 0.8182
val Loss: 0.2596 Acc: 0.7955
Epoch 66/90
----------
train Loss: 0.2711 Acc: 0.8995
val Loss: 0.2642 Acc: 0.7727
Epoch 67/90
----------
train Loss: 0.3042 Acc: 0.8660
val Loss: 0.2585 Acc: 0.7955
Epoch 68/90
----------
train Loss: 0.2542 Acc: 0.8947
val Loss: 0.2620 Acc: 0.7955
Epoch 69/90
----------
train Loss: 0.2533 Acc: 0.8900
val Loss: 0.2584 Acc: 0.7955
Epoch 70/90
----------
train Loss: 0.2860 Acc: 0.8947
val Loss: 0.2592 Acc: 0.7727
Epoch 71/90
----------
train Loss: 0.3008 Acc: 0.9091
val Loss: 0.2571 Acc: 0.7727
Epoch 72/90
----------
train Loss: 0.3017 Acc: 0.8852
val Loss: 0.2633 Acc: 0.7500
Epoch 73/90
----------
train Loss: 0.2149 Acc: 0.9617
val Loss: 0.2681 Acc: 0.7500
Epoch 74/90
----------
train Loss: 0.3156 Acc: 0.8517
val Loss: 0.2628 Acc: 0.7727
Epoch 75/90
----------
train Loss: 0.2344 Acc: 0.9522
val Loss: 0.2607 Acc: 0.7273
Epoch 76/90
----------
train Loss: 0.2549 Acc: 0.8230
val Loss: 0.2578 Acc: 0.7727
Epoch 77/90
----------
train Loss: 0.2918 Acc: 0.8421
val Loss: 0.2571 Acc: 0.7727
Epoch 78/90
----------
train Loss: 0.2527 Acc: 0.8804
val Loss: 0.2575 Acc: 0.7955
Epoch 79/90
----------
train Loss: 0.3093 Acc: 0.8565
val Loss: 0.2533 Acc: 0.7955
Epoch 80/90
----------
train Loss: 0.2726 Acc: 0.8469
val Loss: 0.2537 Acc: 0.8409
Epoch 81/90
----------
train Loss: 0.3146 Acc: 0.7943
val Loss: 0.2638 Acc: 0.7727
Epoch 82/90
----------
train Loss: 0.2715 Acc: 0.8325
val Loss: 0.2674 Acc: 0.7727
Epoch 83/90
----------
train Loss: 0.2350 Acc: 0.9665
val Loss: 0.2686 Acc: 0.7727
Epoch 84/90
----------
train Loss: 0.3109 Acc: 0.7751
val Loss: 0.2655 Acc: 0.7727
Epoch 85/90
----------
train Loss: 0.2452 Acc: 0.8182
[32m[I 2025-06-28 14:20:58,631][0m Trial 64 finished with value: 0.8409090909090909 and parameters: {'batch_size': 18, 'lr': 5.7298491478307324e-05, 'num_epochs': 90, 'weight_decay': 0.0004448217851650566, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2635 Acc: 0.7727
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_18_lr_5.7298491478307324e-05_epoch_90_wd_0.0004448217851650566_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/97
----------
train Loss: 0.6993 Acc: 0.2201
val Loss: 0.6839 Acc: 0.2045
Epoch 2/97
----------
train Loss: 0.6850 Acc: 0.2392
val Loss: 0.6749 Acc: 0.2500
Epoch 3/97
----------
train Loss: 0.6740 Acc: 0.2584
val Loss: 0.6600 Acc: 0.2500
Epoch 4/97
----------
train Loss: 0.6674 Acc: 0.2823
val Loss: 0.6516 Acc: 0.3409
Epoch 5/97
----------
train Loss: 0.6649 Acc: 0.2679
val Loss: 0.6481 Acc: 0.3409
Epoch 6/97
----------
train Loss: 0.6543 Acc: 0.3254
val Loss: 0.6417 Acc: 0.3864
Epoch 7/97
----------
train Loss: 0.6448 Acc: 0.3732
val Loss: 0.6343 Acc: 0.3864
Epoch 8/97
----------
train Loss: 0.6360 Acc: 0.4019
val Loss: 0.6286 Acc: 0.4318
Epoch 9/97
----------
train Loss: 0.6292 Acc: 0.4258
val Loss: 0.6204 Acc: 0.5000
Epoch 10/97
----------
train Loss: 0.6163 Acc: 0.4163
val Loss: 0.6103 Acc: 0.4773
Epoch 11/97
----------
train Loss: 0.6171 Acc: 0.4306
val Loss: 0.6054 Acc: 0.5000
Epoch 12/97
----------
train Loss: 0.6110 Acc: 0.4402
val Loss: 0.6003 Acc: 0.5000
Epoch 13/97
----------
train Loss: 0.5954 Acc: 0.5550
val Loss: 0.5884 Acc: 0.5455
Epoch 14/97
----------
train Loss: 0.5867 Acc: 0.5120
val Loss: 0.5839 Acc: 0.5909
Epoch 15/97
----------
train Loss: 0.5824 Acc: 0.5359
val Loss: 0.5782 Acc: 0.5455
Epoch 16/97
----------
train Loss: 0.5756 Acc: 0.5502
val Loss: 0.5666 Acc: 0.6364
Epoch 17/97
----------
train Loss: 0.5692 Acc: 0.5885
val Loss: 0.5577 Acc: 0.6591
Epoch 18/97
----------
train Loss: 0.5640 Acc: 0.5311
val Loss: 0.5480 Acc: 0.6591
Epoch 19/97
----------
train Loss: 0.5526 Acc: 0.5837
val Loss: 0.5403 Acc: 0.6591
Epoch 20/97
----------
train Loss: 0.5465 Acc: 0.5837
val Loss: 0.5322 Acc: 0.6591
Epoch 21/97
----------
train Loss: 0.5442 Acc: 0.5646
val Loss: 0.5285 Acc: 0.6591
Epoch 22/97
----------
train Loss: 0.5391 Acc: 0.5933
val Loss: 0.5212 Acc: 0.6591
Epoch 23/97
----------
train Loss: 0.5280 Acc: 0.5742
val Loss: 0.5136 Acc: 0.6591
Epoch 24/97
----------
train Loss: 0.5107 Acc: 0.5885
val Loss: 0.4980 Acc: 0.6591
Epoch 25/97
----------
train Loss: 0.5185 Acc: 0.5646
val Loss: 0.4972 Acc: 0.6364
Epoch 26/97
----------
train Loss: 0.5140 Acc: 0.5646
val Loss: 0.4942 Acc: 0.6364
Epoch 27/97
----------
train Loss: 0.4928 Acc: 0.6268
val Loss: 0.4824 Acc: 0.6591
Epoch 28/97
----------
train Loss: 0.5028 Acc: 0.5502
val Loss: 0.4771 Acc: 0.6818
Epoch 29/97
----------
train Loss: 0.5072 Acc: 0.5598
val Loss: 0.4708 Acc: 0.7045
Epoch 30/97
----------
train Loss: 0.4956 Acc: 0.5742
val Loss: 0.4673 Acc: 0.7045
Epoch 31/97
----------
train Loss: 0.4756 Acc: 0.6268
val Loss: 0.4591 Acc: 0.7045
Epoch 32/97
----------
train Loss: 0.4771 Acc: 0.5981
val Loss: 0.4524 Acc: 0.6818
Epoch 33/97
----------
train Loss: 0.4825 Acc: 0.5789
val Loss: 0.4474 Acc: 0.7045
Epoch 34/97
----------
train Loss: 0.4701 Acc: 0.5598
val Loss: 0.4417 Acc: 0.6591
Epoch 35/97
----------
train Loss: 0.4509 Acc: 0.6172
val Loss: 0.4348 Acc: 0.7273
Epoch 36/97
----------
train Loss: 0.4818 Acc: 0.5646
val Loss: 0.4268 Acc: 0.7045
Epoch 37/97
----------
train Loss: 0.4570 Acc: 0.6029
val Loss: 0.4263 Acc: 0.7273
Epoch 38/97
----------
train Loss: 0.4545 Acc: 0.6268
val Loss: 0.4201 Acc: 0.7273
Epoch 39/97
----------
train Loss: 0.4594 Acc: 0.5885
val Loss: 0.4228 Acc: 0.7500
Epoch 40/97
----------
train Loss: 0.4383 Acc: 0.6268
val Loss: 0.4152 Acc: 0.7273
Epoch 41/97
----------
train Loss: 0.4620 Acc: 0.5837
val Loss: 0.4093 Acc: 0.7273
Epoch 42/97
----------
train Loss: 0.4328 Acc: 0.6077
val Loss: 0.4031 Acc: 0.7273
Epoch 43/97
----------
train Loss: 0.4461 Acc: 0.6124
val Loss: 0.3969 Acc: 0.7273
Epoch 44/97
----------
train Loss: 0.4244 Acc: 0.6794
val Loss: 0.3935 Acc: 0.7273
Epoch 45/97
----------
train Loss: 0.3809 Acc: 0.7512
val Loss: 0.3878 Acc: 0.7500
Epoch 46/97
----------
train Loss: 0.4546 Acc: 0.6507
val Loss: 0.3891 Acc: 0.7500
Epoch 47/97
----------
train Loss: 0.4130 Acc: 0.6603
val Loss: 0.3849 Acc: 0.7727
Epoch 48/97
----------
train Loss: 0.4243 Acc: 0.6651
val Loss: 0.3811 Acc: 0.7727
Epoch 49/97
----------
train Loss: 0.4152 Acc: 0.6986
val Loss: 0.3738 Acc: 0.7727
Epoch 50/97
----------
train Loss: 0.4115 Acc: 0.6555
val Loss: 0.3748 Acc: 0.7727
Epoch 51/97
----------
train Loss: 0.3813 Acc: 0.7560
val Loss: 0.3649 Acc: 0.7727
Epoch 52/97
----------
train Loss: 0.4139 Acc: 0.6411
val Loss: 0.3661 Acc: 0.7727
Epoch 53/97
----------
train Loss: 0.4251 Acc: 0.6699
val Loss: 0.3645 Acc: 0.7727
Epoch 54/97
----------
train Loss: 0.3765 Acc: 0.7895
val Loss: 0.3611 Acc: 0.7955
Epoch 55/97
----------
train Loss: 0.3908 Acc: 0.7273
val Loss: 0.3540 Acc: 0.7727
Epoch 56/97
----------
train Loss: 0.4070 Acc: 0.7081
val Loss: 0.3535 Acc: 0.7727
Epoch 57/97
----------
train Loss: 0.4279 Acc: 0.6507
val Loss: 0.3504 Acc: 0.7727
Epoch 58/97
----------
train Loss: 0.3888 Acc: 0.6938
val Loss: 0.3510 Acc: 0.7727
Epoch 59/97
----------
train Loss: 0.4056 Acc: 0.6938
val Loss: 0.3472 Acc: 0.7727
Epoch 60/97
----------
train Loss: 0.3844 Acc: 0.7081
val Loss: 0.3450 Acc: 0.7955
Epoch 61/97
----------
train Loss: 0.4211 Acc: 0.6507
val Loss: 0.3425 Acc: 0.7955
Epoch 62/97
----------
train Loss: 0.3931 Acc: 0.7560
val Loss: 0.3414 Acc: 0.7955
Epoch 63/97
----------
train Loss: 0.3674 Acc: 0.7751
val Loss: 0.3385 Acc: 0.7955
Epoch 64/97
----------
train Loss: 0.3652 Acc: 0.7751
val Loss: 0.3359 Acc: 0.7955
Epoch 65/97
----------
train Loss: 0.3844 Acc: 0.7081
val Loss: 0.3306 Acc: 0.7955
Epoch 66/97
----------
train Loss: 0.3768 Acc: 0.7512
val Loss: 0.3309 Acc: 0.7727
Epoch 67/97
----------
train Loss: 0.3904 Acc: 0.7321
val Loss: 0.3261 Acc: 0.7955
Epoch 68/97
----------
train Loss: 0.3591 Acc: 0.7847
val Loss: 0.3228 Acc: 0.7955
Epoch 69/97
----------
train Loss: 0.3629 Acc: 0.7799
val Loss: 0.3234 Acc: 0.8182
Epoch 70/97
----------
train Loss: 0.3781 Acc: 0.7464
val Loss: 0.3258 Acc: 0.7955
Epoch 71/97
----------
train Loss: 0.3948 Acc: 0.7033
val Loss: 0.3234 Acc: 0.8182
Epoch 72/97
----------
train Loss: 0.3904 Acc: 0.7033
val Loss: 0.3263 Acc: 0.8182
Epoch 73/97
----------
train Loss: 0.3230 Acc: 0.8421
val Loss: 0.3238 Acc: 0.7955
Epoch 74/97
----------
train Loss: 0.4019 Acc: 0.7081
val Loss: 0.3192 Acc: 0.7955
Epoch 75/97
----------
train Loss: 0.3416 Acc: 0.7943
val Loss: 0.3186 Acc: 0.7955
Epoch 76/97
----------
train Loss: 0.3632 Acc: 0.7081
val Loss: 0.3144 Acc: 0.7955
Epoch 77/97
----------
train Loss: 0.3756 Acc: 0.7895
val Loss: 0.3134 Acc: 0.8182
Epoch 78/97
----------
train Loss: 0.3430 Acc: 0.7895
val Loss: 0.3111 Acc: 0.7955
Epoch 79/97
----------
train Loss: 0.3946 Acc: 0.7177
val Loss: 0.3069 Acc: 0.8182
Epoch 80/97
----------
train Loss: 0.3606 Acc: 0.7703
val Loss: 0.3058 Acc: 0.8182
Epoch 81/97
----------
train Loss: 0.3909 Acc: 0.7177
val Loss: 0.3100 Acc: 0.8182
Epoch 82/97
----------
train Loss: 0.3506 Acc: 0.7751
val Loss: 0.3107 Acc: 0.8409
Epoch 83/97
----------
train Loss: 0.3159 Acc: 0.8947
val Loss: 0.3094 Acc: 0.8182
Epoch 84/97
----------
train Loss: 0.3854 Acc: 0.6890
val Loss: 0.3101 Acc: 0.8182
Epoch 85/97
----------
train Loss: 0.3429 Acc: 0.7368
val Loss: 0.3068 Acc: 0.7955
Epoch 86/97
----------
train Loss: 0.3400 Acc: 0.7943
val Loss: 0.3018 Acc: 0.8182
Epoch 87/97
----------
train Loss: 0.3657 Acc: 0.7799
val Loss: 0.3019 Acc: 0.8182
Epoch 88/97
----------
train Loss: 0.3718 Acc: 0.8182
val Loss: 0.2987 Acc: 0.8182
Epoch 89/97
----------
train Loss: 0.3868 Acc: 0.7464
val Loss: 0.2990 Acc: 0.8182
Epoch 90/97
----------
train Loss: 0.3441 Acc: 0.8038
val Loss: 0.2981 Acc: 0.8182
Epoch 91/97
----------
train Loss: 0.3172 Acc: 0.8565
val Loss: 0.3009 Acc: 0.8182
Epoch 92/97
----------
train Loss: 0.3279 Acc: 0.8612
val Loss: 0.3015 Acc: 0.8182
Epoch 93/97
----------
train Loss: 0.3490 Acc: 0.7656
val Loss: 0.2944 Acc: 0.8182
Epoch 94/97
----------
train Loss: 0.2932 Acc: 0.9091
val Loss: 0.2917 Acc: 0.8182
Epoch 95/97
----------
train Loss: 0.3335 Acc: 0.8421
val Loss: 0.2926 Acc: 0.7955
Epoch 96/97
----------
train Loss: 0.2584 Acc: 0.9474
val Loss: 0.2892 Acc: 0.8182
Epoch 97/97
----------
train Loss: 0.3102 Acc: 0.8230
[32m[I 2025-06-28 14:43:00,952][0m Trial 65 finished with value: 0.8181818181818182 and parameters: {'batch_size': 24, 'lr': 1.923546534887743e-05, 'num_epochs': 97, 'weight_decay': 0.0007045536614550406, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2855 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_24_lr_1.923546534887743e-05_epoch_97_wd_0.0007045536614550406_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 0.6850 Acc: 0.2584
val Loss: 0.6592 Acc: 0.2955
Epoch 2/81
----------
train Loss: 0.6368 Acc: 0.4211
val Loss: 0.6146 Acc: 0.4773
Epoch 3/81
----------
train Loss: 0.5984 Acc: 0.4689
val Loss: 0.5555 Acc: 0.5909
Epoch 4/81
----------
train Loss: 0.5680 Acc: 0.4928
val Loss: 0.5126 Acc: 0.6591
Epoch 5/81
----------
train Loss: 0.5438 Acc: 0.5407
val Loss: 0.4836 Acc: 0.6591
Epoch 6/81
----------
train Loss: 0.5105 Acc: 0.5455
val Loss: 0.4511 Acc: 0.6818
Epoch 7/81
----------
train Loss: 0.4787 Acc: 0.5933
val Loss: 0.4242 Acc: 0.6818
Epoch 8/81
----------
train Loss: 0.4765 Acc: 0.5502
val Loss: 0.3986 Acc: 0.6818
Epoch 9/81
----------
train Loss: 0.4616 Acc: 0.5981
val Loss: 0.3815 Acc: 0.6818
Epoch 10/81
----------
train Loss: 0.4002 Acc: 0.6794
val Loss: 0.3677 Acc: 0.7500
Epoch 11/81
----------
train Loss: 0.4266 Acc: 0.6029
val Loss: 0.3543 Acc: 0.7273
Epoch 12/81
----------
train Loss: 0.4316 Acc: 0.6124
val Loss: 0.3513 Acc: 0.7273
Epoch 13/81
----------
train Loss: 0.3921 Acc: 0.6938
val Loss: 0.3353 Acc: 0.7273
Epoch 14/81
----------
train Loss: 0.3645 Acc: 0.7416
val Loss: 0.3231 Acc: 0.7273
Epoch 15/81
----------
train Loss: 0.3847 Acc: 0.7081
val Loss: 0.3145 Acc: 0.7727
Epoch 16/81
----------
train Loss: 0.3766 Acc: 0.7416
val Loss: 0.3137 Acc: 0.7727
Epoch 17/81
----------
train Loss: 0.3628 Acc: 0.7751
val Loss: 0.3140 Acc: 0.7727
Epoch 18/81
----------
train Loss: 0.3421 Acc: 0.7990
val Loss: 0.3042 Acc: 0.7727
Epoch 19/81
----------
train Loss: 0.3195 Acc: 0.8278
val Loss: 0.2965 Acc: 0.7955
Epoch 20/81
----------
train Loss: 0.3405 Acc: 0.8086
val Loss: 0.2839 Acc: 0.7727
Epoch 21/81
----------
train Loss: 0.3455 Acc: 0.7895
val Loss: 0.2723 Acc: 0.7955
Epoch 22/81
----------
train Loss: 0.3233 Acc: 0.8325
val Loss: 0.2706 Acc: 0.7955
Epoch 23/81
----------
train Loss: 0.3314 Acc: 0.8421
val Loss: 0.2671 Acc: 0.8409
Epoch 24/81
----------
train Loss: 0.2736 Acc: 0.8756
val Loss: 0.2519 Acc: 0.8182
Epoch 25/81
----------
train Loss: 0.3024 Acc: 0.9043
val Loss: 0.2564 Acc: 0.7955
Epoch 26/81
----------
train Loss: 0.3151 Acc: 0.8900
val Loss: 0.2603 Acc: 0.8182
Epoch 27/81
----------
train Loss: 0.2574 Acc: 0.9617
val Loss: 0.2730 Acc: 0.8182
Epoch 28/81
----------
train Loss: 0.3193 Acc: 0.8612
val Loss: 0.2719 Acc: 0.7500
Epoch 29/81
----------
train Loss: 0.3435 Acc: 0.7416
val Loss: 0.2711 Acc: 0.7955
Epoch 30/81
----------
train Loss: 0.2930 Acc: 0.8421
val Loss: 0.2543 Acc: 0.8409
Epoch 31/81
----------
train Loss: 0.2506 Acc: 0.9330
val Loss: 0.2438 Acc: 0.8182
Epoch 32/81
----------
train Loss: 0.2828 Acc: 0.8421
val Loss: 0.2420 Acc: 0.7955
Epoch 33/81
----------
train Loss: 0.2983 Acc: 0.8517
val Loss: 0.2423 Acc: 0.7955
Epoch 34/81
----------
train Loss: 0.2819 Acc: 0.8900
val Loss: 0.2483 Acc: 0.7727
Epoch 35/81
----------
train Loss: 0.2254 Acc: 0.9809
val Loss: 0.2617 Acc: 0.7500
Epoch 36/81
----------
train Loss: 0.3340 Acc: 0.8086
val Loss: 0.2680 Acc: 0.7273
Epoch 37/81
----------
train Loss: 0.2732 Acc: 0.8325
val Loss: 0.2676 Acc: 0.7273
Epoch 38/81
----------
train Loss: 0.2758 Acc: 0.9426
val Loss: 0.2563 Acc: 0.7727
Epoch 39/81
----------
train Loss: 0.3030 Acc: 0.7799
val Loss: 0.2601 Acc: 0.7500
Epoch 40/81
----------
train Loss: 0.2449 Acc: 0.8947
val Loss: 0.2572 Acc: 0.7955
Epoch 41/81
----------
train Loss: 0.3370 Acc: 0.7273
val Loss: 0.2511 Acc: 0.7955
Epoch 42/81
----------
train Loss: 0.2434 Acc: 0.8660
val Loss: 0.2483 Acc: 0.7955
Epoch 43/81
----------
train Loss: 0.2705 Acc: 0.8421
val Loss: 0.2475 Acc: 0.7955
Epoch 44/81
----------
train Loss: 0.2601 Acc: 0.8756
val Loss: 0.2565 Acc: 0.8182
Epoch 45/81
----------
train Loss: 0.1599 Acc: 0.9713
val Loss: 0.2599 Acc: 0.8182
Epoch 46/81
----------
train Loss: 0.3567 Acc: 0.8038
val Loss: 0.2630 Acc: 0.7955
Epoch 47/81
----------
train Loss: 0.2469 Acc: 0.9091
val Loss: 0.2526 Acc: 0.7955
Epoch 48/81
----------
train Loss: 0.2844 Acc: 0.8660
val Loss: 0.2558 Acc: 0.7500
Epoch 49/81
----------
train Loss: 0.2687 Acc: 0.9474
val Loss: 0.2596 Acc: 0.7727
Epoch 50/81
----------
train Loss: 0.2633 Acc: 0.8947
val Loss: 0.2605 Acc: 0.7727
Epoch 51/81
----------
train Loss: 0.1940 Acc: 0.9856
val Loss: 0.2529 Acc: 0.7727
Epoch 52/81
----------
train Loss: 0.2794 Acc: 0.8278
val Loss: 0.2504 Acc: 0.7500
Epoch 53/81
----------
train Loss: 0.3161 Acc: 0.9139
val Loss: 0.2462 Acc: 0.7727
Epoch 54/81
----------
train Loss: 0.2306 Acc: 0.9522
val Loss: 0.2472 Acc: 0.7727
Epoch 55/81
----------
train Loss: 0.2451 Acc: 0.9282
val Loss: 0.2566 Acc: 0.7500
Epoch 56/81
----------
train Loss: 0.2881 Acc: 0.9187
val Loss: 0.2596 Acc: 0.7500
Epoch 57/81
----------
train Loss: 0.3278 Acc: 0.8421
val Loss: 0.2615 Acc: 0.7727
Epoch 58/81
----------
train Loss: 0.2656 Acc: 0.7990
val Loss: 0.2547 Acc: 0.8182
Epoch 59/81
----------
train Loss: 0.2735 Acc: 0.8995
val Loss: 0.2572 Acc: 0.7955
Epoch 60/81
----------
train Loss: 0.2250 Acc: 0.8995
val Loss: 0.2575 Acc: 0.7955
Epoch 61/81
----------
train Loss: 0.3177 Acc: 0.7895
val Loss: 0.2637 Acc: 0.7500
Epoch 62/81
----------
train Loss: 0.2892 Acc: 0.9522
val Loss: 0.2631 Acc: 0.7500
Epoch 63/81
----------
train Loss: 0.2461 Acc: 0.9474
val Loss: 0.2621 Acc: 0.7273
Epoch 64/81
----------
train Loss: 0.2303 Acc: 0.9569
val Loss: 0.2590 Acc: 0.7727
Epoch 65/81
----------
train Loss: 0.2636 Acc: 0.8517
val Loss: 0.2645 Acc: 0.7500
Epoch 66/81
----------
train Loss: 0.2581 Acc: 0.8995
val Loss: 0.2723 Acc: 0.7955
Epoch 67/81
----------
train Loss: 0.2918 Acc: 0.8900
val Loss: 0.2679 Acc: 0.7500
Epoch 68/81
----------
train Loss: 0.2458 Acc: 0.9043
val Loss: 0.2718 Acc: 0.7500
Epoch 69/81
----------
train Loss: 0.2400 Acc: 0.9043
val Loss: 0.2649 Acc: 0.7727
Epoch 70/81
----------
train Loss: 0.2735 Acc: 0.9139
val Loss: 0.2642 Acc: 0.7727
Epoch 71/81
----------
train Loss: 0.2869 Acc: 0.9234
val Loss: 0.2557 Acc: 0.7500
Epoch 72/81
----------
train Loss: 0.2843 Acc: 0.9091
val Loss: 0.2608 Acc: 0.7955
Epoch 73/81
----------
train Loss: 0.2077 Acc: 0.9713
val Loss: 0.2687 Acc: 0.7727
Epoch 74/81
----------
train Loss: 0.3016 Acc: 0.8804
val Loss: 0.2655 Acc: 0.7500
Epoch 75/81
----------
train Loss: 0.2251 Acc: 0.9713
val Loss: 0.2589 Acc: 0.7500
Epoch 76/81
----------
train Loss: 0.2369 Acc: 0.8517
val Loss: 0.2549 Acc: 0.7500
Epoch 77/81
----------
train Loss: 0.2780 Acc: 0.8852
val Loss: 0.2556 Acc: 0.7500
Epoch 78/81
----------
train Loss: 0.2427 Acc: 0.8947
val Loss: 0.2588 Acc: 0.7955
Epoch 79/81
----------
train Loss: 0.2877 Acc: 0.8852
val Loss: 0.2571 Acc: 0.7955
Epoch 80/81
----------
train Loss: 0.2609 Acc: 0.8756
val Loss: 0.2605 Acc: 0.8182
Epoch 81/81
----------
train Loss: 0.2991 Acc: 0.8134
[32m[I 2025-06-28 15:01:24,822][0m Trial 66 finished with value: 0.7954545454545455 and parameters: {'batch_size': 107, 'lr': 9.487089620420932e-05, 'num_epochs': 81, 'weight_decay': 0.0002015921666278504, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2724 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_107_lr_9.487089620420932e-05_epoch_81_wd_0.0002015921666278504_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 0.6963 Acc: 0.2201
val Loss: 0.6788 Acc: 0.2500
Epoch 2/90
----------
train Loss: 0.6748 Acc: 0.2727
val Loss: 0.6631 Acc: 0.2727
Epoch 3/90
----------
train Loss: 0.6574 Acc: 0.3254
val Loss: 0.6405 Acc: 0.3409
Epoch 4/90
----------
train Loss: 0.6452 Acc: 0.3493
val Loss: 0.6265 Acc: 0.3409
Epoch 5/90
----------
train Loss: 0.6370 Acc: 0.3541
val Loss: 0.6181 Acc: 0.4318
Epoch 6/90
----------
train Loss: 0.6209 Acc: 0.4354
val Loss: 0.6057 Acc: 0.5000
Epoch 7/90
----------
train Loss: 0.6050 Acc: 0.4976
val Loss: 0.5910 Acc: 0.5455
Epoch 8/90
----------
train Loss: 0.5944 Acc: 0.4976
val Loss: 0.5784 Acc: 0.5455
Epoch 9/90
----------
train Loss: 0.5821 Acc: 0.5263
val Loss: 0.5630 Acc: 0.6136
Epoch 10/90
----------
train Loss: 0.5593 Acc: 0.5455
val Loss: 0.5444 Acc: 0.6364
Epoch 11/90
----------
train Loss: 0.5608 Acc: 0.5215
val Loss: 0.5337 Acc: 0.6818
Epoch 12/90
----------
train Loss: 0.5534 Acc: 0.5120
val Loss: 0.5248 Acc: 0.6364
Epoch 13/90
----------
train Loss: 0.5299 Acc: 0.5837
val Loss: 0.5066 Acc: 0.6591
Epoch 14/90
----------
train Loss: 0.5146 Acc: 0.5742
val Loss: 0.4976 Acc: 0.6591
Epoch 15/90
----------
train Loss: 0.5127 Acc: 0.5502
val Loss: 0.4873 Acc: 0.6818
Epoch 16/90
----------
train Loss: 0.5031 Acc: 0.5742
val Loss: 0.4736 Acc: 0.6591
Epoch 17/90
----------
train Loss: 0.4933 Acc: 0.5646
val Loss: 0.4619 Acc: 0.6591
Epoch 18/90
----------
train Loss: 0.4838 Acc: 0.5742
val Loss: 0.4501 Acc: 0.6591
Epoch 19/90
----------
train Loss: 0.4693 Acc: 0.6172
val Loss: 0.4413 Acc: 0.6591
Epoch 20/90
----------
train Loss: 0.4671 Acc: 0.5933
val Loss: 0.4301 Acc: 0.6591
Epoch 21/90
----------
train Loss: 0.4639 Acc: 0.5933
val Loss: 0.4224 Acc: 0.6591
Epoch 22/90
----------
train Loss: 0.4578 Acc: 0.5981
val Loss: 0.4140 Acc: 0.7045
Epoch 23/90
----------
train Loss: 0.4460 Acc: 0.6172
val Loss: 0.4045 Acc: 0.6818
Epoch 24/90
----------
train Loss: 0.4210 Acc: 0.6603
val Loss: 0.3887 Acc: 0.7045
Epoch 25/90
----------
train Loss: 0.4384 Acc: 0.6651
val Loss: 0.3897 Acc: 0.7500
Epoch 26/90
----------
train Loss: 0.4359 Acc: 0.6316
val Loss: 0.3875 Acc: 0.7727
Epoch 27/90
----------
train Loss: 0.4019 Acc: 0.6986
val Loss: 0.3783 Acc: 0.7500
Epoch 28/90
----------
train Loss: 0.4269 Acc: 0.6364
val Loss: 0.3732 Acc: 0.7727
Epoch 29/90
----------
train Loss: 0.4407 Acc: 0.6268
val Loss: 0.3692 Acc: 0.7500
Epoch 30/90
----------
train Loss: 0.4197 Acc: 0.6316
val Loss: 0.3664 Acc: 0.7727
Epoch 31/90
----------
train Loss: 0.3874 Acc: 0.7703
val Loss: 0.3578 Acc: 0.7727
Epoch 32/90
----------
train Loss: 0.3996 Acc: 0.6746
val Loss: 0.3486 Acc: 0.7955
Epoch 33/90
----------
train Loss: 0.4134 Acc: 0.6746
val Loss: 0.3462 Acc: 0.7500
Epoch 34/90
----------
train Loss: 0.3913 Acc: 0.7273
val Loss: 0.3413 Acc: 0.7955
Epoch 35/90
----------
train Loss: 0.3591 Acc: 0.7799
val Loss: 0.3381 Acc: 0.7955
Epoch 36/90
----------
train Loss: 0.4192 Acc: 0.6746
val Loss: 0.3320 Acc: 0.7955
Epoch 37/90
----------
train Loss: 0.3776 Acc: 0.7321
val Loss: 0.3366 Acc: 0.7955
Epoch 38/90
----------
train Loss: 0.3760 Acc: 0.7847
val Loss: 0.3333 Acc: 0.7955
Epoch 39/90
----------
train Loss: 0.3921 Acc: 0.6555
val Loss: 0.3405 Acc: 0.8182
Epoch 40/90
----------
train Loss: 0.3545 Acc: 0.7560
val Loss: 0.3364 Acc: 0.7955
Epoch 41/90
----------
train Loss: 0.3998 Acc: 0.6746
val Loss: 0.3314 Acc: 0.7727
Epoch 42/90
----------
train Loss: 0.3546 Acc: 0.7273
val Loss: 0.3240 Acc: 0.7955
Epoch 43/90
----------
train Loss: 0.3735 Acc: 0.7321
val Loss: 0.3183 Acc: 0.7727
Epoch 44/90
----------
train Loss: 0.3442 Acc: 0.8038
val Loss: 0.3146 Acc: 0.7955
Epoch 45/90
----------
train Loss: 0.2694 Acc: 0.9091
val Loss: 0.3089 Acc: 0.7955
Epoch 46/90
----------
train Loss: 0.4032 Acc: 0.7751
val Loss: 0.3101 Acc: 0.7955
Epoch 47/90
----------
train Loss: 0.3321 Acc: 0.8086
val Loss: 0.3073 Acc: 0.7955
Epoch 48/90
----------
train Loss: 0.3553 Acc: 0.7608
val Loss: 0.3080 Acc: 0.7727
Epoch 49/90
----------
train Loss: 0.3419 Acc: 0.8325
val Loss: 0.3038 Acc: 0.7955
Epoch 50/90
----------
train Loss: 0.3318 Acc: 0.7751
val Loss: 0.3043 Acc: 0.7955
Epoch 51/90
----------
train Loss: 0.2844 Acc: 0.9234
val Loss: 0.2967 Acc: 0.7955
Epoch 52/90
----------
train Loss: 0.3479 Acc: 0.7512
val Loss: 0.2993 Acc: 0.7727
Epoch 53/90
----------
train Loss: 0.3720 Acc: 0.7943
val Loss: 0.2973 Acc: 0.7955
Epoch 54/90
----------
train Loss: 0.2943 Acc: 0.8900
val Loss: 0.2917 Acc: 0.7955
Epoch 55/90
----------
train Loss: 0.3128 Acc: 0.8804
val Loss: 0.2882 Acc: 0.7955
Epoch 56/90
----------
train Loss: 0.3457 Acc: 0.8134
val Loss: 0.2888 Acc: 0.7955
Epoch 57/90
----------
train Loss: 0.3783 Acc: 0.7416
val Loss: 0.2876 Acc: 0.8182
Epoch 58/90
----------
train Loss: 0.3219 Acc: 0.7799
val Loss: 0.2858 Acc: 0.8182
Epoch 59/90
----------
train Loss: 0.3414 Acc: 0.8182
val Loss: 0.2848 Acc: 0.8182
Epoch 60/90
----------
train Loss: 0.2999 Acc: 0.8182
val Loss: 0.2853 Acc: 0.7955
Epoch 61/90
----------
train Loss: 0.3719 Acc: 0.7033
val Loss: 0.2854 Acc: 0.7955
Epoch 62/90
----------
train Loss: 0.3309 Acc: 0.8612
val Loss: 0.2841 Acc: 0.7955
Epoch 63/90
----------
train Loss: 0.2939 Acc: 0.9091
val Loss: 0.2834 Acc: 0.7955
Epoch 64/90
----------
train Loss: 0.2855 Acc: 0.8995
val Loss: 0.2798 Acc: 0.8182
Epoch 65/90
----------
train Loss: 0.3150 Acc: 0.7799
val Loss: 0.2781 Acc: 0.7955
Epoch 66/90
----------
train Loss: 0.3058 Acc: 0.8612
val Loss: 0.2811 Acc: 0.7727
Epoch 67/90
----------
train Loss: 0.3310 Acc: 0.8325
val Loss: 0.2744 Acc: 0.7955
Epoch 68/90
----------
train Loss: 0.2871 Acc: 0.8804
val Loss: 0.2765 Acc: 0.7727
Epoch 69/90
----------
train Loss: 0.2904 Acc: 0.8517
val Loss: 0.2753 Acc: 0.8182
Epoch 70/90
----------
train Loss: 0.3174 Acc: 0.8469
val Loss: 0.2793 Acc: 0.7955
Epoch 71/90
----------
train Loss: 0.3346 Acc: 0.8565
val Loss: 0.2774 Acc: 0.7955
Epoch 72/90
----------
train Loss: 0.3325 Acc: 0.8421
val Loss: 0.2826 Acc: 0.7955
Epoch 73/90
----------
train Loss: 0.2413 Acc: 0.9474
val Loss: 0.2819 Acc: 0.8182
Epoch 74/90
----------
train Loss: 0.3461 Acc: 0.7943
val Loss: 0.2762 Acc: 0.7955
Epoch 75/90
----------
train Loss: 0.2675 Acc: 0.8995
val Loss: 0.2768 Acc: 0.7955
Epoch 76/90
----------
train Loss: 0.2930 Acc: 0.7751
val Loss: 0.2737 Acc: 0.7727
Epoch 77/90
----------
train Loss: 0.3157 Acc: 0.8182
val Loss: 0.2722 Acc: 0.7955
Epoch 78/90
----------
train Loss: 0.2760 Acc: 0.8565
val Loss: 0.2696 Acc: 0.7955
Epoch 79/90
----------
train Loss: 0.3421 Acc: 0.7990
val Loss: 0.2644 Acc: 0.8409
Epoch 80/90
----------
train Loss: 0.3002 Acc: 0.8421
val Loss: 0.2633 Acc: 0.8409
Epoch 81/90
----------
train Loss: 0.3384 Acc: 0.7608
val Loss: 0.2710 Acc: 0.8409
Epoch 82/90
----------
train Loss: 0.2937 Acc: 0.8278
val Loss: 0.2713 Acc: 0.7955
Epoch 83/90
----------
train Loss: 0.2525 Acc: 0.9426
val Loss: 0.2714 Acc: 0.8182
Epoch 84/90
----------
train Loss: 0.3361 Acc: 0.7416
val Loss: 0.2713 Acc: 0.8182
Epoch 85/90
----------
train Loss: 0.2753 Acc: 0.8086
val Loss: 0.2714 Acc: 0.7727
Epoch 86/90
----------
train Loss: 0.2809 Acc: 0.8612
val Loss: 0.2638 Acc: 0.8409
Epoch 87/90
----------
train Loss: 0.3142 Acc: 0.8612
val Loss: 0.2625 Acc: 0.8409
Epoch 88/90
----------
train Loss: 0.3228 Acc: 0.8804
val Loss: 0.2597 Acc: 0.8409
Epoch 89/90
----------
train Loss: 0.3504 Acc: 0.7847
val Loss: 0.2590 Acc: 0.8636
Epoch 90/90
----------
train Loss: 0.2932 Acc: 0.8469
[32m[I 2025-06-28 15:21:53,407][0m Trial 67 finished with value: 0.8181818181818182 and parameters: {'batch_size': 12, 'lr': 3.5535284152917976e-05, 'num_epochs': 90, 'weight_decay': 0.0011701667707526865, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2605 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_3.5535284152917976e-05_epoch_90_wd_0.0011701667707526865_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 0.6957 Acc: 0.2249
val Loss: 0.6773 Acc: 0.2500
Epoch 2/92
----------
train Loss: 0.6728 Acc: 0.2775
val Loss: 0.6605 Acc: 0.2955
Epoch 3/92
----------
train Loss: 0.6544 Acc: 0.3397
val Loss: 0.6366 Acc: 0.3636
Epoch 4/92
----------
train Loss: 0.6413 Acc: 0.3493
val Loss: 0.6220 Acc: 0.4091
Epoch 5/92
----------
train Loss: 0.6324 Acc: 0.3732
val Loss: 0.6135 Acc: 0.4318
Epoch 6/92
----------
train Loss: 0.6156 Acc: 0.4450
val Loss: 0.6003 Acc: 0.5000
Epoch 7/92
----------
train Loss: 0.5994 Acc: 0.4976
val Loss: 0.5852 Acc: 0.5455
Epoch 8/92
----------
train Loss: 0.5884 Acc: 0.4976
val Loss: 0.5716 Acc: 0.6364
Epoch 9/92
----------
train Loss: 0.5758 Acc: 0.5311
val Loss: 0.5558 Acc: 0.6364
Epoch 10/92
----------
train Loss: 0.5530 Acc: 0.5263
val Loss: 0.5373 Acc: 0.6591
Epoch 11/92
----------
train Loss: 0.5540 Acc: 0.5167
val Loss: 0.5259 Acc: 0.6364
Epoch 12/92
----------
train Loss: 0.5471 Acc: 0.5215
val Loss: 0.5174 Acc: 0.6364
Epoch 13/92
----------
train Loss: 0.5233 Acc: 0.5694
val Loss: 0.4991 Acc: 0.6591
Epoch 14/92
----------
train Loss: 0.5080 Acc: 0.5646
val Loss: 0.4907 Acc: 0.6591
Epoch 15/92
----------
train Loss: 0.5070 Acc: 0.5455
val Loss: 0.4808 Acc: 0.6818
Epoch 16/92
----------
train Loss: 0.4973 Acc: 0.5837
val Loss: 0.4673 Acc: 0.6818
Epoch 17/92
----------
train Loss: 0.4880 Acc: 0.5502
val Loss: 0.4558 Acc: 0.6591
Epoch 18/92
----------
train Loss: 0.4782 Acc: 0.5598
val Loss: 0.4448 Acc: 0.6591
Epoch 19/92
----------
train Loss: 0.4639 Acc: 0.6124
val Loss: 0.4361 Acc: 0.6591
Epoch 20/92
----------
train Loss: 0.4621 Acc: 0.5789
val Loss: 0.4251 Acc: 0.6591
Epoch 21/92
----------
train Loss: 0.4598 Acc: 0.5837
val Loss: 0.4172 Acc: 0.6591
Epoch 22/92
----------
train Loss: 0.4534 Acc: 0.5933
val Loss: 0.4089 Acc: 0.7045
Epoch 23/92
----------
train Loss: 0.4416 Acc: 0.6077
val Loss: 0.3998 Acc: 0.6818
Epoch 24/92
----------
train Loss: 0.4170 Acc: 0.6603
val Loss: 0.3840 Acc: 0.6818
Epoch 25/92
----------
train Loss: 0.4349 Acc: 0.6651
val Loss: 0.3851 Acc: 0.7273
Epoch 26/92
----------
train Loss: 0.4330 Acc: 0.6316
val Loss: 0.3837 Acc: 0.7727
Epoch 27/92
----------
train Loss: 0.3981 Acc: 0.6938
val Loss: 0.3756 Acc: 0.7500
Epoch 28/92
----------
train Loss: 0.4242 Acc: 0.6364
val Loss: 0.3708 Acc: 0.7727
Epoch 29/92
----------
train Loss: 0.4383 Acc: 0.6316
val Loss: 0.3675 Acc: 0.7727
Epoch 30/92
----------
train Loss: 0.4172 Acc: 0.6316
val Loss: 0.3644 Acc: 0.7727
Epoch 31/92
----------
train Loss: 0.3836 Acc: 0.7656
val Loss: 0.3555 Acc: 0.7955
Epoch 32/92
----------
train Loss: 0.3967 Acc: 0.6746
val Loss: 0.3466 Acc: 0.7955
Epoch 33/92
----------
train Loss: 0.4104 Acc: 0.6603
val Loss: 0.3447 Acc: 0.7955
Epoch 34/92
----------
train Loss: 0.3889 Acc: 0.7321
val Loss: 0.3397 Acc: 0.7955
Epoch 35/92
----------
train Loss: 0.3560 Acc: 0.7895
val Loss: 0.3371 Acc: 0.7955
Epoch 36/92
----------
train Loss: 0.4165 Acc: 0.6746
val Loss: 0.3318 Acc: 0.8182
Epoch 37/92
----------
train Loss: 0.3745 Acc: 0.7273
val Loss: 0.3366 Acc: 0.7955
Epoch 38/92
----------
train Loss: 0.3724 Acc: 0.8038
val Loss: 0.3333 Acc: 0.8182
Epoch 39/92
----------
train Loss: 0.3900 Acc: 0.6555
val Loss: 0.3416 Acc: 0.8182
Epoch 40/92
----------
train Loss: 0.3513 Acc: 0.7608
val Loss: 0.3378 Acc: 0.7955
Epoch 41/92
----------
train Loss: 0.3983 Acc: 0.6890
val Loss: 0.3319 Acc: 0.7727
Epoch 42/92
----------
train Loss: 0.3513 Acc: 0.7273
val Loss: 0.3245 Acc: 0.7955
Epoch 43/92
----------
train Loss: 0.3700 Acc: 0.7368
val Loss: 0.3189 Acc: 0.7727
Epoch 44/92
----------
train Loss: 0.3411 Acc: 0.8086
val Loss: 0.3147 Acc: 0.7955
Epoch 45/92
----------
train Loss: 0.2647 Acc: 0.9043
val Loss: 0.3079 Acc: 0.7955
Epoch 46/92
----------
train Loss: 0.4008 Acc: 0.7799
val Loss: 0.3098 Acc: 0.7955
Epoch 47/92
----------
train Loss: 0.3285 Acc: 0.8230
val Loss: 0.3072 Acc: 0.7955
Epoch 48/92
----------
train Loss: 0.3512 Acc: 0.7608
val Loss: 0.3068 Acc: 0.7727
Epoch 49/92
----------
train Loss: 0.3393 Acc: 0.8325
val Loss: 0.3034 Acc: 0.7955
Epoch 50/92
----------
train Loss: 0.3281 Acc: 0.7751
val Loss: 0.3050 Acc: 0.7955
Epoch 51/92
----------
train Loss: 0.2797 Acc: 0.9234
val Loss: 0.2971 Acc: 0.7955
Epoch 52/92
----------
train Loss: 0.3443 Acc: 0.7464
val Loss: 0.2991 Acc: 0.7727
Epoch 53/92
----------
train Loss: 0.3701 Acc: 0.7990
val Loss: 0.2974 Acc: 0.7955
Epoch 54/92
----------
train Loss: 0.2908 Acc: 0.9043
val Loss: 0.2915 Acc: 0.7955
Epoch 55/92
----------
train Loss: 0.3086 Acc: 0.8756
val Loss: 0.2885 Acc: 0.7955
Epoch 56/92
----------
train Loss: 0.3423 Acc: 0.8182
val Loss: 0.2890 Acc: 0.7955
Epoch 57/92
----------
train Loss: 0.3762 Acc: 0.7656
val Loss: 0.2879 Acc: 0.8182
Epoch 58/92
----------
train Loss: 0.3183 Acc: 0.7895
val Loss: 0.2865 Acc: 0.8182
Epoch 59/92
----------
train Loss: 0.3383 Acc: 0.8278
val Loss: 0.2864 Acc: 0.7955
Epoch 60/92
----------
train Loss: 0.2950 Acc: 0.8182
val Loss: 0.2879 Acc: 0.7955
Epoch 61/92
----------
train Loss: 0.3697 Acc: 0.7129
val Loss: 0.2871 Acc: 0.7955
Epoch 62/92
----------
train Loss: 0.3270 Acc: 0.8660
val Loss: 0.2851 Acc: 0.7955
Epoch 63/92
----------
train Loss: 0.2905 Acc: 0.9187
val Loss: 0.2842 Acc: 0.7727
Epoch 64/92
----------
train Loss: 0.2820 Acc: 0.8995
val Loss: 0.2801 Acc: 0.7955
Epoch 65/92
----------
train Loss: 0.3107 Acc: 0.7943
val Loss: 0.2785 Acc: 0.7727
Epoch 66/92
----------
train Loss: 0.3015 Acc: 0.8565
val Loss: 0.2812 Acc: 0.7727
Epoch 67/92
----------
train Loss: 0.3279 Acc: 0.8421
val Loss: 0.2741 Acc: 0.7955
Epoch 68/92
----------
train Loss: 0.2835 Acc: 0.8804
val Loss: 0.2770 Acc: 0.7727
Epoch 69/92
----------
train Loss: 0.2864 Acc: 0.8756
val Loss: 0.2759 Acc: 0.7955
Epoch 70/92
----------
train Loss: 0.3156 Acc: 0.8469
val Loss: 0.2810 Acc: 0.7727
Epoch 71/92
----------
train Loss: 0.3311 Acc: 0.8756
val Loss: 0.2795 Acc: 0.7955
Epoch 72/92
----------
train Loss: 0.3288 Acc: 0.8373
val Loss: 0.2855 Acc: 0.7955
Epoch 73/92
----------
train Loss: 0.2380 Acc: 0.9426
val Loss: 0.2844 Acc: 0.7955
Epoch 74/92
----------
train Loss: 0.3429 Acc: 0.8134
val Loss: 0.2774 Acc: 0.7727
Epoch 75/92
----------
train Loss: 0.2632 Acc: 0.9187
val Loss: 0.2774 Acc: 0.7955
Epoch 76/92
----------
train Loss: 0.2887 Acc: 0.7799
val Loss: 0.2739 Acc: 0.7727
Epoch 77/92
----------
train Loss: 0.3128 Acc: 0.8230
val Loss: 0.2733 Acc: 0.7955
Epoch 78/92
----------
train Loss: 0.2721 Acc: 0.8612
val Loss: 0.2716 Acc: 0.8182
Epoch 79/92
----------
train Loss: 0.3398 Acc: 0.8134
val Loss: 0.2670 Acc: 0.8409
Epoch 80/92
----------
train Loss: 0.2977 Acc: 0.8373
val Loss: 0.2660 Acc: 0.8636
Epoch 81/92
----------
train Loss: 0.3373 Acc: 0.7608
val Loss: 0.2739 Acc: 0.8409
Epoch 82/92
----------
train Loss: 0.2905 Acc: 0.8230
val Loss: 0.2745 Acc: 0.8636
Epoch 83/92
----------
train Loss: 0.2503 Acc: 0.9426
val Loss: 0.2748 Acc: 0.8409
Epoch 84/92
----------
train Loss: 0.3320 Acc: 0.7368
val Loss: 0.2744 Acc: 0.8182
Epoch 85/92
----------
train Loss: 0.2726 Acc: 0.8038
val Loss: 0.2741 Acc: 0.8182
Epoch 86/92
----------
train Loss: 0.2778 Acc: 0.8660
val Loss: 0.2652 Acc: 0.8409
Epoch 87/92
----------
train Loss: 0.3102 Acc: 0.8660
val Loss: 0.2637 Acc: 0.8409
Epoch 88/92
----------
train Loss: 0.3207 Acc: 0.8804
val Loss: 0.2604 Acc: 0.8409
Epoch 89/92
----------
train Loss: 0.3484 Acc: 0.7847
val Loss: 0.2599 Acc: 0.8636
Epoch 90/92
----------
train Loss: 0.2931 Acc: 0.8612
val Loss: 0.2625 Acc: 0.8409
Epoch 91/92
----------
train Loss: 0.2560 Acc: 0.9282
val Loss: 0.2669 Acc: 0.7955
Epoch 92/92
----------
train Loss: 0.2765 Acc: 0.9282
[32m[I 2025-06-28 15:42:49,195][0m Trial 68 finished with value: 0.8181818181818182 and parameters: {'batch_size': 9, 'lr': 4.085472653590503e-05, 'num_epochs': 92, 'weight_decay': 0.0022053221157911015, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2676 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_9_lr_4.085472653590503e-05_epoch_92_wd_0.0022053221157911015_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/85
----------
train Loss: 0.7011 Acc: 0.2249
val Loss: 0.6870 Acc: 0.1591
Epoch 2/85
----------
train Loss: 0.6913 Acc: 0.2201
val Loss: 0.6820 Acc: 0.2273
Epoch 3/85
----------
train Loss: 0.6845 Acc: 0.2344
val Loss: 0.6719 Acc: 0.1818
Epoch 4/85
----------
train Loss: 0.6815 Acc: 0.2488
val Loss: 0.6670 Acc: 0.2045
Epoch 5/85
----------
train Loss: 0.6829 Acc: 0.2201
val Loss: 0.6662 Acc: 0.2273
Epoch 6/85
----------
train Loss: 0.6761 Acc: 0.2679
val Loss: 0.6627 Acc: 0.2273
Epoch 7/85
----------
train Loss: 0.6708 Acc: 0.2584
val Loss: 0.6592 Acc: 0.2500
Epoch 8/85
----------
train Loss: 0.6637 Acc: 0.3158
val Loss: 0.6568 Acc: 0.2727
Epoch 9/85
----------
train Loss: 0.6608 Acc: 0.3493
val Loss: 0.6529 Acc: 0.2955
Epoch 10/85
----------
train Loss: 0.6540 Acc: 0.3206
val Loss: 0.6482 Acc: 0.2955
Epoch 11/85
----------
train Loss: 0.6549 Acc: 0.2871
val Loss: 0.6457 Acc: 0.3182
Epoch 12/85
----------
train Loss: 0.6511 Acc: 0.3349
val Loss: 0.6438 Acc: 0.3409
Epoch 13/85
----------
train Loss: 0.6405 Acc: 0.4450
val Loss: 0.6375 Acc: 0.3409
Epoch 14/85
----------
train Loss: 0.6367 Acc: 0.4115
val Loss: 0.6350 Acc: 0.4091
Epoch 15/85
----------
train Loss: 0.6328 Acc: 0.4354
val Loss: 0.6339 Acc: 0.4091
Epoch 16/85
----------
train Loss: 0.6289 Acc: 0.4211
val Loss: 0.6262 Acc: 0.4318
Epoch 17/85
----------
train Loss: 0.6270 Acc: 0.4641
val Loss: 0.6230 Acc: 0.4545
Epoch 18/85
----------
train Loss: 0.6250 Acc: 0.4354
val Loss: 0.6169 Acc: 0.4545
Epoch 19/85
----------
train Loss: 0.6172 Acc: 0.4785
val Loss: 0.6126 Acc: 0.5000
Epoch 20/85
----------
train Loss: 0.6123 Acc: 0.4928
val Loss: 0.6098 Acc: 0.5000
Epoch 21/85
----------
train Loss: 0.6115 Acc: 0.5120
val Loss: 0.6094 Acc: 0.5227
Epoch 22/85
----------
train Loss: 0.6096 Acc: 0.4737
val Loss: 0.6062 Acc: 0.5227
Epoch 23/85
----------
train Loss: 0.6024 Acc: 0.5263
val Loss: 0.6009 Acc: 0.5455
Epoch 24/85
----------
train Loss: 0.5917 Acc: 0.5598
val Loss: 0.5907 Acc: 0.5682
Epoch 25/85
----------
train Loss: 0.5950 Acc: 0.5120
val Loss: 0.5923 Acc: 0.5455
Epoch 26/85
----------
train Loss: 0.5920 Acc: 0.5359
val Loss: 0.5907 Acc: 0.5455
Epoch 27/85
----------
train Loss: 0.5821 Acc: 0.5694
val Loss: 0.5814 Acc: 0.5909
Epoch 28/85
----------
train Loss: 0.5859 Acc: 0.5455
val Loss: 0.5786 Acc: 0.6136
Epoch 29/85
----------
train Loss: 0.5856 Acc: 0.4976
val Loss: 0.5753 Acc: 0.6136
Epoch 30/85
----------
train Loss: 0.5791 Acc: 0.5120
val Loss: 0.5731 Acc: 0.6136
Epoch 31/85
----------
train Loss: 0.5676 Acc: 0.5694
val Loss: 0.5674 Acc: 0.6364
Epoch 32/85
----------
train Loss: 0.5661 Acc: 0.5742
val Loss: 0.5650 Acc: 0.6591
Epoch 33/85
----------
train Loss: 0.5671 Acc: 0.5263
val Loss: 0.5613 Acc: 0.6818
Epoch 34/85
----------
train Loss: 0.5610 Acc: 0.5455
val Loss: 0.5593 Acc: 0.6364
Epoch 35/85
----------
train Loss: 0.5507 Acc: 0.5646
val Loss: 0.5528 Acc: 0.6818
Epoch 36/85
----------
train Loss: 0.5627 Acc: 0.5311
val Loss: 0.5489 Acc: 0.6364
Epoch 37/85
----------
train Loss: 0.5518 Acc: 0.5407
val Loss: 0.5429 Acc: 0.6818
Epoch 38/85
----------
train Loss: 0.5479 Acc: 0.5789
val Loss: 0.5376 Acc: 0.6591
Epoch 39/85
----------
train Loss: 0.5476 Acc: 0.5407
val Loss: 0.5393 Acc: 0.6364
Epoch 40/85
----------
train Loss: 0.5362 Acc: 0.5837
val Loss: 0.5336 Acc: 0.6591
Epoch 41/85
----------
train Loss: 0.5450 Acc: 0.5359
val Loss: 0.5270 Acc: 0.6591
Epoch 42/85
----------
train Loss: 0.5280 Acc: 0.5694
val Loss: 0.5232 Acc: 0.6364
Epoch 43/85
----------
train Loss: 0.5344 Acc: 0.5407
val Loss: 0.5203 Acc: 0.6591
Epoch 44/85
----------
train Loss: 0.5218 Acc: 0.5933
val Loss: 0.5135 Acc: 0.6818
Epoch 45/85
----------
train Loss: 0.5003 Acc: 0.6268
val Loss: 0.5060 Acc: 0.6818
Epoch 46/85
----------
train Loss: 0.5294 Acc: 0.5598
val Loss: 0.5095 Acc: 0.7045
Epoch 47/85
----------
train Loss: 0.5100 Acc: 0.5837
val Loss: 0.5036 Acc: 0.6818
Epoch 48/85
----------
train Loss: 0.5155 Acc: 0.5550
val Loss: 0.4953 Acc: 0.7045
Epoch 49/85
----------
train Loss: 0.5071 Acc: 0.5885
val Loss: 0.4915 Acc: 0.6818
Epoch 50/85
----------
train Loss: 0.5080 Acc: 0.5598
val Loss: 0.4932 Acc: 0.7045
Epoch 51/85
----------
train Loss: 0.4896 Acc: 0.6077
val Loss: 0.4807 Acc: 0.6818
Epoch 52/85
----------
train Loss: 0.4993 Acc: 0.5789
val Loss: 0.4823 Acc: 0.7045
Epoch 53/85
----------
train Loss: 0.5074 Acc: 0.5550
val Loss: 0.4806 Acc: 0.6818
Epoch 54/85
----------
train Loss: 0.4808 Acc: 0.6077
val Loss: 0.4788 Acc: 0.6818
Epoch 55/85
----------
train Loss: 0.4882 Acc: 0.5933
val Loss: 0.4694 Acc: 0.6818
Epoch 56/85
----------
train Loss: 0.4938 Acc: 0.5837
val Loss: 0.4715 Acc: 0.7045
Epoch 57/85
----------
train Loss: 0.4993 Acc: 0.5407
val Loss: 0.4666 Acc: 0.6818
Epoch 58/85
----------
train Loss: 0.4793 Acc: 0.5933
val Loss: 0.4683 Acc: 0.7045
Epoch 59/85
----------
train Loss: 0.4842 Acc: 0.5742
val Loss: 0.4645 Acc: 0.6818
Epoch 60/85
----------
train Loss: 0.4763 Acc: 0.6077
val Loss: 0.4600 Acc: 0.7045
Epoch 61/85
----------
train Loss: 0.4928 Acc: 0.5598
val Loss: 0.4553 Acc: 0.7045
Epoch 62/85
----------
train Loss: 0.4777 Acc: 0.5981
val Loss: 0.4530 Acc: 0.6818
Epoch 63/85
----------
train Loss: 0.4623 Acc: 0.6029
val Loss: 0.4484 Acc: 0.7045
Epoch 64/85
----------
train Loss: 0.4653 Acc: 0.5981
val Loss: 0.4479 Acc: 0.7045
Epoch 65/85
----------
train Loss: 0.4700 Acc: 0.6220
val Loss: 0.4412 Acc: 0.7273
Epoch 66/85
----------
train Loss: 0.4617 Acc: 0.6172
val Loss: 0.4362 Acc: 0.6818
Epoch 67/85
----------
train Loss: 0.4707 Acc: 0.5885
val Loss: 0.4327 Acc: 0.7045
Epoch 68/85
----------
train Loss: 0.4540 Acc: 0.6220
val Loss: 0.4251 Acc: 0.6818
Epoch 69/85
----------
train Loss: 0.4519 Acc: 0.6220
val Loss: 0.4267 Acc: 0.7045
Epoch 70/85
----------
train Loss: 0.4582 Acc: 0.6459
val Loss: 0.4254 Acc: 0.6818
Epoch 71/85
----------
train Loss: 0.4708 Acc: 0.5598
val Loss: 0.4222 Acc: 0.7273
Epoch 72/85
----------
train Loss: 0.4633 Acc: 0.6029
val Loss: 0.4251 Acc: 0.7273
Epoch 73/85
----------
train Loss: 0.4301 Acc: 0.6794
val Loss: 0.4187 Acc: 0.7273
Epoch 74/85
----------
train Loss: 0.4713 Acc: 0.5885
val Loss: 0.4148 Acc: 0.7045
Epoch 75/85
----------
train Loss: 0.4384 Acc: 0.6555
val Loss: 0.4150 Acc: 0.7273
Epoch 76/85
----------
train Loss: 0.4472 Acc: 0.5981
val Loss: 0.4111 Acc: 0.7273
Epoch 77/85
----------
train Loss: 0.4516 Acc: 0.6316
val Loss: 0.4087 Acc: 0.7500
Epoch 78/85
----------
train Loss: 0.4366 Acc: 0.6555
val Loss: 0.4064 Acc: 0.7273
Epoch 79/85
----------
train Loss: 0.4596 Acc: 0.5789
val Loss: 0.4029 Acc: 0.7273
Epoch 80/85
----------
train Loss: 0.4406 Acc: 0.6124
val Loss: 0.3999 Acc: 0.7500
Epoch 81/85
----------
train Loss: 0.4598 Acc: 0.6029
val Loss: 0.4031 Acc: 0.7727
Epoch 82/85
----------
train Loss: 0.4300 Acc: 0.6699
val Loss: 0.4011 Acc: 0.7727
Epoch 83/85
----------
train Loss: 0.4100 Acc: 0.7225
val Loss: 0.3982 Acc: 0.7273
Epoch 84/85
----------
train Loss: 0.4526 Acc: 0.6316
val Loss: 0.3990 Acc: 0.7500
Epoch 85/85
----------
train Loss: 0.4273 Acc: 0.6746
[32m[I 2025-06-28 16:02:08,823][0m Trial 69 finished with value: 0.75 and parameters: {'batch_size': 12, 'lr': 1.0001385540048288e-05, 'num_epochs': 85, 'weight_decay': 0.0005430822146192552, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.3928 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_1.0001385540048288e-05_epoch_85_wd_0.0005430822146192552_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/97
----------
train Loss: 0.6595 Acc: 0.3110
val Loss: 0.6102 Acc: 0.5682
Epoch 2/97
----------
train Loss: 0.5623 Acc: 0.5742
val Loss: 0.4772 Acc: 0.6364
Epoch 3/97
----------
train Loss: 0.4977 Acc: 0.5550
val Loss: 0.3964 Acc: 0.6364
Epoch 4/97
----------
train Loss: 0.4611 Acc: 0.5407
val Loss: 0.3691 Acc: 0.7045
Epoch 5/97
----------
train Loss: 0.4408 Acc: 0.6411
val Loss: 0.3368 Acc: 0.7727
Epoch 6/97
----------
train Loss: 0.4036 Acc: 0.6364
val Loss: 0.2987 Acc: 0.7727
Epoch 7/97
----------
train Loss: 0.3698 Acc: 0.7225
val Loss: 0.2840 Acc: 0.8182
Epoch 8/97
----------
train Loss: 0.3863 Acc: 0.7081
val Loss: 0.2653 Acc: 0.8182
Epoch 9/97
----------
train Loss: 0.3810 Acc: 0.7512
val Loss: 0.2772 Acc: 0.8182
Epoch 10/97
----------
train Loss: 0.2662 Acc: 0.9043
val Loss: 0.2664 Acc: 0.7955
Epoch 11/97
----------
train Loss: 0.3475 Acc: 0.7608
val Loss: 0.2495 Acc: 0.8636
Epoch 12/97
----------
train Loss: 0.3318 Acc: 0.7177
val Loss: 0.2811 Acc: 0.7955
Epoch 13/97
----------
train Loss: 0.2982 Acc: 0.8900
val Loss: 0.2561 Acc: 0.7273
Epoch 14/97
----------
train Loss: 0.2684 Acc: 0.8230
val Loss: 0.2606 Acc: 0.7500
Epoch 15/97
----------
train Loss: 0.2957 Acc: 0.8182
val Loss: 0.2545 Acc: 0.7955
Epoch 16/97
----------
train Loss: 0.3078 Acc: 0.7703
val Loss: 0.2685 Acc: 0.8409
Epoch 17/97
----------
train Loss: 0.2793 Acc: 0.8565
val Loss: 0.3051 Acc: 0.8409
Epoch 18/97
----------
train Loss: 0.2670 Acc: 0.8612
val Loss: 0.2619 Acc: 0.7955
Epoch 19/97
----------
train Loss: 0.2460 Acc: 0.9330
val Loss: 0.2374 Acc: 0.8182
Epoch 20/97
----------
train Loss: 0.2813 Acc: 0.8708
val Loss: 0.2509 Acc: 0.7955
Epoch 21/97
----------
train Loss: 0.2902 Acc: 0.8900
val Loss: 0.2652 Acc: 0.7500
Epoch 22/97
----------
train Loss: 0.2637 Acc: 0.8708
val Loss: 0.2590 Acc: 0.7500
Epoch 23/97
----------
train Loss: 0.2946 Acc: 0.8804
val Loss: 0.2440 Acc: 0.7727
Epoch 24/97
----------
train Loss: 0.2159 Acc: 0.9378
val Loss: 0.2344 Acc: 0.8182
Epoch 25/97
----------
train Loss: 0.2591 Acc: 0.9282
val Loss: 0.2598 Acc: 0.8182
Epoch 26/97
----------
train Loss: 0.2841 Acc: 0.9426
val Loss: 0.2735 Acc: 0.7955
Epoch 27/97
----------
train Loss: 0.2314 Acc: 0.9761
val Loss: 0.2860 Acc: 0.8182
Epoch 28/97
----------
train Loss: 0.2848 Acc: 0.8517
val Loss: 0.2697 Acc: 0.7727
Epoch 29/97
----------
train Loss: 0.3064 Acc: 0.8038
val Loss: 0.2413 Acc: 0.8409
Epoch 30/97
----------
train Loss: 0.2645 Acc: 0.8804
val Loss: 0.2246 Acc: 0.8182
Epoch 31/97
----------
train Loss: 0.2310 Acc: 0.9522
val Loss: 0.2236 Acc: 0.7727
Epoch 32/97
----------
train Loss: 0.2472 Acc: 0.8947
val Loss: 0.2252 Acc: 0.8182
Epoch 33/97
----------
train Loss: 0.2667 Acc: 0.9139
val Loss: 0.2222 Acc: 0.7727
Epoch 34/97
----------
train Loss: 0.2607 Acc: 0.9474
val Loss: 0.2278 Acc: 0.7500
Epoch 35/97
----------
train Loss: 0.2027 Acc: 0.9856
val Loss: 0.2532 Acc: 0.7273
Epoch 36/97
----------
train Loss: 0.3106 Acc: 0.8517
val Loss: 0.2594 Acc: 0.7500
Epoch 37/97
----------
train Loss: 0.2618 Acc: 0.8421
val Loss: 0.2543 Acc: 0.7727
Epoch 38/97
----------
train Loss: 0.2693 Acc: 0.9569
val Loss: 0.2436 Acc: 0.7955
Epoch 39/97
----------
train Loss: 0.2722 Acc: 0.8134
val Loss: 0.2542 Acc: 0.7045
Epoch 40/97
----------
train Loss: 0.2333 Acc: 0.9330
val Loss: 0.2583 Acc: 0.7500
Epoch 41/97
----------
train Loss: 0.3182 Acc: 0.7177
val Loss: 0.2475 Acc: 0.7727
Epoch 42/97
----------
train Loss: 0.2231 Acc: 0.9091
val Loss: 0.2545 Acc: 0.7273
Epoch 43/97
----------
train Loss: 0.2586 Acc: 0.8852
val Loss: 0.2397 Acc: 0.7273
Epoch 44/97
----------
train Loss: 0.2434 Acc: 0.8852
val Loss: 0.2454 Acc: 0.7500
Epoch 45/97
----------
train Loss: 0.1484 Acc: 0.9761
val Loss: 0.2412 Acc: 0.7727
Epoch 46/97
----------
train Loss: 0.3361 Acc: 0.8182
val Loss: 0.2575 Acc: 0.7955
Epoch 47/97
----------
train Loss: 0.2290 Acc: 0.9378
val Loss: 0.2572 Acc: 0.7955
Epoch 48/97
----------
train Loss: 0.2669 Acc: 0.8708
val Loss: 0.2706 Acc: 0.7500
Epoch 49/97
----------
train Loss: 0.2620 Acc: 0.9665
val Loss: 0.2737 Acc: 0.7955
Epoch 50/97
----------
train Loss: 0.2441 Acc: 0.9091
val Loss: 0.2706 Acc: 0.7727
Epoch 51/97
----------
train Loss: 0.1916 Acc: 1.0000
val Loss: 0.2547 Acc: 0.7500
Epoch 52/97
----------
train Loss: 0.2575 Acc: 0.8852
val Loss: 0.2452 Acc: 0.7727
Epoch 53/97
----------
train Loss: 0.2990 Acc: 0.9282
val Loss: 0.2470 Acc: 0.7727
Epoch 54/97
----------
train Loss: 0.2202 Acc: 0.9522
val Loss: 0.2536 Acc: 0.7273
Epoch 55/97
----------
train Loss: 0.2314 Acc: 0.9617
val Loss: 0.2725 Acc: 0.7273
Epoch 56/97
----------
train Loss: 0.2757 Acc: 0.9617
val Loss: 0.2675 Acc: 0.7273
Epoch 57/97
----------
train Loss: 0.3024 Acc: 0.8612
val Loss: 0.2799 Acc: 0.7727
Epoch 58/97
----------
train Loss: 0.2413 Acc: 0.8230
val Loss: 0.2747 Acc: 0.7500
Epoch 59/97
----------
train Loss: 0.2551 Acc: 0.9474
val Loss: 0.2806 Acc: 0.7273
Epoch 60/97
----------
train Loss: 0.2127 Acc: 0.9091
val Loss: 0.2744 Acc: 0.7273
Epoch 61/97
----------
train Loss: 0.2987 Acc: 0.8038
val Loss: 0.2682 Acc: 0.7273
Epoch 62/97
----------
train Loss: 0.2795 Acc: 0.9426
val Loss: 0.2691 Acc: 0.7045
Epoch 63/97
----------
train Loss: 0.2402 Acc: 0.9522
val Loss: 0.2736 Acc: 0.7045
Epoch 64/97
----------
train Loss: 0.2188 Acc: 0.9713
val Loss: 0.2797 Acc: 0.7727
Epoch 65/97
----------
train Loss: 0.2458 Acc: 0.8852
val Loss: 0.2810 Acc: 0.7045
Epoch 66/97
----------
train Loss: 0.2442 Acc: 0.9282
val Loss: 0.2794 Acc: 0.7045
Epoch 67/97
----------
train Loss: 0.2766 Acc: 0.8947
val Loss: 0.2680 Acc: 0.7273
Epoch 68/97
----------
train Loss: 0.2358 Acc: 0.9091
val Loss: 0.2827 Acc: 0.7273
Epoch 69/97
----------
train Loss: 0.2238 Acc: 0.9043
val Loss: 0.2732 Acc: 0.7727
Epoch 70/97
----------
train Loss: 0.2599 Acc: 0.9234
val Loss: 0.2702 Acc: 0.7727
Epoch 71/97
----------
train Loss: 0.2673 Acc: 0.9330
val Loss: 0.2601 Acc: 0.7955
Epoch 72/97
----------
train Loss: 0.2677 Acc: 0.8852
val Loss: 0.2609 Acc: 0.7727
Epoch 73/97
----------
train Loss: 0.1980 Acc: 0.9761
val Loss: 0.2699 Acc: 0.7727
Epoch 74/97
----------
train Loss: 0.2801 Acc: 0.9282
val Loss: 0.2727 Acc: 0.7727
Epoch 75/97
----------
train Loss: 0.2115 Acc: 0.9856
val Loss: 0.2601 Acc: 0.7955
Epoch 76/97
----------
train Loss: 0.2167 Acc: 0.8804
val Loss: 0.2413 Acc: 0.7727
Epoch 77/97
----------
train Loss: 0.2670 Acc: 0.9043
val Loss: 0.2598 Acc: 0.7500
Epoch 78/97
----------
train Loss: 0.2354 Acc: 0.9187
val Loss: 0.2862 Acc: 0.7500
Epoch 79/97
----------
train Loss: 0.2724 Acc: 0.9330
val Loss: 0.2759 Acc: 0.7955
Epoch 80/97
----------
train Loss: 0.2488 Acc: 0.8756
val Loss: 0.2732 Acc: 0.7727
Epoch 81/97
----------
train Loss: 0.2845 Acc: 0.8373
val Loss: 0.2874 Acc: 0.7273
Epoch 82/97
----------
train Loss: 0.2451 Acc: 0.8947
val Loss: 0.3041 Acc: 0.7045
Epoch 83/97
----------
train Loss: 0.2217 Acc: 0.9856
val Loss: 0.2959 Acc: 0.7045
Epoch 84/97
----------
train Loss: 0.2730 Acc: 0.8278
val Loss: 0.2772 Acc: 0.7500
Epoch 85/97
----------
train Loss: 0.2178 Acc: 0.9139
val Loss: 0.2874 Acc: 0.7500
Epoch 86/97
----------
train Loss: 0.2321 Acc: 0.9139
val Loss: 0.2850 Acc: 0.7500
Epoch 87/97
----------
train Loss: 0.2615 Acc: 0.9665
val Loss: 0.2938 Acc: 0.7045
Epoch 88/97
----------
train Loss: 0.2855 Acc: 0.9139
val Loss: 0.2809 Acc: 0.7500
Epoch 89/97
----------
train Loss: 0.2950 Acc: 0.8660
val Loss: 0.2700 Acc: 0.7727
Epoch 90/97
----------
train Loss: 0.2677 Acc: 0.8517
val Loss: 0.2754 Acc: 0.7955
Epoch 91/97
----------
train Loss: 0.2204 Acc: 0.9713
val Loss: 0.2800 Acc: 0.7727
Epoch 92/97
----------
train Loss: 0.2396 Acc: 0.9474
val Loss: 0.2967 Acc: 0.7500
Epoch 93/97
----------
train Loss: 0.2593 Acc: 0.8995
val Loss: 0.2796 Acc: 0.7727
Epoch 94/97
----------
train Loss: 0.2034 Acc: 0.9952
val Loss: 0.2772 Acc: 0.7727
Epoch 95/97
----------
train Loss: 0.2378 Acc: 0.9713
val Loss: 0.2694 Acc: 0.7500
Epoch 96/97
----------
train Loss: 0.1788 Acc: 0.9856
val Loss: 0.2688 Acc: 0.7727
Epoch 97/97
----------
train Loss: 0.2182 Acc: 0.9282
[32m[I 2025-06-28 16:24:12,027][0m Trial 70 finished with value: 0.7727272727272727 and parameters: {'batch_size': 81, 'lr': 0.00024779722953297375, 'num_epochs': 97, 'weight_decay': 0.0003235521995290094, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2738 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_81_lr_0.00024779722953297375_epoch_97_wd_0.0003235521995290094_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 0.6983 Acc: 0.2249
val Loss: 0.6822 Acc: 0.2500
Epoch 2/88
----------
train Loss: 0.6814 Acc: 0.2584
val Loss: 0.6708 Acc: 0.2500
Epoch 3/88
----------
train Loss: 0.6681 Acc: 0.2727
val Loss: 0.6533 Acc: 0.2500
Epoch 4/88
----------
train Loss: 0.6595 Acc: 0.3062
val Loss: 0.6428 Acc: 0.3636
Epoch 5/88
----------
train Loss: 0.6549 Acc: 0.3158
val Loss: 0.6376 Acc: 0.3636
Epoch 6/88
----------
train Loss: 0.6423 Acc: 0.3589
val Loss: 0.6290 Acc: 0.4091
Epoch 7/88
----------
train Loss: 0.6302 Acc: 0.4211
val Loss: 0.6192 Acc: 0.4773
Epoch 8/88
----------
train Loss: 0.6207 Acc: 0.4402
val Loss: 0.6109 Acc: 0.5000
Epoch 9/88
----------
train Loss: 0.6118 Acc: 0.4737
val Loss: 0.6002 Acc: 0.5227
Epoch 10/88
----------
train Loss: 0.5949 Acc: 0.4976
val Loss: 0.5868 Acc: 0.5455
Epoch 11/88
----------
train Loss: 0.5961 Acc: 0.4689
val Loss: 0.5798 Acc: 0.6136
Epoch 12/88
----------
train Loss: 0.5889 Acc: 0.5072
val Loss: 0.5728 Acc: 0.5455
Epoch 13/88
----------
train Loss: 0.5703 Acc: 0.5694
val Loss: 0.5577 Acc: 0.6136
Epoch 14/88
----------
train Loss: 0.5587 Acc: 0.5407
val Loss: 0.5511 Acc: 0.6591
Epoch 15/88
----------
train Loss: 0.5546 Acc: 0.5550
val Loss: 0.5430 Acc: 0.6591
Epoch 16/88
----------
train Loss: 0.5465 Acc: 0.5550
val Loss: 0.5299 Acc: 0.6364
Epoch 17/88
----------
train Loss: 0.5380 Acc: 0.5694
val Loss: 0.5190 Acc: 0.6364
Epoch 18/88
----------
train Loss: 0.5313 Acc: 0.5455
val Loss: 0.5083 Acc: 0.6591
Epoch 19/88
----------
train Loss: 0.5182 Acc: 0.5981
val Loss: 0.4990 Acc: 0.6591
Epoch 20/88
----------
train Loss: 0.5130 Acc: 0.5837
val Loss: 0.4892 Acc: 0.6591
Epoch 21/88
----------
train Loss: 0.5100 Acc: 0.5694
val Loss: 0.4839 Acc: 0.6591
Epoch 22/88
----------
train Loss: 0.5041 Acc: 0.5837
val Loss: 0.4753 Acc: 0.6591
Epoch 23/88
----------
train Loss: 0.4918 Acc: 0.5789
val Loss: 0.4666 Acc: 0.6818
Epoch 24/88
----------
train Loss: 0.4712 Acc: 0.6077
val Loss: 0.4501 Acc: 0.6818
Epoch 25/88
----------
train Loss: 0.4830 Acc: 0.5933
val Loss: 0.4498 Acc: 0.6591
Epoch 26/88
----------
train Loss: 0.4785 Acc: 0.5789
val Loss: 0.4468 Acc: 0.6818
Epoch 27/88
----------
train Loss: 0.4523 Acc: 0.6364
val Loss: 0.4346 Acc: 0.6818
Epoch 28/88
----------
train Loss: 0.4675 Acc: 0.5885
val Loss: 0.4288 Acc: 0.7500
Epoch 29/88
----------
train Loss: 0.4757 Acc: 0.5598
val Loss: 0.4227 Acc: 0.7273
Epoch 30/88
----------
train Loss: 0.4605 Acc: 0.5885
val Loss: 0.4193 Acc: 0.7273
Epoch 31/88
----------
train Loss: 0.4362 Acc: 0.6746
val Loss: 0.4111 Acc: 0.7273
Epoch 32/88
----------
train Loss: 0.4416 Acc: 0.6172
val Loss: 0.4031 Acc: 0.7500
Epoch 33/88
----------
train Loss: 0.4507 Acc: 0.6316
val Loss: 0.3988 Acc: 0.7273
Epoch 34/88
----------
train Loss: 0.4340 Acc: 0.6220
val Loss: 0.3929 Acc: 0.7273
Epoch 35/88
----------
train Loss: 0.4095 Acc: 0.6603
val Loss: 0.3871 Acc: 0.7500
Epoch 36/88
----------
train Loss: 0.4532 Acc: 0.5981
val Loss: 0.3787 Acc: 0.7500
Epoch 37/88
----------
train Loss: 0.4210 Acc: 0.6603
val Loss: 0.3813 Acc: 0.7273
Epoch 38/88
----------
train Loss: 0.4197 Acc: 0.6890
val Loss: 0.3759 Acc: 0.7500
Epoch 39/88
----------
train Loss: 0.4278 Acc: 0.6124
val Loss: 0.3800 Acc: 0.7273
Epoch 40/88
----------
train Loss: 0.4012 Acc: 0.6794
val Loss: 0.3736 Acc: 0.7500
Epoch 41/88
----------
train Loss: 0.4328 Acc: 0.6316
val Loss: 0.3688 Acc: 0.7273
Epoch 42/88
----------
train Loss: 0.3976 Acc: 0.6651
val Loss: 0.3625 Acc: 0.7273
Epoch 43/88
----------
train Loss: 0.4134 Acc: 0.6411
val Loss: 0.3561 Acc: 0.7727
Epoch 44/88
----------
train Loss: 0.3884 Acc: 0.7464
val Loss: 0.3525 Acc: 0.7727
Epoch 45/88
----------
train Loss: 0.3324 Acc: 0.8182
val Loss: 0.3476 Acc: 0.7727
Epoch 46/88
----------
train Loss: 0.4308 Acc: 0.7368
val Loss: 0.3485 Acc: 0.7727
Epoch 47/88
----------
train Loss: 0.3770 Acc: 0.7560
val Loss: 0.3450 Acc: 0.7727
Epoch 48/88
----------
train Loss: 0.3939 Acc: 0.7273
val Loss: 0.3439 Acc: 0.7727
Epoch 49/88
----------
train Loss: 0.3822 Acc: 0.7656
val Loss: 0.3372 Acc: 0.7727
Epoch 50/88
----------
train Loss: 0.3755 Acc: 0.7129
val Loss: 0.3377 Acc: 0.7727
Epoch 51/88
----------
train Loss: 0.3395 Acc: 0.8086
val Loss: 0.3294 Acc: 0.7727
Epoch 52/88
----------
train Loss: 0.3848 Acc: 0.7033
val Loss: 0.3314 Acc: 0.7955
Epoch 53/88
----------
train Loss: 0.3996 Acc: 0.7273
val Loss: 0.3295 Acc: 0.7955
Epoch 54/88
----------
train Loss: 0.3390 Acc: 0.8325
val Loss: 0.3249 Acc: 0.7727
Epoch 55/88
----------
train Loss: 0.3561 Acc: 0.8134
val Loss: 0.3199 Acc: 0.8182
Epoch 56/88
----------
train Loss: 0.3794 Acc: 0.7656
val Loss: 0.3198 Acc: 0.8182
Epoch 57/88
----------
train Loss: 0.4059 Acc: 0.6986
val Loss: 0.3180 Acc: 0.8182
Epoch 58/88
----------
train Loss: 0.3581 Acc: 0.7464
val Loss: 0.3167 Acc: 0.8182
Epoch 59/88
----------
train Loss: 0.3776 Acc: 0.7273
val Loss: 0.3138 Acc: 0.8182
Epoch 60/88
----------
train Loss: 0.3485 Acc: 0.7560
val Loss: 0.3127 Acc: 0.7955
Epoch 61/88
----------
train Loss: 0.3985 Acc: 0.6746
val Loss: 0.3121 Acc: 0.8182
Epoch 62/88
----------
train Loss: 0.3656 Acc: 0.7847
val Loss: 0.3112 Acc: 0.8182
Epoch 63/88
----------
train Loss: 0.3348 Acc: 0.8421
val Loss: 0.3094 Acc: 0.8182
Epoch 64/88
----------
train Loss: 0.3285 Acc: 0.8517
val Loss: 0.3062 Acc: 0.7955
Epoch 65/88
----------
train Loss: 0.3531 Acc: 0.7225
val Loss: 0.3020 Acc: 0.8182
Epoch 66/88
----------
train Loss: 0.3463 Acc: 0.7990
val Loss: 0.3042 Acc: 0.7727
Epoch 67/88
----------
train Loss: 0.3635 Acc: 0.7847
val Loss: 0.2985 Acc: 0.7955
Epoch 68/88
----------
train Loss: 0.3262 Acc: 0.8373
val Loss: 0.2986 Acc: 0.7955
Epoch 69/88
----------
train Loss: 0.3312 Acc: 0.8134
val Loss: 0.2979 Acc: 0.7955
Epoch 70/88
----------
train Loss: 0.3497 Acc: 0.7895
val Loss: 0.3016 Acc: 0.7727
Epoch 71/88
----------
train Loss: 0.3685 Acc: 0.7608
val Loss: 0.2989 Acc: 0.7955
Epoch 72/88
----------
train Loss: 0.3649 Acc: 0.7799
val Loss: 0.3018 Acc: 0.7955
Epoch 73/88
----------
train Loss: 0.2839 Acc: 0.9091
val Loss: 0.3010 Acc: 0.7955
Epoch 74/88
----------
train Loss: 0.3769 Acc: 0.7416
val Loss: 0.2963 Acc: 0.7955
Epoch 75/88
----------
train Loss: 0.3080 Acc: 0.8421
val Loss: 0.2965 Acc: 0.7955
Epoch 76/88
----------
train Loss: 0.3331 Acc: 0.7321
val Loss: 0.2930 Acc: 0.7955
Epoch 77/88
----------
train Loss: 0.3475 Acc: 0.8038
val Loss: 0.2915 Acc: 0.7955
Epoch 78/88
----------
train Loss: 0.3113 Acc: 0.8230
val Loss: 0.2888 Acc: 0.7955
Epoch 79/88
----------
train Loss: 0.3718 Acc: 0.7656
val Loss: 0.2838 Acc: 0.7955
Epoch 80/88
----------
train Loss: 0.3323 Acc: 0.8134
val Loss: 0.2833 Acc: 0.7955
Epoch 81/88
----------
train Loss: 0.3654 Acc: 0.7368
val Loss: 0.2888 Acc: 0.8182
Epoch 82/88
----------
train Loss: 0.3248 Acc: 0.8086
val Loss: 0.2891 Acc: 0.8182
Epoch 83/88
----------
train Loss: 0.2851 Acc: 0.9282
val Loss: 0.2889 Acc: 0.8182
Epoch 84/88
----------
train Loss: 0.3635 Acc: 0.7273
val Loss: 0.2893 Acc: 0.7955
Epoch 85/88
----------
train Loss: 0.3110 Acc: 0.7656
val Loss: 0.2869 Acc: 0.7955
Epoch 86/88
----------
train Loss: 0.3124 Acc: 0.8325
val Loss: 0.2813 Acc: 0.7955
Epoch 87/88
----------
train Loss: 0.3449 Acc: 0.8230
val Loss: 0.2812 Acc: 0.7955
Epoch 88/88
----------
train Loss: 0.3478 Acc: 0.8660
[32m[I 2025-06-28 16:44:13,742][0m Trial 71 finished with value: 0.7954545454545455 and parameters: {'batch_size': 27, 'lr': 2.3790000653595228e-05, 'num_epochs': 88, 'weight_decay': 0.00010316571888117321, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2782 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_27_lr_2.3790000653595228e-05_epoch_88_wd_0.00010316571888117321_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/93
----------
train Loss: 0.6925 Acc: 0.2392
val Loss: 0.6722 Acc: 0.2955
Epoch 2/93
----------
train Loss: 0.6615 Acc: 0.3110
val Loss: 0.6474 Acc: 0.3864
Epoch 3/93
----------
train Loss: 0.6363 Acc: 0.3923
val Loss: 0.6137 Acc: 0.4318
Epoch 4/93
----------
train Loss: 0.6172 Acc: 0.4354
val Loss: 0.5899 Acc: 0.4773
Epoch 5/93
----------
train Loss: 0.6024 Acc: 0.4928
val Loss: 0.5735 Acc: 0.5682
Epoch 6/93
----------
train Loss: 0.5787 Acc: 0.5072
val Loss: 0.5505 Acc: 0.6136
Epoch 7/93
----------
train Loss: 0.5542 Acc: 0.5598
val Loss: 0.5254 Acc: 0.6136
Epoch 8/93
----------
train Loss: 0.5434 Acc: 0.5359
val Loss: 0.5028 Acc: 0.6818
Epoch 9/93
----------
train Loss: 0.5268 Acc: 0.5646
val Loss: 0.4812 Acc: 0.6818
Epoch 10/93
----------
train Loss: 0.4896 Acc: 0.5837
val Loss: 0.4607 Acc: 0.6591
Epoch 11/93
----------
train Loss: 0.4971 Acc: 0.5598
val Loss: 0.4453 Acc: 0.6818
Epoch 12/93
----------
train Loss: 0.4933 Acc: 0.5598
val Loss: 0.4366 Acc: 0.6818
Epoch 13/93
----------
train Loss: 0.4614 Acc: 0.6172
val Loss: 0.4182 Acc: 0.6818
Epoch 14/93
----------
train Loss: 0.4410 Acc: 0.6124
val Loss: 0.4060 Acc: 0.6818
Epoch 15/93
----------
train Loss: 0.4472 Acc: 0.5981
val Loss: 0.3950 Acc: 0.7273
Epoch 16/93
----------
train Loss: 0.4382 Acc: 0.6316
val Loss: 0.3848 Acc: 0.7273
Epoch 17/93
----------
train Loss: 0.4268 Acc: 0.6364
val Loss: 0.3754 Acc: 0.7273
Epoch 18/93
----------
train Loss: 0.4136 Acc: 0.6699
val Loss: 0.3643 Acc: 0.7045
Epoch 19/93
----------
train Loss: 0.3950 Acc: 0.7464
val Loss: 0.3580 Acc: 0.7500
Epoch 20/93
----------
train Loss: 0.4032 Acc: 0.7033
val Loss: 0.3470 Acc: 0.7500
Epoch 21/93
----------
train Loss: 0.4010 Acc: 0.7177
val Loss: 0.3378 Acc: 0.7727
Epoch 22/93
----------
train Loss: 0.3918 Acc: 0.7033
val Loss: 0.3324 Acc: 0.7727
Epoch 23/93
----------
train Loss: 0.3869 Acc: 0.7273
val Loss: 0.3242 Acc: 0.7955
Epoch 24/93
----------
train Loss: 0.3489 Acc: 0.7943
val Loss: 0.3104 Acc: 0.7727
Epoch 25/93
----------
train Loss: 0.3717 Acc: 0.7177
val Loss: 0.3124 Acc: 0.8182
Epoch 26/93
----------
train Loss: 0.3752 Acc: 0.7799
val Loss: 0.3113 Acc: 0.8182
Epoch 27/93
----------
train Loss: 0.3268 Acc: 0.8612
val Loss: 0.3091 Acc: 0.8409
Epoch 28/93
----------
train Loss: 0.3727 Acc: 0.7608
val Loss: 0.3072 Acc: 0.8182
Epoch 29/93
----------
train Loss: 0.3929 Acc: 0.6890
val Loss: 0.3071 Acc: 0.8182
Epoch 30/93
----------
train Loss: 0.3560 Acc: 0.7273
val Loss: 0.3010 Acc: 0.7955
Epoch 31/93
----------
train Loss: 0.3139 Acc: 0.8517
val Loss: 0.2918 Acc: 0.8182
Epoch 32/93
----------
train Loss: 0.3381 Acc: 0.7703
val Loss: 0.2850 Acc: 0.7727
Epoch 33/93
----------
train Loss: 0.3576 Acc: 0.7799
val Loss: 0.2843 Acc: 0.7955
Epoch 34/93
----------
train Loss: 0.3309 Acc: 0.8421
val Loss: 0.2831 Acc: 0.7727
Epoch 35/93
----------
train Loss: 0.2826 Acc: 0.9187
val Loss: 0.2867 Acc: 0.7955
Epoch 36/93
----------
train Loss: 0.3719 Acc: 0.7321
val Loss: 0.2843 Acc: 0.7955
Epoch 37/93
----------
train Loss: 0.3152 Acc: 0.7990
val Loss: 0.2907 Acc: 0.7727
Epoch 38/93
----------
train Loss: 0.3139 Acc: 0.9187
val Loss: 0.2849 Acc: 0.7727
Epoch 39/93
----------
train Loss: 0.3427 Acc: 0.7273
val Loss: 0.2910 Acc: 0.7727
Epoch 40/93
----------
train Loss: 0.2874 Acc: 0.8421
val Loss: 0.2869 Acc: 0.7727
Epoch 41/93
----------
train Loss: 0.3588 Acc: 0.7321
val Loss: 0.2804 Acc: 0.7955
Epoch 42/93
----------
train Loss: 0.2917 Acc: 0.8134
val Loss: 0.2725 Acc: 0.7955
Epoch 43/93
----------
train Loss: 0.3145 Acc: 0.8278
val Loss: 0.2697 Acc: 0.7955
Epoch 44/93
----------
train Loss: 0.2877 Acc: 0.8469
val Loss: 0.2704 Acc: 0.8182
Epoch 45/93
----------
train Loss: 0.1936 Acc: 0.9617
val Loss: 0.2693 Acc: 0.8182
Epoch 46/93
----------
train Loss: 0.3709 Acc: 0.8182
val Loss: 0.2725 Acc: 0.8182
Epoch 47/93
----------
train Loss: 0.2776 Acc: 0.8756
val Loss: 0.2672 Acc: 0.8182
Epoch 48/93
----------
train Loss: 0.3105 Acc: 0.7990
val Loss: 0.2712 Acc: 0.7955
Epoch 49/93
----------
train Loss: 0.2935 Acc: 0.9043
val Loss: 0.2702 Acc: 0.7955
Epoch 50/93
----------
train Loss: 0.2857 Acc: 0.8469
val Loss: 0.2703 Acc: 0.7955
Epoch 51/93
----------
train Loss: 0.2187 Acc: 0.9761
val Loss: 0.2651 Acc: 0.7955
Epoch 52/93
----------
train Loss: 0.3017 Acc: 0.7751
val Loss: 0.2677 Acc: 0.7727
Epoch 53/93
----------
train Loss: 0.3342 Acc: 0.8995
val Loss: 0.2650 Acc: 0.7727
Epoch 54/93
----------
train Loss: 0.2481 Acc: 0.9187
val Loss: 0.2585 Acc: 0.7955
Epoch 55/93
----------
train Loss: 0.2642 Acc: 0.9282
val Loss: 0.2585 Acc: 0.7727
Epoch 56/93
----------
train Loss: 0.3080 Acc: 0.8612
val Loss: 0.2594 Acc: 0.7727
Epoch 57/93
----------
train Loss: 0.3444 Acc: 0.7990
val Loss: 0.2576 Acc: 0.8182
Epoch 58/93
----------
train Loss: 0.2853 Acc: 0.7943
val Loss: 0.2536 Acc: 0.8182
Epoch 59/93
----------
train Loss: 0.2968 Acc: 0.8612
val Loss: 0.2531 Acc: 0.7955
Epoch 60/93
----------
train Loss: 0.2503 Acc: 0.8612
val Loss: 0.2562 Acc: 0.7955
Epoch 61/93
----------
train Loss: 0.3386 Acc: 0.7416
val Loss: 0.2596 Acc: 0.7955
Epoch 62/93
----------
train Loss: 0.3015 Acc: 0.9426
val Loss: 0.2600 Acc: 0.7727
Epoch 63/93
----------
train Loss: 0.2592 Acc: 0.9330
val Loss: 0.2598 Acc: 0.7727
Epoch 64/93
----------
train Loss: 0.2462 Acc: 0.9282
val Loss: 0.2579 Acc: 0.7955
Epoch 65/93
----------
train Loss: 0.2812 Acc: 0.8182
val Loss: 0.2607 Acc: 0.7955
Epoch 66/93
----------
train Loss: 0.2734 Acc: 0.8900
val Loss: 0.2647 Acc: 0.7955
Epoch 67/93
----------
train Loss: 0.3067 Acc: 0.8612
val Loss: 0.2589 Acc: 0.8182
Epoch 68/93
----------
train Loss: 0.2557 Acc: 0.8900
val Loss: 0.2624 Acc: 0.7955
Epoch 69/93
----------
train Loss: 0.2557 Acc: 0.8804
val Loss: 0.2590 Acc: 0.7955
Epoch 70/93
----------
train Loss: 0.2878 Acc: 0.8995
val Loss: 0.2602 Acc: 0.8182
Epoch 71/93
----------
train Loss: 0.3029 Acc: 0.9139
val Loss: 0.2581 Acc: 0.7727
Epoch 72/93
----------
train Loss: 0.3044 Acc: 0.8756
val Loss: 0.2636 Acc: 0.7500
Epoch 73/93
----------
train Loss: 0.2157 Acc: 0.9713
val Loss: 0.2686 Acc: 0.7273
Epoch 74/93
----------
train Loss: 0.3176 Acc: 0.8469
val Loss: 0.2637 Acc: 0.7727
Epoch 75/93
----------
train Loss: 0.2367 Acc: 0.9474
val Loss: 0.2625 Acc: 0.7273
Epoch 76/93
----------
train Loss: 0.2580 Acc: 0.8230
val Loss: 0.2597 Acc: 0.7727
Epoch 77/93
----------
train Loss: 0.2936 Acc: 0.8421
val Loss: 0.2575 Acc: 0.7727
Epoch 78/93
----------
train Loss: 0.2546 Acc: 0.8804
val Loss: 0.2568 Acc: 0.7727
Epoch 79/93
----------
train Loss: 0.3119 Acc: 0.8517
val Loss: 0.2526 Acc: 0.7955
Epoch 80/93
----------
train Loss: 0.2745 Acc: 0.8469
val Loss: 0.2522 Acc: 0.8409
Epoch 81/93
----------
train Loss: 0.3163 Acc: 0.7895
val Loss: 0.2623 Acc: 0.7727
Epoch 82/93
----------
train Loss: 0.2739 Acc: 0.8278
val Loss: 0.2660 Acc: 0.7727
Epoch 83/93
----------
train Loss: 0.2362 Acc: 0.9522
val Loss: 0.2678 Acc: 0.7500
Epoch 84/93
----------
train Loss: 0.3130 Acc: 0.7751
val Loss: 0.2657 Acc: 0.7500
Epoch 85/93
----------
train Loss: 0.2478 Acc: 0.8134
[32m[I 2025-06-28 17:03:31,548][0m Trial 72 finished with value: 0.8409090909090909 and parameters: {'batch_size': 107, 'lr': 5.397706209054895e-05, 'num_epochs': 93, 'weight_decay': 0.00014716249910272041, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2651 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_107_lr_5.397706209054895e-05_epoch_93_wd_0.00014716249910272041_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 0.6889 Acc: 0.2392
val Loss: 0.6642 Acc: 0.2955
Epoch 2/95
----------
train Loss: 0.6520 Acc: 0.3445
val Loss: 0.6377 Acc: 0.3864
Epoch 3/95
----------
train Loss: 0.6228 Acc: 0.3732
val Loss: 0.6047 Acc: 0.5000
Epoch 4/95
----------
train Loss: 0.6012 Acc: 0.4498
val Loss: 0.5863 Acc: 0.5682
Epoch 5/95
----------
train Loss: 0.5867 Acc: 0.4593
val Loss: 0.5749 Acc: 0.5455
Epoch 6/95
----------
train Loss: 0.5665 Acc: 0.4880
val Loss: 0.5582 Acc: 0.6136
Epoch 7/95
----------
train Loss: 0.5488 Acc: 0.4928
val Loss: 0.5404 Acc: 0.6364
Epoch 8/95
----------
train Loss: 0.5386 Acc: 0.4976
val Loss: 0.5231 Acc: 0.6364
Epoch 9/95
----------
train Loss: 0.5271 Acc: 0.5024
val Loss: 0.5089 Acc: 0.6364
Epoch 10/95
----------
train Loss: 0.5065 Acc: 0.4976
val Loss: 0.4906 Acc: 0.6364
Epoch 11/95
----------
train Loss: 0.5075 Acc: 0.5024
val Loss: 0.4769 Acc: 0.6364
Epoch 12/95
----------
train Loss: 0.5050 Acc: 0.5024
val Loss: 0.4728 Acc: 0.6364
Epoch 13/95
----------
train Loss: 0.4849 Acc: 0.5120
val Loss: 0.4576 Acc: 0.6364
Epoch 14/95
----------
train Loss: 0.4703 Acc: 0.5167
val Loss: 0.4461 Acc: 0.6364
Epoch 15/95
----------
train Loss: 0.4779 Acc: 0.4928
val Loss: 0.4366 Acc: 0.6364
Epoch 16/95
----------
train Loss: 0.4695 Acc: 0.5120
val Loss: 0.4310 Acc: 0.6364
Epoch 17/95
----------
train Loss: 0.4645 Acc: 0.5072
val Loss: 0.4242 Acc: 0.6591
Epoch 18/95
----------
train Loss: 0.4527 Acc: 0.5311
val Loss: 0.4163 Acc: 0.6591
Epoch 19/95
----------
train Loss: 0.4406 Acc: 0.5407
val Loss: 0.4144 Acc: 0.6591
Epoch 20/95
----------
train Loss: 0.4438 Acc: 0.5359
val Loss: 0.4124 Acc: 0.6591
Epoch 21/95
----------
train Loss: 0.4459 Acc: 0.5598
val Loss: 0.4061 Acc: 0.7045
Epoch 22/95
----------
train Loss: 0.4386 Acc: 0.5885
val Loss: 0.3956 Acc: 0.6591
Epoch 23/95
----------
train Loss: 0.4257 Acc: 0.5885
val Loss: 0.3880 Acc: 0.7045
Epoch 24/95
----------
train Loss: 0.4059 Acc: 0.6029
val Loss: 0.3719 Acc: 0.7045
Epoch 25/95
----------
train Loss: 0.4220 Acc: 0.6029
val Loss: 0.3730 Acc: 0.7273
Epoch 26/95
----------
train Loss: 0.4270 Acc: 0.6077
val Loss: 0.3665 Acc: 0.7273
Epoch 27/95
----------
train Loss: 0.3886 Acc: 0.6699
val Loss: 0.3634 Acc: 0.7500
Epoch 28/95
----------
train Loss: 0.4198 Acc: 0.6220
val Loss: 0.3617 Acc: 0.7727
Epoch 29/95
----------
train Loss: 0.4330 Acc: 0.6268
val Loss: 0.3663 Acc: 0.7273
Epoch 30/95
----------
train Loss: 0.4113 Acc: 0.6077
val Loss: 0.3574 Acc: 0.7500
Epoch 31/95
----------
train Loss: 0.3769 Acc: 0.7368
val Loss: 0.3408 Acc: 0.7727
Epoch 32/95
----------
train Loss: 0.3844 Acc: 0.6746
val Loss: 0.3333 Acc: 0.7727
Epoch 33/95
----------
train Loss: 0.4035 Acc: 0.6794
val Loss: 0.3332 Acc: 0.7500
Epoch 34/95
----------
train Loss: 0.3835 Acc: 0.6938
val Loss: 0.3292 Acc: 0.7500
Epoch 35/95
----------
train Loss: 0.3491 Acc: 0.7990
val Loss: 0.3311 Acc: 0.7500
Epoch 36/95
----------
train Loss: 0.4066 Acc: 0.6794
val Loss: 0.3310 Acc: 0.7500
Epoch 37/95
----------
train Loss: 0.3672 Acc: 0.7464
val Loss: 0.3358 Acc: 0.7045
Epoch 38/95
----------
train Loss: 0.3680 Acc: 0.7751
val Loss: 0.3298 Acc: 0.7273
Epoch 39/95
----------
train Loss: 0.3811 Acc: 0.6651
val Loss: 0.3406 Acc: 0.7273
Epoch 40/95
----------
train Loss: 0.3424 Acc: 0.7608
val Loss: 0.3365 Acc: 0.7273
Epoch 41/95
----------
train Loss: 0.3946 Acc: 0.6842
val Loss: 0.3296 Acc: 0.7500
Epoch 42/95
----------
train Loss: 0.3463 Acc: 0.7656
val Loss: 0.3292 Acc: 0.7727
Epoch 43/95
----------
train Loss: 0.3608 Acc: 0.7273
val Loss: 0.3303 Acc: 0.7500
Epoch 44/95
----------
train Loss: 0.3330 Acc: 0.8182
val Loss: 0.3263 Acc: 0.7727
Epoch 45/95
----------
train Loss: 0.2523 Acc: 0.9187
val Loss: 0.3075 Acc: 0.7955
Epoch 46/95
----------
train Loss: 0.3936 Acc: 0.7847
val Loss: 0.3078 Acc: 0.7500
Epoch 47/95
----------
train Loss: 0.3185 Acc: 0.8038
val Loss: 0.3084 Acc: 0.7500
Epoch 48/95
----------
train Loss: 0.3346 Acc: 0.8038
val Loss: 0.2981 Acc: 0.7727
Epoch 49/95
----------
train Loss: 0.3276 Acc: 0.8373
val Loss: 0.3002 Acc: 0.7727
Epoch 50/95
----------
train Loss: 0.3177 Acc: 0.8038
val Loss: 0.3117 Acc: 0.7500
Epoch 51/95
----------
train Loss: 0.2635 Acc: 0.9378
val Loss: 0.2974 Acc: 0.7727
Epoch 52/95
----------
train Loss: 0.3310 Acc: 0.7608
val Loss: 0.2954 Acc: 0.7727
Epoch 53/95
----------
train Loss: 0.3608 Acc: 0.8373
val Loss: 0.3008 Acc: 0.7500
Epoch 54/95
----------
train Loss: 0.2796 Acc: 0.8900
val Loss: 0.2989 Acc: 0.7500
Epoch 55/95
----------
train Loss: 0.3005 Acc: 0.8660
val Loss: 0.3093 Acc: 0.7273
Epoch 56/95
----------
train Loss: 0.3304 Acc: 0.8278
val Loss: 0.2972 Acc: 0.7500
Epoch 57/95
----------
train Loss: 0.3737 Acc: 0.7799
val Loss: 0.2992 Acc: 0.7955
Epoch 58/95
----------
train Loss: 0.3128 Acc: 0.7895
val Loss: 0.2897 Acc: 0.7500
Epoch 59/95
----------
train Loss: 0.3305 Acc: 0.8134
val Loss: 0.2944 Acc: 0.7727
Epoch 60/95
----------
train Loss: 0.2813 Acc: 0.8373
val Loss: 0.3030 Acc: 0.7273
Epoch 61/95
----------
train Loss: 0.3683 Acc: 0.7129
val Loss: 0.2945 Acc: 0.7273
Epoch 62/95
----------
train Loss: 0.3213 Acc: 0.9043
val Loss: 0.2762 Acc: 0.7500
Epoch 63/95
----------
train Loss: 0.2793 Acc: 0.9091
val Loss: 0.2711 Acc: 0.7955
Epoch 64/95
----------
train Loss: 0.2683 Acc: 0.9234
val Loss: 0.2641 Acc: 0.7727
Epoch 65/95
----------
train Loss: 0.2937 Acc: 0.8469
val Loss: 0.2671 Acc: 0.7727
Epoch 66/95
----------
train Loss: 0.2909 Acc: 0.8660
val Loss: 0.2816 Acc: 0.7500
Epoch 67/95
----------
train Loss: 0.3255 Acc: 0.8278
val Loss: 0.2825 Acc: 0.7500
Epoch 68/95
----------
train Loss: 0.2768 Acc: 0.9043
val Loss: 0.2925 Acc: 0.7273
Epoch 69/95
----------
train Loss: 0.2794 Acc: 0.8708
val Loss: 0.2848 Acc: 0.7273
Epoch 70/95
----------
train Loss: 0.3048 Acc: 0.8756
val Loss: 0.2879 Acc: 0.7500
Epoch 71/95
----------
train Loss: 0.3253 Acc: 0.8708
val Loss: 0.2882 Acc: 0.7727
Epoch 72/95
----------
train Loss: 0.3285 Acc: 0.8278
val Loss: 0.2979 Acc: 0.7045
Epoch 73/95
----------
train Loss: 0.2335 Acc: 0.9474
val Loss: 0.2835 Acc: 0.7273
Epoch 74/95
----------
train Loss: 0.3352 Acc: 0.8182
val Loss: 0.2651 Acc: 0.7500
Epoch 75/95
----------
train Loss: 0.2540 Acc: 0.9234
val Loss: 0.2535 Acc: 0.7955
Epoch 76/95
----------
train Loss: 0.2781 Acc: 0.7799
val Loss: 0.2497 Acc: 0.8182
Epoch 77/95
----------
train Loss: 0.3130 Acc: 0.8325
val Loss: 0.2653 Acc: 0.8409
Epoch 78/95
----------
train Loss: 0.2652 Acc: 0.8947
val Loss: 0.2724 Acc: 0.8182
Epoch 79/95
----------
train Loss: 0.3356 Acc: 0.8230
val Loss: 0.2654 Acc: 0.8182
Epoch 80/95
----------
train Loss: 0.2982 Acc: 0.8182
val Loss: 0.2657 Acc: 0.8182
Epoch 81/95
----------
train Loss: 0.3361 Acc: 0.7943
val Loss: 0.2736 Acc: 0.7500
Epoch 82/95
----------
train Loss: 0.2856 Acc: 0.8421
val Loss: 0.2740 Acc: 0.7727
Epoch 83/95
----------
train Loss: 0.2560 Acc: 0.9330
val Loss: 0.2645 Acc: 0.7500
Epoch 84/95
----------
train Loss: 0.3293 Acc: 0.7321
val Loss: 0.2572 Acc: 0.7500
Epoch 85/95
----------
train Loss: 0.2650 Acc: 0.7895
val Loss: 0.2643 Acc: 0.7500
Epoch 86/95
----------
train Loss: 0.2710 Acc: 0.8517
val Loss: 0.2563 Acc: 0.8182
Epoch 87/95
----------
train Loss: 0.3020 Acc: 0.8900
val Loss: 0.2685 Acc: 0.7955
Epoch 88/95
----------
train Loss: 0.3209 Acc: 0.8852
val Loss: 0.2617 Acc: 0.7727
Epoch 89/95
----------
train Loss: 0.3513 Acc: 0.8086
val Loss: 0.2649 Acc: 0.7955
Epoch 90/95
----------
train Loss: 0.3004 Acc: 0.8565
val Loss: 0.2682 Acc: 0.7955
Epoch 91/95
----------
train Loss: 0.2633 Acc: 0.9139
val Loss: 0.2551 Acc: 0.8182
Epoch 92/95
----------
train Loss: 0.2709 Acc: 0.9282
val Loss: 0.2533 Acc: 0.7955
Epoch 93/95
----------
train Loss: 0.3002 Acc: 0.8469
val Loss: 0.2606 Acc: 0.7727
Epoch 94/95
----------
train Loss: 0.2312 Acc: 0.9713
val Loss: 0.2691 Acc: 0.7727
Epoch 95/95
----------
train Loss: 0.2751 Acc: 0.9139
[32m[I 2025-06-28 17:25:09,359][0m Trial 73 finished with value: 0.8181818181818182 and parameters: {'batch_size': 22, 'lr': 0.0001047302205946508, 'num_epochs': 95, 'weight_decay': 0.019268535631794623, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2598 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_22_lr_0.0001047302205946508_epoch_95_wd_0.019268535631794623_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/100
----------
train Loss: 0.6889 Acc: 0.2440
val Loss: 0.6661 Acc: 0.2955
Epoch 2/100
----------
train Loss: 0.6496 Acc: 0.3732
val Loss: 0.6324 Acc: 0.4545
Epoch 3/100
----------
train Loss: 0.6179 Acc: 0.4641
val Loss: 0.5872 Acc: 0.4545
Epoch 4/100
----------
train Loss: 0.5932 Acc: 0.4785
val Loss: 0.5539 Acc: 0.6136
Epoch 5/100
----------
train Loss: 0.5732 Acc: 0.5263
val Loss: 0.5304 Acc: 0.6136
Epoch 6/100
----------
train Loss: 0.5439 Acc: 0.5407
val Loss: 0.5001 Acc: 0.6591
Epoch 7/100
----------
train Loss: 0.5144 Acc: 0.5742
val Loss: 0.4714 Acc: 0.6818
Epoch 8/100
----------
train Loss: 0.5066 Acc: 0.5455
val Loss: 0.4457 Acc: 0.6818
Epoch 9/100
----------
train Loss: 0.4899 Acc: 0.5550
val Loss: 0.4251 Acc: 0.6818
Epoch 10/100
----------
train Loss: 0.4414 Acc: 0.6172
val Loss: 0.4079 Acc: 0.6818
Epoch 11/100
----------
train Loss: 0.4572 Acc: 0.5837
val Loss: 0.3924 Acc: 0.7045
Epoch 12/100
----------
train Loss: 0.4585 Acc: 0.5837
val Loss: 0.3860 Acc: 0.7045
Epoch 13/100
----------
train Loss: 0.4220 Acc: 0.6651
val Loss: 0.3698 Acc: 0.7273
Epoch 14/100
----------
train Loss: 0.3984 Acc: 0.6794
val Loss: 0.3569 Acc: 0.7273
Epoch 15/100
----------
train Loss: 0.4124 Acc: 0.6651
val Loss: 0.3470 Acc: 0.7727
Epoch 16/100
----------
train Loss: 0.4037 Acc: 0.7081
val Loss: 0.3414 Acc: 0.7727
Epoch 17/100
----------
train Loss: 0.3916 Acc: 0.7321
val Loss: 0.3368 Acc: 0.7727
Epoch 18/100
----------
train Loss: 0.3735 Acc: 0.7177
val Loss: 0.3263 Acc: 0.7500
Epoch 19/100
----------
train Loss: 0.3525 Acc: 0.7895
val Loss: 0.3204 Acc: 0.7955
Epoch 20/100
----------
train Loss: 0.3684 Acc: 0.7751
val Loss: 0.3091 Acc: 0.7955
Epoch 21/100
----------
train Loss: 0.3690 Acc: 0.7751
val Loss: 0.2987 Acc: 0.7955
Epoch 22/100
----------
train Loss: 0.3538 Acc: 0.7608
val Loss: 0.2957 Acc: 0.7955
Epoch 23/100
----------
train Loss: 0.3550 Acc: 0.7943
val Loss: 0.2899 Acc: 0.8182
Epoch 24/100
----------
train Loss: 0.3070 Acc: 0.8517
val Loss: 0.2751 Acc: 0.8182
Epoch 25/100
----------
train Loss: 0.3327 Acc: 0.8278
val Loss: 0.2788 Acc: 0.8409
Epoch 26/100
----------
train Loss: 0.3409 Acc: 0.8517
val Loss: 0.2796 Acc: 0.8409
Epoch 27/100
----------
train Loss: 0.2857 Acc: 0.9426
val Loss: 0.2849 Acc: 0.7955
Epoch 28/100
----------
train Loss: 0.3417 Acc: 0.8086
val Loss: 0.2836 Acc: 0.7500
Epoch 29/100
----------
train Loss: 0.3648 Acc: 0.7416
val Loss: 0.2850 Acc: 0.7727
Epoch 30/100
----------
train Loss: 0.3187 Acc: 0.8038
val Loss: 0.2726 Acc: 0.8182
Epoch 31/100
----------
train Loss: 0.2749 Acc: 0.9187
val Loss: 0.2626 Acc: 0.8182
Epoch 32/100
----------
train Loss: 0.3036 Acc: 0.8134
val Loss: 0.2586 Acc: 0.7955
Epoch 33/100
----------
train Loss: 0.3224 Acc: 0.8230
val Loss: 0.2581 Acc: 0.7955
Epoch 34/100
----------
train Loss: 0.2992 Acc: 0.8708
val Loss: 0.2604 Acc: 0.7955
Epoch 35/100
----------
train Loss: 0.2447 Acc: 0.9617
val Loss: 0.2689 Acc: 0.7500
Epoch 36/100
----------
train Loss: 0.3472 Acc: 0.7847
val Loss: 0.2707 Acc: 0.7727
Epoch 37/100
----------
train Loss: 0.2865 Acc: 0.8373
val Loss: 0.2741 Acc: 0.7273
Epoch 38/100
----------
train Loss: 0.2871 Acc: 0.9378
val Loss: 0.2647 Acc: 0.7727
Epoch 39/100
----------
train Loss: 0.3183 Acc: 0.7608
val Loss: 0.2693 Acc: 0.7727
Epoch 40/100
----------
train Loss: 0.2587 Acc: 0.8995
val Loss: 0.2675 Acc: 0.7955
Epoch 41/100
----------
train Loss: 0.3442 Acc: 0.7321
val Loss: 0.2611 Acc: 0.8182
Epoch 42/100
----------
train Loss: 0.2591 Acc: 0.8421
val Loss: 0.2552 Acc: 0.7955
Epoch 43/100
----------
train Loss: 0.2838 Acc: 0.8421
val Loss: 0.2536 Acc: 0.7955
Epoch 44/100
----------
train Loss: 0.2681 Acc: 0.8660
val Loss: 0.2583 Acc: 0.7955
Epoch 45/100
----------
train Loss: 0.1682 Acc: 0.9665
val Loss: 0.2607 Acc: 0.8409
Epoch 46/100
----------
train Loss: 0.3609 Acc: 0.7990
val Loss: 0.2657 Acc: 0.7955
Epoch 47/100
----------
train Loss: 0.2561 Acc: 0.8900
val Loss: 0.2590 Acc: 0.7955
Epoch 48/100
----------
train Loss: 0.2936 Acc: 0.8517
val Loss: 0.2624 Acc: 0.7500
Epoch 49/100
----------
train Loss: 0.2759 Acc: 0.9426
val Loss: 0.2633 Acc: 0.7727
Epoch 50/100
----------
train Loss: 0.2705 Acc: 0.8756
val Loss: 0.2628 Acc: 0.7727
Epoch 51/100
----------
train Loss: 0.1997 Acc: 0.9856
val Loss: 0.2556 Acc: 0.7727
Epoch 52/100
----------
train Loss: 0.2860 Acc: 0.8086
val Loss: 0.2558 Acc: 0.7500
Epoch 53/100
----------
train Loss: 0.3214 Acc: 0.9043
val Loss: 0.2526 Acc: 0.7727
Epoch 54/100
----------
train Loss: 0.2357 Acc: 0.9330
val Loss: 0.2500 Acc: 0.7955
Epoch 55/100
----------
train Loss: 0.2508 Acc: 0.9378
val Loss: 0.2544 Acc: 0.7500
Epoch 56/100
----------
train Loss: 0.2936 Acc: 0.9043
val Loss: 0.2572 Acc: 0.7727
Epoch 57/100
----------
train Loss: 0.3352 Acc: 0.8134
val Loss: 0.2573 Acc: 0.7955
Epoch 58/100
----------
train Loss: 0.2731 Acc: 0.7943
val Loss: 0.2505 Acc: 0.8182
Epoch 59/100
----------
train Loss: 0.2824 Acc: 0.8900
val Loss: 0.2520 Acc: 0.7727
Epoch 60/100
----------
train Loss: 0.2345 Acc: 0.8852
val Loss: 0.2537 Acc: 0.7727
Epoch 61/100
----------
train Loss: 0.3248 Acc: 0.7751
val Loss: 0.2592 Acc: 0.7727
Epoch 62/100
----------
train Loss: 0.2934 Acc: 0.9569
val Loss: 0.2600 Acc: 0.7500
Epoch 63/100
----------
train Loss: 0.2510 Acc: 0.9378
val Loss: 0.2586 Acc: 0.7727
Epoch 64/100
----------
train Loss: 0.2355 Acc: 0.9426
val Loss: 0.2564 Acc: 0.7727
Epoch 65/100
----------
train Loss: 0.2707 Acc: 0.8278
val Loss: 0.2602 Acc: 0.7727
Epoch 66/100
----------
train Loss: 0.2644 Acc: 0.9043
val Loss: 0.2665 Acc: 0.7727
Epoch 67/100
----------
train Loss: 0.2971 Acc: 0.8660
val Loss: 0.2625 Acc: 0.7955
Epoch 68/100
----------
train Loss: 0.2490 Acc: 0.8947
val Loss: 0.2670 Acc: 0.7727
Epoch 69/100
----------
train Loss: 0.2459 Acc: 0.8995
val Loss: 0.2598 Acc: 0.7727
Epoch 70/100
----------
train Loss: 0.2782 Acc: 0.9139
val Loss: 0.2596 Acc: 0.7727
Epoch 71/100
----------
train Loss: 0.2937 Acc: 0.9139
val Loss: 0.2565 Acc: 0.7500
Epoch 72/100
----------
train Loss: 0.2921 Acc: 0.8995
val Loss: 0.2628 Acc: 0.7500
Epoch 73/100
----------
train Loss: 0.2108 Acc: 0.9665
val Loss: 0.2689 Acc: 0.7500
Epoch 74/100
----------
train Loss: 0.3075 Acc: 0.8708
val Loss: 0.2637 Acc: 0.7500
Epoch 75/100
----------
train Loss: 0.2288 Acc: 0.9665
val Loss: 0.2595 Acc: 0.7500
Epoch 76/100
----------
train Loss: 0.2453 Acc: 0.8421
val Loss: 0.2568 Acc: 0.7500
Epoch 77/100
----------
train Loss: 0.2839 Acc: 0.8612
val Loss: 0.2574 Acc: 0.7500
Epoch 78/100
----------
train Loss: 0.2474 Acc: 0.8947
val Loss: 0.2584 Acc: 0.7955
Epoch 79/100
----------
train Loss: 0.2976 Acc: 0.8708
val Loss: 0.2552 Acc: 0.7727
Epoch 80/100
----------
train Loss: 0.2661 Acc: 0.8469
val Loss: 0.2561 Acc: 0.8636
Epoch 81/100
----------
train Loss: 0.3061 Acc: 0.8134
val Loss: 0.2678 Acc: 0.7955
Epoch 82/100
----------
train Loss: 0.2651 Acc: 0.8565
val Loss: 0.2717 Acc: 0.8182
Epoch 83/100
----------
train Loss: 0.2312 Acc: 0.9713
val Loss: 0.2729 Acc: 0.7727
Epoch 84/100
----------
train Loss: 0.3012 Acc: 0.7751
val Loss: 0.2683 Acc: 0.7727
Epoch 85/100
----------
train Loss: 0.2378 Acc: 0.8325
val Loss: 0.2648 Acc: 0.7727
Epoch 86/100
----------
train Loss: 0.2511 Acc: 0.8852
val Loss: 0.2532 Acc: 0.8182
Epoch 87/100
----------
train Loss: 0.2853 Acc: 0.9187
val Loss: 0.2499 Acc: 0.8182
Epoch 88/100
----------
train Loss: 0.3006 Acc: 0.8947
val Loss: 0.2490 Acc: 0.8182
Epoch 89/100
----------
train Loss: 0.3241 Acc: 0.8373
val Loss: 0.2489 Acc: 0.8182
Epoch 90/100
----------
train Loss: 0.2772 Acc: 0.8612
val Loss: 0.2510 Acc: 0.8182
Epoch 91/100
----------
train Loss: 0.2347 Acc: 0.9569
val Loss: 0.2567 Acc: 0.7727
Epoch 92/100
----------
train Loss: 0.2582 Acc: 0.9426
val Loss: 0.2613 Acc: 0.7727
Epoch 93/100
----------
train Loss: 0.2740 Acc: 0.8708
val Loss: 0.2489 Acc: 0.7727
Epoch 94/100
----------
train Loss: 0.2151 Acc: 0.9761
val Loss: 0.2512 Acc: 0.7727
Epoch 95/100
----------
train Loss: 0.2539 Acc: 0.9330
val Loss: 0.2504 Acc: 0.7727
Epoch 96/100
----------
train Loss: 0.1855 Acc: 0.9952
val Loss: 0.2508 Acc: 0.7955
Epoch 97/100
----------
train Loss: 0.2331 Acc: 0.9282
val Loss: 0.2485 Acc: 0.7955
Epoch 98/100
----------
train Loss: 0.2591 Acc: 0.9282
val Loss: 0.2468 Acc: 0.7955
Epoch 99/100
----------
train Loss: 0.2556 Acc: 0.8947
val Loss: 0.2503 Acc: 0.7955
Epoch 100/100
----------
train Loss: 0.2142 Acc: 0.8852
[32m[I 2025-06-28 17:47:54,284][0m Trial 74 finished with value: 0.7954545454545455 and parameters: {'batch_size': 32, 'lr': 7.346396374908584e-05, 'num_epochs': 100, 'weight_decay': 0.00025614190244551625, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2516 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_32_lr_7.346396374908584e-05_epoch_100_wd_0.00025614190244551625_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 0.6953 Acc: 0.2249
val Loss: 0.6770 Acc: 0.2500
Epoch 2/88
----------
train Loss: 0.6709 Acc: 0.2775
val Loss: 0.6588 Acc: 0.2955
Epoch 3/88
----------
train Loss: 0.6511 Acc: 0.3541
val Loss: 0.6330 Acc: 0.3636
Epoch 4/88
----------
train Loss: 0.6369 Acc: 0.3828
val Loss: 0.6162 Acc: 0.4091
Epoch 5/88
----------
train Loss: 0.6267 Acc: 0.3971
val Loss: 0.6054 Acc: 0.5000
Epoch 6/88
----------
train Loss: 0.6081 Acc: 0.4641
val Loss: 0.5898 Acc: 0.5455
Epoch 7/88
----------
train Loss: 0.5893 Acc: 0.5311
val Loss: 0.5715 Acc: 0.5909
Epoch 8/88
----------
train Loss: 0.5783 Acc: 0.5359
val Loss: 0.5551 Acc: 0.6364
Epoch 9/88
----------
train Loss: 0.5641 Acc: 0.5550
val Loss: 0.5367 Acc: 0.6591
Epoch 10/88
----------
train Loss: 0.5362 Acc: 0.5694
val Loss: 0.5162 Acc: 0.6818
Epoch 11/88
----------
train Loss: 0.5393 Acc: 0.5407
val Loss: 0.5029 Acc: 0.6591
Epoch 12/88
----------
train Loss: 0.5322 Acc: 0.5502
val Loss: 0.4935 Acc: 0.6591
Epoch 13/88
----------
train Loss: 0.5055 Acc: 0.6029
val Loss: 0.4742 Acc: 0.6591
Epoch 14/88
----------
train Loss: 0.4880 Acc: 0.5885
val Loss: 0.4638 Acc: 0.6591
Epoch 15/88
----------
train Loss: 0.4881 Acc: 0.5646
val Loss: 0.4523 Acc: 0.6818
Epoch 16/88
----------
train Loss: 0.4784 Acc: 0.5837
val Loss: 0.4395 Acc: 0.6818
Epoch 17/88
----------
train Loss: 0.4677 Acc: 0.5837
val Loss: 0.4279 Acc: 0.6591
Epoch 18/88
----------
train Loss: 0.4571 Acc: 0.6124
val Loss: 0.4159 Acc: 0.6591
Epoch 19/88
----------
train Loss: 0.4412 Acc: 0.6699
val Loss: 0.4077 Acc: 0.6591
Epoch 20/88
----------
train Loss: 0.4423 Acc: 0.6411
val Loss: 0.3964 Acc: 0.7045
Epoch 21/88
----------
train Loss: 0.4390 Acc: 0.6364
val Loss: 0.3880 Acc: 0.7045
Epoch 22/88
----------
train Loss: 0.4322 Acc: 0.6268
val Loss: 0.3803 Acc: 0.7045
Epoch 23/88
----------
train Loss: 0.4227 Acc: 0.6507
val Loss: 0.3709 Acc: 0.7273
Epoch 24/88
----------
train Loss: 0.3932 Acc: 0.7225
val Loss: 0.3558 Acc: 0.7500
Epoch 25/88
----------
train Loss: 0.4133 Acc: 0.6746
val Loss: 0.3576 Acc: 0.7500
Epoch 26/88
----------
train Loss: 0.4122 Acc: 0.6986
val Loss: 0.3554 Acc: 0.7500
Epoch 27/88
----------
train Loss: 0.3729 Acc: 0.7464
val Loss: 0.3480 Acc: 0.7727
Epoch 28/88
----------
train Loss: 0.4055 Acc: 0.6890
val Loss: 0.3440 Acc: 0.7955
Epoch 29/88
----------
train Loss: 0.4219 Acc: 0.6507
val Loss: 0.3409 Acc: 0.7727
Epoch 30/88
----------
train Loss: 0.3955 Acc: 0.6842
val Loss: 0.3378 Acc: 0.7955
Epoch 31/88
----------
train Loss: 0.3590 Acc: 0.8086
val Loss: 0.3290 Acc: 0.7955
Epoch 32/88
----------
train Loss: 0.3757 Acc: 0.7177
val Loss: 0.3203 Acc: 0.8182
Epoch 33/88
----------
train Loss: 0.3928 Acc: 0.7081
val Loss: 0.3187 Acc: 0.7955
Epoch 34/88
----------
train Loss: 0.3672 Acc: 0.7608
val Loss: 0.3147 Acc: 0.7955
Epoch 35/88
----------
train Loss: 0.3292 Acc: 0.8421
val Loss: 0.3139 Acc: 0.7955
Epoch 36/88
----------
train Loss: 0.4005 Acc: 0.7273
val Loss: 0.3086 Acc: 0.8182
Epoch 37/88
----------
train Loss: 0.3526 Acc: 0.7560
val Loss: 0.3144 Acc: 0.8182
Epoch 38/88
----------
train Loss: 0.3514 Acc: 0.8278
val Loss: 0.3115 Acc: 0.7955
Epoch 39/88
----------
train Loss: 0.3721 Acc: 0.6938
val Loss: 0.3190 Acc: 0.7727
Epoch 40/88
----------
train Loss: 0.3278 Acc: 0.8134
val Loss: 0.3150 Acc: 0.7727
Epoch 41/88
----------
train Loss: 0.3817 Acc: 0.6938
val Loss: 0.3096 Acc: 0.7955
Epoch 42/88
----------
train Loss: 0.3304 Acc: 0.7656
val Loss: 0.3014 Acc: 0.7955
Epoch 43/88
----------
train Loss: 0.3514 Acc: 0.7751
val Loss: 0.2965 Acc: 0.7955
Epoch 44/88
----------
train Loss: 0.3196 Acc: 0.8278
val Loss: 0.2935 Acc: 0.7955
Epoch 45/88
----------
train Loss: 0.2367 Acc: 0.9282
val Loss: 0.2892 Acc: 0.7955
Epoch 46/88
----------
train Loss: 0.3894 Acc: 0.7703
val Loss: 0.2908 Acc: 0.7955
Epoch 47/88
----------
train Loss: 0.3095 Acc: 0.8612
val Loss: 0.2873 Acc: 0.7955
Epoch 48/88
----------
train Loss: 0.3367 Acc: 0.7703
val Loss: 0.2899 Acc: 0.7955
Epoch 49/88
----------
train Loss: 0.3213 Acc: 0.8756
val Loss: 0.2868 Acc: 0.7955
Epoch 50/88
----------
train Loss: 0.3116 Acc: 0.8230
val Loss: 0.2867 Acc: 0.7955
Epoch 51/88
----------
train Loss: 0.2561 Acc: 0.9522
val Loss: 0.2801 Acc: 0.7727
Epoch 52/88
----------
train Loss: 0.3281 Acc: 0.7464
val Loss: 0.2828 Acc: 0.7727
Epoch 53/88
----------
train Loss: 0.3568 Acc: 0.8373
val Loss: 0.2802 Acc: 0.7500
Epoch 54/88
----------
train Loss: 0.2732 Acc: 0.9139
val Loss: 0.2738 Acc: 0.7955
Epoch 55/88
----------
train Loss: 0.2914 Acc: 0.9091
val Loss: 0.2717 Acc: 0.7955
Epoch 56/88
----------
train Loss: 0.3310 Acc: 0.8325
val Loss: 0.2724 Acc: 0.7955
Epoch 57/88
----------
train Loss: 0.3628 Acc: 0.7703
val Loss: 0.2711 Acc: 0.8409
Epoch 58/88
----------
train Loss: 0.3061 Acc: 0.7990
val Loss: 0.2688 Acc: 0.8182
Epoch 59/88
----------
train Loss: 0.3219 Acc: 0.8278
val Loss: 0.2676 Acc: 0.8182
Epoch 60/88
----------
train Loss: 0.2776 Acc: 0.8278
val Loss: 0.2698 Acc: 0.7955
Epoch 61/88
----------
train Loss: 0.3585 Acc: 0.7129
val Loss: 0.2708 Acc: 0.7955
Epoch 62/88
----------
train Loss: 0.3168 Acc: 0.8900
val Loss: 0.2696 Acc: 0.8182
Epoch 63/88
----------
train Loss: 0.2770 Acc: 0.9139
val Loss: 0.2697 Acc: 0.8182
Epoch 64/88
----------
train Loss: 0.2667 Acc: 0.9234
val Loss: 0.2670 Acc: 0.7955
Epoch 65/88
----------
train Loss: 0.2992 Acc: 0.7990
val Loss: 0.2667 Acc: 0.7955
Epoch 66/88
----------
train Loss: 0.2896 Acc: 0.8756
val Loss: 0.2700 Acc: 0.7955
Epoch 67/88
----------
train Loss: 0.3195 Acc: 0.8421
val Loss: 0.2635 Acc: 0.7955
Epoch 68/88
----------
train Loss: 0.2716 Acc: 0.9043
val Loss: 0.2664 Acc: 0.8182
Epoch 69/88
----------
train Loss: 0.2735 Acc: 0.8900
val Loss: 0.2656 Acc: 0.7955
Epoch 70/88
----------
train Loss: 0.3034 Acc: 0.8708
val Loss: 0.2687 Acc: 0.7955
Epoch 71/88
----------
train Loss: 0.3192 Acc: 0.8756
val Loss: 0.2662 Acc: 0.7955
Epoch 72/88
----------
train Loss: 0.3199 Acc: 0.8565
val Loss: 0.2710 Acc: 0.7727
Epoch 73/88
----------
train Loss: 0.2270 Acc: 0.9569
val Loss: 0.2729 Acc: 0.7727
Epoch 74/88
----------
train Loss: 0.3329 Acc: 0.8278
val Loss: 0.2674 Acc: 0.7500
Epoch 75/88
----------
train Loss: 0.2524 Acc: 0.9234
val Loss: 0.2684 Acc: 0.7500
Epoch 76/88
----------
train Loss: 0.2767 Acc: 0.7751
val Loss: 0.2653 Acc: 0.7500
Epoch 77/88
----------
train Loss: 0.3053 Acc: 0.8278
val Loss: 0.2630 Acc: 0.7727
Epoch 78/88
----------
train Loss: 0.2656 Acc: 0.8708
val Loss: 0.2608 Acc: 0.7727
Epoch 79/88
----------
train Loss: 0.3294 Acc: 0.8278
val Loss: 0.2558 Acc: 0.7955
Epoch 80/88
----------
train Loss: 0.2879 Acc: 0.8469
val Loss: 0.2546 Acc: 0.8182
Epoch 81/88
----------
train Loss: 0.3279 Acc: 0.7847
val Loss: 0.2628 Acc: 0.7955
Epoch 82/88
----------
train Loss: 0.2848 Acc: 0.8230
val Loss: 0.2637 Acc: 0.7955
Epoch 83/88
----------
train Loss: 0.2437 Acc: 0.9378
val Loss: 0.2648 Acc: 0.7955
Epoch 84/88
----------
train Loss: 0.3265 Acc: 0.7512
val Loss: 0.2639 Acc: 0.7500
Epoch 85/88
----------
train Loss: 0.2626 Acc: 0.8134
val Loss: 0.2653 Acc: 0.7500
Epoch 86/88
----------
train Loss: 0.2712 Acc: 0.8756
val Loss: 0.2574 Acc: 0.7955
Epoch 87/88
----------
train Loss: 0.3065 Acc: 0.8756
val Loss: 0.2552 Acc: 0.8182
Epoch 88/88
----------
train Loss: 0.3157 Acc: 0.8995
[32m[I 2025-06-28 18:07:54,187][0m Trial 75 finished with value: 0.8409090909090909 and parameters: {'batch_size': 17, 'lr': 3.991473765607718e-05, 'num_epochs': 88, 'weight_decay': 0.000356710469482819, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2524 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_17_lr_3.991473765607718e-05_epoch_88_wd_0.000356710469482819_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/76
----------
train Loss: 5.2854 Acc: 0.4258
val Loss: 5.3698 Acc: 0.6591
Epoch 2/76
----------
train Loss: 2.7144 Acc: 0.7799
val Loss: 9.9149 Acc: 0.6591
Epoch 3/76
----------
train Loss: 1.6568 Acc: 0.8325
val Loss: 12.6724 Acc: 0.6818
Epoch 4/76
----------
train Loss: 1.8237 Acc: 0.8612
val Loss: 8.9935 Acc: 0.7045
Epoch 5/76
----------
train Loss: 0.8533 Acc: 0.9282
val Loss: 6.3660 Acc: 0.7955
Epoch 6/76
----------
train Loss: 1.0638 Acc: 0.9043
val Loss: 4.1694 Acc: 0.6364
Epoch 7/76
----------
train Loss: 1.2920 Acc: 0.8660
val Loss: 12.3302 Acc: 0.5455
Epoch 8/76
----------
train Loss: 0.9476 Acc: 0.9043
val Loss: 11.8307 Acc: 0.5227
Epoch 9/76
----------
train Loss: 1.9711 Acc: 0.8660
val Loss: 5.0010 Acc: 0.5909
Epoch 10/76
----------
train Loss: 2.1422 Acc: 0.8373
[32m[I 2025-06-28 18:10:09,821][0m Trial 76 finished with value: 0.7954545454545455 and parameters: {'batch_size': 8, 'lr': 0.00166905299403517, 'num_epochs': 76, 'weight_decay': 0.011143014925748061, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.7905 Acc: 0.6136
Early stopping at epoch 10 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_8_lr_0.00166905299403517_epoch_76_wd_0.011143014925748061_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 0.6779 Acc: 0.2775
val Loss: 0.6461 Acc: 0.4091
Epoch 2/92
----------
train Loss: 0.6171 Acc: 0.4641
val Loss: 0.5937 Acc: 0.5455
Epoch 3/92
----------
train Loss: 0.5728 Acc: 0.4785
val Loss: 0.5326 Acc: 0.6364
Epoch 4/92
----------
train Loss: 0.5413 Acc: 0.4976
val Loss: 0.4932 Acc: 0.6364
Epoch 5/92
----------
train Loss: 0.5186 Acc: 0.5120
val Loss: 0.4731 Acc: 0.6364
Epoch 6/92
----------
train Loss: 0.4903 Acc: 0.5167
val Loss: 0.4436 Acc: 0.6364
Epoch 7/92
----------
train Loss: 0.4639 Acc: 0.5311
val Loss: 0.4206 Acc: 0.6818
Epoch 8/92
----------
train Loss: 0.4659 Acc: 0.5407
val Loss: 0.3952 Acc: 0.6591
Epoch 9/92
----------
train Loss: 0.4555 Acc: 0.5837
val Loss: 0.3795 Acc: 0.6818
Epoch 10/92
----------
train Loss: 0.3940 Acc: 0.6603
val Loss: 0.3672 Acc: 0.7273
Epoch 11/92
----------
train Loss: 0.4213 Acc: 0.5885
val Loss: 0.3521 Acc: 0.7500
Epoch 12/92
----------
train Loss: 0.4265 Acc: 0.6077
val Loss: 0.3651 Acc: 0.7273
Epoch 13/92
----------
train Loss: 0.3889 Acc: 0.6938
val Loss: 0.3439 Acc: 0.7500
Epoch 14/92
----------
train Loss: 0.3559 Acc: 0.7464
val Loss: 0.3208 Acc: 0.7500
Epoch 15/92
----------
train Loss: 0.3786 Acc: 0.7033
val Loss: 0.3138 Acc: 0.7727
Epoch 16/92
----------
train Loss: 0.3682 Acc: 0.7703
val Loss: 0.3270 Acc: 0.7500
Epoch 17/92
----------
train Loss: 0.3563 Acc: 0.7608
val Loss: 0.3324 Acc: 0.7500
Epoch 18/92
----------
train Loss: 0.3326 Acc: 0.7895
val Loss: 0.3163 Acc: 0.7500
Epoch 19/92
----------
train Loss: 0.3081 Acc: 0.8469
val Loss: 0.3003 Acc: 0.7727
Epoch 20/92
----------
train Loss: 0.3246 Acc: 0.8278
val Loss: 0.2782 Acc: 0.7500
Epoch 21/92
----------
train Loss: 0.3359 Acc: 0.8086
val Loss: 0.2672 Acc: 0.7500
Epoch 22/92
----------
train Loss: 0.3152 Acc: 0.8230
val Loss: 0.2707 Acc: 0.7955
Epoch 23/92
----------
train Loss: 0.3170 Acc: 0.8373
val Loss: 0.2728 Acc: 0.7955
Epoch 24/92
----------
train Loss: 0.2587 Acc: 0.9139
val Loss: 0.2571 Acc: 0.7955
Epoch 25/92
----------
train Loss: 0.2877 Acc: 0.9043
val Loss: 0.2745 Acc: 0.7955
Epoch 26/92
----------
train Loss: 0.3073 Acc: 0.8995
val Loss: 0.2829 Acc: 0.8409
Epoch 27/92
----------
train Loss: 0.2502 Acc: 0.9569
val Loss: 0.2908 Acc: 0.7955
Epoch 28/92
----------
train Loss: 0.3087 Acc: 0.8708
val Loss: 0.2731 Acc: 0.7500
Epoch 29/92
----------
train Loss: 0.3365 Acc: 0.7656
val Loss: 0.2820 Acc: 0.7727
Epoch 30/92
----------
train Loss: 0.2867 Acc: 0.8708
val Loss: 0.2730 Acc: 0.7500
Epoch 31/92
----------
train Loss: 0.2438 Acc: 0.9330
val Loss: 0.2550 Acc: 0.8182
Epoch 32/92
----------
train Loss: 0.2774 Acc: 0.8517
val Loss: 0.2513 Acc: 0.7955
Epoch 33/92
----------
train Loss: 0.2848 Acc: 0.8852
val Loss: 0.2582 Acc: 0.7500
Epoch 34/92
----------
train Loss: 0.2728 Acc: 0.9234
val Loss: 0.2709 Acc: 0.7500
Epoch 35/92
----------
train Loss: 0.2193 Acc: 0.9761
val Loss: 0.2941 Acc: 0.7273
Epoch 36/92
----------
train Loss: 0.3254 Acc: 0.8373
val Loss: 0.2897 Acc: 0.7500
Epoch 37/92
----------
train Loss: 0.2710 Acc: 0.8278
val Loss: 0.2842 Acc: 0.7500
Epoch 38/92
----------
train Loss: 0.2798 Acc: 0.9522
val Loss: 0.2671 Acc: 0.7727
Epoch 39/92
----------
train Loss: 0.2949 Acc: 0.7799
val Loss: 0.2842 Acc: 0.7727
Epoch 40/92
----------
train Loss: 0.2492 Acc: 0.8995
val Loss: 0.2771 Acc: 0.7727
Epoch 41/92
----------
train Loss: 0.3417 Acc: 0.7273
val Loss: 0.2710 Acc: 0.7955
Epoch 42/92
----------
train Loss: 0.2438 Acc: 0.8756
val Loss: 0.2750 Acc: 0.7955
Epoch 43/92
----------
train Loss: 0.2770 Acc: 0.8756
val Loss: 0.2622 Acc: 0.8636
Epoch 44/92
----------
train Loss: 0.2551 Acc: 0.8660
val Loss: 0.2718 Acc: 0.7727
Epoch 45/92
----------
train Loss: 0.1611 Acc: 0.9713
val Loss: 0.2583 Acc: 0.7727
Epoch 46/92
----------
train Loss: 0.3559 Acc: 0.8373
val Loss: 0.2752 Acc: 0.7955
Epoch 47/92
----------
train Loss: 0.2537 Acc: 0.8852
val Loss: 0.2733 Acc: 0.7955
Epoch 48/92
----------
train Loss: 0.2823 Acc: 0.8947
[32m[I 2025-06-28 18:21:04,592][0m Trial 77 finished with value: 0.8636363636363636 and parameters: {'batch_size': 13, 'lr': 0.000165657024870384, 'num_epochs': 92, 'weight_decay': 0.005339939032353119, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2614 Acc: 0.7727
Early stopping at epoch 48 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_13_lr_0.000165657024870384_epoch_92_wd_0.005339939032353119_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 5.8844 Acc: 0.2249
val Loss: 4.9695 Acc: 0.3864
Epoch 2/92
----------
train Loss: 4.8041 Acc: 0.5407
val Loss: 4.6391 Acc: 0.5455
Epoch 3/92
----------
train Loss: 4.0122 Acc: 0.7368
val Loss: 4.3703 Acc: 0.5909
Epoch 4/92
----------
train Loss: 3.3291 Acc: 0.8086
val Loss: 4.0682 Acc: 0.6136
Epoch 5/92
----------
train Loss: 2.5993 Acc: 0.8708
val Loss: 3.8162 Acc: 0.6591
Epoch 6/92
----------
train Loss: 2.0668 Acc: 0.8947
val Loss: 3.5112 Acc: 0.7273
Epoch 7/92
----------
train Loss: 1.4883 Acc: 0.9282
val Loss: 3.2075 Acc: 0.7273
Epoch 8/92
----------
train Loss: 1.0862 Acc: 0.9761
val Loss: 3.0329 Acc: 0.7727
Epoch 9/92
----------
train Loss: 0.8458 Acc: 0.9809
val Loss: 3.0102 Acc: 0.7955
Epoch 10/92
----------
train Loss: 0.6425 Acc: 0.9856
val Loss: 2.8574 Acc: 0.7955
Epoch 11/92
----------
train Loss: 0.4875 Acc: 0.9952
val Loss: 2.8046 Acc: 0.7955
Epoch 12/92
----------
train Loss: 0.3633 Acc: 0.9809
val Loss: 2.8968 Acc: 0.8182
Epoch 13/92
----------
train Loss: 0.3515 Acc: 0.9856
val Loss: 2.9933 Acc: 0.8182
Epoch 14/92
----------
train Loss: 0.3429 Acc: 0.9904
val Loss: 2.9702 Acc: 0.8182
Epoch 15/92
----------
train Loss: 0.1995 Acc: 1.0000
val Loss: 2.8804 Acc: 0.7955
Epoch 16/92
----------
train Loss: 0.1226 Acc: 1.0000
val Loss: 2.8319 Acc: 0.8182
Epoch 17/92
----------
train Loss: 0.1264 Acc: 0.9952
val Loss: 2.7969 Acc: 0.8182
Epoch 18/92
----------
train Loss: 0.0961 Acc: 1.0000
val Loss: 2.7831 Acc: 0.8182
Epoch 19/92
----------
train Loss: 0.1391 Acc: 1.0000
val Loss: 2.7837 Acc: 0.8182
Epoch 20/92
----------
train Loss: 0.1487 Acc: 0.9952
val Loss: 2.8685 Acc: 0.8182
Epoch 21/92
----------
train Loss: 0.1274 Acc: 0.9952
val Loss: 2.8675 Acc: 0.7955
Epoch 22/92
----------
train Loss: 0.1060 Acc: 1.0000
val Loss: 3.2222 Acc: 0.7727
Epoch 23/92
----------
train Loss: 0.0842 Acc: 1.0000
val Loss: 3.4455 Acc: 0.7500
Epoch 24/92
----------
train Loss: 0.0720 Acc: 0.9952
val Loss: 3.3609 Acc: 0.7727
Epoch 25/92
----------
train Loss: 0.0656 Acc: 1.0000
val Loss: 3.2967 Acc: 0.7955
Epoch 26/92
----------
train Loss: 0.0679 Acc: 1.0000
val Loss: 3.3317 Acc: 0.7955
Epoch 27/92
----------
train Loss: 0.0620 Acc: 1.0000
val Loss: 3.3272 Acc: 0.7955
Epoch 28/92
----------
train Loss: 0.0940 Acc: 0.9904
val Loss: 3.4015 Acc: 0.8409
Epoch 29/92
----------
train Loss: 0.0678 Acc: 0.9952
val Loss: 3.1578 Acc: 0.8409
Epoch 30/92
----------
train Loss: 0.0396 Acc: 1.0000
val Loss: 2.9585 Acc: 0.8409
Epoch 31/92
----------
train Loss: 0.1004 Acc: 0.9904
val Loss: 3.1340 Acc: 0.8182
Epoch 32/92
----------
train Loss: 0.0397 Acc: 1.0000
val Loss: 3.2411 Acc: 0.7727
Epoch 33/92
----------
train Loss: 0.0955 Acc: 0.9952
val Loss: 3.2167 Acc: 0.7955
Epoch 34/92
----------
train Loss: 0.0727 Acc: 0.9904
val Loss: 3.0735 Acc: 0.7727
Epoch 35/92
----------
train Loss: 0.0422 Acc: 1.0000
val Loss: 3.1351 Acc: 0.7727
Epoch 36/92
----------
train Loss: 0.1258 Acc: 0.9904
val Loss: 3.2376 Acc: 0.7727
Epoch 37/92
----------
train Loss: 0.0762 Acc: 0.9952
val Loss: 3.6916 Acc: 0.7500
Epoch 38/92
----------
train Loss: 0.1119 Acc: 0.9952
val Loss: 3.7581 Acc: 0.7273
Epoch 39/92
----------
train Loss: 0.0457 Acc: 1.0000
val Loss: 3.8156 Acc: 0.7273
Epoch 40/92
----------
train Loss: 0.0712 Acc: 0.9952
val Loss: 3.7495 Acc: 0.7273
Epoch 41/92
----------
train Loss: 0.0576 Acc: 1.0000
val Loss: 3.5909 Acc: 0.7500
Epoch 42/92
----------
train Loss: 0.0340 Acc: 1.0000
val Loss: 3.5277 Acc: 0.7500
Epoch 43/92
----------
train Loss: 0.0488 Acc: 0.9952
val Loss: 3.4852 Acc: 0.7727
Epoch 44/92
----------
train Loss: 0.0326 Acc: 1.0000
val Loss: 3.3903 Acc: 0.7727
Epoch 45/92
----------
train Loss: 0.0215 Acc: 1.0000
val Loss: 3.3188 Acc: 0.7500
Epoch 46/92
----------
train Loss: 0.0129 Acc: 1.0000
val Loss: 3.3331 Acc: 0.7500
Epoch 47/92
----------
train Loss: 0.0281 Acc: 1.0000
val Loss: 3.3451 Acc: 0.7727
Epoch 48/92
----------
train Loss: 0.0211 Acc: 1.0000
val Loss: 3.5614 Acc: 0.7727
Epoch 49/92
----------
train Loss: 0.1240 Acc: 0.9904
val Loss: 3.5253 Acc: 0.7727
Epoch 50/92
----------
train Loss: 0.0827 Acc: 0.9904
val Loss: 3.4124 Acc: 0.7273
Epoch 51/92
----------
train Loss: 0.1060 Acc: 0.9809
val Loss: 3.2901 Acc: 0.7727
Epoch 52/92
----------
train Loss: 0.0667 Acc: 0.9904
val Loss: 3.2221 Acc: 0.7955
Epoch 53/92
----------
train Loss: 0.0529 Acc: 1.0000
val Loss: 2.8767 Acc: 0.7955
Epoch 54/92
----------
train Loss: 0.0661 Acc: 0.9952
val Loss: 2.8118 Acc: 0.7955
Epoch 55/92
----------
train Loss: 0.0628 Acc: 0.9904
val Loss: 3.3484 Acc: 0.7500
Epoch 56/92
----------
train Loss: 0.0451 Acc: 1.0000
val Loss: 3.4263 Acc: 0.7500
Epoch 57/92
----------
train Loss: 0.1185 Acc: 0.9904
val Loss: 3.2467 Acc: 0.7500
Epoch 58/92
----------
train Loss: 0.0431 Acc: 1.0000
val Loss: 2.8597 Acc: 0.8182
Epoch 59/92
----------
train Loss: 0.0413 Acc: 1.0000
val Loss: 2.8841 Acc: 0.8409
Epoch 60/92
----------
train Loss: 0.0360 Acc: 0.9952
val Loss: 2.7891 Acc: 0.8182
Epoch 61/92
----------
train Loss: 0.1130 Acc: 0.9904
val Loss: 2.6926 Acc: 0.7955
Epoch 62/92
----------
train Loss: 0.0197 Acc: 1.0000
val Loss: 2.6659 Acc: 0.7955
Epoch 63/92
----------
train Loss: 0.0330 Acc: 1.0000
val Loss: 2.6353 Acc: 0.7727
Epoch 64/92
----------
train Loss: 0.0425 Acc: 0.9952
val Loss: 2.4008 Acc: 0.7727
Epoch 65/92
----------
train Loss: 0.1105 Acc: 0.9904
val Loss: 2.2060 Acc: 0.8182
Epoch 66/92
----------
train Loss: 0.0174 Acc: 1.0000
val Loss: 2.2267 Acc: 0.8409
Epoch 67/92
----------
train Loss: 0.0980 Acc: 0.9904
val Loss: 2.1041 Acc: 0.8182
Epoch 68/92
----------
train Loss: 0.0915 Acc: 0.9904
val Loss: 2.0928 Acc: 0.7955
Epoch 69/92
----------
train Loss: 0.0544 Acc: 0.9952
val Loss: 2.3052 Acc: 0.7273
Epoch 70/92
----------
train Loss: 0.0714 Acc: 0.9952
val Loss: 2.4841 Acc: 0.7727
Epoch 71/92
----------
train Loss: 0.0469 Acc: 1.0000
val Loss: 2.7656 Acc: 0.7500
Epoch 72/92
----------
train Loss: 0.0376 Acc: 1.0000
val Loss: 2.9448 Acc: 0.7500
Epoch 73/92
----------
train Loss: 0.0202 Acc: 1.0000
val Loss: 3.1219 Acc: 0.7727
Epoch 74/92
----------
train Loss: 0.0120 Acc: 1.0000
val Loss: 3.1757 Acc: 0.7727
Epoch 75/92
----------
train Loss: 0.0149 Acc: 1.0000
val Loss: 3.0881 Acc: 0.7955
Epoch 76/92
----------
train Loss: 0.0274 Acc: 1.0000
val Loss: 2.9939 Acc: 0.7955
Epoch 77/92
----------
train Loss: 0.0140 Acc: 1.0000
val Loss: 3.0333 Acc: 0.7727
Epoch 78/92
----------
train Loss: 0.0096 Acc: 1.0000
val Loss: 2.9739 Acc: 0.7727
Epoch 79/92
----------
train Loss: 0.0130 Acc: 1.0000
val Loss: 3.0228 Acc: 0.7727
Epoch 80/92
----------
train Loss: 0.0101 Acc: 1.0000
val Loss: 2.9996 Acc: 0.7955
Epoch 81/92
----------
train Loss: 0.0071 Acc: 1.0000
val Loss: 2.9043 Acc: 0.7727
Epoch 82/92
----------
train Loss: 0.0163 Acc: 1.0000
val Loss: 2.7587 Acc: 0.7727
Epoch 83/92
----------
train Loss: 0.0086 Acc: 1.0000
val Loss: 2.7766 Acc: 0.7727
Epoch 84/92
----------
train Loss: 0.0116 Acc: 1.0000
val Loss: 2.7709 Acc: 0.7955
Epoch 85/92
----------
train Loss: 0.0054 Acc: 1.0000
val Loss: 2.7658 Acc: 0.7727
Epoch 86/92
----------
train Loss: 0.0153 Acc: 1.0000
val Loss: 2.7859 Acc: 0.7727
Epoch 87/92
----------
train Loss: 0.0050 Acc: 1.0000
val Loss: 2.8319 Acc: 0.7727
Epoch 88/92
----------
train Loss: 0.0112 Acc: 1.0000
val Loss: 2.8364 Acc: 0.7727
Epoch 89/92
----------
train Loss: 0.0139 Acc: 1.0000
val Loss: 3.0405 Acc: 0.7727
Epoch 90/92
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 3.1259 Acc: 0.7727
Epoch 91/92
----------
train Loss: 0.0078 Acc: 1.0000
val Loss: 3.1770 Acc: 0.7727
Epoch 92/92
----------
train Loss: 0.0344 Acc: 0.9952
[32m[I 2025-06-28 18:42:02,286][0m Trial 78 finished with value: 0.7727272727272727 and parameters: {'batch_size': 21, 'lr': 0.00015569263374186451, 'num_epochs': 92, 'weight_decay': 0.004282237162987704, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 3.1343 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_21_lr_0.00015569263374186451_epoch_92_wd_0.004282237162987704_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/58
----------
train Loss: 0.6869 Acc: 0.2584
val Loss: 0.6626 Acc: 0.2955
Epoch 2/58
----------
train Loss: 0.6435 Acc: 0.3923
val Loss: 0.6247 Acc: 0.4545
Epoch 3/58
----------
train Loss: 0.6088 Acc: 0.4737
val Loss: 0.5753 Acc: 0.5682
Epoch 4/58
----------
train Loss: 0.5821 Acc: 0.4928
val Loss: 0.5393 Acc: 0.6136
Epoch 5/58
----------
train Loss: 0.5604 Acc: 0.5215
val Loss: 0.5152 Acc: 0.6364
Epoch 6/58
----------
train Loss: 0.5302 Acc: 0.5407
val Loss: 0.4837 Acc: 0.6591
Epoch 7/58
----------
train Loss: 0.5006 Acc: 0.5646
val Loss: 0.4561 Acc: 0.6818
Epoch 8/58
----------
train Loss: 0.4947 Acc: 0.5359
val Loss: 0.4298 Acc: 0.6818
Epoch 9/58
----------
train Loss: 0.4793 Acc: 0.5598
val Loss: 0.4104 Acc: 0.6818
Epoch 10/58
----------
train Loss: 0.4275 Acc: 0.6364
val Loss: 0.3953 Acc: 0.7045
Epoch 11/58
----------
train Loss: 0.4461 Acc: 0.5885
val Loss: 0.3805 Acc: 0.7045
Epoch 12/58
----------
train Loss: 0.4494 Acc: 0.5981
val Loss: 0.3772 Acc: 0.7045
Epoch 13/58
----------
train Loss: 0.4118 Acc: 0.6651
val Loss: 0.3606 Acc: 0.7045
Epoch 14/58
----------
train Loss: 0.3863 Acc: 0.6842
val Loss: 0.3472 Acc: 0.7273
Epoch 15/58
----------
train Loss: 0.4034 Acc: 0.6651
val Loss: 0.3384 Acc: 0.7955
Epoch 16/58
----------
train Loss: 0.3942 Acc: 0.7225
val Loss: 0.3359 Acc: 0.7955
Epoch 17/58
----------
train Loss: 0.3824 Acc: 0.7368
val Loss: 0.3335 Acc: 0.7727
Epoch 18/58
----------
train Loss: 0.3615 Acc: 0.7416
val Loss: 0.3213 Acc: 0.7500
Epoch 19/58
----------
train Loss: 0.3403 Acc: 0.8086
val Loss: 0.3140 Acc: 0.7955
Epoch 20/58
----------
train Loss: 0.3570 Acc: 0.7703
val Loss: 0.3026 Acc: 0.7727
Epoch 21/58
----------
train Loss: 0.3601 Acc: 0.7799
val Loss: 0.2908 Acc: 0.7727
Epoch 22/58
----------
train Loss: 0.3431 Acc: 0.7895
val Loss: 0.2876 Acc: 0.7955
Epoch 23/58
----------
train Loss: 0.3439 Acc: 0.8182
val Loss: 0.2825 Acc: 0.8409
Epoch 24/58
----------
train Loss: 0.2936 Acc: 0.8565
val Loss: 0.2674 Acc: 0.8182
Epoch 25/58
----------
train Loss: 0.3207 Acc: 0.8756
val Loss: 0.2754 Acc: 0.7955
Epoch 26/58
----------
train Loss: 0.3301 Acc: 0.8660
val Loss: 0.2804 Acc: 0.7955
Epoch 27/58
----------
train Loss: 0.2734 Acc: 0.9522
val Loss: 0.2885 Acc: 0.8182
Epoch 28/58
----------
train Loss: 0.3300 Acc: 0.8469
val Loss: 0.2853 Acc: 0.7500
Epoch 29/58
----------
train Loss: 0.3558 Acc: 0.7416
val Loss: 0.2847 Acc: 0.7727
Epoch 30/58
----------
train Loss: 0.3083 Acc: 0.8278
val Loss: 0.2717 Acc: 0.7727
Epoch 31/58
----------
train Loss: 0.2635 Acc: 0.9187
val Loss: 0.2601 Acc: 0.7955
Epoch 32/58
----------
train Loss: 0.2943 Acc: 0.8278
val Loss: 0.2575 Acc: 0.7955
Epoch 33/58
----------
train Loss: 0.3104 Acc: 0.8373
val Loss: 0.2565 Acc: 0.7955
Epoch 34/58
----------
train Loss: 0.2894 Acc: 0.8852
val Loss: 0.2603 Acc: 0.7727
Epoch 35/58
----------
train Loss: 0.2335 Acc: 0.9809
val Loss: 0.2729 Acc: 0.7727
Epoch 36/58
----------
train Loss: 0.3388 Acc: 0.7847
val Loss: 0.2755 Acc: 0.7500
Epoch 37/58
----------
train Loss: 0.2787 Acc: 0.8373
val Loss: 0.2759 Acc: 0.7500
Epoch 38/58
----------
train Loss: 0.2799 Acc: 0.9378
val Loss: 0.2648 Acc: 0.7955
Epoch 39/58
----------
train Loss: 0.3105 Acc: 0.7799
val Loss: 0.2725 Acc: 0.7727
Epoch 40/58
----------
train Loss: 0.2530 Acc: 0.8852
val Loss: 0.2712 Acc: 0.8182
Epoch 41/58
----------
train Loss: 0.3420 Acc: 0.7368
val Loss: 0.2638 Acc: 0.8182
Epoch 42/58
----------
train Loss: 0.2499 Acc: 0.8708
val Loss: 0.2586 Acc: 0.7955
Epoch 43/58
----------
train Loss: 0.2764 Acc: 0.8373
val Loss: 0.2564 Acc: 0.7955
Epoch 44/58
----------
train Loss: 0.2635 Acc: 0.8708
val Loss: 0.2626 Acc: 0.8182
Epoch 45/58
----------
train Loss: 0.1647 Acc: 0.9809
val Loss: 0.2644 Acc: 0.8182
Epoch 46/58
----------
train Loss: 0.3590 Acc: 0.8086
val Loss: 0.2685 Acc: 0.7727
Epoch 47/58
----------
train Loss: 0.2521 Acc: 0.8900
val Loss: 0.2633 Acc: 0.7955
Epoch 48/58
----------
train Loss: 0.2887 Acc: 0.8517
val Loss: 0.2647 Acc: 0.7727
Epoch 49/58
----------
train Loss: 0.2719 Acc: 0.9522
val Loss: 0.2675 Acc: 0.7727
Epoch 50/58
----------
train Loss: 0.2656 Acc: 0.8900
val Loss: 0.2682 Acc: 0.7727
Epoch 51/58
----------
train Loss: 0.1976 Acc: 0.9856
val Loss: 0.2574 Acc: 0.7727
Epoch 52/58
----------
train Loss: 0.2830 Acc: 0.8230
val Loss: 0.2545 Acc: 0.7727
Epoch 53/58
----------
train Loss: 0.3192 Acc: 0.8995
val Loss: 0.2533 Acc: 0.7727
Epoch 54/58
----------
train Loss: 0.2325 Acc: 0.9282
val Loss: 0.2536 Acc: 0.8182
Epoch 55/58
----------
train Loss: 0.2480 Acc: 0.9282
val Loss: 0.2638 Acc: 0.7727
Epoch 56/58
----------
train Loss: 0.2913 Acc: 0.9187
val Loss: 0.2654 Acc: 0.7500
Epoch 57/58
----------
train Loss: 0.3333 Acc: 0.8038
val Loss: 0.2651 Acc: 0.7727
Epoch 58/58
----------
train Loss: 0.2701 Acc: 0.7990
[32m[I 2025-06-28 18:55:13,056][0m Trial 79 finished with value: 0.8181818181818182 and parameters: {'batch_size': 12, 'lr': 8.885726273494152e-05, 'num_epochs': 58, 'weight_decay': 0.0013921723696492178, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2586 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_8.885726273494152e-05_epoch_58_wd_0.0013921723696492178_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 3.3128 Acc: 0.3732
val Loss: 2.7812 Acc: 0.6364
Epoch 2/83
----------
train Loss: 2.5010 Acc: 0.5407
val Loss: 1.9652 Acc: 0.6364
Epoch 3/83
----------
train Loss: 2.2254 Acc: 0.5215
val Loss: 1.9039 Acc: 0.6818
Epoch 4/83
----------
train Loss: 2.1263 Acc: 0.5455
val Loss: 1.9815 Acc: 0.7500
Epoch 5/83
----------
train Loss: 2.0345 Acc: 0.6507
val Loss: 1.8334 Acc: 0.7727
Epoch 6/83
----------
train Loss: 1.8579 Acc: 0.6794
val Loss: 1.6108 Acc: 0.7955
Epoch 7/83
----------
train Loss: 1.5971 Acc: 0.8278
val Loss: 1.3976 Acc: 0.7727
Epoch 8/83
----------
train Loss: 1.7152 Acc: 0.7608
val Loss: 1.4694 Acc: 0.8182
Epoch 9/83
----------
train Loss: 1.7184 Acc: 0.7512
val Loss: 1.7282 Acc: 0.7955
Epoch 10/83
----------
train Loss: 1.0472 Acc: 0.9474
val Loss: 1.2027 Acc: 0.8182
Epoch 11/83
----------
train Loss: 1.7692 Acc: 0.7799
val Loss: 1.3570 Acc: 0.8182
Epoch 12/83
----------
train Loss: 1.5124 Acc: 0.7560
val Loss: 2.2609 Acc: 0.7045
Epoch 13/83
----------
train Loss: 1.3700 Acc: 0.8804
val Loss: 1.6766 Acc: 0.7727
Epoch 14/83
----------
train Loss: 1.2771 Acc: 0.8373
val Loss: 1.5134 Acc: 0.7955
Epoch 15/83
----------
train Loss: 1.4081 Acc: 0.8373
val Loss: 1.2542 Acc: 0.7955
Epoch 16/83
----------
train Loss: 1.4502 Acc: 0.7895
val Loss: 1.4455 Acc: 0.8409
Epoch 17/83
----------
train Loss: 1.3998 Acc: 0.8325
val Loss: 1.5856 Acc: 0.8182
Epoch 18/83
----------
train Loss: 1.3484 Acc: 0.8086
val Loss: 1.3846 Acc: 0.7727
Epoch 19/83
----------
train Loss: 1.2778 Acc: 0.9139
val Loss: 1.2079 Acc: 0.8409
Epoch 20/83
----------
train Loss: 1.3720 Acc: 0.8565
val Loss: 1.2139 Acc: 0.7500
Epoch 21/83
----------
train Loss: 1.5015 Acc: 0.8852
val Loss: 1.3562 Acc: 0.8182
Epoch 22/83
----------
train Loss: 1.3066 Acc: 0.8947
val Loss: 1.4432 Acc: 0.7955
Epoch 23/83
----------
train Loss: 1.5120 Acc: 0.8900
val Loss: 1.3434 Acc: 0.7955
Epoch 24/83
----------
train Loss: 1.1749 Acc: 0.9187
val Loss: 1.3616 Acc: 0.7955
Epoch 25/83
----------
train Loss: 1.2931 Acc: 0.9234
val Loss: 1.7141 Acc: 0.7500
Epoch 26/83
----------
train Loss: 1.4625 Acc: 0.9234
val Loss: 1.3421 Acc: 0.7955
Epoch 27/83
----------
train Loss: 1.2045 Acc: 0.9569
val Loss: 1.5467 Acc: 0.7500
Epoch 28/83
----------
train Loss: 1.4061 Acc: 0.8469
val Loss: 1.2386 Acc: 0.8182
Epoch 29/83
----------
train Loss: 1.4858 Acc: 0.7799
val Loss: 1.2865 Acc: 0.8409
Epoch 30/83
----------
train Loss: 1.3476 Acc: 0.8517
val Loss: 1.0892 Acc: 0.8182
Epoch 31/83
----------
train Loss: 1.1617 Acc: 0.9474
val Loss: 1.1960 Acc: 0.7727
Epoch 32/83
----------
train Loss: 1.2992 Acc: 0.9043
val Loss: 1.5166 Acc: 0.6818
Epoch 33/83
----------
train Loss: 1.4534 Acc: 0.8756
val Loss: 1.4337 Acc: 0.7045
Epoch 34/83
----------
train Loss: 1.4344 Acc: 0.9043
val Loss: 1.5659 Acc: 0.7500
Epoch 35/83
----------
train Loss: 1.0738 Acc: 0.9665
val Loss: 1.4501 Acc: 0.7273
Epoch 36/83
----------
train Loss: 1.6298 Acc: 0.8469
val Loss: 1.1874 Acc: 0.7955
Epoch 37/83
----------
train Loss: 1.3231 Acc: 0.8421
val Loss: 1.4865 Acc: 0.7727
Epoch 38/83
----------
train Loss: 1.4708 Acc: 0.9187
val Loss: 1.5542 Acc: 0.7727
Epoch 39/83
----------
train Loss: 1.4397 Acc: 0.7560
val Loss: 1.6938 Acc: 0.7045
Epoch 40/83
----------
train Loss: 1.2860 Acc: 0.9043
val Loss: 1.6291 Acc: 0.7500
Epoch 41/83
----------
train Loss: 1.6485 Acc: 0.6794
val Loss: 1.6612 Acc: 0.7500
Epoch 42/83
----------
train Loss: 1.2352 Acc: 0.8469
val Loss: 1.5532 Acc: 0.6591
Epoch 43/83
----------
train Loss: 1.3270 Acc: 0.8517
val Loss: 1.3513 Acc: 0.7955
Epoch 44/83
----------
train Loss: 1.2744 Acc: 0.8900
val Loss: 1.5109 Acc: 0.7500
Epoch 45/83
----------
train Loss: 0.8326 Acc: 0.9474
val Loss: 1.5858 Acc: 0.7273
Epoch 46/83
----------
train Loss: 1.6779 Acc: 0.7943
val Loss: 1.6972 Acc: 0.7045
Epoch 47/83
----------
train Loss: 1.3280 Acc: 0.9139
val Loss: 1.3894 Acc: 0.7045
Epoch 48/83
----------
train Loss: 1.3866 Acc: 0.8852
val Loss: 1.3642 Acc: 0.7727
Epoch 49/83
----------
train Loss: 1.3415 Acc: 0.9091
val Loss: 1.3532 Acc: 0.7273
Epoch 50/83
----------
train Loss: 1.3201 Acc: 0.8469
val Loss: 1.3912 Acc: 0.8182
Epoch 51/83
----------
train Loss: 0.9991 Acc: 0.9856
val Loss: 1.5199 Acc: 0.7273
Epoch 52/83
----------
train Loss: 1.3476 Acc: 0.8278
val Loss: 1.4168 Acc: 0.7500
Epoch 53/83
----------
train Loss: 1.5033 Acc: 0.9091
val Loss: 1.6807 Acc: 0.6818
Epoch 54/83
----------
train Loss: 1.2360 Acc: 0.8995
val Loss: 1.3086 Acc: 0.7727
Epoch 55/83
----------
train Loss: 1.2782 Acc: 0.9330
val Loss: 1.5667 Acc: 0.7727
Epoch 56/83
----------
train Loss: 1.4364 Acc: 0.8708
val Loss: 1.2939 Acc: 0.7273
Epoch 57/83
----------
train Loss: 1.5966 Acc: 0.8230
val Loss: 1.5330 Acc: 0.7045
Epoch 58/83
----------
train Loss: 1.3146 Acc: 0.8038
val Loss: 1.5914 Acc: 0.7045
Epoch 59/83
----------
train Loss: 1.3963 Acc: 0.8804
val Loss: 1.5177 Acc: 0.7045
Epoch 60/83
----------
train Loss: 1.1211 Acc: 0.9139
val Loss: 1.4940 Acc: 0.7500
Epoch 61/83
----------
train Loss: 1.5367 Acc: 0.7512
val Loss: 1.6874 Acc: 0.7500
Epoch 62/83
----------
train Loss: 1.5471 Acc: 0.8947
val Loss: 1.8388 Acc: 0.5909
Epoch 63/83
----------
train Loss: 1.3180 Acc: 0.9187
val Loss: 1.3238 Acc: 0.7500
Epoch 64/83
----------
train Loss: 1.1670 Acc: 0.9474
val Loss: 1.3586 Acc: 0.7727
Epoch 65/83
----------
train Loss: 1.3648 Acc: 0.8469
val Loss: 1.3718 Acc: 0.7045
Epoch 66/83
----------
train Loss: 1.3394 Acc: 0.8852
val Loss: 1.4440 Acc: 0.7955
Epoch 67/83
----------
train Loss: 1.4972 Acc: 0.8134
val Loss: 1.7014 Acc: 0.6591
Epoch 68/83
----------
train Loss: 1.2058 Acc: 0.8947
val Loss: 1.6935 Acc: 0.7273
Epoch 69/83
----------
train Loss: 1.2001 Acc: 0.8756
val Loss: 1.4465 Acc: 0.7955
Epoch 70/83
----------
train Loss: 1.3186 Acc: 0.8995
val Loss: 1.6234 Acc: 0.7045
Epoch 71/83
----------
train Loss: 1.4335 Acc: 0.8804
val Loss: 1.2555 Acc: 0.8636
Epoch 72/83
----------
train Loss: 1.4434 Acc: 0.8756
val Loss: 1.4172 Acc: 0.6818
Epoch 73/83
----------
train Loss: 1.0359 Acc: 0.9426
val Loss: 1.6325 Acc: 0.7045
Epoch 74/83
----------
train Loss: 1.4761 Acc: 0.8612
val Loss: 1.4554 Acc: 0.7045
Epoch 75/83
----------
train Loss: 1.2179 Acc: 0.9522
val Loss: 1.3246 Acc: 0.7273
Epoch 76/83
----------
train Loss: 1.1529 Acc: 0.8469
[32m[I 2025-06-28 19:12:28,205][0m Trial 80 finished with value: 0.8636363636363636 and parameters: {'batch_size': 13, 'lr': 0.0005469124181755644, 'num_epochs': 83, 'weight_decay': 0.015845617450054576, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.4147 Acc: 0.7045
Early stopping at epoch 76 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_13_lr_0.0005469124181755644_epoch_83_wd_0.015845617450054576_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/85
----------
train Loss: 3.2932 Acc: 0.3732
val Loss: 2.5781 Acc: 0.6364
Epoch 2/85
----------
train Loss: 2.4590 Acc: 0.5455
val Loss: 1.9496 Acc: 0.6364
Epoch 3/85
----------
train Loss: 2.1777 Acc: 0.5407
val Loss: 1.7405 Acc: 0.6818
Epoch 4/85
----------
train Loss: 2.0721 Acc: 0.5742
val Loss: 1.6735 Acc: 0.7727
Epoch 5/85
----------
train Loss: 1.9715 Acc: 0.7416
val Loss: 1.5035 Acc: 0.8182
Epoch 6/85
----------
train Loss: 1.8065 Acc: 0.6986
val Loss: 1.3801 Acc: 0.8182
Epoch 7/85
----------
train Loss: 1.5145 Acc: 0.8612
val Loss: 1.2451 Acc: 0.8409
Epoch 8/85
----------
train Loss: 1.6877 Acc: 0.7751
val Loss: 1.2803 Acc: 0.8182
Epoch 9/85
----------
train Loss: 1.6822 Acc: 0.7703
val Loss: 1.4368 Acc: 0.7727
Epoch 10/85
----------
train Loss: 1.0246 Acc: 0.9330
val Loss: 1.1625 Acc: 0.8182
Epoch 11/85
----------
train Loss: 1.7544 Acc: 0.7703
val Loss: 1.2599 Acc: 0.7955
Epoch 12/85
----------
train Loss: 1.4746 Acc: 0.7608
val Loss: 1.7634 Acc: 0.7727
Epoch 13/85
----------
train Loss: 1.3439 Acc: 0.8852
val Loss: 1.4943 Acc: 0.7955
Epoch 14/85
----------
train Loss: 1.2296 Acc: 0.8325
val Loss: 1.4603 Acc: 0.7500
Epoch 15/85
----------
train Loss: 1.4030 Acc: 0.8325
val Loss: 1.2766 Acc: 0.7955
Epoch 16/85
----------
train Loss: 1.3912 Acc: 0.8134
val Loss: 1.4872 Acc: 0.7955
Epoch 17/85
----------
train Loss: 1.3947 Acc: 0.8421
val Loss: 1.4189 Acc: 0.8182
Epoch 18/85
----------
train Loss: 1.3307 Acc: 0.8278
val Loss: 1.2967 Acc: 0.8182
Epoch 19/85
----------
train Loss: 1.2173 Acc: 0.9378
val Loss: 1.1566 Acc: 0.7955
Epoch 20/85
----------
train Loss: 1.3075 Acc: 0.8804
val Loss: 1.1232 Acc: 0.8409
Epoch 21/85
----------
train Loss: 1.4062 Acc: 0.9043
val Loss: 1.0289 Acc: 0.8864
Epoch 22/85
----------
train Loss: 1.2536 Acc: 0.8708
val Loss: 1.1328 Acc: 0.8636
Epoch 23/85
----------
train Loss: 1.4942 Acc: 0.8947
val Loss: 1.2494 Acc: 0.8182
Epoch 24/85
----------
train Loss: 1.0762 Acc: 0.9474
val Loss: 1.2404 Acc: 0.7727
Epoch 25/85
----------
train Loss: 1.2233 Acc: 0.9282
val Loss: 1.3315 Acc: 0.7727
Epoch 26/85
----------
train Loss: 1.4244 Acc: 0.9426
val Loss: 1.2086 Acc: 0.8182
Epoch 27/85
----------
train Loss: 1.1632 Acc: 0.9665
val Loss: 1.3982 Acc: 0.7727
Epoch 28/85
----------
train Loss: 1.3760 Acc: 0.8612
val Loss: 1.2168 Acc: 0.8182
Epoch 29/85
----------
train Loss: 1.4415 Acc: 0.8134
val Loss: 1.3816 Acc: 0.8409
Epoch 30/85
----------
train Loss: 1.2455 Acc: 0.8995
val Loss: 1.3302 Acc: 0.7273
Epoch 31/85
----------
train Loss: 1.0989 Acc: 0.9426
val Loss: 1.2041 Acc: 0.7727
Epoch 32/85
----------
train Loss: 1.1899 Acc: 0.8900
val Loss: 1.2078 Acc: 0.7955
Epoch 33/85
----------
train Loss: 1.3493 Acc: 0.8708
val Loss: 1.4208 Acc: 0.7273
Epoch 34/85
----------
train Loss: 1.2830 Acc: 0.9330
val Loss: 1.4146 Acc: 0.7273
Epoch 35/85
----------
train Loss: 0.9956 Acc: 0.9665
val Loss: 1.3839 Acc: 0.7727
Epoch 36/85
----------
train Loss: 1.5372 Acc: 0.8660
val Loss: 1.3475 Acc: 0.7273
Epoch 37/85
----------
train Loss: 1.3236 Acc: 0.8182
val Loss: 1.5275 Acc: 0.7727
Epoch 38/85
----------
train Loss: 1.3587 Acc: 0.9617
val Loss: 1.3420 Acc: 0.7500
Epoch 39/85
----------
train Loss: 1.3353 Acc: 0.7656
val Loss: 1.3887 Acc: 0.7273
Epoch 40/85
----------
train Loss: 1.1654 Acc: 0.9426
val Loss: 1.4269 Acc: 0.6818
Epoch 41/85
----------
train Loss: 1.5845 Acc: 0.7225
val Loss: 1.3621 Acc: 0.7500
Epoch 42/85
----------
train Loss: 1.1401 Acc: 0.8708
val Loss: 1.3999 Acc: 0.7273
Epoch 43/85
----------
train Loss: 1.2775 Acc: 0.8660
val Loss: 1.2985 Acc: 0.7273
Epoch 44/85
----------
train Loss: 1.1855 Acc: 0.8947
val Loss: 1.3974 Acc: 0.7727
Epoch 45/85
----------
train Loss: 0.7891 Acc: 0.9665
val Loss: 1.2402 Acc: 0.8409
Epoch 46/85
----------
train Loss: 1.6577 Acc: 0.8134
val Loss: 1.5029 Acc: 0.7955
Epoch 47/85
----------
train Loss: 1.2360 Acc: 0.9234
val Loss: 1.5731 Acc: 0.6591
Epoch 48/85
----------
train Loss: 1.3203 Acc: 0.8852
val Loss: 1.3440 Acc: 0.7273
Epoch 49/85
----------
train Loss: 1.2773 Acc: 0.9569
val Loss: 1.2619 Acc: 0.7727
Epoch 50/85
----------
train Loss: 1.2479 Acc: 0.8660
val Loss: 1.2135 Acc: 0.7955
Epoch 51/85
----------
train Loss: 0.9584 Acc: 0.9856
val Loss: 1.6242 Acc: 0.7727
Epoch 52/85
----------
train Loss: 1.3274 Acc: 0.8182
val Loss: 1.2142 Acc: 0.7500
Epoch 53/85
----------
train Loss: 1.4921 Acc: 0.8947
val Loss: 1.3576 Acc: 0.6591
Epoch 54/85
----------
train Loss: 1.1927 Acc: 0.9330
val Loss: 1.3711 Acc: 0.7273
Epoch 55/85
----------
train Loss: 1.1736 Acc: 0.9665
val Loss: 1.4899 Acc: 0.7045
Epoch 56/85
----------
train Loss: 1.3754 Acc: 0.9330
val Loss: 1.4295 Acc: 0.7273
Epoch 57/85
----------
train Loss: 1.4907 Acc: 0.8325
val Loss: 1.6109 Acc: 0.7500
Epoch 58/85
----------
train Loss: 1.2505 Acc: 0.8230
val Loss: 1.5515 Acc: 0.7045
Epoch 59/85
----------
train Loss: 1.3063 Acc: 0.9187
val Loss: 1.4936 Acc: 0.7045
Epoch 60/85
----------
train Loss: 1.0558 Acc: 0.9187
val Loss: 1.5296 Acc: 0.7045
Epoch 61/85
----------
train Loss: 1.4575 Acc: 0.8038
val Loss: 1.6768 Acc: 0.7273
Epoch 62/85
----------
train Loss: 1.4100 Acc: 0.9474
val Loss: 1.5754 Acc: 0.6818
Epoch 63/85
----------
train Loss: 1.2687 Acc: 0.9474
val Loss: 1.4063 Acc: 0.7273
Epoch 64/85
----------
train Loss: 1.0931 Acc: 0.9713
val Loss: 1.3797 Acc: 0.7045
Epoch 65/85
----------
train Loss: 1.2370 Acc: 0.8947
val Loss: 1.4561 Acc: 0.6818
Epoch 66/85
----------
train Loss: 1.2232 Acc: 0.8900
val Loss: 2.2130 Acc: 0.6364
Epoch 67/85
----------
train Loss: 1.4311 Acc: 0.8469
val Loss: 1.4753 Acc: 0.8182
Epoch 68/85
----------
train Loss: 1.1703 Acc: 0.8852
val Loss: 1.4572 Acc: 0.7500
Epoch 69/85
----------
train Loss: 1.1294 Acc: 0.8660
val Loss: 1.4367 Acc: 0.7727
Epoch 70/85
----------
train Loss: 1.3033 Acc: 0.9091
val Loss: 1.3678 Acc: 0.7500
Epoch 71/85
----------
train Loss: 1.3928 Acc: 0.9091
val Loss: 1.5703 Acc: 0.7727
Epoch 72/85
----------
train Loss: 1.3698 Acc: 0.8756
val Loss: 1.4620 Acc: 0.8409
Epoch 73/85
----------
train Loss: 0.9522 Acc: 0.9569
val Loss: 1.3572 Acc: 0.7500
Epoch 74/85
----------
train Loss: 1.4104 Acc: 0.8612
val Loss: 1.3870 Acc: 0.7727
Epoch 75/85
----------
train Loss: 1.1270 Acc: 0.9809
val Loss: 1.5823 Acc: 0.7500
Epoch 76/85
----------
train Loss: 1.0969 Acc: 0.8804
val Loss: 1.4232 Acc: 0.7045
Epoch 77/85
----------
train Loss: 1.3190 Acc: 0.8804
[32m[I 2025-06-28 19:30:00,602][0m Trial 81 finished with value: 0.8409090909090909 and parameters: {'batch_size': 63, 'lr': 0.0005314404599135046, 'num_epochs': 85, 'weight_decay': 0.006103872804104602, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.4889 Acc: 0.7273
Early stopping at epoch 77 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_63_lr_0.0005314404599135046_epoch_85_wd_0.006103872804104602_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 2.9320 Acc: 0.4211
val Loss: 2.0081 Acc: 0.6364
Epoch 2/81
----------
train Loss: 2.4226 Acc: 0.5933
val Loss: 3.5389 Acc: 0.4091
Epoch 3/81
----------
train Loss: 2.0925 Acc: 0.6603
val Loss: 2.3135 Acc: 0.6136
Epoch 4/81
----------
train Loss: 2.0890 Acc: 0.6459
val Loss: 2.7183 Acc: 0.7273
Epoch 5/81
----------
train Loss: 1.8372 Acc: 0.7273
val Loss: 3.5177 Acc: 0.4773
Epoch 6/81
----------
train Loss: 1.8444 Acc: 0.7225
val Loss: 2.6935 Acc: 0.7045
Epoch 7/81
----------
train Loss: 1.7341 Acc: 0.7847
val Loss: 3.8684 Acc: 0.6364
Epoch 8/81
----------
train Loss: 1.8592 Acc: 0.7464
val Loss: 2.2457 Acc: 0.8409
Epoch 9/81
----------
train Loss: 1.8015 Acc: 0.7273
val Loss: 3.2193 Acc: 0.5455
Epoch 10/81
----------
train Loss: 1.2586 Acc: 0.9187
val Loss: 1.3662 Acc: 0.8636
Epoch 11/81
----------
train Loss: 2.0189 Acc: 0.7225
val Loss: 3.2605 Acc: 0.5455
Epoch 12/81
----------
train Loss: 1.9426 Acc: 0.6746
val Loss: 2.3893 Acc: 0.6818
Epoch 13/81
----------
train Loss: 1.6733 Acc: 0.8134
val Loss: 1.7061 Acc: 0.7273
Epoch 14/81
----------
train Loss: 1.4014 Acc: 0.7990
val Loss: 2.1988 Acc: 0.5227
Epoch 15/81
----------
train Loss: 1.6884 Acc: 0.7608
[32m[I 2025-06-28 19:33:25,620][0m Trial 82 finished with value: 0.8636363636363636 and parameters: {'batch_size': 26, 'lr': 0.001383901789931824, 'num_epochs': 81, 'weight_decay': 0.015561166235935108, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.5699 Acc: 0.6136
Early stopping at epoch 15 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_26_lr_0.001383901789931824_epoch_81_wd_0.015561166235935108_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 0.5865 Acc: 0.4067
val Loss: 0.4130 Acc: 0.6136
Epoch 2/87
----------
train Loss: 0.4718 Acc: 0.5885
val Loss: 0.3474 Acc: 0.6818
Epoch 3/87
----------
train Loss: 0.4245 Acc: 0.6890
val Loss: 0.3051 Acc: 0.7045
Epoch 4/87
----------
train Loss: 0.3985 Acc: 0.6220
val Loss: 0.2754 Acc: 0.7500
Epoch 5/87
----------
train Loss: 0.3683 Acc: 0.7751
val Loss: 0.2964 Acc: 0.7955
Epoch 6/87
----------
train Loss: 0.3452 Acc: 0.7321
val Loss: 0.3013 Acc: 0.7955
Epoch 7/87
----------
train Loss: 0.3090 Acc: 0.8565
val Loss: 0.2843 Acc: 0.7500
Epoch 8/87
----------
train Loss: 0.3446 Acc: 0.8038
val Loss: 0.2561 Acc: 0.7500
Epoch 9/87
----------
train Loss: 0.3381 Acc: 0.7895
val Loss: 0.3234 Acc: 0.7273
Epoch 10/87
----------
train Loss: 0.2258 Acc: 0.9234
val Loss: 0.2272 Acc: 0.8182
Epoch 11/87
----------
train Loss: 0.3395 Acc: 0.7703
val Loss: 0.2414 Acc: 0.7727
Epoch 12/87
----------
train Loss: 0.2870 Acc: 0.8325
val Loss: 0.3433 Acc: 0.7273
Epoch 13/87
----------
train Loss: 0.2783 Acc: 0.8995
val Loss: 0.2909 Acc: 0.6591
Epoch 14/87
----------
train Loss: 0.2570 Acc: 0.8325
val Loss: 0.3544 Acc: 0.6818
Epoch 15/87
----------
train Loss: 0.2916 Acc: 0.8230
val Loss: 0.3888 Acc: 0.6591
Epoch 16/87
----------
train Loss: 0.3073 Acc: 0.7895
val Loss: 0.3734 Acc: 0.6364
Epoch 17/87
----------
train Loss: 0.2918 Acc: 0.8612
val Loss: 0.3098 Acc: 0.6591
Epoch 18/87
----------
train Loss: 0.2646 Acc: 0.8565
val Loss: 0.2917 Acc: 0.7273
Epoch 19/87
----------
train Loss: 0.2399 Acc: 0.9378
val Loss: 0.2770 Acc: 0.8182
Epoch 20/87
----------
train Loss: 0.2792 Acc: 0.8708
val Loss: 0.2640 Acc: 0.7955
Epoch 21/87
----------
train Loss: 0.2873 Acc: 0.9139
val Loss: 0.2814 Acc: 0.7727
Epoch 22/87
----------
train Loss: 0.2700 Acc: 0.8612
val Loss: 0.2771 Acc: 0.7727
Epoch 23/87
----------
train Loss: 0.3029 Acc: 0.8612
val Loss: 0.2662 Acc: 0.7500
Epoch 24/87
----------
train Loss: 0.2243 Acc: 0.9091
val Loss: 0.2742 Acc: 0.7727
Epoch 25/87
----------
train Loss: 0.2550 Acc: 0.9378
val Loss: 0.3098 Acc: 0.7273
Epoch 26/87
----------
train Loss: 0.2849 Acc: 0.9378
val Loss: 0.2951 Acc: 0.7045
Epoch 27/87
----------
train Loss: 0.2406 Acc: 0.9617
val Loss: 0.3157 Acc: 0.7500
Epoch 28/87
----------
train Loss: 0.2823 Acc: 0.8182
val Loss: 0.2926 Acc: 0.7727
Epoch 29/87
----------
train Loss: 0.3060 Acc: 0.7943
val Loss: 0.2931 Acc: 0.7273
Epoch 30/87
----------
train Loss: 0.2748 Acc: 0.8756
val Loss: 0.2709 Acc: 0.7273
Epoch 31/87
----------
train Loss: 0.2199 Acc: 0.9569
val Loss: 0.2603 Acc: 0.7500
Epoch 32/87
----------
train Loss: 0.2456 Acc: 0.9043
val Loss: 0.2711 Acc: 0.7500
Epoch 33/87
----------
train Loss: 0.2762 Acc: 0.8947
val Loss: 0.2692 Acc: 0.7500
Epoch 34/87
----------
train Loss: 0.2620 Acc: 0.9522
val Loss: 0.2726 Acc: 0.7727
Epoch 35/87
----------
train Loss: 0.2168 Acc: 0.9617
val Loss: 0.2937 Acc: 0.7727
Epoch 36/87
----------
train Loss: 0.3144 Acc: 0.8660
val Loss: 0.2826 Acc: 0.7500
Epoch 37/87
----------
train Loss: 0.2812 Acc: 0.8230
val Loss: 0.2992 Acc: 0.7273
Epoch 38/87
----------
train Loss: 0.2783 Acc: 0.9617
val Loss: 0.2765 Acc: 0.7045
Epoch 39/87
----------
train Loss: 0.2721 Acc: 0.8182
val Loss: 0.2957 Acc: 0.7273
Epoch 40/87
----------
train Loss: 0.2429 Acc: 0.9043
val Loss: 0.2917 Acc: 0.7727
Epoch 41/87
----------
train Loss: 0.3150 Acc: 0.7273
val Loss: 0.2809 Acc: 0.7045
Epoch 42/87
----------
train Loss: 0.2440 Acc: 0.8325
val Loss: 0.3073 Acc: 0.6591
Epoch 43/87
----------
train Loss: 0.2620 Acc: 0.8900
val Loss: 0.2817 Acc: 0.7273
Epoch 44/87
----------
train Loss: 0.2550 Acc: 0.8660
val Loss: 0.2764 Acc: 0.7273
Epoch 45/87
----------
train Loss: 0.1577 Acc: 0.9617
val Loss: 0.2832 Acc: 0.7273
Epoch 46/87
----------
train Loss: 0.3559 Acc: 0.8086
val Loss: 0.3135 Acc: 0.7273
Epoch 47/87
----------
train Loss: 0.2586 Acc: 0.8900
val Loss: 0.2849 Acc: 0.7045
Epoch 48/87
----------
train Loss: 0.2716 Acc: 0.8421
val Loss: 0.3383 Acc: 0.6818
Epoch 49/87
----------
train Loss: 0.2706 Acc: 0.9378
val Loss: 0.3188 Acc: 0.6818
Epoch 50/87
----------
train Loss: 0.2700 Acc: 0.8325
val Loss: 0.2936 Acc: 0.7727
Epoch 51/87
----------
train Loss: 0.2027 Acc: 0.9952
val Loss: 0.2785 Acc: 0.7955
Epoch 52/87
----------
train Loss: 0.2657 Acc: 0.8373
val Loss: 0.2770 Acc: 0.7500
Epoch 53/87
----------
train Loss: 0.3139 Acc: 0.8900
val Loss: 0.3402 Acc: 0.6818
Epoch 54/87
----------
train Loss: 0.2322 Acc: 0.9474
val Loss: 0.3365 Acc: 0.7273
Epoch 55/87
----------
train Loss: 0.2503 Acc: 0.9378
val Loss: 0.3853 Acc: 0.5455
Epoch 56/87
----------
train Loss: 0.2911 Acc: 0.9330
val Loss: 0.3257 Acc: 0.6818
Epoch 57/87
----------
train Loss: 0.3218 Acc: 0.8612
val Loss: 0.3061 Acc: 0.6591
Epoch 58/87
----------
train Loss: 0.2588 Acc: 0.8278
val Loss: 0.3755 Acc: 0.6364
Epoch 59/87
----------
train Loss: 0.2702 Acc: 0.8852
val Loss: 0.3733 Acc: 0.6364
Epoch 60/87
----------
train Loss: 0.2214 Acc: 0.9187
val Loss: 0.3153 Acc: 0.7045
Epoch 61/87
----------
train Loss: 0.3083 Acc: 0.7943
val Loss: 0.3203 Acc: 0.7273
Epoch 62/87
----------
train Loss: 0.2930 Acc: 0.9139
val Loss: 0.2985 Acc: 0.6364
Epoch 63/87
----------
train Loss: 0.2560 Acc: 0.9474
val Loss: 0.2878 Acc: 0.7955
Epoch 64/87
----------
train Loss: 0.2252 Acc: 0.9569
val Loss: 0.2768 Acc: 0.7500
Epoch 65/87
----------
train Loss: 0.2601 Acc: 0.8660
val Loss: 0.2840 Acc: 0.7273
Epoch 66/87
----------
train Loss: 0.2639 Acc: 0.9234
val Loss: 0.3559 Acc: 0.7727
Epoch 67/87
----------
train Loss: 0.2932 Acc: 0.8708
val Loss: 0.3000 Acc: 0.7273
Epoch 68/87
----------
train Loss: 0.2478 Acc: 0.9091
val Loss: 0.3032 Acc: 0.6818
Epoch 69/87
----------
train Loss: 0.2343 Acc: 0.8804
val Loss: 0.2743 Acc: 0.7955
Epoch 70/87
----------
train Loss: 0.2691 Acc: 0.9043
val Loss: 0.3459 Acc: 0.6591
Epoch 71/87
----------
train Loss: 0.2848 Acc: 0.9091
val Loss: 0.3026 Acc: 0.6591
Epoch 72/87
----------
train Loss: 0.2839 Acc: 0.8900
val Loss: 0.2954 Acc: 0.8182
Epoch 73/87
----------
train Loss: 0.2037 Acc: 0.9713
val Loss: 0.3542 Acc: 0.6136
Epoch 74/87
----------
train Loss: 0.2914 Acc: 0.8708
val Loss: 0.3142 Acc: 0.6818
Epoch 75/87
----------
train Loss: 0.2211 Acc: 0.9809
val Loss: 0.2943 Acc: 0.7500
Epoch 76/87
----------
train Loss: 0.2277 Acc: 0.8517
val Loss: 0.2827 Acc: 0.7727
Epoch 77/87
----------
train Loss: 0.2929 Acc: 0.8660
val Loss: 0.3348 Acc: 0.7273
Epoch 78/87
----------
train Loss: 0.2664 Acc: 0.8900
val Loss: 0.3565 Acc: 0.6364
Epoch 79/87
----------
train Loss: 0.2911 Acc: 0.9234
val Loss: 0.2904 Acc: 0.7727
Epoch 80/87
----------
train Loss: 0.2661 Acc: 0.8660
val Loss: 0.3813 Acc: 0.6136
Epoch 81/87
----------
train Loss: 0.3056 Acc: 0.7799
val Loss: 0.3488 Acc: 0.5909
Epoch 82/87
----------
train Loss: 0.2689 Acc: 0.8517
val Loss: 0.2930 Acc: 0.7045
Epoch 83/87
----------
train Loss: 0.2369 Acc: 0.9665
val Loss: 0.3441 Acc: 0.7273
Epoch 84/87
----------
train Loss: 0.2908 Acc: 0.8038
val Loss: 0.3426 Acc: 0.7045
Epoch 85/87
----------
train Loss: 0.2359 Acc: 0.9139
val Loss: 0.3022 Acc: 0.7955
Epoch 86/87
----------
train Loss: 0.2500 Acc: 0.8804
val Loss: 0.3049 Acc: 0.7955
Epoch 87/87
----------
train Loss: 0.2788 Acc: 0.9330
[32m[I 2025-06-28 19:53:12,374][0m Trial 83 finished with value: 0.75 and parameters: {'batch_size': 53, 'lr': 0.0009058788574214866, 'num_epochs': 87, 'weight_decay': 0.0006030928017029111, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.2988 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_53_lr_0.0009058788574214866_epoch_87_wd_0.0006030928017029111_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/98
----------
train Loss: 3.7550 Acc: 0.2344
val Loss: 3.5810 Acc: 0.2727
Epoch 2/98
----------
train Loss: 3.5333 Acc: 0.3445
val Loss: 3.4086 Acc: 0.4318
Epoch 3/98
----------
train Loss: 3.3330 Acc: 0.4067
val Loss: 3.1613 Acc: 0.4318
Epoch 4/98
----------
train Loss: 3.1863 Acc: 0.4306
val Loss: 2.9783 Acc: 0.5455
Epoch 5/98
----------
train Loss: 3.0507 Acc: 0.4689
val Loss: 2.8286 Acc: 0.6136
Epoch 6/98
----------
train Loss: 2.8788 Acc: 0.4976
val Loss: 2.6467 Acc: 0.6364
Epoch 7/98
----------
train Loss: 2.7236 Acc: 0.5263
val Loss: 2.4704 Acc: 0.6364
Epoch 8/98
----------
train Loss: 2.6476 Acc: 0.5024
val Loss: 2.3289 Acc: 0.6364
Epoch 9/98
----------
train Loss: 2.5508 Acc: 0.5167
val Loss: 2.2121 Acc: 0.6364
Epoch 10/98
----------
train Loss: 2.3155 Acc: 0.5263
val Loss: 2.1255 Acc: 0.6591
Epoch 11/98
----------
train Loss: 2.3804 Acc: 0.5120
val Loss: 2.0623 Acc: 0.6591
Epoch 12/98
----------
train Loss: 2.3775 Acc: 0.5167
val Loss: 2.0318 Acc: 0.6818
Epoch 13/98
----------
train Loss: 2.1992 Acc: 0.5646
val Loss: 1.9538 Acc: 0.6591
Epoch 14/98
----------
train Loss: 2.1125 Acc: 0.5694
val Loss: 1.9228 Acc: 0.6818
Epoch 15/98
----------
train Loss: 2.1899 Acc: 0.5455
val Loss: 1.8882 Acc: 0.6818
Epoch 16/98
----------
train Loss: 2.1462 Acc: 0.5789
val Loss: 1.8507 Acc: 0.6818
Epoch 17/98
----------
train Loss: 2.0714 Acc: 0.5885
val Loss: 1.8165 Acc: 0.6818
Epoch 18/98
----------
train Loss: 1.9907 Acc: 0.6316
val Loss: 1.7621 Acc: 0.7045
Epoch 19/98
----------
train Loss: 1.9332 Acc: 0.6507
val Loss: 1.7387 Acc: 0.7045
Epoch 20/98
----------
train Loss: 1.9539 Acc: 0.6411
val Loss: 1.6998 Acc: 0.7045
Epoch 21/98
----------
train Loss: 1.9782 Acc: 0.6603
val Loss: 1.6629 Acc: 0.7273
Epoch 22/98
----------
train Loss: 1.9170 Acc: 0.6651
val Loss: 1.6282 Acc: 0.7500
Epoch 23/98
----------
train Loss: 1.8993 Acc: 0.6890
val Loss: 1.5763 Acc: 0.7500
Epoch 24/98
----------
train Loss: 1.6726 Acc: 0.7464
val Loss: 1.5152 Acc: 0.7727
Epoch 25/98
----------
train Loss: 1.7959 Acc: 0.7081
val Loss: 1.5221 Acc: 0.8409
Epoch 26/98
----------
train Loss: 1.8272 Acc: 0.7416
val Loss: 1.5298 Acc: 0.8409
Epoch 27/98
----------
train Loss: 1.5875 Acc: 0.8325
val Loss: 1.5170 Acc: 0.8182
Epoch 28/98
----------
train Loss: 1.8007 Acc: 0.7225
val Loss: 1.4974 Acc: 0.8182
Epoch 29/98
----------
train Loss: 1.8492 Acc: 0.6507
val Loss: 1.4772 Acc: 0.8182
Epoch 30/98
----------
train Loss: 1.6885 Acc: 0.7512
val Loss: 1.4735 Acc: 0.8182
Epoch 31/98
----------
train Loss: 1.5017 Acc: 0.8517
val Loss: 1.4371 Acc: 0.8182
Epoch 32/98
----------
train Loss: 1.6570 Acc: 0.7512
val Loss: 1.3991 Acc: 0.8182
Epoch 33/98
----------
train Loss: 1.6781 Acc: 0.7943
val Loss: 1.3988 Acc: 0.7955
Epoch 34/98
----------
train Loss: 1.5805 Acc: 0.8517
val Loss: 1.4003 Acc: 0.7955
Epoch 35/98
----------
train Loss: 1.2977 Acc: 0.9330
val Loss: 1.3905 Acc: 0.8182
Epoch 36/98
----------
train Loss: 1.7646 Acc: 0.7560
val Loss: 1.3839 Acc: 0.7955
Epoch 37/98
----------
train Loss: 1.4583 Acc: 0.8086
val Loss: 1.3877 Acc: 0.8409
Epoch 38/98
----------
train Loss: 1.4910 Acc: 0.9187
val Loss: 1.3610 Acc: 0.8409
Epoch 39/98
----------
train Loss: 1.6323 Acc: 0.6986
val Loss: 1.4096 Acc: 0.8409
Epoch 40/98
----------
train Loss: 1.3330 Acc: 0.8660
val Loss: 1.4220 Acc: 0.8182
Epoch 41/98
----------
train Loss: 1.7714 Acc: 0.7177
val Loss: 1.3969 Acc: 0.8182
Epoch 42/98
----------
train Loss: 1.3485 Acc: 0.8421
val Loss: 1.3725 Acc: 0.8182
Epoch 43/98
----------
train Loss: 1.4682 Acc: 0.8373
val Loss: 1.3630 Acc: 0.8182
Epoch 44/98
----------
train Loss: 1.3382 Acc: 0.8469
val Loss: 1.3450 Acc: 0.8182
Epoch 45/98
----------
train Loss: 0.8930 Acc: 0.9713
val Loss: 1.3338 Acc: 0.7955
Epoch 46/98
----------
train Loss: 1.7460 Acc: 0.7990
val Loss: 1.3515 Acc: 0.8409
Epoch 47/98
----------
train Loss: 1.3326 Acc: 0.8660
val Loss: 1.3343 Acc: 0.7955
Epoch 48/98
----------
train Loss: 1.4282 Acc: 0.8182
val Loss: 1.3266 Acc: 0.7955
Epoch 49/98
----------
train Loss: 1.3641 Acc: 0.9091
val Loss: 1.3283 Acc: 0.7955
Epoch 50/98
----------
train Loss: 1.3552 Acc: 0.8708
val Loss: 1.3692 Acc: 0.7727
Epoch 51/98
----------
train Loss: 1.0053 Acc: 0.9809
val Loss: 1.3232 Acc: 0.7727
Epoch 52/98
----------
train Loss: 1.4282 Acc: 0.8086
val Loss: 1.3132 Acc: 0.7727
Epoch 53/98
----------
train Loss: 1.5962 Acc: 0.8947
val Loss: 1.3040 Acc: 0.8182
Epoch 54/98
----------
train Loss: 1.2144 Acc: 0.9234
val Loss: 1.2956 Acc: 0.7955
Epoch 55/98
----------
train Loss: 1.2670 Acc: 0.9234
val Loss: 1.2859 Acc: 0.7955
Epoch 56/98
----------
train Loss: 1.4449 Acc: 0.8995
val Loss: 1.2996 Acc: 0.7727
Epoch 57/98
----------
train Loss: 1.6478 Acc: 0.7799
val Loss: 1.2708 Acc: 0.8182
Epoch 58/98
----------
train Loss: 1.3773 Acc: 0.7990
val Loss: 1.2655 Acc: 0.7955
Epoch 59/98
----------
train Loss: 1.3986 Acc: 0.8660
val Loss: 1.2770 Acc: 0.7727
Epoch 60/98
----------
train Loss: 1.1465 Acc: 0.8804
val Loss: 1.2870 Acc: 0.7955
Epoch 61/98
----------
train Loss: 1.5956 Acc: 0.7464
val Loss: 1.3239 Acc: 0.7955
Epoch 62/98
----------
train Loss: 1.4359 Acc: 0.9282
val Loss: 1.3158 Acc: 0.7955
Epoch 63/98
----------
train Loss: 1.2505 Acc: 0.9378
val Loss: 1.3144 Acc: 0.8182
Epoch 64/98
----------
train Loss: 1.1618 Acc: 0.9426
val Loss: 1.3055 Acc: 0.8182
Epoch 65/98
----------
train Loss: 1.3560 Acc: 0.8086
val Loss: 1.3259 Acc: 0.7727
Epoch 66/98
----------
train Loss: 1.2920 Acc: 0.8852
val Loss: 1.3093 Acc: 0.8182
Epoch 67/98
----------
train Loss: 1.4793 Acc: 0.8708
val Loss: 1.2954 Acc: 0.7955
Epoch 68/98
----------
train Loss: 1.1984 Acc: 0.8995
val Loss: 1.2962 Acc: 0.7955
Epoch 69/98
----------
train Loss: 1.1977 Acc: 0.8947
val Loss: 1.2865 Acc: 0.8409
Epoch 70/98
----------
train Loss: 1.3602 Acc: 0.8852
val Loss: 1.2750 Acc: 0.8409
Epoch 71/98
----------
train Loss: 1.4599 Acc: 0.8995
val Loss: 1.2993 Acc: 0.7727
Epoch 72/98
----------
train Loss: 1.4536 Acc: 0.8804
val Loss: 1.3500 Acc: 0.7955
Epoch 73/98
----------
train Loss: 1.0380 Acc: 0.9569
val Loss: 1.3463 Acc: 0.7955
Epoch 74/98
----------
train Loss: 1.5014 Acc: 0.8325
val Loss: 1.3062 Acc: 0.7727
Epoch 75/98
----------
train Loss: 1.1300 Acc: 0.9378
val Loss: 1.2804 Acc: 0.7955
Epoch 76/98
----------
train Loss: 1.2210 Acc: 0.8086
val Loss: 1.2869 Acc: 0.7727
Epoch 77/98
----------
train Loss: 1.3793 Acc: 0.8325
val Loss: 1.2902 Acc: 0.7955
Epoch 78/98
----------
train Loss: 1.2344 Acc: 0.8804
val Loss: 1.2947 Acc: 0.8409
Epoch 79/98
----------
train Loss: 1.4611 Acc: 0.8565
val Loss: 1.3007 Acc: 0.8636
Epoch 80/98
----------
train Loss: 1.3199 Acc: 0.8421
val Loss: 1.3081 Acc: 0.8636
Epoch 81/98
----------
train Loss: 1.5067 Acc: 0.7943
val Loss: 1.3554 Acc: 0.8182
Epoch 82/98
----------
train Loss: 1.2659 Acc: 0.8421
val Loss: 1.3574 Acc: 0.8409
Epoch 83/98
----------
train Loss: 1.1361 Acc: 0.9617
val Loss: 1.3298 Acc: 0.7955
Epoch 84/98
----------
train Loss: 1.4891 Acc: 0.7703
val Loss: 1.3277 Acc: 0.8182
Epoch 85/98
----------
train Loss: 1.1749 Acc: 0.8230
val Loss: 1.3406 Acc: 0.8409
Epoch 86/98
----------
train Loss: 1.2140 Acc: 0.8756
val Loss: 1.3050 Acc: 0.8409
Epoch 87/98
----------
train Loss: 1.3622 Acc: 0.9282
val Loss: 1.2617 Acc: 0.8182
Epoch 88/98
----------
train Loss: 1.4572 Acc: 0.9187
val Loss: 1.2659 Acc: 0.8182
Epoch 89/98
----------
train Loss: 1.5980 Acc: 0.7895
val Loss: 1.2780 Acc: 0.7955
Epoch 90/98
----------
train Loss: 1.3431 Acc: 0.8660
val Loss: 1.2681 Acc: 0.8409
Epoch 91/98
----------
train Loss: 1.1435 Acc: 0.9474
val Loss: 1.2751 Acc: 0.8182
Epoch 92/98
----------
train Loss: 1.2627 Acc: 0.9330
val Loss: 1.2738 Acc: 0.8182
Epoch 93/98
----------
train Loss: 1.3503 Acc: 0.8565
val Loss: 1.2352 Acc: 0.8182
Epoch 94/98
----------
train Loss: 1.0454 Acc: 0.9809
val Loss: 1.2441 Acc: 0.8409
Epoch 95/98
----------
train Loss: 1.2269 Acc: 0.9234
val Loss: 1.2454 Acc: 0.8409
Epoch 96/98
----------
train Loss: 0.9239 Acc: 0.9904
val Loss: 1.2675 Acc: 0.8636
Epoch 97/98
----------
train Loss: 1.1272 Acc: 0.9378
val Loss: 1.2718 Acc: 0.8636
Epoch 98/98
----------
train Loss: 1.2517 Acc: 0.9139
[32m[I 2025-06-28 20:15:29,693][0m Trial 84 finished with value: 0.8409090909090909 and parameters: {'batch_size': 14, 'lr': 6.832259907690443e-05, 'num_epochs': 98, 'weight_decay': 0.008364484202371437, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.2773 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_14_lr_6.832259907690443e-05_epoch_98_wd_0.008364484202371437_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 3.4312 Acc: 0.3636
val Loss: 3.1417 Acc: 0.5909
Epoch 2/83
----------
train Loss: 2.7107 Acc: 0.5120
val Loss: 2.3639 Acc: 0.6364
Epoch 3/83
----------
train Loss: 2.3722 Acc: 0.5024
val Loss: 2.0799 Acc: 0.6364
Epoch 4/83
----------
train Loss: 2.2620 Acc: 0.5024
val Loss: 2.0812 Acc: 0.7045
Epoch 5/83
----------
train Loss: 2.1952 Acc: 0.5742
val Loss: 2.0804 Acc: 0.7727
Epoch 6/83
----------
train Loss: 2.0390 Acc: 0.5837
val Loss: 2.0773 Acc: 0.7955
Epoch 7/83
----------
train Loss: 1.8992 Acc: 0.6794
val Loss: 2.0464 Acc: 0.7955
Epoch 8/83
----------
train Loss: 1.9410 Acc: 0.6986
val Loss: 1.7833 Acc: 0.8182
Epoch 9/83
----------
train Loss: 1.8660 Acc: 0.7273
val Loss: 1.8655 Acc: 0.7500
Epoch 10/83
----------
train Loss: 1.3165 Acc: 0.9282
val Loss: 1.5884 Acc: 0.7955
Epoch 11/83
----------
train Loss: 1.7051 Acc: 0.7703
val Loss: 1.3449 Acc: 0.8636
Epoch 12/83
----------
train Loss: 1.5891 Acc: 0.7464
val Loss: 1.6397 Acc: 0.7955
Epoch 13/83
----------
train Loss: 1.3855 Acc: 0.8804
val Loss: 1.5190 Acc: 0.7727
Epoch 14/83
----------
train Loss: 1.2816 Acc: 0.8278
val Loss: 1.6107 Acc: 0.7273
Epoch 15/83
----------
train Loss: 1.4933 Acc: 0.8038
val Loss: 1.4411 Acc: 0.7727
Epoch 16/83
----------
train Loss: 1.5149 Acc: 0.8038
[32m[I 2025-06-28 20:19:09,084][0m Trial 85 finished with value: 0.8636363636363636 and parameters: {'batch_size': 88, 'lr': 0.00044179299842116865, 'num_epochs': 83, 'weight_decay': 0.03372633054828703, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 1.7315 Acc: 0.7727
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_88_lr_0.00044179299842116865_epoch_83_wd_0.03372633054828703_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/25
----------
train Loss: 0.6684 Acc: 0.2967
val Loss: 0.6384 Acc: 0.4545
Epoch 2/25
----------
train Loss: 0.5958 Acc: 0.4689
val Loss: 0.6008 Acc: 0.5682
Epoch 3/25
----------
train Loss: 0.5538 Acc: 0.4833
val Loss: 0.5610 Acc: 0.5909
Epoch 4/25
----------
train Loss: 0.5301 Acc: 0.4976
val Loss: 0.5457 Acc: 0.6136
Epoch 5/25
----------
train Loss: 0.5188 Acc: 0.4976
val Loss: 0.5397 Acc: 0.6364
Epoch 6/25
----------
train Loss: 0.5078 Acc: 0.5072
val Loss: 0.5212 Acc: 0.6364
Epoch 7/25
----------
train Loss: 0.4906 Acc: 0.4976
val Loss: 0.4959 Acc: 0.6591
Epoch 8/25
----------
train Loss: 0.4934 Acc: 0.5024
val Loss: 0.4782 Acc: 0.6364
Epoch 9/25
----------
train Loss: 0.4869 Acc: 0.5024
val Loss: 0.4701 Acc: 0.6591
Epoch 10/25
----------
train Loss: 0.4546 Acc: 0.5024
val Loss: 0.4662 Acc: 0.6818
Epoch 11/25
----------
train Loss: 0.4645 Acc: 0.5120
val Loss: 0.4574 Acc: 0.6591
Epoch 12/25
----------
train Loss: 0.4671 Acc: 0.5072
val Loss: 0.4742 Acc: 0.6364
Epoch 13/25
----------
train Loss: 0.4459 Acc: 0.5502
val Loss: 0.4232 Acc: 0.6818
Epoch 14/25
----------
train Loss: 0.4233 Acc: 0.5742
val Loss: 0.4103 Acc: 0.6818
Epoch 15/25
----------
train Loss: 0.4386 Acc: 0.5407
val Loss: 0.4194 Acc: 0.6591
Epoch 16/25
----------
train Loss: 0.4332 Acc: 0.5789
val Loss: 0.4208 Acc: 0.6818
Epoch 17/25
----------
train Loss: 0.4222 Acc: 0.5837
val Loss: 0.4403 Acc: 0.7273
Epoch 18/25
----------
train Loss: 0.4053 Acc: 0.6794
val Loss: 0.4378 Acc: 0.6818
Epoch 19/25
----------
train Loss: 0.3914 Acc: 0.7081
val Loss: 0.4026 Acc: 0.7045
Epoch 20/25
----------
train Loss: 0.3999 Acc: 0.6890
val Loss: 0.3556 Acc: 0.7273
Epoch 21/25
----------
train Loss: 0.3923 Acc: 0.6746
val Loss: 0.3585 Acc: 0.6818
Epoch 22/25
----------
train Loss: 0.3912 Acc: 0.6746
val Loss: 0.3858 Acc: 0.6818
Epoch 23/25
----------
train Loss: 0.3857 Acc: 0.7081
val Loss: 0.3958 Acc: 0.6818
Epoch 24/25
----------
train Loss: 0.3570 Acc: 0.7464
val Loss: 0.3684 Acc: 0.7045
Epoch 25/25
----------
train Loss: 0.3684 Acc: 0.7368
[32m[I 2025-06-28 20:24:50,618][0m Trial 86 finished with value: 0.75 and parameters: {'batch_size': 93, 'lr': 0.0002903217674261881, 'num_epochs': 25, 'weight_decay': 0.06322433537052105, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 0.4308 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_93_lr_0.0002903217674261881_epoch_25_wd_0.06322433537052105_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/94
----------
train Loss: 5.4680 Acc: 0.3732
val Loss: 5.7632 Acc: 0.6591
Epoch 2/94
----------
train Loss: 3.4587 Acc: 0.6746
val Loss: 4.8482 Acc: 0.6364
Epoch 3/94
----------
train Loss: 3.1468 Acc: 0.7273
val Loss: 4.6490 Acc: 0.2955
Epoch 4/94
----------
train Loss: 3.5766 Acc: 0.6411
val Loss: 3.7325 Acc: 0.5000
Epoch 5/94
----------
train Loss: 3.0630 Acc: 0.6794
val Loss: 5.0392 Acc: 0.3864
Epoch 6/94
----------
train Loss: 2.7918 Acc: 0.7464
val Loss: 4.4079 Acc: 0.6364
Epoch 7/94
----------
train Loss: 2.9014 Acc: 0.6986
val Loss: 4.8505 Acc: 0.7045
Epoch 8/94
----------
train Loss: 1.8993 Acc: 0.8086
val Loss: 4.0106 Acc: 0.7045
Epoch 9/94
----------
train Loss: 1.6856 Acc: 0.8947
val Loss: 3.8098 Acc: 0.6591
Epoch 10/94
----------
train Loss: 2.4667 Acc: 0.7751
val Loss: 4.4962 Acc: 0.7727
Epoch 11/94
----------
train Loss: 2.4713 Acc: 0.7895
val Loss: 6.1074 Acc: 0.5682
Epoch 12/94
----------
train Loss: 1.8515 Acc: 0.8086
val Loss: 5.7512 Acc: 0.6364
Epoch 13/94
----------
train Loss: 1.8695 Acc: 0.8565
val Loss: 7.6842 Acc: 0.6364
Epoch 14/94
----------
train Loss: 2.5547 Acc: 0.7990
val Loss: 4.4206 Acc: 0.6818
Epoch 15/94
----------
train Loss: 2.3276 Acc: 0.8038
[32m[I 2025-06-28 20:28:15,548][0m Trial 87 finished with value: 0.7727272727272727 and parameters: {'batch_size': 73, 'lr': 0.002826869276563211, 'num_epochs': 94, 'weight_decay': 0.0374617967474813, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 4.4257 Acc: 0.7045
Early stopping at epoch 15 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_73_lr_0.002826869276563211_epoch_94_wd_0.0374617967474813_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 2.9118 Acc: 0.4258
val Loss: 2.0688 Acc: 0.6364
Epoch 2/81
----------
train Loss: 2.4181 Acc: 0.5789
val Loss: 4.6318 Acc: 0.2273
Epoch 3/81
----------
train Loss: 2.0876 Acc: 0.6938
val Loss: 2.9590 Acc: 0.5682
Epoch 4/81
----------
train Loss: 2.1320 Acc: 0.6411
val Loss: 3.1487 Acc: 0.7045
Epoch 5/81
----------
train Loss: 1.8357 Acc: 0.7799
val Loss: 3.8177 Acc: 0.5000
Epoch 6/81
----------
train Loss: 1.7967 Acc: 0.6986
val Loss: 3.1960 Acc: 0.6818
Epoch 7/81
----------
train Loss: 1.7282 Acc: 0.7799
val Loss: 4.0524 Acc: 0.6818
Epoch 8/81
----------
train Loss: 1.9283 Acc: 0.6938
val Loss: 4.3844 Acc: 0.5682
Epoch 9/81
----------
train Loss: 1.9016 Acc: 0.7225
val Loss: 4.9150 Acc: 0.5227
Epoch 10/81
----------
train Loss: 1.2582 Acc: 0.9234
val Loss: 3.1963 Acc: 0.5909
Epoch 11/81
----------
train Loss: 2.0858 Acc: 0.7081
val Loss: 2.8153 Acc: 0.7727
Epoch 12/81
----------
train Loss: 1.8917 Acc: 0.6077
val Loss: 2.2806 Acc: 0.6818
Epoch 13/81
----------
train Loss: 1.7309 Acc: 0.8086
val Loss: 1.6330 Acc: 0.7045
Epoch 14/81
----------
train Loss: 1.6188 Acc: 0.7225
val Loss: 1.7565 Acc: 0.6818
Epoch 15/81
----------
train Loss: 1.8251 Acc: 0.7273
val Loss: 3.2467 Acc: 0.2500
Epoch 16/81
----------
train Loss: 1.7832 Acc: 0.7560
[32m[I 2025-06-28 20:31:54,953][0m Trial 88 finished with value: 0.7727272727272727 and parameters: {'batch_size': 19, 'lr': 0.0015500143879412778, 'num_epochs': 81, 'weight_decay': 0.019016720412525414, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.8636363636363636.[0m
val Loss: 2.5859 Acc: 0.5455
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_19_lr_0.0015500143879412778_epoch_81_wd_0.019016720412525414_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.4125 Acc: 0.3541
val Loss: 3.0099 Acc: 0.6136
Epoch 2/78
----------
train Loss: 2.6517 Acc: 0.5215
val Loss: 2.0981 Acc: 0.6364
Epoch 3/78
----------
train Loss: 2.3012 Acc: 0.5120
val Loss: 1.8908 Acc: 0.6364
Epoch 4/78
----------
train Loss: 2.1931 Acc: 0.5167
val Loss: 1.8430 Acc: 0.7045
Epoch 5/78
----------
train Loss: 2.1189 Acc: 0.6364
val Loss: 1.7608 Acc: 0.7955
Epoch 6/78
----------
train Loss: 1.9381 Acc: 0.6507
val Loss: 1.6631 Acc: 0.7955
Epoch 7/78
----------
train Loss: 1.7631 Acc: 0.7560
val Loss: 1.5520 Acc: 0.8182
Epoch 8/78
----------
train Loss: 1.8273 Acc: 0.7321
val Loss: 1.4309 Acc: 0.7955
Epoch 9/78
----------
train Loss: 1.7620 Acc: 0.7512
val Loss: 1.5639 Acc: 0.7500
Epoch 10/78
----------
train Loss: 1.1515 Acc: 0.9378
val Loss: 1.3199 Acc: 0.7955
Epoch 11/78
----------
train Loss: 1.7016 Acc: 0.7799
val Loss: 1.1641 Acc: 0.8864
Epoch 12/78
----------
train Loss: 1.5227 Acc: 0.7464
val Loss: 1.6749 Acc: 0.7955
Epoch 13/78
----------
train Loss: 1.3324 Acc: 0.8947
val Loss: 1.5414 Acc: 0.7727
Epoch 14/78
----------
train Loss: 1.2548 Acc: 0.8469
val Loss: 1.4550 Acc: 0.7273
Epoch 15/78
----------
train Loss: 1.4017 Acc: 0.8182
val Loss: 1.1517 Acc: 0.7955
Epoch 16/78
----------
train Loss: 1.4940 Acc: 0.8086
val Loss: 1.3763 Acc: 0.8409
Epoch 17/78
----------
train Loss: 1.4248 Acc: 0.8612
val Loss: 1.4291 Acc: 0.8636
Epoch 18/78
----------
train Loss: 1.3475 Acc: 0.8373
val Loss: 1.3436 Acc: 0.8182
Epoch 19/78
----------
train Loss: 1.2123 Acc: 0.9474
val Loss: 1.2693 Acc: 0.7727
Epoch 20/78
----------
train Loss: 1.3494 Acc: 0.8804
val Loss: 1.1969 Acc: 0.7500
Epoch 21/78
----------
train Loss: 1.4309 Acc: 0.8660
val Loss: 1.1373 Acc: 0.8182
Epoch 22/78
----------
train Loss: 1.2532 Acc: 0.8995
val Loss: 1.2756 Acc: 0.8182
Epoch 23/78
----------
train Loss: 1.4794 Acc: 0.8612
val Loss: 1.2559 Acc: 0.7955
Epoch 24/78
----------
train Loss: 1.1162 Acc: 0.9091
val Loss: 1.1506 Acc: 0.8182
Epoch 25/78
----------
train Loss: 1.2734 Acc: 0.9330
val Loss: 1.3560 Acc: 0.7727
Epoch 26/78
----------
train Loss: 1.4553 Acc: 0.9426
val Loss: 1.3565 Acc: 0.7727
Epoch 27/78
----------
train Loss: 1.1734 Acc: 0.9617
val Loss: 1.4744 Acc: 0.7500
Epoch 28/78
----------
train Loss: 1.3749 Acc: 0.8565
val Loss: 1.2282 Acc: 0.7727
Epoch 29/78
----------
train Loss: 1.5160 Acc: 0.7990
val Loss: 1.2901 Acc: 0.8409
Epoch 30/78
----------
train Loss: 1.3059 Acc: 0.8708
val Loss: 1.0520 Acc: 0.8864
Epoch 31/78
----------
train Loss: 1.1344 Acc: 0.9378
val Loss: 1.0930 Acc: 0.7955
Epoch 32/78
----------
train Loss: 1.2482 Acc: 0.8995
val Loss: 1.1946 Acc: 0.7955
Epoch 33/78
----------
train Loss: 1.3898 Acc: 0.8804
val Loss: 1.3389 Acc: 0.8182
Epoch 34/78
----------
train Loss: 1.3313 Acc: 0.9426
val Loss: 1.3595 Acc: 0.7500
Epoch 35/78
----------
train Loss: 1.0137 Acc: 0.9761
[32m[I 2025-06-28 20:39:51,697][0m Trial 89 finished with value: 0.8863636363636364 and parameters: {'batch_size': 79, 'lr': 0.000422832210953983, 'num_epochs': 78, 'weight_decay': 0.01605540302060581, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2645 Acc: 0.7273
Early stopping at epoch 35 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_79_lr_0.000422832210953983_epoch_78_wd_0.01605540302060581_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.4086 Acc: 0.3541
val Loss: 3.0009 Acc: 0.6136
Epoch 2/78
----------
train Loss: 2.6443 Acc: 0.5263
val Loss: 2.0864 Acc: 0.6364
Epoch 3/78
----------
train Loss: 2.2960 Acc: 0.5120
val Loss: 1.8862 Acc: 0.6364
Epoch 4/78
----------
train Loss: 2.1885 Acc: 0.5167
val Loss: 1.8394 Acc: 0.7045
Epoch 5/78
----------
train Loss: 2.1139 Acc: 0.6364
val Loss: 1.7538 Acc: 0.7955
Epoch 6/78
----------
train Loss: 1.9321 Acc: 0.6507
val Loss: 1.6527 Acc: 0.7955
Epoch 7/78
----------
train Loss: 1.7543 Acc: 0.7608
val Loss: 1.5383 Acc: 0.8182
Epoch 8/78
----------
train Loss: 1.8188 Acc: 0.7368
val Loss: 1.4186 Acc: 0.7955
Epoch 9/78
----------
train Loss: 1.7558 Acc: 0.7512
val Loss: 1.5949 Acc: 0.7500
Epoch 10/78
----------
train Loss: 1.1434 Acc: 0.9474
val Loss: 1.3086 Acc: 0.7955
Epoch 11/78
----------
train Loss: 1.7059 Acc: 0.7751
val Loss: 1.1721 Acc: 0.8636
Epoch 12/78
----------
train Loss: 1.5228 Acc: 0.7608
val Loss: 1.7079 Acc: 0.8182
Epoch 13/78
----------
train Loss: 1.3326 Acc: 0.8995
val Loss: 1.5460 Acc: 0.7500
Epoch 14/78
----------
train Loss: 1.2469 Acc: 0.8373
val Loss: 1.4685 Acc: 0.7273
Epoch 15/78
----------
train Loss: 1.3918 Acc: 0.8134
val Loss: 1.1505 Acc: 0.7955
Epoch 16/78
----------
train Loss: 1.4948 Acc: 0.7895
val Loss: 1.3681 Acc: 0.8409
Epoch 17/78
----------
train Loss: 1.4248 Acc: 0.8756
val Loss: 1.4559 Acc: 0.8636
Epoch 18/78
----------
train Loss: 1.3552 Acc: 0.8373
val Loss: 1.3751 Acc: 0.7955
Epoch 19/78
----------
train Loss: 1.2188 Acc: 0.9426
val Loss: 1.3200 Acc: 0.7727
Epoch 20/78
----------
train Loss: 1.3516 Acc: 0.8660
val Loss: 1.2000 Acc: 0.7727
Epoch 21/78
----------
train Loss: 1.4285 Acc: 0.8565
val Loss: 1.1488 Acc: 0.8182
Epoch 22/78
----------
train Loss: 1.2517 Acc: 0.8947
val Loss: 1.2678 Acc: 0.8182
Epoch 23/78
----------
train Loss: 1.4828 Acc: 0.8612
val Loss: 1.2326 Acc: 0.7955
Epoch 24/78
----------
train Loss: 1.1193 Acc: 0.9187
val Loss: 1.1452 Acc: 0.7955
Epoch 25/78
----------
train Loss: 1.2752 Acc: 0.9282
val Loss: 1.3898 Acc: 0.7727
Epoch 26/78
----------
train Loss: 1.4643 Acc: 0.9378
val Loss: 1.2996 Acc: 0.7727
Epoch 27/78
----------
train Loss: 1.1776 Acc: 0.9665
val Loss: 1.3736 Acc: 0.7727
Epoch 28/78
----------
train Loss: 1.3712 Acc: 0.8517
val Loss: 1.1832 Acc: 0.7727
Epoch 29/78
----------
train Loss: 1.4877 Acc: 0.8086
val Loss: 1.2425 Acc: 0.8182
Epoch 30/78
----------
train Loss: 1.2958 Acc: 0.8852
val Loss: 1.0438 Acc: 0.8636
Epoch 31/78
----------
train Loss: 1.1253 Acc: 0.9330
val Loss: 1.0904 Acc: 0.8409
Epoch 32/78
----------
train Loss: 1.2443 Acc: 0.8995
val Loss: 1.2360 Acc: 0.7955
Epoch 33/78
----------
train Loss: 1.3946 Acc: 0.8708
val Loss: 1.3676 Acc: 0.7500
Epoch 34/78
----------
train Loss: 1.3473 Acc: 0.9330
val Loss: 1.3891 Acc: 0.7045
Epoch 35/78
----------
train Loss: 1.0244 Acc: 0.9617
val Loss: 1.4082 Acc: 0.7273
Epoch 36/78
----------
train Loss: 1.5935 Acc: 0.8565
val Loss: 1.3637 Acc: 0.7273
Epoch 37/78
----------
train Loss: 1.3591 Acc: 0.8086
val Loss: 1.3752 Acc: 0.7500
Epoch 38/78
----------
train Loss: 1.4109 Acc: 0.9330
val Loss: 1.2361 Acc: 0.7955
Epoch 39/78
----------
train Loss: 1.4042 Acc: 0.7799
val Loss: 1.5436 Acc: 0.7273
Epoch 40/78
----------
train Loss: 1.1996 Acc: 0.8995
val Loss: 1.3399 Acc: 0.7273
Epoch 41/78
----------
train Loss: 1.6043 Acc: 0.6842
val Loss: 1.3845 Acc: 0.7500
Epoch 42/78
----------
train Loss: 1.2268 Acc: 0.8565
val Loss: 1.4914 Acc: 0.7045
Epoch 43/78
----------
train Loss: 1.2860 Acc: 0.8995
val Loss: 1.4042 Acc: 0.7727
Epoch 44/78
----------
train Loss: 1.2595 Acc: 0.8660
val Loss: 1.4545 Acc: 0.7273
Epoch 45/78
----------
train Loss: 0.8034 Acc: 0.9569
val Loss: 1.3130 Acc: 0.7500
Epoch 46/78
----------
train Loss: 1.6830 Acc: 0.8134
val Loss: 1.6399 Acc: 0.7500
Epoch 47/78
----------
train Loss: 1.2669 Acc: 0.8900
val Loss: 1.6696 Acc: 0.6818
Epoch 48/78
----------
train Loss: 1.3689 Acc: 0.8421
val Loss: 1.7079 Acc: 0.7500
Epoch 49/78
----------
train Loss: 1.3048 Acc: 0.9330
val Loss: 1.4226 Acc: 0.7727
Epoch 50/78
----------
train Loss: 1.3308 Acc: 0.8565
val Loss: 1.1232 Acc: 0.7955
Epoch 51/78
----------
train Loss: 0.9825 Acc: 0.9809
val Loss: 1.2969 Acc: 0.8636
Epoch 52/78
----------
train Loss: 1.3247 Acc: 0.8230
val Loss: 1.3013 Acc: 0.7500
Epoch 53/78
----------
train Loss: 1.5314 Acc: 0.9091
val Loss: 1.4800 Acc: 0.7500
Epoch 54/78
----------
train Loss: 1.2237 Acc: 0.9378
val Loss: 1.3195 Acc: 0.7273
Epoch 55/78
----------
train Loss: 1.2434 Acc: 0.9474
val Loss: 1.5027 Acc: 0.7273
Epoch 56/78
----------
train Loss: 1.4120 Acc: 0.9234
[32m[I 2025-06-28 20:52:34,156][0m Trial 90 finished with value: 0.8636363636363636 and parameters: {'batch_size': 25, 'lr': 0.0004262667128412041, 'num_epochs': 78, 'weight_decay': 0.015671083445537387, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5561 Acc: 0.7727
Early stopping at epoch 56 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_25_lr_0.0004262667128412041_epoch_78_wd_0.015671083445537387_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/74
----------
train Loss: 3.4184 Acc: 0.3541
val Loss: 3.0216 Acc: 0.6136
Epoch 2/74
----------
train Loss: 2.6624 Acc: 0.5263
val Loss: 2.1114 Acc: 0.6364
Epoch 3/74
----------
train Loss: 2.3072 Acc: 0.5072
val Loss: 1.8928 Acc: 0.6364
Epoch 4/74
----------
train Loss: 2.1976 Acc: 0.5167
val Loss: 1.8414 Acc: 0.7045
Epoch 5/74
----------
train Loss: 2.1240 Acc: 0.6364
val Loss: 1.7606 Acc: 0.7955
Epoch 6/74
----------
train Loss: 1.9435 Acc: 0.6507
val Loss: 1.6666 Acc: 0.7955
Epoch 7/74
----------
train Loss: 1.7716 Acc: 0.7464
val Loss: 1.5620 Acc: 0.8182
Epoch 8/74
----------
train Loss: 1.8373 Acc: 0.7273
val Loss: 1.4131 Acc: 0.7955
Epoch 9/74
----------
train Loss: 1.7738 Acc: 0.7512
val Loss: 1.5829 Acc: 0.7500
Epoch 10/74
----------
train Loss: 1.1640 Acc: 0.9378
val Loss: 1.3265 Acc: 0.7955
Epoch 11/74
----------
train Loss: 1.6917 Acc: 0.7751
val Loss: 1.1556 Acc: 0.8864
Epoch 12/74
----------
train Loss: 1.5246 Acc: 0.7464
val Loss: 1.5986 Acc: 0.8182
Epoch 13/74
----------
train Loss: 1.3373 Acc: 0.8947
val Loss: 1.5158 Acc: 0.7727
Epoch 14/74
----------
train Loss: 1.2534 Acc: 0.8373
val Loss: 1.4358 Acc: 0.7273
Epoch 15/74
----------
train Loss: 1.3990 Acc: 0.8230
val Loss: 1.1432 Acc: 0.7955
Epoch 16/74
----------
train Loss: 1.4945 Acc: 0.7990
[32m[I 2025-06-28 20:56:11,268][0m Trial 91 finished with value: 0.8863636363636364 and parameters: {'batch_size': 80, 'lr': 0.00041575202083353984, 'num_epochs': 74, 'weight_decay': 0.016027919722942218, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3915 Acc: 0.8182
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_80_lr_0.00041575202083353984_epoch_74_wd_0.016027919722942218_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/74
----------
train Loss: 3.8047 Acc: 0.2297
val Loss: 3.6628 Acc: 0.2500
Epoch 2/74
----------
train Loss: 3.7000 Acc: 0.2584
val Loss: 3.5971 Acc: 0.2500
Epoch 3/74
----------
train Loss: 3.6008 Acc: 0.2919
val Loss: 3.4809 Acc: 0.2500
Epoch 4/74
----------
train Loss: 3.5412 Acc: 0.3014
val Loss: 3.4217 Acc: 0.3636
Epoch 5/74
----------
train Loss: 3.4865 Acc: 0.3206
val Loss: 3.3822 Acc: 0.3864
Epoch 6/74
----------
train Loss: 3.4025 Acc: 0.3445
val Loss: 3.3236 Acc: 0.4318
Epoch 7/74
----------
train Loss: 3.3267 Acc: 0.4115
val Loss: 3.2475 Acc: 0.4773
Epoch 8/74
----------
train Loss: 3.2566 Acc: 0.4354
val Loss: 3.1897 Acc: 0.5227
Epoch 9/74
----------
train Loss: 3.1974 Acc: 0.4306
val Loss: 3.1000 Acc: 0.5227
Epoch 10/74
----------
train Loss: 3.0726 Acc: 0.4545
val Loss: 2.9977 Acc: 0.5909
Epoch 11/74
----------
train Loss: 3.0664 Acc: 0.4737
val Loss: 2.9535 Acc: 0.5909
Epoch 12/74
----------
train Loss: 3.0174 Acc: 0.4833
val Loss: 2.9037 Acc: 0.5909
Epoch 13/74
----------
train Loss: 2.9027 Acc: 0.5407
val Loss: 2.7891 Acc: 0.6136
Epoch 14/74
----------
train Loss: 2.8363 Acc: 0.5167
val Loss: 2.7510 Acc: 0.6364
Epoch 15/74
----------
train Loss: 2.8079 Acc: 0.5215
val Loss: 2.6973 Acc: 0.6364
Epoch 16/74
----------
train Loss: 2.7512 Acc: 0.5167
val Loss: 2.6101 Acc: 0.6591
Epoch 17/74
----------
train Loss: 2.6852 Acc: 0.5215
val Loss: 2.5354 Acc: 0.6818
Epoch 18/74
----------
train Loss: 2.6411 Acc: 0.5120
val Loss: 2.4672 Acc: 0.6591
Epoch 19/74
----------
train Loss: 2.5773 Acc: 0.5359
val Loss: 2.4141 Acc: 0.6818
Epoch 20/74
----------
train Loss: 2.5327 Acc: 0.5263
val Loss: 2.3541 Acc: 0.6818
Epoch 21/74
----------
train Loss: 2.5223 Acc: 0.5407
val Loss: 2.3303 Acc: 0.6818
Epoch 22/74
----------
train Loss: 2.4865 Acc: 0.5502
val Loss: 2.2835 Acc: 0.6818
Epoch 23/74
----------
train Loss: 2.4127 Acc: 0.5359
val Loss: 2.2324 Acc: 0.6818
Epoch 24/74
----------
train Loss: 2.3062 Acc: 0.5359
val Loss: 2.1540 Acc: 0.6818
Epoch 25/74
----------
train Loss: 2.3698 Acc: 0.5455
val Loss: 2.1525 Acc: 0.6818
Epoch 26/74
----------
train Loss: 2.3624 Acc: 0.5215
val Loss: 2.1475 Acc: 0.6818
Epoch 27/74
----------
train Loss: 2.2355 Acc: 0.5694
val Loss: 2.0995 Acc: 0.6818
Epoch 28/74
----------
train Loss: 2.3168 Acc: 0.5167
val Loss: 2.0737 Acc: 0.6818
Epoch 29/74
----------
train Loss: 2.3388 Acc: 0.5407
val Loss: 2.0515 Acc: 0.6818
Epoch 30/74
----------
train Loss: 2.2783 Acc: 0.5359
val Loss: 2.0515 Acc: 0.6818
Epoch 31/74
----------
train Loss: 2.1651 Acc: 0.5837
val Loss: 2.0077 Acc: 0.6818
Epoch 32/74
----------
train Loss: 2.2026 Acc: 0.5598
val Loss: 1.9736 Acc: 0.6818
Epoch 33/74
----------
train Loss: 2.2251 Acc: 0.5646
val Loss: 1.9613 Acc: 0.6818
Epoch 34/74
----------
train Loss: 2.1737 Acc: 0.5359
val Loss: 1.9434 Acc: 0.6818
Epoch 35/74
----------
train Loss: 2.0417 Acc: 0.5789
val Loss: 1.9135 Acc: 0.7045
Epoch 36/74
----------
train Loss: 2.2705 Acc: 0.5407
val Loss: 1.8828 Acc: 0.6818
Epoch 37/74
----------
train Loss: 2.1110 Acc: 0.5885
val Loss: 1.8860 Acc: 0.7273
Epoch 38/74
----------
train Loss: 2.1116 Acc: 0.6077
val Loss: 1.8706 Acc: 0.7273
Epoch 39/74
----------
train Loss: 2.1690 Acc: 0.5742
val Loss: 1.9032 Acc: 0.7273
Epoch 40/74
----------
train Loss: 2.0210 Acc: 0.6029
val Loss: 1.8900 Acc: 0.7273
Epoch 41/74
----------
train Loss: 2.2088 Acc: 0.5837
val Loss: 1.8674 Acc: 0.7273
Epoch 42/74
----------
train Loss: 2.0273 Acc: 0.6124
val Loss: 1.8355 Acc: 0.7273
Epoch 43/74
----------
train Loss: 2.1037 Acc: 0.5598
val Loss: 1.8226 Acc: 0.7273
Epoch 44/74
----------
train Loss: 1.9553 Acc: 0.6411
val Loss: 1.8022 Acc: 0.7273
Epoch 45/74
----------
train Loss: 1.7400 Acc: 0.6986
val Loss: 1.7766 Acc: 0.7500
Epoch 46/74
----------
train Loss: 2.1596 Acc: 0.6077
val Loss: 1.7830 Acc: 0.7273
Epoch 47/74
----------
train Loss: 1.9335 Acc: 0.6507
val Loss: 1.7659 Acc: 0.7500
Epoch 48/74
----------
train Loss: 1.9571 Acc: 0.6411
val Loss: 1.7452 Acc: 0.7500
Epoch 49/74
----------
train Loss: 1.9468 Acc: 0.6794
val Loss: 1.7199 Acc: 0.7500
Epoch 50/74
----------
train Loss: 1.9203 Acc: 0.6507
val Loss: 1.7436 Acc: 0.7727
Epoch 51/74
----------
train Loss: 1.7366 Acc: 0.7177
val Loss: 1.6896 Acc: 0.7500
Epoch 52/74
----------
train Loss: 1.9407 Acc: 0.6699
val Loss: 1.6895 Acc: 0.7955
Epoch 53/74
----------
train Loss: 2.0306 Acc: 0.6459
val Loss: 1.6867 Acc: 0.7955
Epoch 54/74
----------
train Loss: 1.7773 Acc: 0.7560
val Loss: 1.6712 Acc: 0.7955
Epoch 55/74
----------
train Loss: 1.8185 Acc: 0.7081
val Loss: 1.6375 Acc: 0.7955
Epoch 56/74
----------
train Loss: 1.9249 Acc: 0.6794
val Loss: 1.6360 Acc: 0.7955
Epoch 57/74
----------
train Loss: 2.0299 Acc: 0.6220
val Loss: 1.6167 Acc: 0.7727
Epoch 58/74
----------
train Loss: 1.8282 Acc: 0.7033
val Loss: 1.6308 Acc: 0.8182
Epoch 59/74
----------
train Loss: 1.8861 Acc: 0.6986
val Loss: 1.6104 Acc: 0.7955
Epoch 60/74
----------
train Loss: 1.7292 Acc: 0.7321
val Loss: 1.6075 Acc: 0.7955
Epoch 61/74
----------
train Loss: 2.0017 Acc: 0.6459
val Loss: 1.5829 Acc: 0.7955
Epoch 62/74
----------
train Loss: 1.8239 Acc: 0.7368
val Loss: 1.5726 Acc: 0.7955
Epoch 63/74
----------
train Loss: 1.6906 Acc: 0.7990
val Loss: 1.5598 Acc: 0.8182
Epoch 64/74
----------
train Loss: 1.6682 Acc: 0.7703
val Loss: 1.5566 Acc: 0.8182
Epoch 65/74
----------
train Loss: 1.7759 Acc: 0.7225
val Loss: 1.5449 Acc: 0.8182
Epoch 66/74
----------
train Loss: 1.7328 Acc: 0.7943
val Loss: 1.5350 Acc: 0.8409
Epoch 67/74
----------
train Loss: 1.8207 Acc: 0.7656
val Loss: 1.5115 Acc: 0.8182
Epoch 68/74
----------
train Loss: 1.6326 Acc: 0.7799
val Loss: 1.4983 Acc: 0.8409
Epoch 69/74
----------
train Loss: 1.6648 Acc: 0.7799
val Loss: 1.5058 Acc: 0.8182
Epoch 70/74
----------
train Loss: 1.7453 Acc: 0.7560
val Loss: 1.5019 Acc: 0.8182
Epoch 71/74
----------
train Loss: 1.8489 Acc: 0.7464
val Loss: 1.4840 Acc: 0.8182
Epoch 72/74
----------
train Loss: 1.8159 Acc: 0.7368
val Loss: 1.5035 Acc: 0.8182
Epoch 73/74
----------
train Loss: 1.4191 Acc: 0.8947
val Loss: 1.4819 Acc: 0.8409
Epoch 74/74
----------
train Loss: 1.8514 Acc: 0.7321
[32m[I 2025-06-28 21:13:02,270][0m Trial 92 finished with value: 0.8181818181818182 and parameters: {'batch_size': 38, 'lr': 2.8498194544977513e-05, 'num_epochs': 74, 'weight_decay': 0.01113354604393801, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4581 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_38_lr_2.8498194544977513e-05_epoch_74_wd_0.01113354604393801_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/66
----------
train Loss: 0.6785 Acc: 0.2679
val Loss: 0.6481 Acc: 0.4091
Epoch 2/66
----------
train Loss: 0.6212 Acc: 0.4258
val Loss: 0.6093 Acc: 0.5682
Epoch 3/66
----------
train Loss: 0.5808 Acc: 0.4641
val Loss: 0.5656 Acc: 0.6136
Epoch 4/66
----------
train Loss: 0.5537 Acc: 0.4928
val Loss: 0.5421 Acc: 0.6364
Epoch 5/66
----------
train Loss: 0.5371 Acc: 0.4928
val Loss: 0.5288 Acc: 0.6364
Epoch 6/66
----------
train Loss: 0.5182 Acc: 0.5072
val Loss: 0.5059 Acc: 0.6364
Epoch 7/66
----------
train Loss: 0.4997 Acc: 0.5024
val Loss: 0.4830 Acc: 0.6364
Epoch 8/66
----------
train Loss: 0.4973 Acc: 0.5024
val Loss: 0.4633 Acc: 0.6364
Epoch 9/66
----------
train Loss: 0.4891 Acc: 0.5024
val Loss: 0.4501 Acc: 0.6364
Epoch 10/66
----------
train Loss: 0.4560 Acc: 0.5120
val Loss: 0.4385 Acc: 0.6591
Epoch 11/66
----------
train Loss: 0.4663 Acc: 0.5120
val Loss: 0.4248 Acc: 0.6591
Epoch 12/66
----------
train Loss: 0.4681 Acc: 0.5167
val Loss: 0.4314 Acc: 0.6591
Epoch 13/66
----------
train Loss: 0.4450 Acc: 0.5598
val Loss: 0.4135 Acc: 0.6591
Epoch 14/66
----------
train Loss: 0.4212 Acc: 0.5742
val Loss: 0.3934 Acc: 0.6818
Epoch 15/66
----------
train Loss: 0.4372 Acc: 0.5646
val Loss: 0.3802 Acc: 0.7045
Epoch 16/66
----------
train Loss: 0.4265 Acc: 0.5981
val Loss: 0.3799 Acc: 0.7045
Epoch 17/66
----------
train Loss: 0.4228 Acc: 0.5837
val Loss: 0.3799 Acc: 0.7273
Epoch 18/66
----------
train Loss: 0.3991 Acc: 0.6938
val Loss: 0.3720 Acc: 0.7045
Epoch 19/66
----------
train Loss: 0.3839 Acc: 0.6746
val Loss: 0.3641 Acc: 0.7045
Epoch 20/66
----------
train Loss: 0.3902 Acc: 0.6938
val Loss: 0.3461 Acc: 0.7273
Epoch 21/66
----------
train Loss: 0.3898 Acc: 0.6699
val Loss: 0.3228 Acc: 0.7500
Epoch 22/66
----------
train Loss: 0.3850 Acc: 0.7033
val Loss: 0.3158 Acc: 0.7500
Epoch 23/66
----------
train Loss: 0.3704 Acc: 0.7225
val Loss: 0.3168 Acc: 0.7727
Epoch 24/66
----------
train Loss: 0.3406 Acc: 0.7799
val Loss: 0.3066 Acc: 0.7500
Epoch 25/66
----------
train Loss: 0.3545 Acc: 0.7847
val Loss: 0.3298 Acc: 0.7500
Epoch 26/66
----------
train Loss: 0.3690 Acc: 0.8325
val Loss: 0.3348 Acc: 0.7955
Epoch 27/66
----------
train Loss: 0.3170 Acc: 0.8612
val Loss: 0.3258 Acc: 0.7727
Epoch 28/66
----------
train Loss: 0.3699 Acc: 0.7847
val Loss: 0.3099 Acc: 0.7500
Epoch 29/66
----------
train Loss: 0.3871 Acc: 0.7129
val Loss: 0.3319 Acc: 0.7273
Epoch 30/66
----------
train Loss: 0.3458 Acc: 0.7799
val Loss: 0.3122 Acc: 0.7273
Epoch 31/66
----------
train Loss: 0.3001 Acc: 0.8660
val Loss: 0.2895 Acc: 0.7500
Epoch 32/66
----------
train Loss: 0.3243 Acc: 0.8134
val Loss: 0.2874 Acc: 0.7500
Epoch 33/66
----------
train Loss: 0.3386 Acc: 0.8182
val Loss: 0.2974 Acc: 0.7727
Epoch 34/66
----------
train Loss: 0.3115 Acc: 0.8612
val Loss: 0.2922 Acc: 0.7273
Epoch 35/66
----------
train Loss: 0.2643 Acc: 0.9330
val Loss: 0.3080 Acc: 0.7045
Epoch 36/66
----------
train Loss: 0.3536 Acc: 0.7751
val Loss: 0.2931 Acc: 0.7273
Epoch 37/66
----------
train Loss: 0.2997 Acc: 0.7847
val Loss: 0.3261 Acc: 0.7727
Epoch 38/66
----------
train Loss: 0.3082 Acc: 0.8804
val Loss: 0.3194 Acc: 0.7727
Epoch 39/66
----------
train Loss: 0.3260 Acc: 0.7368
val Loss: 0.3403 Acc: 0.7727
Epoch 40/66
----------
train Loss: 0.2846 Acc: 0.8756
val Loss: 0.3110 Acc: 0.7727
Epoch 41/66
----------
train Loss: 0.3631 Acc: 0.7033
val Loss: 0.3043 Acc: 0.7727
Epoch 42/66
----------
train Loss: 0.2878 Acc: 0.8421
val Loss: 0.3272 Acc: 0.7500
Epoch 43/66
----------
train Loss: 0.3032 Acc: 0.8421
val Loss: 0.3057 Acc: 0.7727
Epoch 44/66
----------
train Loss: 0.2746 Acc: 0.8660
val Loss: 0.2924 Acc: 0.7500
Epoch 45/66
----------
train Loss: 0.1856 Acc: 0.9761
val Loss: 0.2780 Acc: 0.7727
Epoch 46/66
----------
train Loss: 0.3720 Acc: 0.8182
val Loss: 0.3091 Acc: 0.8182
Epoch 47/66
----------
train Loss: 0.2785 Acc: 0.8756
val Loss: 0.2959 Acc: 0.7273
Epoch 48/66
----------
train Loss: 0.3078 Acc: 0.8230
val Loss: 0.2823 Acc: 0.7727
Epoch 49/66
----------
train Loss: 0.2879 Acc: 0.9043
val Loss: 0.2923 Acc: 0.7500
Epoch 50/66
----------
train Loss: 0.2820 Acc: 0.8517
val Loss: 0.2724 Acc: 0.7727
Epoch 51/66
----------
train Loss: 0.2218 Acc: 0.9761
val Loss: 0.2384 Acc: 0.8182
Epoch 52/66
----------
train Loss: 0.3021 Acc: 0.7990
val Loss: 0.2833 Acc: 0.7273
Epoch 53/66
----------
train Loss: 0.3331 Acc: 0.8756
val Loss: 0.3283 Acc: 0.6818
Epoch 54/66
----------
train Loss: 0.2564 Acc: 0.9043
val Loss: 0.2730 Acc: 0.8409
Epoch 55/66
----------
train Loss: 0.2646 Acc: 0.9378
val Loss: 0.2740 Acc: 0.7955
Epoch 56/66
----------
train Loss: 0.3123 Acc: 0.8660
val Loss: 0.2601 Acc: 0.7955
Epoch 57/66
----------
train Loss: 0.3530 Acc: 0.7990
val Loss: 0.2876 Acc: 0.7955
Epoch 58/66
----------
train Loss: 0.3012 Acc: 0.8038
val Loss: 0.3029 Acc: 0.7727
Epoch 59/66
----------
train Loss: 0.3037 Acc: 0.8373
val Loss: 0.2965 Acc: 0.8182
Epoch 60/66
----------
train Loss: 0.2559 Acc: 0.8852
val Loss: 0.2729 Acc: 0.7727
Epoch 61/66
----------
train Loss: 0.3436 Acc: 0.7512
val Loss: 0.2647 Acc: 0.7500
Epoch 62/66
----------
train Loss: 0.3079 Acc: 0.9187
val Loss: 0.2777 Acc: 0.7273
Epoch 63/66
----------
train Loss: 0.2679 Acc: 0.9139
val Loss: 0.2772 Acc: 0.7500
Epoch 64/66
----------
train Loss: 0.2574 Acc: 0.9474
val Loss: 0.2809 Acc: 0.7727
Epoch 65/66
----------
train Loss: 0.2869 Acc: 0.8421
val Loss: 0.3010 Acc: 0.7500
Epoch 66/66
----------
train Loss: 0.2808 Acc: 0.8804
[32m[I 2025-06-28 21:28:03,923][0m Trial 93 finished with value: 0.7727272727272727 and parameters: {'batch_size': 78, 'lr': 0.00019065889773219792, 'num_epochs': 66, 'weight_decay': 0.024188855198162842, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2835 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_78_lr_0.00019065889773219792_epoch_66_wd_0.024188855198162842_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/79
----------
train Loss: 3.2947 Acc: 0.3780
val Loss: 2.9278 Acc: 0.6364
Epoch 2/79
----------
train Loss: 2.5081 Acc: 0.5167
val Loss: 2.1283 Acc: 0.6364
Epoch 3/79
----------
train Loss: 2.2659 Acc: 0.5120
val Loss: 2.2954 Acc: 0.6818
Epoch 4/79
----------
train Loss: 2.1666 Acc: 0.5359
val Loss: 2.6348 Acc: 0.7273
Epoch 5/79
----------
train Loss: 2.0813 Acc: 0.6459
val Loss: 2.4181 Acc: 0.7727
Epoch 6/79
----------
train Loss: 1.9354 Acc: 0.6651
val Loss: 2.0694 Acc: 0.7955
Epoch 7/79
----------
train Loss: 1.6911 Acc: 0.7895
val Loss: 2.0895 Acc: 0.7955
Epoch 8/79
----------
train Loss: 1.7993 Acc: 0.7368
val Loss: 2.0731 Acc: 0.8182
Epoch 9/79
----------
train Loss: 1.7628 Acc: 0.7464
val Loss: 2.1434 Acc: 0.7727
Epoch 10/79
----------
train Loss: 1.1144 Acc: 0.9522
val Loss: 1.5806 Acc: 0.7955
Epoch 11/79
----------
train Loss: 1.7564 Acc: 0.7703
val Loss: 2.0695 Acc: 0.8182
Epoch 12/79
----------
train Loss: 1.5650 Acc: 0.7751
val Loss: 2.8897 Acc: 0.5455
Epoch 13/79
----------
train Loss: 1.4453 Acc: 0.8756
val Loss: 2.0538 Acc: 0.7727
Epoch 14/79
----------
train Loss: 1.3407 Acc: 0.8421
val Loss: 1.7687 Acc: 0.7045
Epoch 15/79
----------
train Loss: 1.5171 Acc: 0.8038
val Loss: 1.7365 Acc: 0.7273
Epoch 16/79
----------
train Loss: 1.5848 Acc: 0.7560
val Loss: 2.3839 Acc: 0.7500
Epoch 17/79
----------
train Loss: 1.4300 Acc: 0.8182
val Loss: 2.0687 Acc: 0.7727
Epoch 18/79
----------
train Loss: 1.4093 Acc: 0.8182
val Loss: 1.9030 Acc: 0.7500
Epoch 19/79
----------
train Loss: 1.3501 Acc: 0.9043
val Loss: 1.6494 Acc: 0.7500
Epoch 20/79
----------
train Loss: 1.4893 Acc: 0.8517
val Loss: 1.6203 Acc: 0.7500
Epoch 21/79
----------
train Loss: 1.5321 Acc: 0.8947
val Loss: 1.6385 Acc: 0.8182
Epoch 22/79
----------
train Loss: 1.3343 Acc: 0.8708
val Loss: 1.7500 Acc: 0.7045
Epoch 23/79
----------
train Loss: 1.6562 Acc: 0.8134
val Loss: 1.7428 Acc: 0.7045
Epoch 24/79
----------
train Loss: 1.3047 Acc: 0.8660
val Loss: 1.8472 Acc: 0.7727
Epoch 25/79
----------
train Loss: 1.4135 Acc: 0.9139
val Loss: 1.7666 Acc: 0.7500
Epoch 26/79
----------
train Loss: 1.4453 Acc: 0.9330
val Loss: 1.7172 Acc: 0.7045
Epoch 27/79
----------
train Loss: 1.3583 Acc: 0.9378
val Loss: 1.8907 Acc: 0.7045
Epoch 28/79
----------
train Loss: 1.5438 Acc: 0.8038
val Loss: 1.6918 Acc: 0.7727
Epoch 29/79
----------
train Loss: 1.6386 Acc: 0.7751
val Loss: 1.8595 Acc: 0.7273
Epoch 30/79
----------
train Loss: 1.5301 Acc: 0.8230
val Loss: 1.2476 Acc: 0.8182
Epoch 31/79
----------
train Loss: 1.2422 Acc: 0.9139
val Loss: 1.3461 Acc: 0.7955
Epoch 32/79
----------
train Loss: 1.4661 Acc: 0.8565
val Loss: 1.3452 Acc: 0.7500
Epoch 33/79
----------
train Loss: 1.4577 Acc: 0.8612
val Loss: 1.4898 Acc: 0.7045
Epoch 34/79
----------
train Loss: 1.4332 Acc: 0.9091
val Loss: 2.5067 Acc: 0.5909
Epoch 35/79
----------
train Loss: 1.1312 Acc: 0.9378
val Loss: 1.8481 Acc: 0.6591
Epoch 36/79
----------
train Loss: 1.6689 Acc: 0.8086
val Loss: 1.6075 Acc: 0.7045
Epoch 37/79
----------
train Loss: 1.5483 Acc: 0.8086
val Loss: 1.6341 Acc: 0.7273
Epoch 38/79
----------
train Loss: 1.5194 Acc: 0.8947
val Loss: 1.6770 Acc: 0.7273
Epoch 39/79
----------
train Loss: 1.5102 Acc: 0.7751
val Loss: 1.5635 Acc: 0.7500
Epoch 40/79
----------
train Loss: 1.4300 Acc: 0.8517
val Loss: 1.4500 Acc: 0.7955
Epoch 41/79
----------
train Loss: 1.6907 Acc: 0.6986
val Loss: 1.5779 Acc: 0.7273
Epoch 42/79
----------
train Loss: 1.3683 Acc: 0.8373
val Loss: 1.5635 Acc: 0.6818
Epoch 43/79
----------
train Loss: 1.4590 Acc: 0.8038
val Loss: 2.2348 Acc: 0.6364
Epoch 44/79
----------
train Loss: 1.4085 Acc: 0.8756
val Loss: 1.5814 Acc: 0.6591
Epoch 45/79
----------
train Loss: 0.8968 Acc: 0.9522
val Loss: 1.3324 Acc: 0.7500
Epoch 46/79
----------
train Loss: 1.7882 Acc: 0.8230
val Loss: 1.6653 Acc: 0.7045
Epoch 47/79
----------
train Loss: 1.4213 Acc: 0.8756
val Loss: 2.1968 Acc: 0.6591
Epoch 48/79
----------
train Loss: 1.3941 Acc: 0.8373
val Loss: 1.8918 Acc: 0.6818
Epoch 49/79
----------
train Loss: 1.4163 Acc: 0.8756
val Loss: 1.5525 Acc: 0.7273
Epoch 50/79
----------
train Loss: 1.4305 Acc: 0.8182
val Loss: 1.8227 Acc: 0.6364
Epoch 51/79
----------
train Loss: 1.0887 Acc: 0.9665
val Loss: 1.5229 Acc: 0.7273
Epoch 52/79
----------
train Loss: 1.3928 Acc: 0.8517
val Loss: 1.5771 Acc: 0.7045
Epoch 53/79
----------
train Loss: 1.6282 Acc: 0.8660
val Loss: 1.5974 Acc: 0.7727
Epoch 54/79
----------
train Loss: 1.3202 Acc: 0.8900
val Loss: 1.3944 Acc: 0.7727
Epoch 55/79
----------
train Loss: 1.2677 Acc: 0.9234
val Loss: 1.6544 Acc: 0.7273
Epoch 56/79
----------
train Loss: 1.4237 Acc: 0.8852
val Loss: 1.5563 Acc: 0.7500
Epoch 57/79
----------
train Loss: 1.6891 Acc: 0.8038
val Loss: 1.7033 Acc: 0.7500
Epoch 58/79
----------
train Loss: 1.3899 Acc: 0.7990
val Loss: 1.5306 Acc: 0.7500
Epoch 59/79
----------
train Loss: 1.4152 Acc: 0.8517
val Loss: 2.2227 Acc: 0.6591
Epoch 60/79
----------
train Loss: 1.1249 Acc: 0.8660
val Loss: 1.6679 Acc: 0.7727
Epoch 61/79
----------
train Loss: 1.6606 Acc: 0.7751
val Loss: 1.7169 Acc: 0.8182
Epoch 62/79
----------
train Loss: 1.6095 Acc: 0.8900
val Loss: 2.4815 Acc: 0.5909
Epoch 63/79
----------
train Loss: 1.4127 Acc: 0.8852
val Loss: 1.9682 Acc: 0.6364
Epoch 64/79
----------
train Loss: 1.3045 Acc: 0.8852
val Loss: 1.5988 Acc: 0.6818
Epoch 65/79
----------
train Loss: 1.4632 Acc: 0.8182
val Loss: 1.5478 Acc: 0.7273
Epoch 66/79
----------
train Loss: 1.4845 Acc: 0.8612
[32m[I 2025-06-28 21:43:04,570][0m Trial 94 finished with value: 0.8181818181818182 and parameters: {'batch_size': 88, 'lr': 0.0006256570859494502, 'num_epochs': 79, 'weight_decay': 0.03256149089346359, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.7692 Acc: 0.6591
Early stopping at epoch 66 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_88_lr_0.0006256570859494502_epoch_79_wd_0.03256149089346359_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/91
----------
train Loss: 0.6536 Acc: 0.3254
val Loss: 0.5992 Acc: 0.5909
Epoch 2/91
----------
train Loss: 0.5478 Acc: 0.5742
val Loss: 0.4539 Acc: 0.6364
Epoch 3/91
----------
train Loss: 0.4829 Acc: 0.5598
val Loss: 0.3839 Acc: 0.6364
Epoch 4/91
----------
train Loss: 0.4498 Acc: 0.5502
val Loss: 0.3561 Acc: 0.7273
Epoch 5/91
----------
train Loss: 0.4294 Acc: 0.6842
val Loss: 0.3210 Acc: 0.7955
Epoch 6/91
----------
train Loss: 0.3929 Acc: 0.6603
val Loss: 0.2844 Acc: 0.8182
Epoch 7/91
----------
train Loss: 0.3567 Acc: 0.7703
val Loss: 0.2730 Acc: 0.8182
Epoch 8/91
----------
train Loss: 0.3748 Acc: 0.7464
val Loss: 0.2524 Acc: 0.8182
Epoch 9/91
----------
train Loss: 0.3734 Acc: 0.7608
val Loss: 0.2695 Acc: 0.8182
Epoch 10/91
----------
train Loss: 0.2525 Acc: 0.9330
val Loss: 0.2540 Acc: 0.8409
Epoch 11/91
----------
train Loss: 0.3386 Acc: 0.7895
val Loss: 0.2378 Acc: 0.8409
Epoch 12/91
----------
train Loss: 0.3194 Acc: 0.7321
val Loss: 0.2801 Acc: 0.8182
Epoch 13/91
----------
train Loss: 0.2880 Acc: 0.8995
val Loss: 0.2635 Acc: 0.7500
Epoch 14/91
----------
train Loss: 0.2603 Acc: 0.8325
val Loss: 0.2717 Acc: 0.7045
Epoch 15/91
----------
train Loss: 0.2893 Acc: 0.8325
val Loss: 0.2584 Acc: 0.8182
Epoch 16/91
----------
train Loss: 0.3069 Acc: 0.7751
val Loss: 0.2746 Acc: 0.8182
Epoch 17/91
----------
train Loss: 0.2765 Acc: 0.8517
val Loss: 0.3165 Acc: 0.8182
Epoch 18/91
----------
train Loss: 0.2649 Acc: 0.8469
val Loss: 0.2631 Acc: 0.8182
Epoch 19/91
----------
train Loss: 0.2458 Acc: 0.9234
val Loss: 0.2443 Acc: 0.8409
Epoch 20/91
----------
train Loss: 0.2774 Acc: 0.8804
val Loss: 0.2560 Acc: 0.8182
Epoch 21/91
----------
train Loss: 0.2901 Acc: 0.8947
val Loss: 0.2654 Acc: 0.7727
Epoch 22/91
----------
train Loss: 0.2624 Acc: 0.8804
val Loss: 0.2502 Acc: 0.7273
Epoch 23/91
----------
train Loss: 0.2937 Acc: 0.8995
val Loss: 0.2361 Acc: 0.7500
Epoch 24/91
----------
train Loss: 0.2157 Acc: 0.9426
val Loss: 0.2312 Acc: 0.8182
Epoch 25/91
----------
train Loss: 0.2569 Acc: 0.9426
val Loss: 0.2595 Acc: 0.7955
Epoch 26/91
----------
train Loss: 0.2842 Acc: 0.9378
val Loss: 0.2677 Acc: 0.8182
Epoch 27/91
----------
train Loss: 0.2317 Acc: 0.9761
val Loss: 0.2778 Acc: 0.8182
Epoch 28/91
----------
train Loss: 0.2830 Acc: 0.8565
val Loss: 0.2626 Acc: 0.7955
Epoch 29/91
----------
train Loss: 0.3028 Acc: 0.7895
val Loss: 0.2392 Acc: 0.8636
Epoch 30/91
----------
train Loss: 0.2630 Acc: 0.8804
val Loss: 0.2200 Acc: 0.8182
Epoch 31/91
----------
train Loss: 0.2287 Acc: 0.9522
val Loss: 0.2167 Acc: 0.7727
Epoch 32/91
----------
train Loss: 0.2423 Acc: 0.8995
val Loss: 0.2187 Acc: 0.8636
Epoch 33/91
----------
train Loss: 0.2654 Acc: 0.9139
val Loss: 0.2148 Acc: 0.7955
Epoch 34/91
----------
train Loss: 0.2607 Acc: 0.9617
val Loss: 0.2236 Acc: 0.7727
Epoch 35/91
----------
train Loss: 0.2032 Acc: 0.9761
val Loss: 0.2520 Acc: 0.7500
Epoch 36/91
----------
train Loss: 0.3072 Acc: 0.8708
val Loss: 0.2492 Acc: 0.7727
Epoch 37/91
----------
train Loss: 0.2608 Acc: 0.8517
val Loss: 0.2493 Acc: 0.8182
Epoch 38/91
----------
train Loss: 0.2725 Acc: 0.9569
val Loss: 0.2458 Acc: 0.8182
Epoch 39/91
----------
train Loss: 0.2733 Acc: 0.7895
val Loss: 0.2611 Acc: 0.7045
Epoch 40/91
----------
train Loss: 0.2358 Acc: 0.9234
val Loss: 0.2618 Acc: 0.7273
Epoch 41/91
----------
train Loss: 0.3184 Acc: 0.7033
val Loss: 0.2427 Acc: 0.7727
Epoch 42/91
----------
train Loss: 0.2253 Acc: 0.8995
val Loss: 0.2461 Acc: 0.7273
Epoch 43/91
----------
train Loss: 0.2589 Acc: 0.8947
val Loss: 0.2284 Acc: 0.7727
Epoch 44/91
----------
train Loss: 0.2419 Acc: 0.8995
val Loss: 0.2357 Acc: 0.7955
Epoch 45/91
----------
train Loss: 0.1504 Acc: 0.9761
val Loss: 0.2263 Acc: 0.8182
Epoch 46/91
----------
train Loss: 0.3384 Acc: 0.8278
val Loss: 0.2545 Acc: 0.7955
Epoch 47/91
----------
train Loss: 0.2316 Acc: 0.9426
val Loss: 0.2618 Acc: 0.7273
Epoch 48/91
----------
train Loss: 0.2656 Acc: 0.8660
val Loss: 0.2811 Acc: 0.7273
Epoch 49/91
----------
train Loss: 0.2668 Acc: 0.9665
val Loss: 0.2699 Acc: 0.7955
Epoch 50/91
----------
train Loss: 0.2431 Acc: 0.9139
val Loss: 0.2626 Acc: 0.7500
Epoch 51/91
----------
train Loss: 0.1952 Acc: 0.9856
val Loss: 0.2424 Acc: 0.7955
Epoch 52/91
----------
train Loss: 0.2582 Acc: 0.8947
val Loss: 0.2421 Acc: 0.7500
Epoch 53/91
----------
train Loss: 0.3013 Acc: 0.9187
val Loss: 0.2595 Acc: 0.7045
Epoch 54/91
----------
train Loss: 0.2228 Acc: 0.9474
val Loss: 0.2742 Acc: 0.7273
Epoch 55/91
----------
train Loss: 0.2335 Acc: 0.9713
val Loss: 0.2905 Acc: 0.7273
Epoch 56/91
----------
train Loss: 0.2747 Acc: 0.9522
val Loss: 0.2655 Acc: 0.7500
Epoch 57/91
----------
train Loss: 0.3053 Acc: 0.8421
val Loss: 0.2800 Acc: 0.7500
Epoch 58/91
----------
train Loss: 0.2407 Acc: 0.8421
val Loss: 0.2760 Acc: 0.7500
Epoch 59/91
----------
train Loss: 0.2554 Acc: 0.9378
val Loss: 0.2842 Acc: 0.7500
Epoch 60/91
----------
train Loss: 0.2122 Acc: 0.9187
val Loss: 0.2780 Acc: 0.7273
Epoch 61/91
----------
train Loss: 0.2985 Acc: 0.8038
val Loss: 0.2677 Acc: 0.7273
Epoch 62/91
----------
train Loss: 0.2821 Acc: 0.9522
val Loss: 0.2660 Acc: 0.7727
Epoch 63/91
----------
train Loss: 0.2406 Acc: 0.9474
val Loss: 0.2817 Acc: 0.7955
Epoch 64/91
----------
train Loss: 0.2222 Acc: 0.9474
val Loss: 0.2838 Acc: 0.7955
Epoch 65/91
----------
train Loss: 0.2457 Acc: 0.8708
val Loss: 0.2686 Acc: 0.7273
Epoch 66/91
----------
train Loss: 0.2452 Acc: 0.9330
val Loss: 0.2768 Acc: 0.7273
Epoch 67/91
----------
train Loss: 0.2797 Acc: 0.8947
val Loss: 0.2692 Acc: 0.7727
Epoch 68/91
----------
train Loss: 0.2379 Acc: 0.9091
val Loss: 0.2804 Acc: 0.7955
Epoch 69/91
----------
train Loss: 0.2230 Acc: 0.8900
val Loss: 0.2766 Acc: 0.7955
Epoch 70/91
----------
train Loss: 0.2640 Acc: 0.9139
val Loss: 0.2711 Acc: 0.7727
Epoch 71/91
----------
train Loss: 0.2681 Acc: 0.9330
val Loss: 0.2504 Acc: 0.7955
Epoch 72/91
----------
train Loss: 0.2671 Acc: 0.8947
val Loss: 0.2541 Acc: 0.8182
Epoch 73/91
----------
train Loss: 0.2007 Acc: 0.9665
val Loss: 0.2727 Acc: 0.7727
Epoch 74/91
----------
train Loss: 0.2833 Acc: 0.8995
val Loss: 0.2826 Acc: 0.7727
Epoch 75/91
----------
train Loss: 0.2123 Acc: 1.0000
val Loss: 0.2564 Acc: 0.8409
Epoch 76/91
----------
train Loss: 0.2191 Acc: 0.8804
val Loss: 0.2309 Acc: 0.7955
Epoch 77/91
----------
train Loss: 0.2714 Acc: 0.8995
val Loss: 0.2706 Acc: 0.7955
Epoch 78/91
----------
train Loss: 0.2363 Acc: 0.9091
val Loss: 0.2819 Acc: 0.7955
Epoch 79/91
----------
train Loss: 0.2728 Acc: 0.9426
val Loss: 0.2420 Acc: 0.8636
Epoch 80/91
----------
train Loss: 0.2505 Acc: 0.8947
val Loss: 0.2503 Acc: 0.7955
Epoch 81/91
----------
train Loss: 0.2918 Acc: 0.7943
val Loss: 0.2831 Acc: 0.7727
Epoch 82/91
----------
train Loss: 0.2458 Acc: 0.9282
val Loss: 0.2904 Acc: 0.6818
Epoch 83/91
----------
train Loss: 0.2236 Acc: 0.9856
val Loss: 0.2699 Acc: 0.8409
Epoch 84/91
----------
train Loss: 0.2798 Acc: 0.8182
val Loss: 0.2634 Acc: 0.7727
Epoch 85/91
----------
train Loss: 0.2196 Acc: 0.9091
val Loss: 0.2911 Acc: 0.7500
Epoch 86/91
----------
train Loss: 0.2339 Acc: 0.9091
val Loss: 0.2819 Acc: 0.7727
Epoch 87/91
----------
train Loss: 0.2637 Acc: 0.9665
val Loss: 0.2881 Acc: 0.7273
Epoch 88/91
----------
train Loss: 0.2880 Acc: 0.9091
val Loss: 0.2455 Acc: 0.7955
Epoch 89/91
----------
train Loss: 0.2980 Acc: 0.8612
val Loss: 0.2451 Acc: 0.7955
Epoch 90/91
----------
train Loss: 0.2681 Acc: 0.8708
val Loss: 0.2604 Acc: 0.7500
Epoch 91/91
----------
train Loss: 0.2241 Acc: 0.9569
[32m[I 2025-06-28 22:03:46,171][0m Trial 95 finished with value: 0.7727272727272727 and parameters: {'batch_size': 10, 'lr': 0.00029098838949496444, 'num_epochs': 91, 'weight_decay': 0.0007557847613894274, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2522 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_10_lr_0.00029098838949496444_epoch_91_wd_0.0007557847613894274_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/71
----------
train Loss: 5.5657 Acc: 0.3445
val Loss: 4.3683 Acc: 0.7045
Epoch 2/71
----------
train Loss: 3.1327 Acc: 0.7703
val Loss: 3.7653 Acc: 0.7273
Epoch 3/71
----------
train Loss: 1.3656 Acc: 0.9091
val Loss: 3.5098 Acc: 0.7500
Epoch 4/71
----------
train Loss: 0.4825 Acc: 0.9856
val Loss: 3.7940 Acc: 0.6818
Epoch 5/71
----------
train Loss: 0.2492 Acc: 0.9809
val Loss: 3.8375 Acc: 0.6136
Epoch 6/71
----------
train Loss: 0.2524 Acc: 0.9904
val Loss: 3.2400 Acc: 0.7273
Epoch 7/71
----------
train Loss: 0.1397 Acc: 1.0000
val Loss: 2.9974 Acc: 0.6136
Epoch 8/71
----------
train Loss: 0.2721 Acc: 0.9809
val Loss: 3.4479 Acc: 0.5455
Epoch 9/71
----------
train Loss: 0.5446 Acc: 0.9617
val Loss: 3.4960 Acc: 0.5909
Epoch 10/71
----------
train Loss: 1.2393 Acc: 0.8708
val Loss: 4.2124 Acc: 0.6364
Epoch 11/71
----------
train Loss: 1.3056 Acc: 0.8612
val Loss: 4.6158 Acc: 0.7273
Epoch 12/71
----------
train Loss: 0.7535 Acc: 0.9234
val Loss: 3.9455 Acc: 0.7273
Epoch 13/71
----------
train Loss: 1.1820 Acc: 0.9043
val Loss: 3.0460 Acc: 0.7727
Epoch 14/71
----------
train Loss: 0.9797 Acc: 0.9187
val Loss: 4.4721 Acc: 0.6591
Epoch 15/71
----------
train Loss: 0.8106 Acc: 0.9330
val Loss: 3.8412 Acc: 0.6364
Epoch 16/71
----------
train Loss: 0.4418 Acc: 0.9378
val Loss: 4.7199 Acc: 0.3409
Epoch 17/71
----------
train Loss: 0.5218 Acc: 0.9330
val Loss: 3.6276 Acc: 0.6591
Epoch 18/71
----------
train Loss: 0.4263 Acc: 0.9809
val Loss: 4.5356 Acc: 0.7273
Epoch 19/71
----------
train Loss: 0.6018 Acc: 0.9234
val Loss: 5.5918 Acc: 0.7273
Epoch 20/71
----------
train Loss: 0.6816 Acc: 0.9522
val Loss: 4.8792 Acc: 0.7045
Epoch 21/71
----------
train Loss: 0.7818 Acc: 0.9522
val Loss: 4.6753 Acc: 0.6136
Epoch 22/71
----------
train Loss: 0.8317 Acc: 0.9378
val Loss: 3.9240 Acc: 0.4773
Epoch 23/71
----------
train Loss: 0.7199 Acc: 0.9234
val Loss: 3.2319 Acc: 0.6818
Epoch 24/71
----------
train Loss: 0.5515 Acc: 0.9474
val Loss: 5.3767 Acc: 0.6591
Epoch 25/71
----------
train Loss: 0.4124 Acc: 0.9665
val Loss: 4.6472 Acc: 0.7273
Epoch 26/71
----------
train Loss: 0.8496 Acc: 0.9091
val Loss: 7.2382 Acc: 0.4318
Epoch 27/71
----------
train Loss: 1.1422 Acc: 0.8947
val Loss: 2.9251 Acc: 0.6818
Epoch 28/71
----------
train Loss: 1.3894 Acc: 0.8852
val Loss: 4.3041 Acc: 0.7727
Epoch 29/71
----------
train Loss: 1.1307 Acc: 0.8900
val Loss: 4.0692 Acc: 0.6136
Epoch 30/71
----------
train Loss: 1.1308 Acc: 0.9187
val Loss: 4.6739 Acc: 0.6364
Epoch 31/71
----------
train Loss: 0.6687 Acc: 0.9569
val Loss: 4.3282 Acc: 0.4773
Epoch 32/71
----------
train Loss: 0.7364 Acc: 0.9091
val Loss: 3.0218 Acc: 0.6136
Epoch 33/71
----------
train Loss: 1.1164 Acc: 0.9569
[32m[I 2025-06-28 22:11:17,529][0m Trial 96 finished with value: 0.7727272727272727 and parameters: {'batch_size': 87, 'lr': 0.0007628456691271959, 'num_epochs': 71, 'weight_decay': 0.04995908831179261, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.3097 Acc: 0.7045
Early stopping at epoch 33 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_87_lr_0.0007628456691271959_epoch_71_wd_0.04995908831179261_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 2.9389 Acc: 0.4402
val Loss: 2.3096 Acc: 0.6818
Epoch 2/84
----------
train Loss: 2.5088 Acc: 0.5885
val Loss: 2.2350 Acc: 0.6818
Epoch 3/84
----------
train Loss: 2.1761 Acc: 0.6555
val Loss: 1.9277 Acc: 0.7500
Epoch 4/84
----------
train Loss: 2.0701 Acc: 0.6316
val Loss: 3.5372 Acc: 0.5682
Epoch 5/84
----------
train Loss: 2.0538 Acc: 0.7081
val Loss: 3.1994 Acc: 0.7045
Epoch 6/84
----------
train Loss: 1.8846 Acc: 0.6603
val Loss: 2.3901 Acc: 0.7273
Epoch 7/84
----------
train Loss: 1.7232 Acc: 0.7751
val Loss: 2.6797 Acc: 0.7273
Epoch 8/84
----------
train Loss: 1.8699 Acc: 0.7560
val Loss: 2.6835 Acc: 0.6818
Epoch 9/84
----------
train Loss: 1.8899 Acc: 0.7225
val Loss: 3.7253 Acc: 0.3409
Epoch 10/84
----------
train Loss: 1.3300 Acc: 0.8852
val Loss: 2.4767 Acc: 0.6591
Epoch 11/84
----------
train Loss: 2.1049 Acc: 0.6699
val Loss: 2.4911 Acc: 0.4091
Epoch 12/84
----------
train Loss: 2.0054 Acc: 0.6603
val Loss: 2.2377 Acc: 0.5000
Epoch 13/84
----------
train Loss: 1.6445 Acc: 0.7703
val Loss: 2.4514 Acc: 0.6136
Epoch 14/84
----------
train Loss: 1.4760 Acc: 0.8038
val Loss: 1.6488 Acc: 0.7045
Epoch 15/84
----------
train Loss: 1.7875 Acc: 0.7033
val Loss: 2.2764 Acc: 0.7500
Epoch 16/84
----------
train Loss: 1.7872 Acc: 0.7225
val Loss: 1.9145 Acc: 0.6818
Epoch 17/84
----------
train Loss: 1.5815 Acc: 0.8038
val Loss: 2.7376 Acc: 0.6818
Epoch 18/84
----------
train Loss: 1.5956 Acc: 0.7608
val Loss: 3.1086 Acc: 0.7500
Epoch 19/84
----------
train Loss: 1.7063 Acc: 0.7799
val Loss: 2.3524 Acc: 0.6364
Epoch 20/84
----------
train Loss: 1.6813 Acc: 0.7656
val Loss: 1.9840 Acc: 0.6591
Epoch 21/84
----------
train Loss: 1.6857 Acc: 0.8373
val Loss: 2.2642 Acc: 0.6818
Epoch 22/84
----------
train Loss: 1.5794 Acc: 0.7608
val Loss: 2.0369 Acc: 0.6364
Epoch 23/84
----------
train Loss: 1.8420 Acc: 0.7656
[32m[I 2025-06-28 22:16:31,344][0m Trial 97 finished with value: 0.75 and parameters: {'batch_size': 71, 'lr': 0.0021946277862319253, 'num_epochs': 84, 'weight_decay': 0.009558570564870165, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.9636 Acc: 0.6364
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_71_lr_0.0021946277862319253_epoch_84_wd_0.009558570564870165_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/76
----------
train Loss: 3.3261 Acc: 0.3636
val Loss: 2.8338 Acc: 0.6364
Epoch 2/76
----------
train Loss: 2.5213 Acc: 0.5407
val Loss: 1.9860 Acc: 0.6364
Epoch 3/76
----------
train Loss: 2.2387 Acc: 0.5167
val Loss: 1.9202 Acc: 0.6591
Epoch 4/76
----------
train Loss: 2.1392 Acc: 0.5455
val Loss: 1.9968 Acc: 0.7273
Epoch 5/76
----------
train Loss: 2.0522 Acc: 0.6603
val Loss: 1.8532 Acc: 0.7727
Epoch 6/76
----------
train Loss: 1.8756 Acc: 0.6794
val Loss: 1.6702 Acc: 0.7955
Epoch 7/76
----------
train Loss: 1.6311 Acc: 0.8038
val Loss: 1.4269 Acc: 0.7955
Epoch 8/76
----------
train Loss: 1.7358 Acc: 0.7560
val Loss: 1.4191 Acc: 0.8182
Epoch 9/76
----------
train Loss: 1.7441 Acc: 0.7416
val Loss: 1.8313 Acc: 0.8182
Epoch 10/76
----------
train Loss: 1.0722 Acc: 0.9474
val Loss: 1.2985 Acc: 0.8409
Epoch 11/76
----------
train Loss: 1.7739 Acc: 0.7847
val Loss: 1.3881 Acc: 0.8409
Epoch 12/76
----------
train Loss: 1.5402 Acc: 0.7416
val Loss: 2.2594 Acc: 0.6818
Epoch 13/76
----------
train Loss: 1.3746 Acc: 0.8947
val Loss: 1.7012 Acc: 0.7500
Epoch 14/76
----------
train Loss: 1.2827 Acc: 0.8278
val Loss: 1.5399 Acc: 0.7500
Epoch 15/76
----------
train Loss: 1.4447 Acc: 0.8325
val Loss: 1.2459 Acc: 0.7727
Epoch 16/76
----------
train Loss: 1.4672 Acc: 0.7990
val Loss: 1.4750 Acc: 0.8182
Epoch 17/76
----------
train Loss: 1.4088 Acc: 0.8325
val Loss: 1.7981 Acc: 0.7955
Epoch 18/76
----------
train Loss: 1.3488 Acc: 0.8086
val Loss: 1.4340 Acc: 0.7727
Epoch 19/76
----------
train Loss: 1.2523 Acc: 0.9234
val Loss: 1.2712 Acc: 0.7955
Epoch 20/76
----------
train Loss: 1.3869 Acc: 0.8278
val Loss: 1.2551 Acc: 0.7273
Epoch 21/76
----------
train Loss: 1.4793 Acc: 0.8756
val Loss: 1.2751 Acc: 0.7727
Epoch 22/76
----------
train Loss: 1.2988 Acc: 0.8756
val Loss: 1.4864 Acc: 0.7955
Epoch 23/76
----------
train Loss: 1.5146 Acc: 0.8660
val Loss: 1.4038 Acc: 0.7727
Epoch 24/76
----------
train Loss: 1.1889 Acc: 0.9043
val Loss: 1.1881 Acc: 0.8182
Epoch 25/76
----------
train Loss: 1.3056 Acc: 0.9234
val Loss: 1.5364 Acc: 0.7727
Epoch 26/76
----------
train Loss: 1.4554 Acc: 0.9187
val Loss: 1.3220 Acc: 0.7955
Epoch 27/76
----------
train Loss: 1.2292 Acc: 0.9569
val Loss: 1.6130 Acc: 0.7727
Epoch 28/76
----------
train Loss: 1.4415 Acc: 0.8373
val Loss: 1.3846 Acc: 0.7955
Epoch 29/76
----------
train Loss: 1.5231 Acc: 0.7799
val Loss: 1.5413 Acc: 0.8182
Epoch 30/76
----------
train Loss: 1.4016 Acc: 0.8278
val Loss: 1.2342 Acc: 0.7727
Epoch 31/76
----------
train Loss: 1.1681 Acc: 0.9282
val Loss: 1.3251 Acc: 0.7500
Epoch 32/76
----------
train Loss: 1.3169 Acc: 0.8900
val Loss: 1.4030 Acc: 0.7273
Epoch 33/76
----------
train Loss: 1.3916 Acc: 0.8612
val Loss: 1.6050 Acc: 0.6591
Epoch 34/76
----------
train Loss: 1.4095 Acc: 0.9091
val Loss: 1.6546 Acc: 0.7500
Epoch 35/76
----------
train Loss: 1.0953 Acc: 0.9474
val Loss: 1.4179 Acc: 0.7273
Epoch 36/76
----------
train Loss: 1.6137 Acc: 0.8517
val Loss: 1.2604 Acc: 0.7727
Epoch 37/76
----------
train Loss: 1.3657 Acc: 0.8517
val Loss: 1.6531 Acc: 0.7500
Epoch 38/76
----------
train Loss: 1.4173 Acc: 0.9378
val Loss: 1.5026 Acc: 0.7727
Epoch 39/76
----------
train Loss: 1.3879 Acc: 0.7751
val Loss: 1.8415 Acc: 0.7045
Epoch 40/76
----------
train Loss: 1.2402 Acc: 0.8995
val Loss: 1.6139 Acc: 0.7727
Epoch 41/76
----------
train Loss: 1.6171 Acc: 0.6938
val Loss: 1.8299 Acc: 0.7500
Epoch 42/76
----------
train Loss: 1.2658 Acc: 0.8373
val Loss: 1.7217 Acc: 0.6364
Epoch 43/76
----------
train Loss: 1.3154 Acc: 0.8852
val Loss: 1.3521 Acc: 0.7955
Epoch 44/76
----------
train Loss: 1.3067 Acc: 0.8612
val Loss: 1.7875 Acc: 0.7045
Epoch 45/76
----------
train Loss: 0.8454 Acc: 0.9617
val Loss: 1.6016 Acc: 0.6818
Epoch 46/76
----------
train Loss: 1.6917 Acc: 0.8230
val Loss: 1.9275 Acc: 0.6591
Epoch 47/76
----------
train Loss: 1.3461 Acc: 0.9091
val Loss: 1.8388 Acc: 0.7500
Epoch 48/76
----------
train Loss: 1.3626 Acc: 0.8660
val Loss: 1.8491 Acc: 0.7045
Epoch 49/76
----------
train Loss: 1.3621 Acc: 0.8900
val Loss: 1.5230 Acc: 0.7273
Epoch 50/76
----------
train Loss: 1.3370 Acc: 0.8421
val Loss: 1.5120 Acc: 0.7727
Epoch 51/76
----------
train Loss: 1.0271 Acc: 0.9809
val Loss: 1.6194 Acc: 0.7045
Epoch 52/76
----------
train Loss: 1.3381 Acc: 0.8373
val Loss: 1.1956 Acc: 0.7727
Epoch 53/76
----------
train Loss: 1.5287 Acc: 0.9091
val Loss: 1.3512 Acc: 0.7955
Epoch 54/76
----------
train Loss: 1.2516 Acc: 0.9139
val Loss: 1.3542 Acc: 0.7727
Epoch 55/76
----------
train Loss: 1.1946 Acc: 0.9522
val Loss: 1.4400 Acc: 0.6818
Epoch 56/76
----------
train Loss: 1.4241 Acc: 0.8995
val Loss: 1.2957 Acc: 0.7500
Epoch 57/76
----------
train Loss: 1.5563 Acc: 0.8421
val Loss: 1.5081 Acc: 0.7500
Epoch 58/76
----------
train Loss: 1.2770 Acc: 0.8230
val Loss: 1.5587 Acc: 0.7273
Epoch 59/76
----------
train Loss: 1.3442 Acc: 0.8900
val Loss: 1.7233 Acc: 0.7273
Epoch 60/76
----------
train Loss: 1.1252 Acc: 0.8852
val Loss: 1.7518 Acc: 0.6364
Epoch 61/76
----------
train Loss: 1.5743 Acc: 0.7656
val Loss: 1.7514 Acc: 0.6136
Epoch 62/76
----------
train Loss: 1.5473 Acc: 0.9091
val Loss: 1.8002 Acc: 0.7045
Epoch 63/76
----------
train Loss: 1.2757 Acc: 0.9139
val Loss: 1.7587 Acc: 0.6818
Epoch 64/76
----------
train Loss: 1.1567 Acc: 0.9474
val Loss: 1.5611 Acc: 0.7955
Epoch 65/76
----------
train Loss: 1.3187 Acc: 0.8852
val Loss: 1.5385 Acc: 0.6818
Epoch 66/76
----------
train Loss: 1.3263 Acc: 0.8995
val Loss: 1.6253 Acc: 0.7727
Epoch 67/76
----------
train Loss: 1.5481 Acc: 0.8421
val Loss: 1.6913 Acc: 0.7045
Epoch 68/76
----------
train Loss: 1.2296 Acc: 0.8852
val Loss: 1.4880 Acc: 0.7727
Epoch 69/76
----------
train Loss: 1.2446 Acc: 0.8469
val Loss: 1.3348 Acc: 0.7500
Epoch 70/76
----------
train Loss: 1.3702 Acc: 0.8995
val Loss: 1.5356 Acc: 0.7500
Epoch 71/76
----------
train Loss: 1.4317 Acc: 0.9187
val Loss: 1.8537 Acc: 0.6591
Epoch 72/76
----------
train Loss: 1.4489 Acc: 0.8804
val Loss: 1.4416 Acc: 0.7273
Epoch 73/76
----------
train Loss: 1.0448 Acc: 0.9330
val Loss: 1.5707 Acc: 0.7500
Epoch 74/76
----------
train Loss: 1.5114 Acc: 0.8469
val Loss: 1.4970 Acc: 0.7500
Epoch 75/76
----------
train Loss: 1.2424 Acc: 0.9330
val Loss: 1.6786 Acc: 0.7273
Epoch 76/76
----------
train Loss: 1.1813 Acc: 0.8708
[32m[I 2025-06-28 22:33:48,237][0m Trial 98 finished with value: 0.7727272727272727 and parameters: {'batch_size': 21, 'lr': 0.0005349694302784464, 'num_epochs': 76, 'weight_decay': 0.0173733492415023, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 2.1091 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_21_lr_0.0005349694302784464_epoch_76_wd_0.0173733492415023_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/82
----------
train Loss: 2.9524 Acc: 0.4163
val Loss: 2.1540 Acc: 0.6364
Epoch 2/82
----------
train Loss: 2.4306 Acc: 0.5646
val Loss: 4.0196 Acc: 0.3864
Epoch 3/82
----------
train Loss: 2.1261 Acc: 0.6364
val Loss: 3.0333 Acc: 0.6591
Epoch 4/82
----------
train Loss: 2.0795 Acc: 0.6507
val Loss: 5.1308 Acc: 0.3864
Epoch 5/82
----------
train Loss: 1.9242 Acc: 0.7273
val Loss: 4.7735 Acc: 0.3182
Epoch 6/82
----------
train Loss: 1.8331 Acc: 0.7225
val Loss: 4.4374 Acc: 0.6591
Epoch 7/82
----------
train Loss: 1.6537 Acc: 0.7943
val Loss: 3.8637 Acc: 0.6591
Epoch 8/82
----------
train Loss: 1.9453 Acc: 0.7129
val Loss: 3.5406 Acc: 0.7955
Epoch 9/82
----------
train Loss: 1.8649 Acc: 0.7512
val Loss: 4.8781 Acc: 0.3864
Epoch 10/82
----------
train Loss: 1.2268 Acc: 0.9043
val Loss: 3.2022 Acc: 0.6591
Epoch 11/82
----------
train Loss: 2.0395 Acc: 0.7368
val Loss: 3.2343 Acc: 0.5455
Epoch 12/82
----------
train Loss: 1.7137 Acc: 0.7321
val Loss: 4.5625 Acc: 0.2955
Epoch 13/82
----------
train Loss: 1.7404 Acc: 0.7799
[32m[I 2025-06-28 22:36:46,897][0m Trial 99 finished with value: 0.7954545454545455 and parameters: {'batch_size': 82, 'lr': 0.0013631008841805763, 'num_epochs': 82, 'weight_decay': 0.0256619058120488, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.0638 Acc: 0.5682
Early stopping at epoch 13 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_82_lr_0.0013631008841805763_epoch_82_wd_0.0256619058120488_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/89
----------
train Loss: 0.6812 Acc: 0.2727
val Loss: 0.6515 Acc: 0.3182
Epoch 2/89
----------
train Loss: 0.6271 Acc: 0.4306
val Loss: 0.6069 Acc: 0.4773
Epoch 3/89
----------
train Loss: 0.5866 Acc: 0.4498
val Loss: 0.5539 Acc: 0.6136
Epoch 4/89
----------
train Loss: 0.5574 Acc: 0.4928
val Loss: 0.5196 Acc: 0.6364
Epoch 5/89
----------
train Loss: 0.5360 Acc: 0.4976
val Loss: 0.5010 Acc: 0.6364
Epoch 6/89
----------
train Loss: 0.5086 Acc: 0.5072
val Loss: 0.4715 Acc: 0.6364
Epoch 7/89
----------
train Loss: 0.4834 Acc: 0.5072
val Loss: 0.4469 Acc: 0.6364
Epoch 8/89
----------
train Loss: 0.4816 Acc: 0.5120
val Loss: 0.4220 Acc: 0.6591
Epoch 9/89
----------
train Loss: 0.4705 Acc: 0.5455
val Loss: 0.4056 Acc: 0.6591
Epoch 10/89
----------
train Loss: 0.4199 Acc: 0.5694
val Loss: 0.3918 Acc: 0.6818
Epoch 11/89
----------
train Loss: 0.4399 Acc: 0.5550
val Loss: 0.3762 Acc: 0.7045
Epoch 12/89
----------
train Loss: 0.4442 Acc: 0.5837
val Loss: 0.3819 Acc: 0.7045
Epoch 13/89
----------
train Loss: 0.4103 Acc: 0.6603
val Loss: 0.3646 Acc: 0.7045
Epoch 14/89
----------
train Loss: 0.3806 Acc: 0.6794
val Loss: 0.3448 Acc: 0.7273
Epoch 15/89
----------
train Loss: 0.4001 Acc: 0.6555
val Loss: 0.3358 Acc: 0.7727
Epoch 16/89
----------
train Loss: 0.3890 Acc: 0.7321
val Loss: 0.3403 Acc: 0.7727
Epoch 17/89
----------
train Loss: 0.3798 Acc: 0.7321
val Loss: 0.3383 Acc: 0.7500
Epoch 18/89
----------
train Loss: 0.3549 Acc: 0.7464
val Loss: 0.3270 Acc: 0.7500
Epoch 19/89
----------
train Loss: 0.3329 Acc: 0.8086
val Loss: 0.3168 Acc: 0.7500
Epoch 20/89
----------
train Loss: 0.3463 Acc: 0.7895
val Loss: 0.2981 Acc: 0.7500
Epoch 21/89
----------
train Loss: 0.3538 Acc: 0.7751
val Loss: 0.2847 Acc: 0.7727
Epoch 22/89
----------
train Loss: 0.3381 Acc: 0.7895
val Loss: 0.2846 Acc: 0.7500
Epoch 23/89
----------
train Loss: 0.3320 Acc: 0.8373
val Loss: 0.2850 Acc: 0.7955
Epoch 24/89
----------
train Loss: 0.2836 Acc: 0.8947
val Loss: 0.2718 Acc: 0.7955
Epoch 25/89
----------
train Loss: 0.3078 Acc: 0.8660
val Loss: 0.2876 Acc: 0.7955
Epoch 26/89
----------
train Loss: 0.3236 Acc: 0.8756
val Loss: 0.2968 Acc: 0.7727
Epoch 27/89
----------
train Loss: 0.2658 Acc: 0.9522
val Loss: 0.3022 Acc: 0.7955
Epoch 28/89
----------
train Loss: 0.3231 Acc: 0.8612
val Loss: 0.2870 Acc: 0.7727
Epoch 29/89
----------
train Loss: 0.3489 Acc: 0.7464
val Loss: 0.2930 Acc: 0.7955
Epoch 30/89
----------
train Loss: 0.2992 Acc: 0.8517
val Loss: 0.2805 Acc: 0.7727
Epoch 31/89
----------
train Loss: 0.2553 Acc: 0.9234
val Loss: 0.2648 Acc: 0.7955
Epoch 32/89
----------
train Loss: 0.2870 Acc: 0.8373
val Loss: 0.2640 Acc: 0.7955
Epoch 33/89
----------
train Loss: 0.2972 Acc: 0.8660
val Loss: 0.2651 Acc: 0.7500
Epoch 34/89
----------
train Loss: 0.2806 Acc: 0.9139
val Loss: 0.2748 Acc: 0.7727
Epoch 35/89
----------
train Loss: 0.2271 Acc: 0.9617
val Loss: 0.2949 Acc: 0.7273
Epoch 36/89
----------
train Loss: 0.3312 Acc: 0.8134
val Loss: 0.2917 Acc: 0.7727
Epoch 37/89
----------
train Loss: 0.2758 Acc: 0.8038
val Loss: 0.2862 Acc: 0.7500
Epoch 38/89
----------
train Loss: 0.2823 Acc: 0.9522
val Loss: 0.2696 Acc: 0.8182
Epoch 39/89
----------
train Loss: 0.3038 Acc: 0.7656
val Loss: 0.2862 Acc: 0.7955
Epoch 40/89
----------
train Loss: 0.2536 Acc: 0.8900
val Loss: 0.2782 Acc: 0.7955
Epoch 41/89
----------
train Loss: 0.3456 Acc: 0.7416
val Loss: 0.2720 Acc: 0.8182
Epoch 42/89
----------
train Loss: 0.2487 Acc: 0.8565
val Loss: 0.2738 Acc: 0.8182
Epoch 43/89
----------
train Loss: 0.2794 Acc: 0.8660
val Loss: 0.2665 Acc: 0.8182
Epoch 44/89
----------
train Loss: 0.2579 Acc: 0.8612
val Loss: 0.2781 Acc: 0.7727
Epoch 45/89
----------
train Loss: 0.1644 Acc: 0.9665
val Loss: 0.2688 Acc: 0.7500
Epoch 46/89
----------
train Loss: 0.3587 Acc: 0.8278
val Loss: 0.2770 Acc: 0.7727
Epoch 47/89
----------
train Loss: 0.2571 Acc: 0.8804
val Loss: 0.2737 Acc: 0.7955
Epoch 48/89
----------
train Loss: 0.2848 Acc: 0.8756
val Loss: 0.2651 Acc: 0.7500
Epoch 49/89
----------
train Loss: 0.2742 Acc: 0.9474
val Loss: 0.2717 Acc: 0.7727
Epoch 50/89
----------
train Loss: 0.2658 Acc: 0.8852
val Loss: 0.2720 Acc: 0.7500
Epoch 51/89
----------
train Loss: 0.2024 Acc: 0.9809
val Loss: 0.2520 Acc: 0.7727
Epoch 52/89
----------
train Loss: 0.2817 Acc: 0.8469
val Loss: 0.2469 Acc: 0.7955
Epoch 53/89
----------
train Loss: 0.3188 Acc: 0.9139
val Loss: 0.2632 Acc: 0.7045
Epoch 54/89
----------
train Loss: 0.2356 Acc: 0.9282
val Loss: 0.2685 Acc: 0.7727
Epoch 55/89
----------
train Loss: 0.2507 Acc: 0.9426
val Loss: 0.2952 Acc: 0.7045
Epoch 56/89
----------
train Loss: 0.2960 Acc: 0.9043
val Loss: 0.2704 Acc: 0.7045
Epoch 57/89
----------
train Loss: 0.3326 Acc: 0.8278
val Loss: 0.2716 Acc: 0.7955
Epoch 58/89
----------
train Loss: 0.2689 Acc: 0.8038
val Loss: 0.2643 Acc: 0.7500
Epoch 59/89
----------
train Loss: 0.2833 Acc: 0.8756
val Loss: 0.2818 Acc: 0.7727
Epoch 60/89
----------
train Loss: 0.2344 Acc: 0.8947
val Loss: 0.2729 Acc: 0.7500
Epoch 61/89
----------
train Loss: 0.3276 Acc: 0.7416
val Loss: 0.2528 Acc: 0.7273
Epoch 62/89
----------
train Loss: 0.2917 Acc: 0.9282
val Loss: 0.2547 Acc: 0.7500
Epoch 63/89
----------
train Loss: 0.2524 Acc: 0.9426
val Loss: 0.2679 Acc: 0.7955
Epoch 64/89
----------
train Loss: 0.2376 Acc: 0.9569
val Loss: 0.2661 Acc: 0.8182
Epoch 65/89
----------
train Loss: 0.2668 Acc: 0.8612
val Loss: 0.2755 Acc: 0.8182
Epoch 66/89
----------
train Loss: 0.2651 Acc: 0.8995
val Loss: 0.2811 Acc: 0.7955
Epoch 67/89
----------
train Loss: 0.2998 Acc: 0.8900
val Loss: 0.2714 Acc: 0.7727
Epoch 68/89
----------
train Loss: 0.2536 Acc: 0.9043
val Loss: 0.2830 Acc: 0.7500
Epoch 69/89
----------
train Loss: 0.2486 Acc: 0.8947
val Loss: 0.2752 Acc: 0.7727
Epoch 70/89
----------
train Loss: 0.2869 Acc: 0.8900
val Loss: 0.2729 Acc: 0.7727
Epoch 71/89
----------
train Loss: 0.2969 Acc: 0.9234
val Loss: 0.2741 Acc: 0.7955
Epoch 72/89
----------
train Loss: 0.2922 Acc: 0.8660
val Loss: 0.2790 Acc: 0.8182
Epoch 73/89
----------
train Loss: 0.2146 Acc: 0.9713
val Loss: 0.2697 Acc: 0.8182
Epoch 74/89
----------
train Loss: 0.3074 Acc: 0.8660
val Loss: 0.2598 Acc: 0.7727
Epoch 75/89
----------
train Loss: 0.2220 Acc: 0.9761
val Loss: 0.2534 Acc: 0.7727
Epoch 76/89
----------
train Loss: 0.2370 Acc: 0.8469
val Loss: 0.2548 Acc: 0.8182
Epoch 77/89
----------
train Loss: 0.2860 Acc: 0.8660
val Loss: 0.2913 Acc: 0.8409
Epoch 78/89
----------
train Loss: 0.2438 Acc: 0.8947
val Loss: 0.2995 Acc: 0.8409
Epoch 79/89
----------
train Loss: 0.2993 Acc: 0.8708
val Loss: 0.2667 Acc: 0.7955
Epoch 80/89
----------
train Loss: 0.2738 Acc: 0.8421
val Loss: 0.2762 Acc: 0.7955
Epoch 81/89
----------
train Loss: 0.3164 Acc: 0.7990
val Loss: 0.3058 Acc: 0.7500
Epoch 82/89
----------
train Loss: 0.2651 Acc: 0.8804
val Loss: 0.3109 Acc: 0.7273
Epoch 83/89
----------
train Loss: 0.2394 Acc: 0.9665
val Loss: 0.2828 Acc: 0.7727
Epoch 84/89
----------
train Loss: 0.3008 Acc: 0.7943
val Loss: 0.2649 Acc: 0.7955
Epoch 85/89
----------
train Loss: 0.2361 Acc: 0.8756
val Loss: 0.2805 Acc: 0.7727
Epoch 86/89
----------
train Loss: 0.2449 Acc: 0.8852
val Loss: 0.2677 Acc: 0.7500
Epoch 87/89
----------
train Loss: 0.2784 Acc: 0.9378
val Loss: 0.2825 Acc: 0.8182
Epoch 88/89
----------
train Loss: 0.3034 Acc: 0.8995
val Loss: 0.2524 Acc: 0.7955
Epoch 89/89
----------
train Loss: 0.3240 Acc: 0.8325
[32m[I 2025-06-28 22:57:02,448][0m Trial 100 finished with value: 0.7954545454545455 and parameters: {'batch_size': 15, 'lr': 0.00014589410279944835, 'num_epochs': 89, 'weight_decay': 0.006233135268442062, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2526 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_15_lr_0.00014589410279944835_epoch_89_wd_0.006233135268442062_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/91
----------
train Loss: 0.6924 Acc: 0.2440
val Loss: 0.6722 Acc: 0.2955
Epoch 2/91
----------
train Loss: 0.6611 Acc: 0.3158
val Loss: 0.6472 Acc: 0.3636
Epoch 3/91
----------
train Loss: 0.6357 Acc: 0.3923
val Loss: 0.6129 Acc: 0.4318
Epoch 4/91
----------
train Loss: 0.6165 Acc: 0.4402
val Loss: 0.5890 Acc: 0.5000
Epoch 5/91
----------
train Loss: 0.6015 Acc: 0.4976
val Loss: 0.5727 Acc: 0.5682
Epoch 6/91
----------
train Loss: 0.5776 Acc: 0.5120
val Loss: 0.5496 Acc: 0.6136
Epoch 7/91
----------
train Loss: 0.5530 Acc: 0.5598
val Loss: 0.5236 Acc: 0.6136
Epoch 8/91
----------
train Loss: 0.5422 Acc: 0.5407
val Loss: 0.5013 Acc: 0.6818
Epoch 9/91
----------
train Loss: 0.5256 Acc: 0.5646
val Loss: 0.4794 Acc: 0.6818
Epoch 10/91
----------
train Loss: 0.4882 Acc: 0.5789
val Loss: 0.4587 Acc: 0.6591
Epoch 11/91
----------
train Loss: 0.4957 Acc: 0.5646
val Loss: 0.4433 Acc: 0.6818
Epoch 12/91
----------
train Loss: 0.4921 Acc: 0.5598
val Loss: 0.4347 Acc: 0.6818
Epoch 13/91
----------
train Loss: 0.4598 Acc: 0.6268
val Loss: 0.4165 Acc: 0.6591
Epoch 14/91
----------
train Loss: 0.4393 Acc: 0.6172
val Loss: 0.4044 Acc: 0.6818
Epoch 15/91
----------
train Loss: 0.4460 Acc: 0.5981
val Loss: 0.3934 Acc: 0.7273
Epoch 16/91
----------
train Loss: 0.4368 Acc: 0.6316
val Loss: 0.3835 Acc: 0.7500
Epoch 17/91
----------
train Loss: 0.4255 Acc: 0.6364
val Loss: 0.3742 Acc: 0.7273
Epoch 18/91
----------
train Loss: 0.4117 Acc: 0.6842
val Loss: 0.3630 Acc: 0.7273
Epoch 19/91
----------
train Loss: 0.3932 Acc: 0.7560
val Loss: 0.3566 Acc: 0.7500
Epoch 20/91
----------
train Loss: 0.4015 Acc: 0.7129
val Loss: 0.3453 Acc: 0.7500
Epoch 21/91
----------
train Loss: 0.3995 Acc: 0.7177
val Loss: 0.3359 Acc: 0.7727
Epoch 22/91
----------
train Loss: 0.3902 Acc: 0.7177
val Loss: 0.3307 Acc: 0.7955
Epoch 23/91
----------
train Loss: 0.3851 Acc: 0.7225
val Loss: 0.3223 Acc: 0.7955
Epoch 24/91
----------
train Loss: 0.3469 Acc: 0.7943
val Loss: 0.3083 Acc: 0.7727
Epoch 25/91
----------
train Loss: 0.3699 Acc: 0.7177
val Loss: 0.3109 Acc: 0.7955
Epoch 26/91
----------
train Loss: 0.3736 Acc: 0.7895
val Loss: 0.3102 Acc: 0.7955
Epoch 27/91
----------
train Loss: 0.3246 Acc: 0.8612
val Loss: 0.3082 Acc: 0.8182
Epoch 28/91
----------
train Loss: 0.3709 Acc: 0.7560
val Loss: 0.3061 Acc: 0.7955
Epoch 29/91
----------
train Loss: 0.3915 Acc: 0.6938
val Loss: 0.3063 Acc: 0.8182
Epoch 30/91
----------
train Loss: 0.3542 Acc: 0.7368
val Loss: 0.2998 Acc: 0.7955
Epoch 31/91
----------
train Loss: 0.3117 Acc: 0.8565
val Loss: 0.2902 Acc: 0.8182
Epoch 32/91
----------
train Loss: 0.3361 Acc: 0.7799
val Loss: 0.2836 Acc: 0.7727
Epoch 33/91
----------
train Loss: 0.3554 Acc: 0.7799
val Loss: 0.2833 Acc: 0.7955
Epoch 34/91
----------
train Loss: 0.3288 Acc: 0.8469
val Loss: 0.2820 Acc: 0.7727
Epoch 35/91
----------
train Loss: 0.2799 Acc: 0.9234
val Loss: 0.2858 Acc: 0.7955
Epoch 36/91
----------
train Loss: 0.3701 Acc: 0.7368
val Loss: 0.2834 Acc: 0.7955
Epoch 37/91
----------
train Loss: 0.3131 Acc: 0.8038
val Loss: 0.2894 Acc: 0.7727
Epoch 38/91
----------
train Loss: 0.3116 Acc: 0.9234
val Loss: 0.2834 Acc: 0.7727
Epoch 39/91
----------
train Loss: 0.3411 Acc: 0.7321
val Loss: 0.2895 Acc: 0.7500
Epoch 40/91
----------
train Loss: 0.2855 Acc: 0.8421
val Loss: 0.2858 Acc: 0.7727
Epoch 41/91
----------
train Loss: 0.3580 Acc: 0.7321
val Loss: 0.2793 Acc: 0.7955
Epoch 42/91
----------
train Loss: 0.2892 Acc: 0.8182
val Loss: 0.2713 Acc: 0.7955
Epoch 43/91
----------
train Loss: 0.3120 Acc: 0.8278
val Loss: 0.2684 Acc: 0.7955
Epoch 44/91
----------
train Loss: 0.2862 Acc: 0.8469
val Loss: 0.2691 Acc: 0.8182
Epoch 45/91
----------
train Loss: 0.1914 Acc: 0.9665
val Loss: 0.2679 Acc: 0.8182
Epoch 46/91
----------
train Loss: 0.3696 Acc: 0.8182
val Loss: 0.2713 Acc: 0.8182
Epoch 47/91
----------
train Loss: 0.2758 Acc: 0.8708
val Loss: 0.2666 Acc: 0.8182
Epoch 48/91
----------
train Loss: 0.3085 Acc: 0.8182
val Loss: 0.2699 Acc: 0.8182
Epoch 49/91
----------
train Loss: 0.2917 Acc: 0.9091
val Loss: 0.2691 Acc: 0.7955
Epoch 50/91
----------
train Loss: 0.2841 Acc: 0.8612
val Loss: 0.2697 Acc: 0.7955
Epoch 51/91
----------
train Loss: 0.2166 Acc: 0.9856
val Loss: 0.2641 Acc: 0.7955
Epoch 52/91
----------
train Loss: 0.3000 Acc: 0.7895
val Loss: 0.2664 Acc: 0.7727
Epoch 53/91
----------
train Loss: 0.3327 Acc: 0.9043
val Loss: 0.2639 Acc: 0.7727
Epoch 54/91
----------
train Loss: 0.2466 Acc: 0.9234
val Loss: 0.2578 Acc: 0.7955
Epoch 55/91
----------
train Loss: 0.2628 Acc: 0.9234
val Loss: 0.2580 Acc: 0.7727
Epoch 56/91
----------
train Loss: 0.3062 Acc: 0.8565
val Loss: 0.2592 Acc: 0.7727
Epoch 57/91
----------
train Loss: 0.3438 Acc: 0.7990
val Loss: 0.2574 Acc: 0.8182
Epoch 58/91
----------
train Loss: 0.2847 Acc: 0.7990
val Loss: 0.2540 Acc: 0.8182
Epoch 59/91
----------
train Loss: 0.2957 Acc: 0.8660
val Loss: 0.2538 Acc: 0.7955
Epoch 60/91
----------
train Loss: 0.2487 Acc: 0.8565
val Loss: 0.2562 Acc: 0.7955
Epoch 61/91
----------
train Loss: 0.3374 Acc: 0.7416
val Loss: 0.2594 Acc: 0.7955
Epoch 62/91
----------
train Loss: 0.3000 Acc: 0.9474
val Loss: 0.2594 Acc: 0.7727
Epoch 63/91
----------
train Loss: 0.2587 Acc: 0.9330
val Loss: 0.2588 Acc: 0.7727
Epoch 64/91
----------
train Loss: 0.2452 Acc: 0.9330
val Loss: 0.2572 Acc: 0.7955
Epoch 65/91
----------
train Loss: 0.2800 Acc: 0.8134
val Loss: 0.2598 Acc: 0.7955
Epoch 66/91
----------
train Loss: 0.2721 Acc: 0.8947
val Loss: 0.2643 Acc: 0.7955
Epoch 67/91
----------
train Loss: 0.3053 Acc: 0.8660
val Loss: 0.2584 Acc: 0.8182
Epoch 68/91
----------
train Loss: 0.2551 Acc: 0.8947
val Loss: 0.2620 Acc: 0.7955
Epoch 69/91
----------
train Loss: 0.2544 Acc: 0.8852
val Loss: 0.2585 Acc: 0.7955
Epoch 70/91
----------
train Loss: 0.2872 Acc: 0.8947
val Loss: 0.2594 Acc: 0.7727
Epoch 71/91
----------
train Loss: 0.3019 Acc: 0.9091
val Loss: 0.2576 Acc: 0.7727
Epoch 72/91
----------
train Loss: 0.3031 Acc: 0.8852
val Loss: 0.2634 Acc: 0.7500
Epoch 73/91
----------
train Loss: 0.2155 Acc: 0.9665
val Loss: 0.2681 Acc: 0.7500
Epoch 74/91
----------
train Loss: 0.3168 Acc: 0.8517
val Loss: 0.2629 Acc: 0.7727
Epoch 75/91
----------
train Loss: 0.2354 Acc: 0.9426
val Loss: 0.2611 Acc: 0.7273
Epoch 76/91
----------
train Loss: 0.2564 Acc: 0.8230
val Loss: 0.2581 Acc: 0.7727
Epoch 77/91
----------
train Loss: 0.2929 Acc: 0.8469
val Loss: 0.2571 Acc: 0.7727
Epoch 78/91
----------
train Loss: 0.2536 Acc: 0.8804
val Loss: 0.2575 Acc: 0.7955
Epoch 79/91
----------
train Loss: 0.3109 Acc: 0.8517
val Loss: 0.2532 Acc: 0.7955
Epoch 80/91
----------
train Loss: 0.2736 Acc: 0.8469
val Loss: 0.2532 Acc: 0.8636
Epoch 81/91
----------
train Loss: 0.3157 Acc: 0.7943
val Loss: 0.2632 Acc: 0.7727
Epoch 82/91
----------
train Loss: 0.2724 Acc: 0.8325
val Loss: 0.2669 Acc: 0.7727
Epoch 83/91
----------
train Loss: 0.2356 Acc: 0.9617
val Loss: 0.2677 Acc: 0.7727
Epoch 84/91
----------
train Loss: 0.3121 Acc: 0.7751
val Loss: 0.2649 Acc: 0.7727
Epoch 85/91
----------
train Loss: 0.2465 Acc: 0.8182
[32m[I 2025-06-28 23:16:22,026][0m Trial 101 finished with value: 0.8636363636363636 and parameters: {'batch_size': 13, 'lr': 5.552401851313316e-05, 'num_epochs': 91, 'weight_decay': 0.00045453235678269915, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2636 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_13_lr_5.552401851313316e-05_epoch_91_wd_0.00045453235678269915_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 0.6934 Acc: 0.2297
val Loss: 0.6740 Acc: 0.2955
Epoch 2/86
----------
train Loss: 0.6646 Acc: 0.3062
val Loss: 0.6514 Acc: 0.3182
Epoch 3/86
----------
train Loss: 0.6411 Acc: 0.3780
val Loss: 0.6202 Acc: 0.4318
Epoch 4/86
----------
train Loss: 0.6237 Acc: 0.4115
val Loss: 0.5991 Acc: 0.4318
Epoch 5/86
----------
train Loss: 0.6103 Acc: 0.4737
val Loss: 0.5846 Acc: 0.5227
Epoch 6/86
----------
train Loss: 0.5883 Acc: 0.5024
val Loss: 0.5642 Acc: 0.5909
Epoch 7/86
----------
train Loss: 0.5657 Acc: 0.5455
val Loss: 0.5408 Acc: 0.6136
Epoch 8/86
----------
train Loss: 0.5546 Acc: 0.5311
val Loss: 0.5201 Acc: 0.6364
Epoch 9/86
----------
train Loss: 0.5385 Acc: 0.5694
val Loss: 0.4991 Acc: 0.6818
Epoch 10/86
----------
train Loss: 0.5045 Acc: 0.5789
val Loss: 0.4778 Acc: 0.6591
Epoch 11/86
----------
train Loss: 0.5101 Acc: 0.5550
val Loss: 0.4628 Acc: 0.6818
Epoch 12/86
----------
train Loss: 0.5050 Acc: 0.5646
val Loss: 0.4537 Acc: 0.6818
Epoch 13/86
----------
train Loss: 0.4745 Acc: 0.6077
val Loss: 0.4348 Acc: 0.6818
Epoch 14/86
----------
train Loss: 0.4549 Acc: 0.6077
val Loss: 0.4234 Acc: 0.6591
Epoch 15/86
----------
train Loss: 0.4592 Acc: 0.5981
val Loss: 0.4123 Acc: 0.7045
Epoch 16/86
----------
train Loss: 0.4497 Acc: 0.6172
val Loss: 0.4008 Acc: 0.7045
Epoch 17/86
----------
train Loss: 0.4387 Acc: 0.6029
val Loss: 0.3907 Acc: 0.7045
Epoch 18/86
----------
train Loss: 0.4261 Acc: 0.6555
val Loss: 0.3791 Acc: 0.7045
Epoch 19/86
----------
train Loss: 0.4085 Acc: 0.7081
val Loss: 0.3722 Acc: 0.7727
Epoch 20/86
----------
train Loss: 0.4142 Acc: 0.7033
val Loss: 0.3608 Acc: 0.7273
Epoch 21/86
----------
train Loss: 0.4117 Acc: 0.6794
val Loss: 0.3516 Acc: 0.7500
Epoch 22/86
----------
train Loss: 0.4035 Acc: 0.6699
val Loss: 0.3457 Acc: 0.7500
Epoch 23/86
----------
train Loss: 0.3969 Acc: 0.7033
val Loss: 0.3366 Acc: 0.7727
Epoch 24/86
----------
train Loss: 0.3617 Acc: 0.7799
val Loss: 0.3225 Acc: 0.7727
Epoch 25/86
----------
train Loss: 0.3839 Acc: 0.7081
val Loss: 0.3247 Acc: 0.7955
Epoch 26/86
----------
train Loss: 0.3860 Acc: 0.7464
val Loss: 0.3236 Acc: 0.7955
Epoch 27/86
----------
train Loss: 0.3400 Acc: 0.8278
val Loss: 0.3196 Acc: 0.8182
Epoch 28/86
----------
train Loss: 0.3820 Acc: 0.7368
val Loss: 0.3169 Acc: 0.7955
Epoch 29/86
----------
train Loss: 0.4013 Acc: 0.6651
val Loss: 0.3160 Acc: 0.7955
Epoch 30/86
----------
train Loss: 0.3677 Acc: 0.7177
val Loss: 0.3112 Acc: 0.7727
Epoch 31/86
----------
train Loss: 0.3265 Acc: 0.8421
val Loss: 0.3021 Acc: 0.7727
Epoch 32/86
----------
train Loss: 0.3488 Acc: 0.7608
val Loss: 0.2946 Acc: 0.7727
Epoch 33/86
----------
train Loss: 0.3677 Acc: 0.7751
val Loss: 0.2938 Acc: 0.7727
Epoch 34/86
----------
train Loss: 0.3408 Acc: 0.8325
val Loss: 0.2915 Acc: 0.7727
Epoch 35/86
----------
train Loss: 0.2953 Acc: 0.8947
val Loss: 0.2936 Acc: 0.7955
Epoch 36/86
----------
train Loss: 0.3795 Acc: 0.7321
val Loss: 0.2902 Acc: 0.7955
Epoch 37/86
----------
train Loss: 0.3249 Acc: 0.7895
val Loss: 0.2963 Acc: 0.7955
Epoch 38/86
----------
train Loss: 0.3235 Acc: 0.8995
val Loss: 0.2920 Acc: 0.7955
Epoch 39/86
----------
train Loss: 0.3505 Acc: 0.7321
val Loss: 0.2989 Acc: 0.7273
Epoch 40/86
----------
train Loss: 0.2982 Acc: 0.8278
val Loss: 0.2950 Acc: 0.7500
Epoch 41/86
----------
train Loss: 0.3648 Acc: 0.7177
val Loss: 0.2886 Acc: 0.7955
Epoch 42/86
----------
train Loss: 0.3021 Acc: 0.7943
val Loss: 0.2799 Acc: 0.7955
Epoch 43/86
----------
train Loss: 0.3244 Acc: 0.8182
val Loss: 0.2764 Acc: 0.7955
Epoch 44/86
----------
train Loss: 0.2955 Acc: 0.8421
val Loss: 0.2754 Acc: 0.8182
Epoch 45/86
----------
train Loss: 0.2040 Acc: 0.9569
val Loss: 0.2729 Acc: 0.7955
Epoch 46/86
----------
train Loss: 0.3750 Acc: 0.8038
val Loss: 0.2754 Acc: 0.8182
Epoch 47/86
----------
train Loss: 0.2857 Acc: 0.8756
val Loss: 0.2714 Acc: 0.8182
Epoch 48/86
----------
train Loss: 0.3162 Acc: 0.7943
val Loss: 0.2743 Acc: 0.8182
Epoch 49/86
----------
train Loss: 0.3002 Acc: 0.8947
val Loss: 0.2729 Acc: 0.7955
Epoch 50/86
----------
train Loss: 0.2915 Acc: 0.8421
val Loss: 0.2737 Acc: 0.7955
Epoch 51/86
----------
train Loss: 0.2271 Acc: 0.9713
val Loss: 0.2680 Acc: 0.7955
Epoch 52/86
----------
train Loss: 0.3075 Acc: 0.7703
val Loss: 0.2701 Acc: 0.7727
Epoch 53/86
----------
train Loss: 0.3394 Acc: 0.8852
val Loss: 0.2678 Acc: 0.7727
Epoch 54/86
----------
train Loss: 0.2532 Acc: 0.9187
val Loss: 0.2614 Acc: 0.7955
Epoch 55/86
----------
train Loss: 0.2701 Acc: 0.9234
val Loss: 0.2610 Acc: 0.8182
Epoch 56/86
----------
train Loss: 0.3133 Acc: 0.8612
val Loss: 0.2617 Acc: 0.7727
Epoch 57/86
----------
train Loss: 0.3485 Acc: 0.7990
val Loss: 0.2599 Acc: 0.8409
Epoch 58/86
----------
train Loss: 0.2905 Acc: 0.7990
val Loss: 0.2575 Acc: 0.8182
Epoch 59/86
----------
train Loss: 0.3026 Acc: 0.8421
val Loss: 0.2566 Acc: 0.7955
Epoch 60/86
----------
train Loss: 0.2562 Acc: 0.8565
val Loss: 0.2597 Acc: 0.7955
Epoch 61/86
----------
train Loss: 0.3434 Acc: 0.7368
val Loss: 0.2615 Acc: 0.7955
Epoch 62/86
----------
train Loss: 0.3039 Acc: 0.9139
val Loss: 0.2609 Acc: 0.7727
Epoch 63/86
----------
train Loss: 0.2630 Acc: 0.9330
val Loss: 0.2609 Acc: 0.7727
Epoch 64/86
----------
train Loss: 0.2506 Acc: 0.9282
val Loss: 0.2591 Acc: 0.7955
Epoch 65/86
----------
train Loss: 0.2846 Acc: 0.8086
val Loss: 0.2611 Acc: 0.7955
Epoch 66/86
----------
train Loss: 0.2759 Acc: 0.8947
val Loss: 0.2648 Acc: 0.7955
Epoch 67/86
----------
train Loss: 0.3091 Acc: 0.8612
val Loss: 0.2583 Acc: 0.8182
Epoch 68/86
----------
train Loss: 0.2588 Acc: 0.8995
val Loss: 0.2616 Acc: 0.7955
Epoch 69/86
----------
train Loss: 0.2590 Acc: 0.8852
val Loss: 0.2600 Acc: 0.8182
Epoch 70/86
----------
train Loss: 0.2916 Acc: 0.8947
val Loss: 0.2616 Acc: 0.7955
Epoch 71/86
----------
train Loss: 0.3059 Acc: 0.9091
val Loss: 0.2591 Acc: 0.7727
Epoch 72/86
----------
train Loss: 0.3079 Acc: 0.8708
val Loss: 0.2649 Acc: 0.7727
Epoch 73/86
----------
train Loss: 0.2179 Acc: 0.9617
val Loss: 0.2686 Acc: 0.7500
Epoch 74/86
----------
train Loss: 0.3210 Acc: 0.8469
val Loss: 0.2627 Acc: 0.7727
Epoch 75/86
----------
train Loss: 0.2394 Acc: 0.9282
val Loss: 0.2622 Acc: 0.7273
Epoch 76/86
----------
train Loss: 0.2616 Acc: 0.8134
val Loss: 0.2592 Acc: 0.7727
Epoch 77/86
----------
train Loss: 0.2966 Acc: 0.8469
val Loss: 0.2576 Acc: 0.7727
Epoch 78/86
----------
train Loss: 0.2564 Acc: 0.8756
val Loss: 0.2572 Acc: 0.8182
Epoch 79/86
----------
train Loss: 0.3165 Acc: 0.8325
val Loss: 0.2534 Acc: 0.8182
Epoch 80/86
----------
train Loss: 0.2774 Acc: 0.8421
val Loss: 0.2528 Acc: 0.8864
Epoch 81/86
----------
train Loss: 0.3194 Acc: 0.7847
val Loss: 0.2620 Acc: 0.7727
Epoch 82/86
----------
train Loss: 0.2758 Acc: 0.8373
val Loss: 0.2648 Acc: 0.7955
Epoch 83/86
----------
train Loss: 0.2374 Acc: 0.9522
val Loss: 0.2662 Acc: 0.7955
Epoch 84/86
----------
train Loss: 0.3159 Acc: 0.7703
val Loss: 0.2635 Acc: 0.7273
Epoch 85/86
----------
train Loss: 0.2509 Acc: 0.8086
[32m[I 2025-06-28 23:35:42,374][0m Trial 102 finished with value: 0.8863636363636364 and parameters: {'batch_size': 13, 'lr': 5.015160767855362e-05, 'num_epochs': 86, 'weight_decay': 0.0005082669645563045, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2633 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_13_lr_5.015160767855362e-05_epoch_86_wd_0.0005082669645563045_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 0.6916 Acc: 0.2392
val Loss: 0.6689 Acc: 0.2955
Epoch 2/86
----------
train Loss: 0.6601 Acc: 0.3254
val Loss: 0.6457 Acc: 0.3636
Epoch 3/86
----------
train Loss: 0.6349 Acc: 0.3493
val Loss: 0.6160 Acc: 0.4318
Epoch 4/86
----------
train Loss: 0.6162 Acc: 0.4115
val Loss: 0.5988 Acc: 0.4773
Epoch 5/86
----------
train Loss: 0.6034 Acc: 0.4402
val Loss: 0.5884 Acc: 0.5000
Epoch 6/86
----------
train Loss: 0.5836 Acc: 0.4785
val Loss: 0.5730 Acc: 0.5909
Epoch 7/86
----------
train Loss: 0.5662 Acc: 0.4976
val Loss: 0.5559 Acc: 0.6136
Epoch 8/86
----------
train Loss: 0.5548 Acc: 0.5120
val Loss: 0.5402 Acc: 0.6364
Epoch 9/86
----------
train Loss: 0.5423 Acc: 0.5072
val Loss: 0.5251 Acc: 0.6364
Epoch 10/86
----------
train Loss: 0.5216 Acc: 0.5024
val Loss: 0.5064 Acc: 0.6364
Epoch 11/86
----------
train Loss: 0.5215 Acc: 0.5072
val Loss: 0.4937 Acc: 0.6364
Epoch 12/86
----------
train Loss: 0.5173 Acc: 0.4976
val Loss: 0.4878 Acc: 0.6364
Epoch 13/86
----------
train Loss: 0.4958 Acc: 0.5167
val Loss: 0.4717 Acc: 0.6364
Epoch 14/86
----------
train Loss: 0.4814 Acc: 0.5215
val Loss: 0.4613 Acc: 0.6364
Epoch 15/86
----------
train Loss: 0.4863 Acc: 0.4928
val Loss: 0.4513 Acc: 0.6364
Epoch 16/86
----------
train Loss: 0.4777 Acc: 0.5167
val Loss: 0.4436 Acc: 0.6591
Epoch 17/86
----------
train Loss: 0.4716 Acc: 0.5072
val Loss: 0.4355 Acc: 0.6591
Epoch 18/86
----------
train Loss: 0.4607 Acc: 0.5263
val Loss: 0.4244 Acc: 0.6591
Epoch 19/86
----------
train Loss: 0.4482 Acc: 0.5550
val Loss: 0.4185 Acc: 0.6591
Epoch 20/86
----------
train Loss: 0.4497 Acc: 0.5359
val Loss: 0.4136 Acc: 0.6591
Epoch 21/86
----------
train Loss: 0.4514 Acc: 0.5550
val Loss: 0.4080 Acc: 0.6818
Epoch 22/86
----------
train Loss: 0.4436 Acc: 0.5789
val Loss: 0.4017 Acc: 0.6818
Epoch 23/86
----------
train Loss: 0.4318 Acc: 0.5646
val Loss: 0.3939 Acc: 0.7045
Epoch 24/86
----------
train Loss: 0.4117 Acc: 0.6124
val Loss: 0.3790 Acc: 0.7045
Epoch 25/86
----------
train Loss: 0.4294 Acc: 0.5933
val Loss: 0.3808 Acc: 0.7045
Epoch 26/86
----------
train Loss: 0.4312 Acc: 0.5885
val Loss: 0.3764 Acc: 0.7273
Epoch 27/86
----------
train Loss: 0.3950 Acc: 0.6507
val Loss: 0.3725 Acc: 0.7273
Epoch 28/86
----------
train Loss: 0.4230 Acc: 0.6029
val Loss: 0.3684 Acc: 0.7273
Epoch 29/86
----------
train Loss: 0.4370 Acc: 0.6172
val Loss: 0.3694 Acc: 0.7500
Epoch 30/86
----------
train Loss: 0.4163 Acc: 0.6124
val Loss: 0.3624 Acc: 0.7273
Epoch 31/86
----------
train Loss: 0.3827 Acc: 0.7225
val Loss: 0.3496 Acc: 0.7727
Epoch 32/86
----------
train Loss: 0.3911 Acc: 0.6555
val Loss: 0.3432 Acc: 0.7500
Epoch 33/86
----------
train Loss: 0.4090 Acc: 0.6651
val Loss: 0.3424 Acc: 0.7273
Epoch 34/86
----------
train Loss: 0.3890 Acc: 0.6794
val Loss: 0.3367 Acc: 0.7727
Epoch 35/86
----------
train Loss: 0.3559 Acc: 0.7703
val Loss: 0.3350 Acc: 0.7727
Epoch 36/86
----------
train Loss: 0.4125 Acc: 0.6746
val Loss: 0.3336 Acc: 0.7727
Epoch 37/86
----------
train Loss: 0.3735 Acc: 0.7273
val Loss: 0.3387 Acc: 0.7273
Epoch 38/86
----------
train Loss: 0.3720 Acc: 0.7799
val Loss: 0.3356 Acc: 0.7273
Epoch 39/86
----------
train Loss: 0.3864 Acc: 0.6411
val Loss: 0.3461 Acc: 0.7500
Epoch 40/86
----------
train Loss: 0.3495 Acc: 0.7560
val Loss: 0.3426 Acc: 0.7273
Epoch 41/86
----------
train Loss: 0.3979 Acc: 0.6842
val Loss: 0.3343 Acc: 0.7273
Epoch 42/86
----------
train Loss: 0.3503 Acc: 0.7416
val Loss: 0.3298 Acc: 0.7727
Epoch 43/86
----------
train Loss: 0.3657 Acc: 0.7177
val Loss: 0.3291 Acc: 0.7500
Epoch 44/86
----------
train Loss: 0.3385 Acc: 0.8086
val Loss: 0.3270 Acc: 0.7500
Epoch 45/86
----------
train Loss: 0.2596 Acc: 0.9282
val Loss: 0.3141 Acc: 0.7500
Epoch 46/86
----------
train Loss: 0.3962 Acc: 0.7703
val Loss: 0.3125 Acc: 0.7500
Epoch 47/86
----------
train Loss: 0.3253 Acc: 0.8134
val Loss: 0.3127 Acc: 0.7727
Epoch 48/86
----------
train Loss: 0.3400 Acc: 0.7608
val Loss: 0.3062 Acc: 0.7727
Epoch 49/86
----------
train Loss: 0.3346 Acc: 0.8325
val Loss: 0.3055 Acc: 0.7727
Epoch 50/86
----------
train Loss: 0.3215 Acc: 0.7847
val Loss: 0.3125 Acc: 0.7273
Epoch 51/86
----------
train Loss: 0.2717 Acc: 0.9378
val Loss: 0.3030 Acc: 0.7273
Epoch 52/86
----------
train Loss: 0.3378 Acc: 0.7464
val Loss: 0.3034 Acc: 0.7273
Epoch 53/86
----------
train Loss: 0.3665 Acc: 0.8134
val Loss: 0.3011 Acc: 0.7500
Epoch 54/86
----------
train Loss: 0.2845 Acc: 0.8947
val Loss: 0.2943 Acc: 0.7500
Epoch 55/86
----------
train Loss: 0.3042 Acc: 0.8804
val Loss: 0.2977 Acc: 0.7500
Epoch 56/86
----------
train Loss: 0.3336 Acc: 0.8373
val Loss: 0.2985 Acc: 0.7500
Epoch 57/86
----------
train Loss: 0.3770 Acc: 0.7703
val Loss: 0.3045 Acc: 0.7727
Epoch 58/86
----------
train Loss: 0.3105 Acc: 0.7990
val Loss: 0.2948 Acc: 0.7500
Epoch 59/86
----------
train Loss: 0.3327 Acc: 0.8086
val Loss: 0.2955 Acc: 0.7727
Epoch 60/86
----------
train Loss: 0.2864 Acc: 0.8230
val Loss: 0.3021 Acc: 0.7500
Epoch 61/86
----------
train Loss: 0.3717 Acc: 0.7225
val Loss: 0.2978 Acc: 0.7273
Epoch 62/86
----------
train Loss: 0.3213 Acc: 0.8947
val Loss: 0.2867 Acc: 0.7500
Epoch 63/86
----------
train Loss: 0.2829 Acc: 0.9139
val Loss: 0.2812 Acc: 0.7727
Epoch 64/86
----------
train Loss: 0.2738 Acc: 0.9187
val Loss: 0.2704 Acc: 0.7727
Epoch 65/86
----------
train Loss: 0.2968 Acc: 0.8325
val Loss: 0.2674 Acc: 0.7727
Epoch 66/86
----------
train Loss: 0.2935 Acc: 0.8756
val Loss: 0.2772 Acc: 0.7727
Epoch 67/86
----------
train Loss: 0.3230 Acc: 0.8565
val Loss: 0.2707 Acc: 0.7727
Epoch 68/86
----------
train Loss: 0.2798 Acc: 0.8900
val Loss: 0.2846 Acc: 0.7273
Epoch 69/86
----------
train Loss: 0.2814 Acc: 0.8612
val Loss: 0.2866 Acc: 0.7500
Epoch 70/86
----------
train Loss: 0.3089 Acc: 0.8612
val Loss: 0.2973 Acc: 0.7500
Epoch 71/86
----------
train Loss: 0.3245 Acc: 0.8660
val Loss: 0.2941 Acc: 0.7045
Epoch 72/86
----------
train Loss: 0.3284 Acc: 0.8421
val Loss: 0.2974 Acc: 0.6818
Epoch 73/86
----------
train Loss: 0.2334 Acc: 0.9522
val Loss: 0.2895 Acc: 0.6818
Epoch 74/86
----------
train Loss: 0.3331 Acc: 0.8134
val Loss: 0.2773 Acc: 0.7273
Epoch 75/86
----------
train Loss: 0.2559 Acc: 0.9282
val Loss: 0.2666 Acc: 0.7500
Epoch 76/86
----------
train Loss: 0.2809 Acc: 0.7990
val Loss: 0.2621 Acc: 0.7955
Epoch 77/86
----------
train Loss: 0.3124 Acc: 0.8421
val Loss: 0.2694 Acc: 0.7727
Epoch 78/86
----------
train Loss: 0.2675 Acc: 0.8804
val Loss: 0.2760 Acc: 0.8182
Epoch 79/86
----------
train Loss: 0.3347 Acc: 0.8278
val Loss: 0.2726 Acc: 0.7955
Epoch 80/86
----------
train Loss: 0.2961 Acc: 0.8278
val Loss: 0.2760 Acc: 0.7955
Epoch 81/86
----------
train Loss: 0.3372 Acc: 0.7895
val Loss: 0.2840 Acc: 0.7955
Epoch 82/86
----------
train Loss: 0.2865 Acc: 0.8278
val Loss: 0.2859 Acc: 0.7500
Epoch 83/86
----------
train Loss: 0.2518 Acc: 0.9522
val Loss: 0.2828 Acc: 0.7500
Epoch 84/86
----------
train Loss: 0.3243 Acc: 0.7656
val Loss: 0.2744 Acc: 0.7273
Epoch 85/86
----------
train Loss: 0.2688 Acc: 0.7799
val Loss: 0.2735 Acc: 0.7273
Epoch 86/86
----------
train Loss: 0.2721 Acc: 0.8469
[32m[I 2025-06-28 23:55:17,645][0m Trial 103 finished with value: 0.75 and parameters: {'batch_size': 18, 'lr': 8.075238922782917e-05, 'num_epochs': 86, 'weight_decay': 0.012335090803172504, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2644 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_18_lr_8.075238922782917e-05_epoch_86_wd_0.012335090803172504_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/79
----------
train Loss: 3.4299 Acc: 0.3541
val Loss: 3.0355 Acc: 0.6136
Epoch 2/79
----------
train Loss: 2.6804 Acc: 0.5215
val Loss: 2.1184 Acc: 0.6364
Epoch 3/79
----------
train Loss: 2.3138 Acc: 0.5072
val Loss: 1.8830 Acc: 0.6364
Epoch 4/79
----------
train Loss: 2.2003 Acc: 0.5072
val Loss: 1.8147 Acc: 0.7045
Epoch 5/79
----------
train Loss: 2.1282 Acc: 0.6316
val Loss: 1.7289 Acc: 0.7727
Epoch 6/79
----------
train Loss: 1.9457 Acc: 0.6507
val Loss: 1.6380 Acc: 0.8182
Epoch 7/79
----------
train Loss: 1.7757 Acc: 0.7464
val Loss: 1.5385 Acc: 0.8182
Epoch 8/79
----------
train Loss: 1.8405 Acc: 0.7273
val Loss: 1.3814 Acc: 0.7955
Epoch 9/79
----------
train Loss: 1.8201 Acc: 0.7368
val Loss: 1.5131 Acc: 0.7727
Epoch 10/79
----------
train Loss: 1.1938 Acc: 0.9426
val Loss: 1.4004 Acc: 0.7955
Epoch 11/79
----------
train Loss: 1.6992 Acc: 0.7847
val Loss: 1.2236 Acc: 0.8864
Epoch 12/79
----------
train Loss: 1.5281 Acc: 0.7464
val Loss: 1.5352 Acc: 0.8182
Epoch 13/79
----------
train Loss: 1.3423 Acc: 0.8900
val Loss: 1.4626 Acc: 0.7727
Epoch 14/79
----------
train Loss: 1.2589 Acc: 0.8373
val Loss: 1.4110 Acc: 0.7273
Epoch 15/79
----------
train Loss: 1.4031 Acc: 0.8182
val Loss: 1.2029 Acc: 0.7727
Epoch 16/79
----------
train Loss: 1.4843 Acc: 0.8086
val Loss: 1.2948 Acc: 0.8409
Epoch 17/79
----------
train Loss: 1.4189 Acc: 0.8565
val Loss: 1.3894 Acc: 0.8182
Epoch 18/79
----------
train Loss: 1.3065 Acc: 0.8373
val Loss: 1.2943 Acc: 0.7955
Epoch 19/79
----------
train Loss: 1.2058 Acc: 0.9474
val Loss: 1.3073 Acc: 0.7955
Epoch 20/79
----------
train Loss: 1.3147 Acc: 0.8756
val Loss: 1.3004 Acc: 0.8182
Epoch 21/79
----------
train Loss: 1.4241 Acc: 0.8852
val Loss: 1.3502 Acc: 0.7727
Epoch 22/79
----------
train Loss: 1.2661 Acc: 0.8900
val Loss: 1.2715 Acc: 0.8409
Epoch 23/79
----------
train Loss: 1.4872 Acc: 0.8517
val Loss: 1.2354 Acc: 0.8182
Epoch 24/79
----------
train Loss: 1.0934 Acc: 0.9187
val Loss: 1.1611 Acc: 0.7955
Epoch 25/79
----------
train Loss: 1.2454 Acc: 0.9378
val Loss: 1.3179 Acc: 0.7727
Epoch 26/79
----------
train Loss: 1.4700 Acc: 0.9474
val Loss: 1.2635 Acc: 0.8409
Epoch 27/79
----------
train Loss: 1.1754 Acc: 0.9665
val Loss: 1.3710 Acc: 0.7955
Epoch 28/79
----------
train Loss: 1.3449 Acc: 0.8517
val Loss: 1.1908 Acc: 0.7273
Epoch 29/79
----------
train Loss: 1.5088 Acc: 0.8134
val Loss: 1.1672 Acc: 0.8409
Epoch 30/79
----------
train Loss: 1.2671 Acc: 0.8804
val Loss: 1.0727 Acc: 0.8864
Epoch 31/79
----------
train Loss: 1.1289 Acc: 0.9474
val Loss: 1.0927 Acc: 0.8409
Epoch 32/79
----------
train Loss: 1.2313 Acc: 0.9282
val Loss: 1.1591 Acc: 0.8182
Epoch 33/79
----------
train Loss: 1.3984 Acc: 0.8804
val Loss: 1.2689 Acc: 0.7727
Epoch 34/79
----------
train Loss: 1.3031 Acc: 0.9378
val Loss: 1.3538 Acc: 0.7273
Epoch 35/79
----------
train Loss: 1.0137 Acc: 0.9809
val Loss: 1.3133 Acc: 0.7500
Epoch 36/79
----------
train Loss: 1.5718 Acc: 0.8373
val Loss: 1.2354 Acc: 0.7727
Epoch 37/79
----------
train Loss: 1.3216 Acc: 0.8325
val Loss: 1.4068 Acc: 0.7727
Epoch 38/79
----------
train Loss: 1.4017 Acc: 0.9522
val Loss: 1.2755 Acc: 0.7955
Epoch 39/79
----------
train Loss: 1.3618 Acc: 0.7990
val Loss: 1.4357 Acc: 0.7727
Epoch 40/79
----------
train Loss: 1.1929 Acc: 0.8947
val Loss: 1.2782 Acc: 0.7727
Epoch 41/79
----------
train Loss: 1.6126 Acc: 0.7033
val Loss: 1.2969 Acc: 0.7273
Epoch 42/79
----------
train Loss: 1.2131 Acc: 0.8660
val Loss: 1.3838 Acc: 0.7500
Epoch 43/79
----------
train Loss: 1.3376 Acc: 0.8565
val Loss: 1.1973 Acc: 0.7955
Epoch 44/79
----------
train Loss: 1.2368 Acc: 0.8804
val Loss: 1.4061 Acc: 0.7955
Epoch 45/79
----------
train Loss: 0.8075 Acc: 0.9522
val Loss: 1.2442 Acc: 0.7955
Epoch 46/79
----------
train Loss: 1.6427 Acc: 0.8230
val Loss: 1.4505 Acc: 0.7500
Epoch 47/79
----------
train Loss: 1.2408 Acc: 0.9091
val Loss: 1.5969 Acc: 0.7500
Epoch 48/79
----------
train Loss: 1.3611 Acc: 0.8421
val Loss: 1.7232 Acc: 0.7045
Epoch 49/79
----------
train Loss: 1.3664 Acc: 0.9234
val Loss: 1.3176 Acc: 0.7955
Epoch 50/79
----------
train Loss: 1.3018 Acc: 0.8708
val Loss: 1.4052 Acc: 0.7955
Epoch 51/79
----------
train Loss: 0.9872 Acc: 0.9856
val Loss: 1.3006 Acc: 0.7955
Epoch 52/79
----------
train Loss: 1.3080 Acc: 0.8469
val Loss: 1.2602 Acc: 0.6818
Epoch 53/79
----------
train Loss: 1.4964 Acc: 0.8995
val Loss: 1.4639 Acc: 0.6818
Epoch 54/79
----------
train Loss: 1.2064 Acc: 0.9330
val Loss: 1.5184 Acc: 0.7727
Epoch 55/79
----------
train Loss: 1.2257 Acc: 0.9522
val Loss: 1.7298 Acc: 0.7273
Epoch 56/79
----------
train Loss: 1.4096 Acc: 0.9139
val Loss: 1.5427 Acc: 0.5909
Epoch 57/79
----------
train Loss: 1.5070 Acc: 0.8325
val Loss: 1.6237 Acc: 0.7045
Epoch 58/79
----------
train Loss: 1.2573 Acc: 0.8373
val Loss: 1.3092 Acc: 0.7500
Epoch 59/79
----------
train Loss: 1.3119 Acc: 0.9187
val Loss: 1.4398 Acc: 0.7727
Epoch 60/79
----------
train Loss: 1.0695 Acc: 0.8995
val Loss: 1.6829 Acc: 0.6818
Epoch 61/79
----------
train Loss: 1.5057 Acc: 0.8230
val Loss: 1.7312 Acc: 0.6364
Epoch 62/79
----------
train Loss: 1.4422 Acc: 0.9378
val Loss: 1.6773 Acc: 0.7045
Epoch 63/79
----------
train Loss: 1.2928 Acc: 0.9043
val Loss: 1.7870 Acc: 0.6364
Epoch 64/79
----------
train Loss: 1.1228 Acc: 0.9330
val Loss: 1.5325 Acc: 0.7500
Epoch 65/79
----------
train Loss: 1.2444 Acc: 0.8852
val Loss: 1.4050 Acc: 0.7273
Epoch 66/79
----------
train Loss: 1.2805 Acc: 0.9043
val Loss: 1.6928 Acc: 0.7045
Epoch 67/79
----------
train Loss: 1.4451 Acc: 0.8804
val Loss: 1.5329 Acc: 0.7500
Epoch 68/79
----------
train Loss: 1.1678 Acc: 0.8900
val Loss: 1.4241 Acc: 0.8182
Epoch 69/79
----------
train Loss: 1.1460 Acc: 0.8804
val Loss: 1.2656 Acc: 0.7727
Epoch 70/79
----------
train Loss: 1.3304 Acc: 0.8708
val Loss: 1.1940 Acc: 0.8182
Epoch 71/79
----------
train Loss: 1.4033 Acc: 0.9139
val Loss: 1.2657 Acc: 0.8636
Epoch 72/79
----------
train Loss: 1.4357 Acc: 0.8756
val Loss: 1.3747 Acc: 0.8182
Epoch 73/79
----------
train Loss: 0.9977 Acc: 0.9522
val Loss: 1.4769 Acc: 0.7727
Epoch 74/79
----------
train Loss: 1.4263 Acc: 0.8373
val Loss: 1.4955 Acc: 0.8182
Epoch 75/79
----------
train Loss: 1.1293 Acc: 0.9713
val Loss: 1.4874 Acc: 0.7500
Epoch 76/79
----------
train Loss: 1.1411 Acc: 0.8565
val Loss: 1.3257 Acc: 0.7273
Epoch 77/79
----------
train Loss: 1.3796 Acc: 0.8612
val Loss: 1.4504 Acc: 0.6591
Epoch 78/79
----------
train Loss: 1.2853 Acc: 0.8995
val Loss: 1.7047 Acc: 0.6818
Epoch 79/79
----------
train Loss: 1.4205 Acc: 0.8804
[32m[I 2025-06-29 00:13:16,242][0m Trial 104 finished with value: 0.8181818181818182 and parameters: {'batch_size': 32, 'lr': 0.0003973403775956229, 'num_epochs': 79, 'weight_decay': 0.014368048907756389, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5386 Acc: 0.7500
Early stopping at epoch 79 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_32_lr_0.0003973403775956229_epoch_79_wd_0.014368048907756389_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/77
----------
train Loss: 3.0904 Acc: 0.3971
val Loss: 2.2538 Acc: 0.6364
Epoch 2/77
----------
train Loss: 2.3855 Acc: 0.5359
val Loss: 2.0338 Acc: 0.6364
Epoch 3/77
----------
train Loss: 2.1202 Acc: 0.6029
val Loss: 2.4901 Acc: 0.6818
Epoch 4/77
----------
train Loss: 2.0131 Acc: 0.6364
val Loss: 2.3084 Acc: 0.7727
Epoch 5/77
----------
train Loss: 1.8062 Acc: 0.7656
val Loss: 2.0381 Acc: 0.7727
Epoch 6/77
----------
train Loss: 1.7693 Acc: 0.7129
val Loss: 2.0376 Acc: 0.7727
Epoch 7/77
----------
train Loss: 1.5010 Acc: 0.8517
val Loss: 2.2338 Acc: 0.7500
Epoch 8/77
----------
train Loss: 1.7838 Acc: 0.7512
val Loss: 1.8848 Acc: 0.7500
Epoch 9/77
----------
train Loss: 1.7317 Acc: 0.8038
val Loss: 3.0809 Acc: 0.6591
Epoch 10/77
----------
train Loss: 1.0970 Acc: 0.9282
val Loss: 1.5917 Acc: 0.8182
Epoch 11/77
----------
train Loss: 1.8378 Acc: 0.8086
val Loss: 1.7890 Acc: 0.7955
Epoch 12/77
----------
train Loss: 1.6572 Acc: 0.7416
val Loss: 2.0708 Acc: 0.6136
Epoch 13/77
----------
train Loss: 1.5404 Acc: 0.8517
val Loss: 2.1196 Acc: 0.7045
Epoch 14/77
----------
train Loss: 1.4454 Acc: 0.8325
val Loss: 2.4401 Acc: 0.5682
Epoch 15/77
----------
train Loss: 1.5835 Acc: 0.8134
val Loss: 2.2554 Acc: 0.6591
Epoch 16/77
----------
train Loss: 1.6779 Acc: 0.7703
[32m[I 2025-06-29 00:16:54,328][0m Trial 105 finished with value: 0.7954545454545455 and parameters: {'batch_size': 25, 'lr': 0.0009047642039758194, 'num_epochs': 77, 'weight_decay': 0.016330254076835627, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 2.9984 Acc: 0.5909
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_25_lr_0.0009047642039758194_epoch_77_wd_0.016330254076835627_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/68
----------
train Loss: 3.7998 Acc: 0.2297
val Loss: 3.6547 Acc: 0.2500
Epoch 2/68
----------
train Loss: 3.6826 Acc: 0.2632
val Loss: 3.5780 Acc: 0.2727
Epoch 3/68
----------
train Loss: 3.5721 Acc: 0.2967
val Loss: 3.4505 Acc: 0.2727
Epoch 4/68
----------
train Loss: 3.5029 Acc: 0.3062
val Loss: 3.3785 Acc: 0.3636
Epoch 5/68
----------
train Loss: 3.4386 Acc: 0.3206
val Loss: 3.3290 Acc: 0.4091
Epoch 6/68
----------
train Loss: 3.3446 Acc: 0.3636
val Loss: 3.2583 Acc: 0.4773
Epoch 7/68
----------
train Loss: 3.2574 Acc: 0.4258
val Loss: 3.1673 Acc: 0.5000
Epoch 8/68
----------
train Loss: 3.1826 Acc: 0.4498
val Loss: 3.0928 Acc: 0.5227
Epoch 9/68
----------
train Loss: 3.1138 Acc: 0.4402
val Loss: 2.9900 Acc: 0.5455
Epoch 10/68
----------
train Loss: 2.9728 Acc: 0.4689
val Loss: 2.8759 Acc: 0.6364
Epoch 11/68
----------
train Loss: 2.9672 Acc: 0.4833
val Loss: 2.8220 Acc: 0.6136
Epoch 12/68
----------
train Loss: 2.9159 Acc: 0.5024
val Loss: 2.7666 Acc: 0.6136
Epoch 13/68
----------
train Loss: 2.7882 Acc: 0.5263
val Loss: 2.6430 Acc: 0.6364
Epoch 14/68
----------
train Loss: 2.7135 Acc: 0.5359
val Loss: 2.6006 Acc: 0.6591
Epoch 15/68
----------
train Loss: 2.6922 Acc: 0.5167
val Loss: 2.5418 Acc: 0.6818
Epoch 16/68
----------
train Loss: 2.6335 Acc: 0.5455
val Loss: 2.4567 Acc: 0.6818
Epoch 17/68
----------
train Loss: 2.5653 Acc: 0.5263
val Loss: 2.3830 Acc: 0.6818
Epoch 18/68
----------
train Loss: 2.5136 Acc: 0.5167
val Loss: 2.3173 Acc: 0.6818
Epoch 19/68
----------
train Loss: 2.4534 Acc: 0.5455
val Loss: 2.2682 Acc: 0.6818
Epoch 20/68
----------
train Loss: 2.4174 Acc: 0.5311
val Loss: 2.2093 Acc: 0.6818
Epoch 21/68
----------
train Loss: 2.4100 Acc: 0.5455
val Loss: 2.1863 Acc: 0.6818
Epoch 22/68
----------
train Loss: 2.3765 Acc: 0.5550
val Loss: 2.1420 Acc: 0.6818
Epoch 23/68
----------
train Loss: 2.3063 Acc: 0.5455
val Loss: 2.0951 Acc: 0.6818
Epoch 24/68
----------
train Loss: 2.1915 Acc: 0.5407
val Loss: 2.0242 Acc: 0.6818
Epoch 25/68
----------
train Loss: 2.2712 Acc: 0.5502
val Loss: 2.0251 Acc: 0.6818
Epoch 26/68
----------
train Loss: 2.2673 Acc: 0.5359
val Loss: 2.0227 Acc: 0.6818
Epoch 27/68
----------
train Loss: 2.1299 Acc: 0.5742
val Loss: 1.9814 Acc: 0.6818
Epoch 28/68
----------
train Loss: 2.2292 Acc: 0.5215
val Loss: 1.9591 Acc: 0.6818
Epoch 29/68
----------
train Loss: 2.2603 Acc: 0.5550
val Loss: 1.9385 Acc: 0.6818
Epoch 30/68
----------
train Loss: 2.1883 Acc: 0.5502
val Loss: 1.9409 Acc: 0.7273
Epoch 31/68
----------
train Loss: 2.0674 Acc: 0.5981
val Loss: 1.9011 Acc: 0.7045
Epoch 32/68
----------
train Loss: 2.1202 Acc: 0.5837
val Loss: 1.8666 Acc: 0.7045
Epoch 33/68
----------
train Loss: 2.1470 Acc: 0.6029
val Loss: 1.8591 Acc: 0.7045
Epoch 34/68
----------
train Loss: 2.0891 Acc: 0.5550
val Loss: 1.8429 Acc: 0.7045
Epoch 35/68
----------
train Loss: 1.9403 Acc: 0.6555
val Loss: 1.8165 Acc: 0.7273
Epoch 36/68
----------
train Loss: 2.2006 Acc: 0.5550
val Loss: 1.7853 Acc: 0.7045
Epoch 37/68
----------
train Loss: 2.0203 Acc: 0.6172
val Loss: 1.7927 Acc: 0.7273
Epoch 38/68
----------
train Loss: 2.0248 Acc: 0.6411
val Loss: 1.7779 Acc: 0.7273
Epoch 39/68
----------
train Loss: 2.0918 Acc: 0.6077
val Loss: 1.8146 Acc: 0.7500
Epoch 40/68
----------
train Loss: 1.9211 Acc: 0.6555
val Loss: 1.8043 Acc: 0.7500
Epoch 41/68
----------
train Loss: 2.1413 Acc: 0.6077
val Loss: 1.7823 Acc: 0.7727
Epoch 42/68
----------
train Loss: 1.9356 Acc: 0.6316
val Loss: 1.7491 Acc: 0.7727
Epoch 43/68
----------
train Loss: 2.0166 Acc: 0.6077
val Loss: 1.7326 Acc: 0.7727
Epoch 44/68
----------
train Loss: 1.8533 Acc: 0.6842
val Loss: 1.7094 Acc: 0.7500
Epoch 45/68
----------
train Loss: 1.5998 Acc: 0.7847
val Loss: 1.6802 Acc: 0.7500
Epoch 46/68
----------
train Loss: 2.0842 Acc: 0.6746
val Loss: 1.6829 Acc: 0.7500
Epoch 47/68
----------
train Loss: 1.8284 Acc: 0.6842
val Loss: 1.6637 Acc: 0.7727
Epoch 48/68
----------
train Loss: 1.8561 Acc: 0.6986
val Loss: 1.6448 Acc: 0.7955
Epoch 49/68
----------
train Loss: 1.8443 Acc: 0.7273
val Loss: 1.6195 Acc: 0.7500
Epoch 50/68
----------
train Loss: 1.8129 Acc: 0.7129
val Loss: 1.6435 Acc: 0.7955
Epoch 51/68
----------
train Loss: 1.5981 Acc: 0.8373
val Loss: 1.5905 Acc: 0.7955
Epoch 52/68
----------
train Loss: 1.8431 Acc: 0.6986
val Loss: 1.5884 Acc: 0.7727
Epoch 53/68
----------
train Loss: 1.9428 Acc: 0.7081
val Loss: 1.5846 Acc: 0.7727
Epoch 54/68
----------
train Loss: 1.6547 Acc: 0.8182
val Loss: 1.5645 Acc: 0.7955
Epoch 55/68
----------
train Loss: 1.7018 Acc: 0.7847
val Loss: 1.5326 Acc: 0.8409
Epoch 56/68
----------
train Loss: 1.8237 Acc: 0.7560
val Loss: 1.5316 Acc: 0.7955
Epoch 57/68
----------
train Loss: 1.9435 Acc: 0.6699
val Loss: 1.5136 Acc: 0.8409
Epoch 58/68
----------
train Loss: 1.7205 Acc: 0.7416
val Loss: 1.5252 Acc: 0.8182
Epoch 59/68
----------
train Loss: 1.7786 Acc: 0.7464
val Loss: 1.5103 Acc: 0.7955
Epoch 60/68
----------
train Loss: 1.5920 Acc: 0.7464
val Loss: 1.5098 Acc: 0.8182
Epoch 61/68
----------
train Loss: 1.9150 Acc: 0.6794
val Loss: 1.4908 Acc: 0.7955
Epoch 62/68
----------
train Loss: 1.7235 Acc: 0.8134
val Loss: 1.4795 Acc: 0.7955
Epoch 63/68
----------
train Loss: 1.5702 Acc: 0.8517
val Loss: 1.4683 Acc: 0.8182
Epoch 64/68
----------
train Loss: 1.5347 Acc: 0.8565
val Loss: 1.4653 Acc: 0.8409
Epoch 65/68
----------
train Loss: 1.6630 Acc: 0.7512
val Loss: 1.4576 Acc: 0.8409
Epoch 66/68
----------
train Loss: 1.6110 Acc: 0.8230
val Loss: 1.4491 Acc: 0.8182
Epoch 67/68
----------
train Loss: 1.7268 Acc: 0.7799
val Loss: 1.4281 Acc: 0.8182
Epoch 68/68
----------
train Loss: 1.5124 Acc: 0.8517
[32m[I 2025-06-29 00:32:22,910][0m Trial 106 finished with value: 0.8636363636363636 and parameters: {'batch_size': 8, 'lr': 3.218003258611749e-05, 'num_epochs': 68, 'weight_decay': 0.00953779960552268, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4211 Acc: 0.8636
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_8_lr_3.218003258611749e-05_epoch_68_wd_0.00953779960552268_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/69
----------
train Loss: 3.4186 Acc: 0.3493
val Loss: 2.9477 Acc: 0.6136
Epoch 2/69
----------
train Loss: 2.6420 Acc: 0.5455
val Loss: 2.0135 Acc: 0.6364
Epoch 3/69
----------
train Loss: 2.2748 Acc: 0.5167
val Loss: 1.8247 Acc: 0.6591
Epoch 4/69
----------
train Loss: 2.1634 Acc: 0.5359
val Loss: 1.6985 Acc: 0.7045
Epoch 5/69
----------
train Loss: 2.0873 Acc: 0.6603
val Loss: 1.5863 Acc: 0.7500
Epoch 6/69
----------
train Loss: 1.8921 Acc: 0.6651
val Loss: 1.4672 Acc: 0.8182
Epoch 7/69
----------
train Loss: 1.7031 Acc: 0.7847
val Loss: 1.3616 Acc: 0.8409
Epoch 8/69
----------
train Loss: 1.7815 Acc: 0.7512
val Loss: 1.3054 Acc: 0.7727
Epoch 9/69
----------
train Loss: 1.7807 Acc: 0.7464
val Loss: 1.4362 Acc: 0.7273
Epoch 10/69
----------
train Loss: 1.1171 Acc: 0.9426
val Loss: 1.2922 Acc: 0.8182
Epoch 11/69
----------
train Loss: 1.6979 Acc: 0.7703
val Loss: 1.1841 Acc: 0.8636
Epoch 12/69
----------
train Loss: 1.4986 Acc: 0.7464
val Loss: 1.4229 Acc: 0.7727
Epoch 13/69
----------
train Loss: 1.3224 Acc: 0.8995
val Loss: 1.4062 Acc: 0.7955
Epoch 14/69
----------
train Loss: 1.2445 Acc: 0.8373
val Loss: 1.3462 Acc: 0.7727
Epoch 15/69
----------
train Loss: 1.3761 Acc: 0.8325
val Loss: 1.1603 Acc: 0.7955
Epoch 16/69
----------
train Loss: 1.4560 Acc: 0.8086
val Loss: 1.2439 Acc: 0.8409
Epoch 17/69
----------
train Loss: 1.3886 Acc: 0.8565
val Loss: 1.3855 Acc: 0.7727
Epoch 18/69
----------
train Loss: 1.3012 Acc: 0.8230
val Loss: 1.3196 Acc: 0.7955
Epoch 19/69
----------
train Loss: 1.2104 Acc: 0.9187
val Loss: 1.2715 Acc: 0.7955
Epoch 20/69
----------
train Loss: 1.2847 Acc: 0.8708
val Loss: 1.2382 Acc: 0.8182
Epoch 21/69
----------
train Loss: 1.3914 Acc: 0.8852
val Loss: 1.2358 Acc: 0.7500
Epoch 22/69
----------
train Loss: 1.2431 Acc: 0.8852
val Loss: 1.1971 Acc: 0.7727
Epoch 23/69
----------
train Loss: 1.4810 Acc: 0.8852
val Loss: 1.1488 Acc: 0.8636
Epoch 24/69
----------
train Loss: 1.0557 Acc: 0.9139
val Loss: 1.1368 Acc: 0.8864
Epoch 25/69
----------
train Loss: 1.2424 Acc: 0.9330
val Loss: 1.2491 Acc: 0.7955
Epoch 26/69
----------
train Loss: 1.4396 Acc: 0.9522
val Loss: 1.2542 Acc: 0.7727
Epoch 27/69
----------
train Loss: 1.1488 Acc: 0.9713
val Loss: 1.3296 Acc: 0.7955
Epoch 28/69
----------
train Loss: 1.3482 Acc: 0.8708
val Loss: 1.2396 Acc: 0.7727
Epoch 29/69
----------
train Loss: 1.4510 Acc: 0.8182
[32m[I 2025-06-29 00:38:58,891][0m Trial 107 finished with value: 0.8863636363636364 and parameters: {'batch_size': 97, 'lr': 0.0003881720046343929, 'num_epochs': 69, 'weight_decay': 0.0070855652267236115, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.1464 Acc: 0.7727
Early stopping at epoch 29 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_97_lr_0.0003881720046343929_epoch_69_wd_0.0070855652267236115_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/68
----------
train Loss: 3.4512 Acc: 0.3397
val Loss: 2.9996 Acc: 0.5909
Epoch 2/68
----------
train Loss: 2.6983 Acc: 0.5550
val Loss: 2.0425 Acc: 0.6364
Epoch 3/68
----------
train Loss: 2.3026 Acc: 0.5167
val Loss: 1.8365 Acc: 0.6364
Epoch 4/68
----------
train Loss: 2.1779 Acc: 0.5263
val Loss: 1.6950 Acc: 0.6818
Epoch 5/68
----------
train Loss: 2.1057 Acc: 0.6364
val Loss: 1.5811 Acc: 0.7500
Epoch 6/68
----------
train Loss: 1.9084 Acc: 0.6699
val Loss: 1.4524 Acc: 0.7727
Epoch 7/68
----------
train Loss: 1.7359 Acc: 0.7656
val Loss: 1.3611 Acc: 0.8409
Epoch 8/68
----------
train Loss: 1.8162 Acc: 0.7368
val Loss: 1.2980 Acc: 0.8182
Epoch 9/68
----------
train Loss: 1.7528 Acc: 0.7512
val Loss: 1.3928 Acc: 0.7727
Epoch 10/68
----------
train Loss: 1.1226 Acc: 0.9474
val Loss: 1.2684 Acc: 0.8182
Epoch 11/68
----------
train Loss: 1.6711 Acc: 0.7703
val Loss: 1.1429 Acc: 0.8409
Epoch 12/68
----------
train Loss: 1.4985 Acc: 0.7464
val Loss: 1.3705 Acc: 0.8182
Epoch 13/68
----------
train Loss: 1.3255 Acc: 0.8995
val Loss: 1.3455 Acc: 0.7955
Epoch 14/68
----------
train Loss: 1.2368 Acc: 0.8373
val Loss: 1.3472 Acc: 0.7500
Epoch 15/68
----------
train Loss: 1.3797 Acc: 0.8278
val Loss: 1.1564 Acc: 0.8409
Epoch 16/68
----------
train Loss: 1.4599 Acc: 0.7943
val Loss: 1.2111 Acc: 0.8182
Epoch 17/68
----------
train Loss: 1.3773 Acc: 0.8565
val Loss: 1.4361 Acc: 0.7727
Epoch 18/68
----------
train Loss: 1.2903 Acc: 0.8373
val Loss: 1.2874 Acc: 0.7500
Epoch 19/68
----------
train Loss: 1.2061 Acc: 0.9426
val Loss: 1.2029 Acc: 0.7955
Epoch 20/68
----------
train Loss: 1.3087 Acc: 0.8660
val Loss: 1.1669 Acc: 0.7955
Epoch 21/68
----------
train Loss: 1.3898 Acc: 0.8852
val Loss: 1.1724 Acc: 0.7727
Epoch 22/68
----------
train Loss: 1.2533 Acc: 0.8804
val Loss: 1.1627 Acc: 0.7727
Epoch 23/68
----------
train Loss: 1.4587 Acc: 0.8804
val Loss: 1.1215 Acc: 0.8182
Epoch 24/68
----------
train Loss: 1.0407 Acc: 0.9187
val Loss: 1.1164 Acc: 0.8182
Epoch 25/68
----------
train Loss: 1.2231 Acc: 0.9330
val Loss: 1.1966 Acc: 0.8182
Epoch 26/68
----------
train Loss: 1.4175 Acc: 0.9474
val Loss: 1.2256 Acc: 0.8182
Epoch 27/68
----------
train Loss: 1.1322 Acc: 0.9809
val Loss: 1.2982 Acc: 0.7955
Epoch 28/68
----------
train Loss: 1.3360 Acc: 0.8612
val Loss: 1.1833 Acc: 0.7955
Epoch 29/68
----------
train Loss: 1.4225 Acc: 0.8086
val Loss: 1.0513 Acc: 0.7955
Epoch 30/68
----------
train Loss: 1.2277 Acc: 0.8852
val Loss: 1.0080 Acc: 0.8182
Epoch 31/68
----------
train Loss: 1.0703 Acc: 0.9378
val Loss: 1.0853 Acc: 0.7955
Epoch 32/68
----------
train Loss: 1.2089 Acc: 0.9139
val Loss: 1.1060 Acc: 0.7955
Epoch 33/68
----------
train Loss: 1.2992 Acc: 0.9043
val Loss: 1.1180 Acc: 0.7727
Epoch 34/68
----------
train Loss: 1.2495 Acc: 0.9665
val Loss: 1.2177 Acc: 0.8182
Epoch 35/68
----------
train Loss: 0.9508 Acc: 0.9761
val Loss: 1.2891 Acc: 0.7727
Epoch 36/68
----------
train Loss: 1.4884 Acc: 0.8517
val Loss: 1.2037 Acc: 0.8409
Epoch 37/68
----------
train Loss: 1.2557 Acc: 0.8230
val Loss: 1.2398 Acc: 0.8636
Epoch 38/68
----------
train Loss: 1.3072 Acc: 0.9522
val Loss: 1.2041 Acc: 0.8182
Epoch 39/68
----------
train Loss: 1.3051 Acc: 0.7895
val Loss: 1.2446 Acc: 0.7955
Epoch 40/68
----------
train Loss: 1.1219 Acc: 0.9187
val Loss: 1.2792 Acc: 0.7500
Epoch 41/68
----------
train Loss: 1.5448 Acc: 0.6986
val Loss: 1.2187 Acc: 0.7727
Epoch 42/68
----------
train Loss: 1.1132 Acc: 0.8804
val Loss: 1.2539 Acc: 0.7273
Epoch 43/68
----------
train Loss: 1.2671 Acc: 0.8756
val Loss: 1.1910 Acc: 0.7727
Epoch 44/68
----------
train Loss: 1.1490 Acc: 0.8947
val Loss: 1.2775 Acc: 0.7955
Epoch 45/68
----------
train Loss: 0.7576 Acc: 0.9665
val Loss: 1.2112 Acc: 0.8182
Epoch 46/68
----------
train Loss: 1.5840 Acc: 0.8278
val Loss: 1.2476 Acc: 0.7955
Epoch 47/68
----------
train Loss: 1.1574 Acc: 0.9378
val Loss: 1.3031 Acc: 0.7955
Epoch 48/68
----------
train Loss: 1.2821 Acc: 0.8373
val Loss: 1.4032 Acc: 0.8182
Epoch 49/68
----------
train Loss: 1.2917 Acc: 0.9617
val Loss: 1.3455 Acc: 0.7727
Epoch 50/68
----------
train Loss: 1.2072 Acc: 0.8900
val Loss: 1.3158 Acc: 0.7500
Epoch 51/68
----------
train Loss: 0.9240 Acc: 1.0000
val Loss: 1.1968 Acc: 0.8182
Epoch 52/68
----------
train Loss: 1.2384 Acc: 0.8756
val Loss: 1.2006 Acc: 0.7727
Epoch 53/68
----------
train Loss: 1.4138 Acc: 0.9330
val Loss: 1.2271 Acc: 0.8182
Epoch 54/68
----------
train Loss: 1.1065 Acc: 0.9474
val Loss: 1.3202 Acc: 0.7955
Epoch 55/68
----------
train Loss: 1.1679 Acc: 0.9474
val Loss: 1.4301 Acc: 0.6818
Epoch 56/68
----------
train Loss: 1.3555 Acc: 0.9378
val Loss: 1.2952 Acc: 0.7500
Epoch 57/68
----------
train Loss: 1.4369 Acc: 0.8756
val Loss: 1.3428 Acc: 0.7727
Epoch 58/68
----------
train Loss: 1.1708 Acc: 0.8373
val Loss: 1.3057 Acc: 0.7727
Epoch 59/68
----------
train Loss: 1.2029 Acc: 0.9282
val Loss: 1.3869 Acc: 0.7045
Epoch 60/68
----------
train Loss: 1.0104 Acc: 0.9139
val Loss: 1.3810 Acc: 0.7500
Epoch 61/68
----------
train Loss: 1.3980 Acc: 0.7943
val Loss: 1.4132 Acc: 0.7045
Epoch 62/68
----------
train Loss: 1.3506 Acc: 0.9665
val Loss: 1.4368 Acc: 0.7273
Epoch 63/68
----------
train Loss: 1.1794 Acc: 0.9522
val Loss: 1.4186 Acc: 0.7273
Epoch 64/68
----------
train Loss: 1.0598 Acc: 0.9522
val Loss: 1.4366 Acc: 0.7727
Epoch 65/68
----------
train Loss: 1.2099 Acc: 0.8804
val Loss: 1.4250 Acc: 0.7273
Epoch 66/68
----------
train Loss: 1.2034 Acc: 0.9043
val Loss: 1.4973 Acc: 0.7045
Epoch 67/68
----------
train Loss: 1.3501 Acc: 0.8900
val Loss: 1.5485 Acc: 0.7500
Epoch 68/68
----------
train Loss: 1.1281 Acc: 0.9139
[32m[I 2025-06-29 00:54:26,501][0m Trial 108 finished with value: 0.75 and parameters: {'batch_size': 79, 'lr': 0.0003443067176150756, 'num_epochs': 68, 'weight_decay': 0.0036155171154207493, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5856 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_79_lr_0.0003443067176150756_epoch_68_wd_0.0036155171154207493_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/71
----------
train Loss: 3.4029 Acc: 0.3493
val Loss: 2.8670 Acc: 0.6136
Epoch 2/71
----------
train Loss: 2.6066 Acc: 0.5502
val Loss: 1.9717 Acc: 0.6364
Epoch 3/71
----------
train Loss: 2.2492 Acc: 0.5167
val Loss: 1.8090 Acc: 0.6364
Epoch 4/71
----------
train Loss: 2.1382 Acc: 0.5407
val Loss: 1.6386 Acc: 0.7500
Epoch 5/71
----------
train Loss: 2.0596 Acc: 0.6603
val Loss: 1.5114 Acc: 0.7500
Epoch 6/71
----------
train Loss: 1.8612 Acc: 0.6651
val Loss: 1.3750 Acc: 0.7727
Epoch 7/71
----------
train Loss: 1.6570 Acc: 0.8038
val Loss: 1.2884 Acc: 0.8182
Epoch 8/71
----------
train Loss: 1.7548 Acc: 0.7560
val Loss: 1.2930 Acc: 0.7727
Epoch 9/71
----------
train Loss: 1.7499 Acc: 0.7608
val Loss: 1.3961 Acc: 0.7273
Epoch 10/71
----------
train Loss: 1.0774 Acc: 0.9522
val Loss: 1.2465 Acc: 0.8409
Epoch 11/71
----------
train Loss: 1.6945 Acc: 0.7895
val Loss: 1.1628 Acc: 0.8182
Epoch 12/71
----------
train Loss: 1.4747 Acc: 0.7656
val Loss: 1.3715 Acc: 0.7955
Epoch 13/71
----------
train Loss: 1.3155 Acc: 0.8995
val Loss: 1.3655 Acc: 0.8182
Epoch 14/71
----------
train Loss: 1.2335 Acc: 0.8373
val Loss: 1.3108 Acc: 0.7500
Epoch 15/71
----------
train Loss: 1.3709 Acc: 0.8325
val Loss: 1.1395 Acc: 0.8182
Epoch 16/71
----------
train Loss: 1.4300 Acc: 0.8230
val Loss: 1.2224 Acc: 0.8182
Epoch 17/71
----------
train Loss: 1.3771 Acc: 0.8612
val Loss: 1.3284 Acc: 0.7955
Epoch 18/71
----------
train Loss: 1.2962 Acc: 0.8421
val Loss: 1.3508 Acc: 0.7727
Epoch 19/71
----------
train Loss: 1.2305 Acc: 0.9091
val Loss: 1.2352 Acc: 0.7727
Epoch 20/71
----------
train Loss: 1.2863 Acc: 0.8852
val Loss: 1.1671 Acc: 0.8182
Epoch 21/71
----------
train Loss: 1.3853 Acc: 0.9139
val Loss: 1.1294 Acc: 0.8864
Epoch 22/71
----------
train Loss: 1.2264 Acc: 0.8947
val Loss: 1.1396 Acc: 0.8182
Epoch 23/71
----------
train Loss: 1.4843 Acc: 0.8804
val Loss: 1.1597 Acc: 0.8182
Epoch 24/71
----------
train Loss: 1.0345 Acc: 0.9378
val Loss: 1.1817 Acc: 0.8182
Epoch 25/71
----------
train Loss: 1.2283 Acc: 0.9426
val Loss: 1.2321 Acc: 0.7727
Epoch 26/71
----------
train Loss: 1.4015 Acc: 0.9617
[32m[I 2025-06-29 01:00:21,817][0m Trial 109 finished with value: 0.8863636363636364 and parameters: {'batch_size': 97, 'lr': 0.0003930447443819334, 'num_epochs': 71, 'weight_decay': 0.002611683470042746, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2601 Acc: 0.8182
Early stopping at epoch 26 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_97_lr_0.0003930447443819334_epoch_71_wd_0.002611683470042746_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/72
----------
train Loss: 3.5782 Acc: 0.3062
val Loss: 3.2826 Acc: 0.5682
Epoch 2/72
----------
train Loss: 3.0048 Acc: 0.5167
val Loss: 2.5682 Acc: 0.6364
Epoch 3/72
----------
train Loss: 2.5821 Acc: 0.5167
val Loss: 2.0309 Acc: 0.6364
Epoch 4/72
----------
train Loss: 2.3661 Acc: 0.5120
val Loss: 1.8913 Acc: 0.6364
Epoch 5/72
----------
train Loss: 2.2666 Acc: 0.5455
val Loss: 1.7962 Acc: 0.6591
Epoch 6/72
----------
train Loss: 2.1035 Acc: 0.5694
val Loss: 1.6909 Acc: 0.6818
Epoch 7/72
----------
train Loss: 1.9801 Acc: 0.6364
val Loss: 1.6437 Acc: 0.7273
Epoch 8/72
----------
train Loss: 2.0408 Acc: 0.6220
val Loss: 1.5545 Acc: 0.7500
Epoch 9/72
----------
train Loss: 1.9645 Acc: 0.6890
val Loss: 1.5613 Acc: 0.7500
Epoch 10/72
----------
train Loss: 1.4607 Acc: 0.8804
val Loss: 1.4815 Acc: 0.7955
Epoch 11/72
----------
train Loss: 1.8040 Acc: 0.7273
val Loss: 1.4205 Acc: 0.7955
Epoch 12/72
----------
train Loss: 1.7540 Acc: 0.7081
val Loss: 1.4425 Acc: 0.7727
Epoch 13/72
----------
train Loss: 1.5057 Acc: 0.8708
val Loss: 1.3479 Acc: 0.7955
Epoch 14/72
----------
train Loss: 1.3766 Acc: 0.8230
val Loss: 1.3837 Acc: 0.7273
Epoch 15/72
----------
train Loss: 1.4980 Acc: 0.7943
val Loss: 1.3244 Acc: 0.7273
Epoch 16/72
----------
train Loss: 1.5185 Acc: 0.7560
val Loss: 1.2641 Acc: 0.7955
Epoch 17/72
----------
train Loss: 1.4136 Acc: 0.8517
val Loss: 1.3155 Acc: 0.8409
Epoch 18/72
----------
train Loss: 1.3419 Acc: 0.8373
val Loss: 1.2236 Acc: 0.8182
Epoch 19/72
----------
train Loss: 1.2338 Acc: 0.9234
val Loss: 1.2120 Acc: 0.8182
Epoch 20/72
----------
train Loss: 1.3606 Acc: 0.8565
val Loss: 1.1705 Acc: 0.7727
Epoch 21/72
----------
train Loss: 1.4422 Acc: 0.8804
val Loss: 1.1676 Acc: 0.8182
Epoch 22/72
----------
train Loss: 1.2916 Acc: 0.8708
val Loss: 1.1734 Acc: 0.8182
Epoch 23/72
----------
train Loss: 1.4907 Acc: 0.8756
val Loss: 1.1439 Acc: 0.8182
Epoch 24/72
----------
train Loss: 1.0435 Acc: 0.9282
val Loss: 1.1115 Acc: 0.8409
Epoch 25/72
----------
train Loss: 1.2509 Acc: 0.9474
val Loss: 1.1854 Acc: 0.8182
Epoch 26/72
----------
train Loss: 1.4004 Acc: 0.9282
val Loss: 1.2387 Acc: 0.8409
Epoch 27/72
----------
train Loss: 1.1484 Acc: 0.9761
val Loss: 1.3324 Acc: 0.8182
Epoch 28/72
----------
train Loss: 1.3750 Acc: 0.8947
val Loss: 1.2868 Acc: 0.8182
Epoch 29/72
----------
train Loss: 1.4753 Acc: 0.7656
val Loss: 1.1726 Acc: 0.8409
Epoch 30/72
----------
train Loss: 1.2609 Acc: 0.8660
val Loss: 1.1398 Acc: 0.8182
Epoch 31/72
----------
train Loss: 1.1203 Acc: 0.9378
val Loss: 1.1151 Acc: 0.8636
Epoch 32/72
----------
train Loss: 1.2705 Acc: 0.8900
val Loss: 1.1260 Acc: 0.7955
Epoch 33/72
----------
train Loss: 1.3127 Acc: 0.8995
val Loss: 1.1747 Acc: 0.8182
Epoch 34/72
----------
train Loss: 1.2849 Acc: 0.9378
val Loss: 1.2504 Acc: 0.8182
Epoch 35/72
----------
train Loss: 0.9685 Acc: 0.9809
val Loss: 1.3173 Acc: 0.7955
Epoch 36/72
----------
train Loss: 1.5077 Acc: 0.8517
val Loss: 1.2898 Acc: 0.7955
Epoch 37/72
----------
train Loss: 1.2651 Acc: 0.8469
val Loss: 1.2561 Acc: 0.7955
Epoch 38/72
----------
train Loss: 1.3069 Acc: 0.9474
val Loss: 1.2255 Acc: 0.8409
Epoch 39/72
----------
train Loss: 1.3729 Acc: 0.7751
val Loss: 1.3063 Acc: 0.7727
Epoch 40/72
----------
train Loss: 1.1349 Acc: 0.9234
val Loss: 1.4143 Acc: 0.7727
Epoch 41/72
----------
train Loss: 1.5940 Acc: 0.7225
val Loss: 1.3357 Acc: 0.8182
Epoch 42/72
----------
train Loss: 1.1136 Acc: 0.8947
val Loss: 1.2676 Acc: 0.7727
Epoch 43/72
----------
train Loss: 1.3062 Acc: 0.8756
val Loss: 1.2049 Acc: 0.7955
Epoch 44/72
----------
train Loss: 1.1869 Acc: 0.8947
val Loss: 1.2906 Acc: 0.8182
Epoch 45/72
----------
train Loss: 0.7606 Acc: 0.9713
val Loss: 1.2819 Acc: 0.8182
Epoch 46/72
----------
train Loss: 1.5951 Acc: 0.8230
val Loss: 1.3937 Acc: 0.7955
Epoch 47/72
----------
train Loss: 1.1760 Acc: 0.9282
val Loss: 1.3263 Acc: 0.7727
Epoch 48/72
----------
train Loss: 1.3005 Acc: 0.8660
val Loss: 1.3165 Acc: 0.7955
Epoch 49/72
----------
train Loss: 1.2768 Acc: 0.9665
val Loss: 1.3850 Acc: 0.7955
Epoch 50/72
----------
train Loss: 1.2233 Acc: 0.9043
val Loss: 1.4363 Acc: 0.7500
Epoch 51/72
----------
train Loss: 0.9456 Acc: 0.9952
val Loss: 1.2948 Acc: 0.8182
Epoch 52/72
----------
train Loss: 1.2794 Acc: 0.8708
val Loss: 1.2719 Acc: 0.8182
Epoch 53/72
----------
train Loss: 1.4591 Acc: 0.9187
val Loss: 1.2797 Acc: 0.7727
Epoch 54/72
----------
train Loss: 1.1222 Acc: 0.9282
val Loss: 1.3579 Acc: 0.7273
Epoch 55/72
----------
train Loss: 1.1626 Acc: 0.9522
val Loss: 1.4448 Acc: 0.7045
Epoch 56/72
----------
train Loss: 1.3592 Acc: 0.9330
val Loss: 1.4033 Acc: 0.7045
Epoch 57/72
----------
train Loss: 1.4704 Acc: 0.8421
val Loss: 1.3943 Acc: 0.7500
Epoch 58/72
----------
train Loss: 1.1988 Acc: 0.8230
val Loss: 1.3605 Acc: 0.7727
Epoch 59/72
----------
train Loss: 1.2300 Acc: 0.9282
val Loss: 1.4542 Acc: 0.7273
Epoch 60/72
----------
train Loss: 1.0395 Acc: 0.8756
val Loss: 1.4752 Acc: 0.7500
Epoch 61/72
----------
train Loss: 1.4407 Acc: 0.7799
val Loss: 1.4361 Acc: 0.7045
Epoch 62/72
----------
train Loss: 1.3668 Acc: 0.9426
val Loss: 1.4049 Acc: 0.7273
Epoch 63/72
----------
train Loss: 1.2066 Acc: 0.9282
val Loss: 1.4632 Acc: 0.7045
Epoch 64/72
----------
train Loss: 1.0845 Acc: 0.9522
val Loss: 1.4822 Acc: 0.7273
Epoch 65/72
----------
train Loss: 1.2137 Acc: 0.8708
val Loss: 1.5037 Acc: 0.6818
Epoch 66/72
----------
train Loss: 1.1948 Acc: 0.8900
val Loss: 1.4593 Acc: 0.6591
Epoch 67/72
----------
train Loss: 1.3849 Acc: 0.8804
val Loss: 1.4440 Acc: 0.7045
Epoch 68/72
----------
train Loss: 1.1280 Acc: 0.9139
val Loss: 1.4425 Acc: 0.7500
Epoch 69/72
----------
train Loss: 1.0786 Acc: 0.8995
val Loss: 1.4172 Acc: 0.7727
Epoch 70/72
----------
train Loss: 1.2614 Acc: 0.9187
val Loss: 1.3771 Acc: 0.7727
Epoch 71/72
----------
train Loss: 1.3141 Acc: 0.9330
val Loss: 1.3565 Acc: 0.7727
Epoch 72/72
----------
train Loss: 1.3290 Acc: 0.8852
[32m[I 2025-06-29 01:16:46,060][0m Trial 110 finished with value: 0.7727272727272727 and parameters: {'batch_size': 97, 'lr': 0.0002241198684906573, 'num_epochs': 72, 'weight_decay': 0.00715162833200054, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3830 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_97_lr_0.0002241198684906573_epoch_72_wd_0.00715162833200054_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/64
----------
train Loss: 3.3202 Acc: 0.3684
val Loss: 2.6447 Acc: 0.6364
Epoch 2/64
----------
train Loss: 2.4874 Acc: 0.5407
val Loss: 1.9534 Acc: 0.6364
Epoch 3/64
----------
train Loss: 2.1909 Acc: 0.5263
val Loss: 1.7508 Acc: 0.6591
Epoch 4/64
----------
train Loss: 2.0863 Acc: 0.5694
val Loss: 1.6214 Acc: 0.7500
Epoch 5/64
----------
train Loss: 1.9894 Acc: 0.6986
val Loss: 1.4762 Acc: 0.8409
Epoch 6/64
----------
train Loss: 1.8116 Acc: 0.6986
val Loss: 1.3477 Acc: 0.8409
Epoch 7/64
----------
train Loss: 1.5407 Acc: 0.8373
val Loss: 1.2489 Acc: 0.8409
Epoch 8/64
----------
train Loss: 1.7064 Acc: 0.7656
val Loss: 1.2623 Acc: 0.8409
Epoch 9/64
----------
train Loss: 1.6900 Acc: 0.7656
val Loss: 1.3957 Acc: 0.7955
Epoch 10/64
----------
train Loss: 1.0271 Acc: 0.9426
val Loss: 1.2359 Acc: 0.7500
Epoch 11/64
----------
train Loss: 1.7374 Acc: 0.7847
val Loss: 1.2244 Acc: 0.7955
Epoch 12/64
----------
train Loss: 1.4628 Acc: 0.7608
val Loss: 1.6218 Acc: 0.7727
Epoch 13/64
----------
train Loss: 1.3403 Acc: 0.8995
val Loss: 1.4560 Acc: 0.7955
Epoch 14/64
----------
train Loss: 1.2243 Acc: 0.8325
val Loss: 1.3792 Acc: 0.7727
Epoch 15/64
----------
train Loss: 1.3940 Acc: 0.8278
val Loss: 1.1922 Acc: 0.8409
Epoch 16/64
----------
train Loss: 1.3841 Acc: 0.8278
val Loss: 1.4280 Acc: 0.8182
Epoch 17/64
----------
train Loss: 1.3891 Acc: 0.8517
val Loss: 1.2932 Acc: 0.7727
Epoch 18/64
----------
train Loss: 1.3140 Acc: 0.8325
val Loss: 1.2027 Acc: 0.8182
Epoch 19/64
----------
train Loss: 1.2182 Acc: 0.9378
val Loss: 1.1422 Acc: 0.8182
Epoch 20/64
----------
train Loss: 1.3056 Acc: 0.8804
val Loss: 1.0955 Acc: 0.7955
Epoch 21/64
----------
train Loss: 1.4178 Acc: 0.8852
val Loss: 1.0454 Acc: 0.8182
Epoch 22/64
----------
train Loss: 1.2416 Acc: 0.8900
val Loss: 1.1706 Acc: 0.8409
Epoch 23/64
----------
train Loss: 1.4697 Acc: 0.8804
val Loss: 1.2621 Acc: 0.8182
Epoch 24/64
----------
train Loss: 1.0568 Acc: 0.9378
val Loss: 1.2519 Acc: 0.7727
Epoch 25/64
----------
train Loss: 1.2264 Acc: 0.9569
val Loss: 1.3476 Acc: 0.7955
Epoch 26/64
----------
train Loss: 1.4230 Acc: 0.9426
val Loss: 1.1763 Acc: 0.8182
Epoch 27/64
----------
train Loss: 1.1538 Acc: 0.9665
val Loss: 1.2597 Acc: 0.7955
Epoch 28/64
----------
train Loss: 1.3270 Acc: 0.8517
val Loss: 1.1469 Acc: 0.8409
Epoch 29/64
----------
train Loss: 1.4383 Acc: 0.8182
val Loss: 1.1944 Acc: 0.8636
Epoch 30/64
----------
train Loss: 1.2450 Acc: 0.8900
val Loss: 1.2027 Acc: 0.7727
Epoch 31/64
----------
train Loss: 1.1109 Acc: 0.9234
val Loss: 1.2298 Acc: 0.7955
Epoch 32/64
----------
train Loss: 1.1748 Acc: 0.9091
val Loss: 1.2948 Acc: 0.7955
Epoch 33/64
----------
train Loss: 1.3254 Acc: 0.8852
val Loss: 1.4015 Acc: 0.7273
Epoch 34/64
----------
train Loss: 1.2654 Acc: 0.9330
[32m[I 2025-06-29 01:24:30,694][0m Trial 111 finished with value: 0.8636363636363636 and parameters: {'batch_size': 104, 'lr': 0.0004947863787091801, 'num_epochs': 64, 'weight_decay': 0.004894906807164804, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4909 Acc: 0.7500
Early stopping at epoch 34 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_104_lr_0.0004947863787091801_epoch_64_wd_0.004894906807164804_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/63
----------
train Loss: 0.6947 Acc: 0.2392
val Loss: 0.6756 Acc: 0.2727
Epoch 2/63
----------
train Loss: 0.6694 Acc: 0.2823
val Loss: 0.6566 Acc: 0.2955
Epoch 3/63
----------
train Loss: 0.6489 Acc: 0.3445
val Loss: 0.6300 Acc: 0.3636
Epoch 4/63
----------
train Loss: 0.6341 Acc: 0.3732
val Loss: 0.6134 Acc: 0.4091
Epoch 5/63
----------
train Loss: 0.6235 Acc: 0.4067
val Loss: 0.6031 Acc: 0.5000
Epoch 6/63
----------
train Loss: 0.6048 Acc: 0.4641
val Loss: 0.5874 Acc: 0.5227
Epoch 7/63
----------
train Loss: 0.5865 Acc: 0.5167
val Loss: 0.5695 Acc: 0.5682
Epoch 8/63
----------
train Loss: 0.5753 Acc: 0.5215
val Loss: 0.5533 Acc: 0.6136
Epoch 9/63
----------
train Loss: 0.5613 Acc: 0.5455
val Loss: 0.5353 Acc: 0.6364
Epoch 10/63
----------
train Loss: 0.5350 Acc: 0.5359
val Loss: 0.5150 Acc: 0.6364
Epoch 11/63
----------
train Loss: 0.5371 Acc: 0.5311
val Loss: 0.5020 Acc: 0.6591
Epoch 12/63
----------
train Loss: 0.5307 Acc: 0.5311
val Loss: 0.4933 Acc: 0.6591
Epoch 13/63
----------
train Loss: 0.5045 Acc: 0.5885
val Loss: 0.4747 Acc: 0.6591
Epoch 14/63
----------
train Loss: 0.4875 Acc: 0.5837
val Loss: 0.4655 Acc: 0.6591
Epoch 15/63
----------
train Loss: 0.4885 Acc: 0.5550
val Loss: 0.4549 Acc: 0.6818
Epoch 16/63
----------
train Loss: 0.4785 Acc: 0.5694
val Loss: 0.4424 Acc: 0.6818
Epoch 17/63
----------
train Loss: 0.4688 Acc: 0.5598
val Loss: 0.4311 Acc: 0.6591
Epoch 18/63
----------
train Loss: 0.4579 Acc: 0.6124
val Loss: 0.4198 Acc: 0.6591
Epoch 19/63
----------
train Loss: 0.4426 Acc: 0.6459
val Loss: 0.4115 Acc: 0.6591
Epoch 20/63
----------
train Loss: 0.4431 Acc: 0.6220
val Loss: 0.4004 Acc: 0.6818
Epoch 21/63
----------
train Loss: 0.4410 Acc: 0.6124
val Loss: 0.3917 Acc: 0.7045
Epoch 22/63
----------
train Loss: 0.4343 Acc: 0.6220
val Loss: 0.3838 Acc: 0.7045
Epoch 23/63
----------
train Loss: 0.4236 Acc: 0.6411
val Loss: 0.3743 Acc: 0.7273
Epoch 24/63
----------
train Loss: 0.3957 Acc: 0.7081
val Loss: 0.3592 Acc: 0.7273
Epoch 25/63
----------
train Loss: 0.4158 Acc: 0.6746
val Loss: 0.3612 Acc: 0.7500
Epoch 26/63
----------
train Loss: 0.4152 Acc: 0.6986
val Loss: 0.3603 Acc: 0.7727
Epoch 27/63
----------
train Loss: 0.3759 Acc: 0.7368
val Loss: 0.3536 Acc: 0.7727
Epoch 28/63
----------
train Loss: 0.4077 Acc: 0.6794
val Loss: 0.3497 Acc: 0.7727
Epoch 29/63
----------
train Loss: 0.4240 Acc: 0.6364
val Loss: 0.3470 Acc: 0.7727
Epoch 30/63
----------
train Loss: 0.3986 Acc: 0.6890
val Loss: 0.3438 Acc: 0.8182
Epoch 31/63
----------
train Loss: 0.3612 Acc: 0.7990
val Loss: 0.3346 Acc: 0.7955
Epoch 32/63
----------
train Loss: 0.3780 Acc: 0.6986
val Loss: 0.3263 Acc: 0.7955
Epoch 33/63
----------
train Loss: 0.3938 Acc: 0.7033
val Loss: 0.3248 Acc: 0.7955
Epoch 34/63
----------
train Loss: 0.3698 Acc: 0.7512
val Loss: 0.3205 Acc: 0.7955
Epoch 35/63
----------
train Loss: 0.3324 Acc: 0.8373
val Loss: 0.3197 Acc: 0.7955
Epoch 36/63
----------
train Loss: 0.4013 Acc: 0.7129
val Loss: 0.3153 Acc: 0.8182
Epoch 37/63
----------
train Loss: 0.3543 Acc: 0.7560
val Loss: 0.3208 Acc: 0.7955
Epoch 38/63
----------
train Loss: 0.3524 Acc: 0.8421
val Loss: 0.3177 Acc: 0.7955
Epoch 39/63
----------
train Loss: 0.3740 Acc: 0.6938
val Loss: 0.3264 Acc: 0.7727
Epoch 40/63
----------
train Loss: 0.3299 Acc: 0.8038
val Loss: 0.3228 Acc: 0.7955
Epoch 41/63
----------
train Loss: 0.3844 Acc: 0.7033
val Loss: 0.3162 Acc: 0.7955
Epoch 42/63
----------
train Loss: 0.3316 Acc: 0.7464
val Loss: 0.3075 Acc: 0.7955
Epoch 43/63
----------
train Loss: 0.3518 Acc: 0.7751
val Loss: 0.3026 Acc: 0.7955
Epoch 44/63
----------
train Loss: 0.3215 Acc: 0.8182
val Loss: 0.2989 Acc: 0.7955
Epoch 45/63
----------
train Loss: 0.2382 Acc: 0.9330
val Loss: 0.2927 Acc: 0.7955
Epoch 46/63
----------
train Loss: 0.3896 Acc: 0.7751
val Loss: 0.2948 Acc: 0.7955
Epoch 47/63
----------
train Loss: 0.3102 Acc: 0.8660
val Loss: 0.2924 Acc: 0.7955
Epoch 48/63
----------
train Loss: 0.3351 Acc: 0.7751
val Loss: 0.2929 Acc: 0.7955
Epoch 49/63
----------
train Loss: 0.3224 Acc: 0.8756
val Loss: 0.2904 Acc: 0.7955
Epoch 50/63
----------
train Loss: 0.3113 Acc: 0.8182
val Loss: 0.2919 Acc: 0.7955
Epoch 51/63
----------
train Loss: 0.2565 Acc: 0.9474
val Loss: 0.2846 Acc: 0.7955
Epoch 52/63
----------
train Loss: 0.3278 Acc: 0.7608
val Loss: 0.2861 Acc: 0.7727
Epoch 53/63
----------
train Loss: 0.3572 Acc: 0.8421
val Loss: 0.2842 Acc: 0.7727
Epoch 54/63
----------
train Loss: 0.2734 Acc: 0.9043
val Loss: 0.2784 Acc: 0.7955
Epoch 55/63
----------
train Loss: 0.2907 Acc: 0.9091
val Loss: 0.2768 Acc: 0.7955
Epoch 56/63
----------
train Loss: 0.3293 Acc: 0.8373
val Loss: 0.2775 Acc: 0.7955
Epoch 57/63
----------
train Loss: 0.3641 Acc: 0.7847
val Loss: 0.2762 Acc: 0.8182
Epoch 58/63
----------
train Loss: 0.3051 Acc: 0.7943
val Loss: 0.2757 Acc: 0.8182
Epoch 59/63
----------
train Loss: 0.3227 Acc: 0.8325
val Loss: 0.2757 Acc: 0.7955
Epoch 60/63
----------
train Loss: 0.2765 Acc: 0.8230
val Loss: 0.2779 Acc: 0.7955
Epoch 61/63
----------
train Loss: 0.3586 Acc: 0.7225
val Loss: 0.2774 Acc: 0.7955
Epoch 62/63
----------
train Loss: 0.3149 Acc: 0.8852
val Loss: 0.2751 Acc: 0.7955
Epoch 63/63
----------
train Loss: 0.2770 Acc: 0.9234
[32m[I 2025-06-29 01:38:52,482][0m Trial 112 finished with value: 0.7727272727272727 and parameters: {'batch_size': 104, 'lr': 4.6082166146133036e-05, 'num_epochs': 63, 'weight_decay': 0.0019723044319956686, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2746 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_104_lr_4.6082166146133036e-05_epoch_63_wd_0.0019723044319956686_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 3.4273 Acc: 0.3493
val Loss: 3.0354 Acc: 0.6136
Epoch 2/83
----------
train Loss: 2.6772 Acc: 0.5263
val Loss: 2.1229 Acc: 0.6364
Epoch 3/83
----------
train Loss: 2.3141 Acc: 0.5072
val Loss: 1.8898 Acc: 0.6364
Epoch 4/83
----------
train Loss: 2.2018 Acc: 0.5072
val Loss: 1.8292 Acc: 0.7045
Epoch 5/83
----------
train Loss: 2.1294 Acc: 0.6364
val Loss: 1.7468 Acc: 0.7727
Epoch 6/83
----------
train Loss: 1.9477 Acc: 0.6507
val Loss: 1.6555 Acc: 0.8182
Epoch 7/83
----------
train Loss: 1.7789 Acc: 0.7416
val Loss: 1.5589 Acc: 0.8182
Epoch 8/83
----------
train Loss: 1.8456 Acc: 0.7273
val Loss: 1.3771 Acc: 0.7955
Epoch 9/83
----------
train Loss: 1.8050 Acc: 0.7416
val Loss: 1.5395 Acc: 0.7727
Epoch 10/83
----------
train Loss: 1.1849 Acc: 0.9330
val Loss: 1.3378 Acc: 0.8182
Epoch 11/83
----------
train Loss: 1.6900 Acc: 0.7703
val Loss: 1.1717 Acc: 0.8864
Epoch 12/83
----------
train Loss: 1.5214 Acc: 0.7512
val Loss: 1.5391 Acc: 0.7955
Epoch 13/83
----------
train Loss: 1.3464 Acc: 0.8995
val Loss: 1.4864 Acc: 0.7955
Epoch 14/83
----------
train Loss: 1.2597 Acc: 0.8373
val Loss: 1.4142 Acc: 0.7273
Epoch 15/83
----------
train Loss: 1.4118 Acc: 0.8134
val Loss: 1.1462 Acc: 0.7955
Epoch 16/83
----------
train Loss: 1.4765 Acc: 0.7990
[32m[I 2025-06-29 01:42:31,439][0m Trial 113 finished with value: 0.8863636363636364 and parameters: {'batch_size': 90, 'lr': 0.0004032205885702636, 'num_epochs': 83, 'weight_decay': 0.01529468864640798, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3592 Acc: 0.8182
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_90_lr_0.0004032205885702636_epoch_83_wd_0.01529468864640798_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/74
----------
train Loss: 0.6901 Acc: 0.2344
val Loss: 0.6682 Acc: 0.2955
Epoch 2/74
----------
train Loss: 0.6536 Acc: 0.3541
val Loss: 0.6378 Acc: 0.4318
Epoch 3/74
----------
train Loss: 0.6240 Acc: 0.4354
val Loss: 0.5964 Acc: 0.4318
Epoch 4/74
----------
train Loss: 0.6012 Acc: 0.4689
val Loss: 0.5666 Acc: 0.5682
Epoch 5/74
----------
train Loss: 0.5828 Acc: 0.5167
val Loss: 0.5453 Acc: 0.6136
Epoch 6/74
----------
train Loss: 0.5553 Acc: 0.5263
val Loss: 0.5170 Acc: 0.6591
Epoch 7/74
----------
train Loss: 0.5271 Acc: 0.5694
val Loss: 0.4888 Acc: 0.6591
Epoch 8/74
----------
train Loss: 0.5180 Acc: 0.5359
val Loss: 0.4637 Acc: 0.6818
Epoch 9/74
----------
train Loss: 0.5011 Acc: 0.5550
val Loss: 0.4422 Acc: 0.6818
Epoch 10/74
----------
train Loss: 0.4564 Acc: 0.5981
val Loss: 0.4236 Acc: 0.6818
Epoch 11/74
----------
train Loss: 0.4691 Acc: 0.5694
val Loss: 0.4079 Acc: 0.7045
Epoch 12/74
----------
train Loss: 0.4688 Acc: 0.5837
val Loss: 0.4008 Acc: 0.7045
Epoch 13/74
----------
train Loss: 0.4335 Acc: 0.6507
val Loss: 0.3839 Acc: 0.7045
Epoch 14/74
----------
train Loss: 0.4110 Acc: 0.6555
val Loss: 0.3710 Acc: 0.7045
Epoch 15/74
----------
train Loss: 0.4227 Acc: 0.6411
val Loss: 0.3609 Acc: 0.7727
Epoch 16/74
----------
train Loss: 0.4139 Acc: 0.6794
val Loss: 0.3534 Acc: 0.7500
Epoch 17/74
----------
train Loss: 0.4020 Acc: 0.7273
val Loss: 0.3471 Acc: 0.7500
Epoch 18/74
----------
train Loss: 0.3853 Acc: 0.7081
val Loss: 0.3365 Acc: 0.7727
Epoch 19/74
----------
train Loss: 0.3651 Acc: 0.7751
val Loss: 0.3306 Acc: 0.7727
Epoch 20/74
----------
train Loss: 0.3786 Acc: 0.7512
val Loss: 0.3194 Acc: 0.7727
Epoch 21/74
----------
train Loss: 0.3781 Acc: 0.7608
val Loss: 0.3095 Acc: 0.7955
Epoch 22/74
----------
train Loss: 0.3652 Acc: 0.7464
val Loss: 0.3059 Acc: 0.7955
Epoch 23/74
----------
train Loss: 0.3641 Acc: 0.7608
val Loss: 0.2991 Acc: 0.7955
Epoch 24/74
----------
train Loss: 0.3194 Acc: 0.8469
val Loss: 0.2849 Acc: 0.7955
Epoch 25/74
----------
train Loss: 0.3441 Acc: 0.7895
val Loss: 0.2881 Acc: 0.8409
Epoch 26/74
----------
train Loss: 0.3509 Acc: 0.8182
val Loss: 0.2881 Acc: 0.8409
Epoch 27/74
----------
train Loss: 0.2972 Acc: 0.9187
val Loss: 0.2911 Acc: 0.8182
Epoch 28/74
----------
train Loss: 0.3506 Acc: 0.7847
val Loss: 0.2895 Acc: 0.7500
Epoch 29/74
----------
train Loss: 0.3731 Acc: 0.7225
val Loss: 0.2909 Acc: 0.7727
Epoch 30/74
----------
train Loss: 0.3294 Acc: 0.7799
val Loss: 0.2805 Acc: 0.7955
Epoch 31/74
----------
train Loss: 0.2857 Acc: 0.9043
val Loss: 0.2705 Acc: 0.8182
Epoch 32/74
----------
train Loss: 0.3133 Acc: 0.8086
val Loss: 0.2659 Acc: 0.7955
Epoch 33/74
----------
train Loss: 0.3323 Acc: 0.8182
val Loss: 0.2656 Acc: 0.7955
Epoch 34/74
----------
train Loss: 0.3078 Acc: 0.8612
val Loss: 0.2667 Acc: 0.7955
Epoch 35/74
----------
train Loss: 0.2545 Acc: 0.9569
val Loss: 0.2738 Acc: 0.7500
Epoch 36/74
----------
train Loss: 0.3538 Acc: 0.7703
val Loss: 0.2735 Acc: 0.7727
Epoch 37/74
----------
train Loss: 0.2937 Acc: 0.8278
val Loss: 0.2780 Acc: 0.7500
Epoch 38/74
----------
train Loss: 0.2934 Acc: 0.9378
val Loss: 0.2694 Acc: 0.7727
Epoch 39/74
----------
train Loss: 0.3249 Acc: 0.7321
val Loss: 0.2747 Acc: 0.7727
Epoch 40/74
----------
train Loss: 0.2657 Acc: 0.8900
val Loss: 0.2722 Acc: 0.7955
Epoch 41/74
----------
train Loss: 0.3479 Acc: 0.7368
val Loss: 0.2655 Acc: 0.8182
Epoch 42/74
----------
train Loss: 0.2673 Acc: 0.8278
val Loss: 0.2591 Acc: 0.7955
Epoch 43/74
----------
train Loss: 0.2912 Acc: 0.8373
val Loss: 0.2573 Acc: 0.7955
Epoch 44/74
----------
train Loss: 0.2725 Acc: 0.8565
val Loss: 0.2610 Acc: 0.7955
Epoch 45/74
----------
train Loss: 0.1737 Acc: 0.9665
val Loss: 0.2621 Acc: 0.8409
Epoch 46/74
----------
train Loss: 0.3625 Acc: 0.8086
val Loss: 0.2670 Acc: 0.8182
Epoch 47/74
----------
train Loss: 0.2610 Acc: 0.8852
val Loss: 0.2611 Acc: 0.8182
Epoch 48/74
----------
train Loss: 0.2975 Acc: 0.8373
val Loss: 0.2646 Acc: 0.7727
Epoch 49/74
----------
train Loss: 0.2797 Acc: 0.9282
val Loss: 0.2646 Acc: 0.7955
Epoch 50/74
----------
train Loss: 0.2738 Acc: 0.8612
val Loss: 0.2646 Acc: 0.7727
Epoch 51/74
----------
train Loss: 0.2033 Acc: 0.9856
val Loss: 0.2577 Acc: 0.7727
Epoch 52/74
----------
train Loss: 0.2896 Acc: 0.8086
val Loss: 0.2588 Acc: 0.7500
Epoch 53/74
----------
train Loss: 0.3240 Acc: 0.9139
val Loss: 0.2560 Acc: 0.7727
Epoch 54/74
----------
train Loss: 0.2383 Acc: 0.9330
val Loss: 0.2518 Acc: 0.7955
Epoch 55/74
----------
train Loss: 0.2537 Acc: 0.9282
val Loss: 0.2547 Acc: 0.7500
Epoch 56/74
----------
train Loss: 0.2965 Acc: 0.8947
val Loss: 0.2569 Acc: 0.7727
Epoch 57/74
----------
train Loss: 0.3375 Acc: 0.8182
val Loss: 0.2562 Acc: 0.7727
Epoch 58/74
----------
train Loss: 0.2763 Acc: 0.7943
val Loss: 0.2501 Acc: 0.8182
Epoch 59/74
----------
train Loss: 0.2862 Acc: 0.8852
val Loss: 0.2513 Acc: 0.7955
Epoch 60/74
----------
train Loss: 0.2382 Acc: 0.8756
val Loss: 0.2532 Acc: 0.7727
Epoch 61/74
----------
train Loss: 0.3281 Acc: 0.7703
val Loss: 0.2582 Acc: 0.7727
Epoch 62/74
----------
train Loss: 0.2951 Acc: 0.9569
val Loss: 0.2585 Acc: 0.7727
Epoch 63/74
----------
train Loss: 0.2531 Acc: 0.9378
val Loss: 0.2577 Acc: 0.7727
Epoch 64/74
----------
train Loss: 0.2380 Acc: 0.9426
val Loss: 0.2559 Acc: 0.7955
Epoch 65/74
----------
train Loss: 0.2732 Acc: 0.8278
val Loss: 0.2596 Acc: 0.7727
Epoch 66/74
----------
train Loss: 0.2666 Acc: 0.9043
val Loss: 0.2656 Acc: 0.7727
Epoch 67/74
----------
train Loss: 0.2994 Acc: 0.8708
val Loss: 0.2609 Acc: 0.7727
Epoch 68/74
----------
train Loss: 0.2504 Acc: 0.8947
val Loss: 0.2647 Acc: 0.7727
Epoch 69/74
----------
train Loss: 0.2483 Acc: 0.8900
val Loss: 0.2589 Acc: 0.7727
Epoch 70/74
----------
train Loss: 0.2806 Acc: 0.9091
val Loss: 0.2589 Acc: 0.7727
Epoch 71/74
----------
train Loss: 0.2962 Acc: 0.9091
val Loss: 0.2566 Acc: 0.7500
Epoch 72/74
----------
train Loss: 0.2953 Acc: 0.8947
val Loss: 0.2635 Acc: 0.7500
Epoch 73/74
----------
train Loss: 0.2121 Acc: 0.9617
val Loss: 0.2686 Acc: 0.7500
Epoch 74/74
----------
train Loss: 0.3100 Acc: 0.8660
[32m[I 2025-06-29 01:59:23,540][0m Trial 114 finished with value: 0.75 and parameters: {'batch_size': 93, 'lr': 6.727832042146601e-05, 'num_epochs': 74, 'weight_decay': 0.0003427613182488082, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2635 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_93_lr_6.727832042146601e-05_epoch_74_wd_0.0003427613182488082_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/75
----------
train Loss: 0.6812 Acc: 0.2632
val Loss: 0.6528 Acc: 0.3182
Epoch 2/75
----------
train Loss: 0.6249 Acc: 0.4593
val Loss: 0.5966 Acc: 0.5000
Epoch 3/75
----------
train Loss: 0.5808 Acc: 0.4737
val Loss: 0.5245 Acc: 0.6136
Epoch 4/75
----------
train Loss: 0.5459 Acc: 0.5215
val Loss: 0.4759 Acc: 0.6591
Epoch 5/75
----------
train Loss: 0.5194 Acc: 0.5598
val Loss: 0.4458 Acc: 0.6818
Epoch 6/75
----------
train Loss: 0.4847 Acc: 0.5598
val Loss: 0.4149 Acc: 0.6818
Epoch 7/75
----------
train Loss: 0.4527 Acc: 0.6077
val Loss: 0.3904 Acc: 0.7045
Epoch 8/75
----------
train Loss: 0.4560 Acc: 0.5742
val Loss: 0.3659 Acc: 0.7045
Epoch 9/75
----------
train Loss: 0.4427 Acc: 0.6268
val Loss: 0.3522 Acc: 0.7273
Epoch 10/75
----------
train Loss: 0.3691 Acc: 0.7560
val Loss: 0.3406 Acc: 0.6818
Epoch 11/75
----------
train Loss: 0.4055 Acc: 0.6077
val Loss: 0.3295 Acc: 0.7500
Epoch 12/75
----------
train Loss: 0.4117 Acc: 0.6364
val Loss: 0.3314 Acc: 0.7500
Epoch 13/75
----------
train Loss: 0.3700 Acc: 0.7560
val Loss: 0.3122 Acc: 0.7045
Epoch 14/75
----------
train Loss: 0.3389 Acc: 0.7751
val Loss: 0.3005 Acc: 0.7500
Epoch 15/75
----------
train Loss: 0.3633 Acc: 0.7464
val Loss: 0.2950 Acc: 0.7727
Epoch 16/75
----------
train Loss: 0.3564 Acc: 0.7512
val Loss: 0.3002 Acc: 0.7727
Epoch 17/75
----------
train Loss: 0.3409 Acc: 0.7943
val Loss: 0.3049 Acc: 0.7955
Epoch 18/75
----------
train Loss: 0.3205 Acc: 0.7895
val Loss: 0.2924 Acc: 0.7955
Epoch 19/75
----------
train Loss: 0.2967 Acc: 0.8469
val Loss: 0.2801 Acc: 0.7955
Epoch 20/75
----------
train Loss: 0.3193 Acc: 0.8469
val Loss: 0.2667 Acc: 0.7727
Epoch 21/75
----------
train Loss: 0.3278 Acc: 0.7990
val Loss: 0.2575 Acc: 0.7955
Epoch 22/75
----------
train Loss: 0.3016 Acc: 0.8469
val Loss: 0.2558 Acc: 0.7955
Epoch 23/75
----------
train Loss: 0.3162 Acc: 0.8517
val Loss: 0.2524 Acc: 0.7955
Epoch 24/75
----------
train Loss: 0.2506 Acc: 0.9139
val Loss: 0.2364 Acc: 0.7955
Epoch 25/75
----------
train Loss: 0.2834 Acc: 0.9282
val Loss: 0.2418 Acc: 0.7955
Epoch 26/75
----------
train Loss: 0.2991 Acc: 0.9139
val Loss: 0.2501 Acc: 0.7955
Epoch 27/75
----------
train Loss: 0.2417 Acc: 0.9713
val Loss: 0.2695 Acc: 0.7955
Epoch 28/75
----------
train Loss: 0.3060 Acc: 0.8612
val Loss: 0.2675 Acc: 0.7500
Epoch 29/75
----------
train Loss: 0.3316 Acc: 0.7560
val Loss: 0.2603 Acc: 0.7500
Epoch 30/75
----------
train Loss: 0.2808 Acc: 0.8660
val Loss: 0.2432 Acc: 0.7727
Epoch 31/75
----------
train Loss: 0.2391 Acc: 0.9282
val Loss: 0.2329 Acc: 0.7955
Epoch 32/75
----------
train Loss: 0.2720 Acc: 0.8565
val Loss: 0.2324 Acc: 0.8182
Epoch 33/75
----------
train Loss: 0.2850 Acc: 0.8708
val Loss: 0.2355 Acc: 0.7500
Epoch 34/75
----------
train Loss: 0.2742 Acc: 0.9091
val Loss: 0.2437 Acc: 0.7273
Epoch 35/75
----------
train Loss: 0.2162 Acc: 0.9809
val Loss: 0.2617 Acc: 0.7273
Epoch 36/75
----------
train Loss: 0.3277 Acc: 0.8230
val Loss: 0.2692 Acc: 0.7273
Epoch 37/75
----------
train Loss: 0.2673 Acc: 0.8182
[32m[I 2025-06-29 02:07:47,669][0m Trial 115 finished with value: 0.8181818181818182 and parameters: {'batch_size': 90, 'lr': 0.00011724376173922667, 'num_epochs': 75, 'weight_decay': 0.00041717110276909963, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2642 Acc: 0.7500
Early stopping at epoch 37 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_90_lr_0.00011724376173922667_epoch_75_wd_0.00041717110276909963_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/70
----------
train Loss: 3.2143 Acc: 0.3876
val Loss: 2.4921 Acc: 0.6364
Epoch 2/70
----------
train Loss: 2.4125 Acc: 0.5407
val Loss: 1.9121 Acc: 0.6364
Epoch 3/70
----------
train Loss: 2.1641 Acc: 0.5598
val Loss: 2.0025 Acc: 0.7273
Epoch 4/70
----------
train Loss: 2.0539 Acc: 0.5742
val Loss: 2.1850 Acc: 0.7727
Epoch 5/70
----------
train Loss: 1.9349 Acc: 0.7225
val Loss: 1.7984 Acc: 0.7955
Epoch 6/70
----------
train Loss: 1.7884 Acc: 0.7273
val Loss: 1.4706 Acc: 0.7727
Epoch 7/70
----------
train Loss: 1.4922 Acc: 0.8995
val Loss: 1.4692 Acc: 0.7727
Epoch 8/70
----------
train Loss: 1.6980 Acc: 0.7560
val Loss: 1.5668 Acc: 0.7500
Epoch 9/70
----------
train Loss: 1.7022 Acc: 0.7703
val Loss: 1.6948 Acc: 0.7955
Epoch 10/70
----------
train Loss: 1.0713 Acc: 0.9378
val Loss: 1.1447 Acc: 0.8182
Epoch 11/70
----------
train Loss: 1.7770 Acc: 0.7895
val Loss: 1.8770 Acc: 0.7273
Epoch 12/70
----------
train Loss: 1.4853 Acc: 0.7943
val Loss: 2.2889 Acc: 0.6818
Epoch 13/70
----------
train Loss: 1.3888 Acc: 0.8708
val Loss: 1.6254 Acc: 0.7727
Epoch 14/70
----------
train Loss: 1.3207 Acc: 0.8278
val Loss: 1.6233 Acc: 0.7727
Epoch 15/70
----------
train Loss: 1.4584 Acc: 0.8278
val Loss: 1.7989 Acc: 0.7273
Epoch 16/70
----------
train Loss: 1.4786 Acc: 0.7799
val Loss: 2.2734 Acc: 0.7045
Epoch 17/70
----------
train Loss: 1.3811 Acc: 0.8469
val Loss: 1.8201 Acc: 0.7500
Epoch 18/70
----------
train Loss: 1.3955 Acc: 0.8230
val Loss: 1.3603 Acc: 0.7273
Epoch 19/70
----------
train Loss: 1.2252 Acc: 0.9139
val Loss: 1.6005 Acc: 0.6818
Epoch 20/70
----------
train Loss: 1.3887 Acc: 0.8565
val Loss: 1.4633 Acc: 0.7273
Epoch 21/70
----------
train Loss: 1.5249 Acc: 0.8660
val Loss: 1.5065 Acc: 0.8182
Epoch 22/70
----------
train Loss: 1.3376 Acc: 0.8708
val Loss: 1.7364 Acc: 0.7045
Epoch 23/70
----------
train Loss: 1.5875 Acc: 0.8517
val Loss: 1.4059 Acc: 0.7045
Epoch 24/70
----------
train Loss: 1.1400 Acc: 0.9378
val Loss: 1.3669 Acc: 0.7727
Epoch 25/70
----------
train Loss: 1.2686 Acc: 0.9426
val Loss: 1.5893 Acc: 0.7500
Epoch 26/70
----------
train Loss: 1.4698 Acc: 0.9234
val Loss: 1.4629 Acc: 0.7045
Epoch 27/70
----------
train Loss: 1.2652 Acc: 0.9522
val Loss: 1.6311 Acc: 0.7727
Epoch 28/70
----------
train Loss: 1.4654 Acc: 0.8134
val Loss: 1.8372 Acc: 0.7955
Epoch 29/70
----------
train Loss: 1.5391 Acc: 0.7751
val Loss: 1.3576 Acc: 0.8182
Epoch 30/70
----------
train Loss: 1.3508 Acc: 0.8612
val Loss: 1.1714 Acc: 0.7955
Epoch 31/70
----------
train Loss: 1.1413 Acc: 0.9091
val Loss: 1.4362 Acc: 0.7727
Epoch 32/70
----------
train Loss: 1.2843 Acc: 0.8852
val Loss: 1.3644 Acc: 0.7500
Epoch 33/70
----------
train Loss: 1.4245 Acc: 0.8660
val Loss: 1.5102 Acc: 0.7955
Epoch 34/70
----------
train Loss: 1.3814 Acc: 0.9234
val Loss: 1.3635 Acc: 0.7727
Epoch 35/70
----------
train Loss: 1.0727 Acc: 0.9330
val Loss: 1.2897 Acc: 0.7955
Epoch 36/70
----------
train Loss: 1.6525 Acc: 0.8469
val Loss: 1.3425 Acc: 0.7955
Epoch 37/70
----------
train Loss: 1.4376 Acc: 0.8134
val Loss: 1.7997 Acc: 0.6136
Epoch 38/70
----------
train Loss: 1.5038 Acc: 0.9091
val Loss: 1.4021 Acc: 0.7727
Epoch 39/70
----------
train Loss: 1.4744 Acc: 0.7560
val Loss: 1.3672 Acc: 0.7955
Epoch 40/70
----------
train Loss: 1.2578 Acc: 0.9187
val Loss: 1.3213 Acc: 0.8182
Epoch 41/70
----------
train Loss: 1.6523 Acc: 0.7033
val Loss: 1.2469 Acc: 0.7727
Epoch 42/70
----------
train Loss: 1.2497 Acc: 0.8421
val Loss: 1.4624 Acc: 0.7045
Epoch 43/70
----------
train Loss: 1.3816 Acc: 0.8517
val Loss: 1.3346 Acc: 0.8182
Epoch 44/70
----------
train Loss: 1.2545 Acc: 0.8900
val Loss: 1.6178 Acc: 0.7500
Epoch 45/70
----------
train Loss: 0.8208 Acc: 0.9617
val Loss: 1.4401 Acc: 0.7273
Epoch 46/70
----------
train Loss: 1.7190 Acc: 0.7990
val Loss: 1.6124 Acc: 0.7273
Epoch 47/70
----------
train Loss: 1.2850 Acc: 0.9043
val Loss: 1.5483 Acc: 0.7955
Epoch 48/70
----------
train Loss: 1.3380 Acc: 0.8565
val Loss: 1.7169 Acc: 0.8182
Epoch 49/70
----------
train Loss: 1.3623 Acc: 0.8804
val Loss: 1.7420 Acc: 0.7500
Epoch 50/70
----------
train Loss: 1.3699 Acc: 0.8182
val Loss: 1.5381 Acc: 0.7045
Epoch 51/70
----------
train Loss: 1.0748 Acc: 0.9378
val Loss: 1.3288 Acc: 0.7727
Epoch 52/70
----------
train Loss: 1.3897 Acc: 0.7990
val Loss: 1.3378 Acc: 0.7500
Epoch 53/70
----------
train Loss: 1.5916 Acc: 0.8756
val Loss: 1.5307 Acc: 0.7045
Epoch 54/70
----------
train Loss: 1.2265 Acc: 0.9234
val Loss: 1.5824 Acc: 0.7500
Epoch 55/70
----------
train Loss: 1.2704 Acc: 0.9234
val Loss: 1.5761 Acc: 0.7727
Epoch 56/70
----------
train Loss: 1.4491 Acc: 0.8947
val Loss: 1.3699 Acc: 0.7500
Epoch 57/70
----------
train Loss: 1.5520 Acc: 0.8086
val Loss: 1.6912 Acc: 0.7500
Epoch 58/70
----------
train Loss: 1.3298 Acc: 0.7990
val Loss: 1.7029 Acc: 0.7045
Epoch 59/70
----------
train Loss: 1.4274 Acc: 0.8421
val Loss: 1.8105 Acc: 0.6591
Epoch 60/70
----------
train Loss: 1.1305 Acc: 0.8804
val Loss: 1.4505 Acc: 0.7045
Epoch 61/70
----------
train Loss: 1.5250 Acc: 0.7895
val Loss: 1.8624 Acc: 0.7273
Epoch 62/70
----------
train Loss: 1.5289 Acc: 0.8995
val Loss: 1.6564 Acc: 0.6591
Epoch 63/70
----------
train Loss: 1.2980 Acc: 0.9139
val Loss: 1.4008 Acc: 0.7955
Epoch 64/70
----------
train Loss: 1.1494 Acc: 0.9234
val Loss: 1.4366 Acc: 0.7955
Epoch 65/70
----------
train Loss: 1.3486 Acc: 0.8756
val Loss: 1.7543 Acc: 0.7273
Epoch 66/70
----------
train Loss: 1.4360 Acc: 0.8852
val Loss: 1.6244 Acc: 0.7500
Epoch 67/70
----------
train Loss: 1.5516 Acc: 0.8612
val Loss: 1.5139 Acc: 0.7045
Epoch 68/70
----------
train Loss: 1.2246 Acc: 0.8708
val Loss: 1.5747 Acc: 0.7045
Epoch 69/70
----------
train Loss: 1.2531 Acc: 0.8852
val Loss: 1.5091 Acc: 0.7045
Epoch 70/70
----------
train Loss: 1.3471 Acc: 0.9043
[32m[I 2025-06-29 02:23:41,181][0m Trial 116 finished with value: 0.7727272727272727 and parameters: {'batch_size': 86, 'lr': 0.0006714666587571075, 'num_epochs': 70, 'weight_decay': 0.013367553111945143, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.8824 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_86_lr_0.0006714666587571075_epoch_70_wd_0.013367553111945143_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 3.4733 Acc: 0.3397
val Loss: 3.0832 Acc: 0.6136
Epoch 2/83
----------
train Loss: 2.7531 Acc: 0.5359
val Loss: 2.1548 Acc: 0.6364
Epoch 3/83
----------
train Loss: 2.3485 Acc: 0.5167
val Loss: 1.8690 Acc: 0.6591
Epoch 4/83
----------
train Loss: 2.2155 Acc: 0.5024
val Loss: 1.7632 Acc: 0.6818
Epoch 5/83
----------
train Loss: 2.1438 Acc: 0.6172
val Loss: 1.6633 Acc: 0.7500
Epoch 6/83
----------
train Loss: 1.9583 Acc: 0.6411
val Loss: 1.5607 Acc: 0.7727
Epoch 7/83
----------
train Loss: 1.8002 Acc: 0.7225
val Loss: 1.4775 Acc: 0.8182
Epoch 8/83
----------
train Loss: 1.8757 Acc: 0.6986
val Loss: 1.3382 Acc: 0.7955
Epoch 9/83
----------
train Loss: 1.8178 Acc: 0.7464
val Loss: 1.4502 Acc: 0.7500
Epoch 10/83
----------
train Loss: 1.2064 Acc: 0.9234
val Loss: 1.3090 Acc: 0.8182
Epoch 11/83
----------
train Loss: 1.6713 Acc: 0.7751
val Loss: 1.1804 Acc: 0.8182
Epoch 12/83
----------
train Loss: 1.5418 Acc: 0.7368
val Loss: 1.3522 Acc: 0.8409
Epoch 13/83
----------
train Loss: 1.3462 Acc: 0.9139
val Loss: 1.3729 Acc: 0.8409
Epoch 14/83
----------
train Loss: 1.2720 Acc: 0.8325
val Loss: 1.3829 Acc: 0.7273
Epoch 15/83
----------
train Loss: 1.3969 Acc: 0.7943
val Loss: 1.1888 Acc: 0.7955
Epoch 16/83
----------
train Loss: 1.4803 Acc: 0.7895
val Loss: 1.2830 Acc: 0.8182
Epoch 17/83
----------
train Loss: 1.4045 Acc: 0.8565
val Loss: 1.4792 Acc: 0.8409
Epoch 18/83
----------
train Loss: 1.3125 Acc: 0.8278
val Loss: 1.2848 Acc: 0.7955
Epoch 19/83
----------
train Loss: 1.2097 Acc: 0.9378
val Loss: 1.2148 Acc: 0.8409
Epoch 20/83
----------
train Loss: 1.3249 Acc: 0.8517
val Loss: 1.2118 Acc: 0.8182
Epoch 21/83
----------
train Loss: 1.4209 Acc: 0.8852
val Loss: 1.1302 Acc: 0.8182
Epoch 22/83
----------
train Loss: 1.2422 Acc: 0.8900
val Loss: 1.1045 Acc: 0.7955
Epoch 23/83
----------
train Loss: 1.4619 Acc: 0.8756
val Loss: 1.1303 Acc: 0.8636
Epoch 24/83
----------
train Loss: 1.0411 Acc: 0.9330
val Loss: 1.1331 Acc: 0.8409
Epoch 25/83
----------
train Loss: 1.2242 Acc: 0.9474
val Loss: 1.2504 Acc: 0.8182
Epoch 26/83
----------
train Loss: 1.4294 Acc: 0.9426
val Loss: 1.2229 Acc: 0.8182
Epoch 27/83
----------
train Loss: 1.1562 Acc: 0.9665
val Loss: 1.3260 Acc: 0.7727
Epoch 28/83
----------
train Loss: 1.3571 Acc: 0.8612
val Loss: 1.2427 Acc: 0.7500
Epoch 29/83
----------
train Loss: 1.4556 Acc: 0.7751
val Loss: 1.1881 Acc: 0.8182
Epoch 30/83
----------
train Loss: 1.2465 Acc: 0.8852
val Loss: 1.0970 Acc: 0.8182
Epoch 31/83
----------
train Loss: 1.1003 Acc: 0.9474
val Loss: 1.1029 Acc: 0.7727
Epoch 32/83
----------
train Loss: 1.2284 Acc: 0.9139
val Loss: 1.1492 Acc: 0.8409
Epoch 33/83
----------
train Loss: 1.3287 Acc: 0.8804
val Loss: 1.1779 Acc: 0.8409
Epoch 34/83
----------
train Loss: 1.2703 Acc: 0.9665
val Loss: 1.3829 Acc: 0.7955
Epoch 35/83
----------
train Loss: 0.9801 Acc: 0.9761
val Loss: 1.3930 Acc: 0.7727
Epoch 36/83
----------
train Loss: 1.5196 Acc: 0.8517
val Loss: 1.2659 Acc: 0.7727
Epoch 37/83
----------
train Loss: 1.2722 Acc: 0.8230
val Loss: 1.2984 Acc: 0.7727
Epoch 38/83
----------
train Loss: 1.3246 Acc: 0.9569
val Loss: 1.2616 Acc: 0.7727
Epoch 39/83
----------
train Loss: 1.3335 Acc: 0.7799
val Loss: 1.4874 Acc: 0.7727
Epoch 40/83
----------
train Loss: 1.1478 Acc: 0.9187
val Loss: 1.4726 Acc: 0.7727
Epoch 41/83
----------
train Loss: 1.5879 Acc: 0.7225
val Loss: 1.3315 Acc: 0.7500
Epoch 42/83
----------
train Loss: 1.1421 Acc: 0.8804
val Loss: 1.2885 Acc: 0.7273
Epoch 43/83
----------
train Loss: 1.3242 Acc: 0.8852
val Loss: 1.2042 Acc: 0.8182
Epoch 44/83
----------
train Loss: 1.1712 Acc: 0.9139
val Loss: 1.3907 Acc: 0.7955
Epoch 45/83
----------
train Loss: 0.7950 Acc: 0.9617
val Loss: 1.2122 Acc: 0.7955
Epoch 46/83
----------
train Loss: 1.5929 Acc: 0.8182
val Loss: 1.3203 Acc: 0.7273
Epoch 47/83
----------
train Loss: 1.1843 Acc: 0.9187
val Loss: 1.4454 Acc: 0.6818
Epoch 48/83
----------
train Loss: 1.2842 Acc: 0.8278
val Loss: 1.5012 Acc: 0.7273
Epoch 49/83
----------
train Loss: 1.2938 Acc: 0.9378
val Loss: 1.3360 Acc: 0.8182
Epoch 50/83
----------
train Loss: 1.2273 Acc: 0.8852
val Loss: 1.2721 Acc: 0.8409
Epoch 51/83
----------
train Loss: 0.9324 Acc: 0.9952
val Loss: 1.1351 Acc: 0.8182
Epoch 52/83
----------
train Loss: 1.2811 Acc: 0.8708
val Loss: 1.1212 Acc: 0.8409
Epoch 53/83
----------
train Loss: 1.4513 Acc: 0.9187
val Loss: 1.3402 Acc: 0.7273
Epoch 54/83
----------
train Loss: 1.1485 Acc: 0.9522
val Loss: 1.4598 Acc: 0.7500
Epoch 55/83
----------
train Loss: 1.1968 Acc: 0.9617
val Loss: 1.6019 Acc: 0.5909
Epoch 56/83
----------
train Loss: 1.3645 Acc: 0.9139
val Loss: 1.3408 Acc: 0.7955
Epoch 57/83
----------
train Loss: 1.5006 Acc: 0.8278
val Loss: 1.3688 Acc: 0.7500
Epoch 58/83
----------
train Loss: 1.2023 Acc: 0.8612
val Loss: 1.4029 Acc: 0.7500
Epoch 59/83
----------
train Loss: 1.2512 Acc: 0.9187
val Loss: 1.4603 Acc: 0.6591
Epoch 60/83
----------
train Loss: 1.0472 Acc: 0.9091
val Loss: 1.4507 Acc: 0.6591
Epoch 61/83
----------
train Loss: 1.4191 Acc: 0.8134
val Loss: 1.4712 Acc: 0.6818
Epoch 62/83
----------
train Loss: 1.4056 Acc: 0.9474
val Loss: 1.5073 Acc: 0.6818
Epoch 63/83
----------
train Loss: 1.2230 Acc: 0.9426
val Loss: 1.6084 Acc: 0.7045
Epoch 64/83
----------
train Loss: 1.0927 Acc: 0.9569
val Loss: 1.6676 Acc: 0.7727
Epoch 65/83
----------
train Loss: 1.2523 Acc: 0.8565
val Loss: 1.3961 Acc: 0.7045
Epoch 66/83
----------
train Loss: 1.2444 Acc: 0.9043
val Loss: 1.5969 Acc: 0.7273
Epoch 67/83
----------
train Loss: 1.3969 Acc: 0.8804
val Loss: 1.6065 Acc: 0.7500
Epoch 68/83
----------
train Loss: 1.1626 Acc: 0.9187
val Loss: 1.4645 Acc: 0.7500
Epoch 69/83
----------
train Loss: 1.1158 Acc: 0.8900
val Loss: 1.2796 Acc: 0.8182
Epoch 70/83
----------
train Loss: 1.2826 Acc: 0.9043
val Loss: 1.1779 Acc: 0.8636
Epoch 71/83
----------
train Loss: 1.3717 Acc: 0.9091
val Loss: 1.1767 Acc: 0.8636
Epoch 72/83
----------
train Loss: 1.3499 Acc: 0.8947
val Loss: 1.3332 Acc: 0.8182
Epoch 73/83
----------
train Loss: 0.9740 Acc: 0.9617
val Loss: 1.2799 Acc: 0.7955
Epoch 74/83
----------
train Loss: 1.3642 Acc: 0.8756
val Loss: 1.1489 Acc: 0.8182
Epoch 75/83
----------
train Loss: 1.0937 Acc: 0.9761
val Loss: 1.1335 Acc: 0.7727
Epoch 76/83
----------
train Loss: 1.0777 Acc: 0.8804
val Loss: 1.1644 Acc: 0.7727
Epoch 77/83
----------
train Loss: 1.3375 Acc: 0.8612
val Loss: 1.1899 Acc: 0.8182
Epoch 78/83
----------
train Loss: 1.2153 Acc: 0.9282
val Loss: 1.3663 Acc: 0.7500
Epoch 79/83
----------
train Loss: 1.3403 Acc: 0.9234
val Loss: 1.2336 Acc: 0.7727
Epoch 80/83
----------
train Loss: 1.2647 Acc: 0.9043
val Loss: 1.2102 Acc: 0.8182
Epoch 81/83
----------
train Loss: 1.4296 Acc: 0.7943
val Loss: 1.4675 Acc: 0.7045
Epoch 82/83
----------
train Loss: 1.2047 Acc: 0.8804
val Loss: 1.3601 Acc: 0.7045
Epoch 83/83
----------
train Loss: 1.1122 Acc: 0.9713
[32m[I 2025-06-29 02:42:33,485][0m Trial 117 finished with value: 0.8181818181818182 and parameters: {'batch_size': 96, 'lr': 0.00033289256882106485, 'num_epochs': 83, 'weight_decay': 0.00840471654017747, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3599 Acc: 0.7273
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_96_lr_0.00033289256882106485_epoch_83_wd_0.00840471654017747_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.4084 Acc: 0.3541
val Loss: 3.0431 Acc: 0.6136
Epoch 2/78
----------
train Loss: 2.6547 Acc: 0.5215
val Loss: 2.1508 Acc: 0.6364
Epoch 3/78
----------
train Loss: 2.3142 Acc: 0.5072
val Loss: 1.9423 Acc: 0.6364
Epoch 4/78
----------
train Loss: 2.2078 Acc: 0.5167
val Loss: 1.9387 Acc: 0.7273
Epoch 5/78
----------
train Loss: 2.1366 Acc: 0.6268
val Loss: 1.8774 Acc: 0.7727
Epoch 6/78
----------
train Loss: 1.9610 Acc: 0.6411
val Loss: 1.7882 Acc: 0.7955
Epoch 7/78
----------
train Loss: 1.7939 Acc: 0.7129
val Loss: 1.6856 Acc: 0.8182
Epoch 8/78
----------
train Loss: 1.8510 Acc: 0.7321
val Loss: 1.5500 Acc: 0.7955
Epoch 9/78
----------
train Loss: 1.7825 Acc: 0.7608
val Loss: 1.6974 Acc: 0.7500
Epoch 10/78
----------
train Loss: 1.1844 Acc: 0.9378
val Loss: 1.3948 Acc: 0.8182
Epoch 11/78
----------
train Loss: 1.6986 Acc: 0.7847
val Loss: 1.2223 Acc: 0.8864
Epoch 12/78
----------
train Loss: 1.5305 Acc: 0.7560
val Loss: 1.7294 Acc: 0.7727
Epoch 13/78
----------
train Loss: 1.3441 Acc: 0.8947
val Loss: 1.5848 Acc: 0.7273
Epoch 14/78
----------
train Loss: 1.2721 Acc: 0.8278
val Loss: 1.5018 Acc: 0.7273
Epoch 15/78
----------
train Loss: 1.4201 Acc: 0.8230
val Loss: 1.1704 Acc: 0.7727
Epoch 16/78
----------
train Loss: 1.5179 Acc: 0.8038
[32m[I 2025-06-29 02:46:13,192][0m Trial 118 finished with value: 0.8863636363636364 and parameters: {'batch_size': 85, 'lr': 0.00044165461750972953, 'num_epochs': 78, 'weight_decay': 0.021078005437390673, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4949 Acc: 0.7955
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_85_lr_0.00044165461750972953_epoch_78_wd_0.021078005437390673_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/73
----------
train Loss: 3.5868 Acc: 0.2919
val Loss: 3.3271 Acc: 0.5682
Epoch 2/73
----------
train Loss: 3.0480 Acc: 0.4928
val Loss: 2.7838 Acc: 0.6364
Epoch 3/73
----------
train Loss: 2.6667 Acc: 0.5120
val Loss: 2.2465 Acc: 0.6364
Epoch 4/73
----------
train Loss: 2.4551 Acc: 0.4976
val Loss: 2.0475 Acc: 0.6364
Epoch 5/73
----------
train Loss: 2.3444 Acc: 0.5120
val Loss: 1.9571 Acc: 0.6364
Epoch 6/73
----------
train Loss: 2.2024 Acc: 0.5359
val Loss: 1.8711 Acc: 0.6818
Epoch 7/73
----------
train Loss: 2.0934 Acc: 0.5550
val Loss: 1.8490 Acc: 0.7045
Epoch 8/73
----------
train Loss: 2.1439 Acc: 0.5694
val Loss: 1.7448 Acc: 0.7045
Epoch 9/73
----------
train Loss: 2.0756 Acc: 0.6316
val Loss: 1.7471 Acc: 0.7500
Epoch 10/73
----------
train Loss: 1.6519 Acc: 0.8182
val Loss: 1.6797 Acc: 0.7727
Epoch 11/73
----------
train Loss: 1.9203 Acc: 0.6746
val Loss: 1.5623 Acc: 0.7500
Epoch 12/73
----------
train Loss: 1.8964 Acc: 0.6220
val Loss: 1.6082 Acc: 0.7727
Epoch 13/73
----------
train Loss: 1.6419 Acc: 0.8182
val Loss: 1.4842 Acc: 0.7727
Epoch 14/73
----------
train Loss: 1.4871 Acc: 0.7943
val Loss: 1.4688 Acc: 0.7500
Epoch 15/73
----------
train Loss: 1.6089 Acc: 0.7608
val Loss: 1.3900 Acc: 0.7727
Epoch 16/73
----------
train Loss: 1.5652 Acc: 0.7656
val Loss: 1.4084 Acc: 0.7955
Epoch 17/73
----------
train Loss: 1.4875 Acc: 0.8182
val Loss: 1.4770 Acc: 0.7955
Epoch 18/73
----------
train Loss: 1.4138 Acc: 0.8278
val Loss: 1.3803 Acc: 0.8182
Epoch 19/73
----------
train Loss: 1.2869 Acc: 0.9282
val Loss: 1.3140 Acc: 0.7500
Epoch 20/73
----------
train Loss: 1.3977 Acc: 0.8517
val Loss: 1.2510 Acc: 0.7955
Epoch 21/73
----------
train Loss: 1.4667 Acc: 0.8565
val Loss: 1.2528 Acc: 0.7955
Epoch 22/73
----------
train Loss: 1.3470 Acc: 0.8612
val Loss: 1.3100 Acc: 0.8409
Epoch 23/73
----------
train Loss: 1.5051 Acc: 0.8421
val Loss: 1.3111 Acc: 0.8182
Epoch 24/73
----------
train Loss: 1.1033 Acc: 0.9187
val Loss: 1.2286 Acc: 0.8182
Epoch 25/73
----------
train Loss: 1.2984 Acc: 0.9378
val Loss: 1.3604 Acc: 0.7727
Epoch 26/73
----------
train Loss: 1.4539 Acc: 0.9139
val Loss: 1.3848 Acc: 0.8182
Epoch 27/73
----------
train Loss: 1.1824 Acc: 0.9665
val Loss: 1.4747 Acc: 0.8182
Epoch 28/73
----------
train Loss: 1.4300 Acc: 0.8756
val Loss: 1.3726 Acc: 0.7727
Epoch 29/73
----------
train Loss: 1.5198 Acc: 0.7608
val Loss: 1.3901 Acc: 0.7955
Epoch 30/73
----------
train Loss: 1.2996 Acc: 0.8756
val Loss: 1.2844 Acc: 0.7727
Epoch 31/73
----------
train Loss: 1.1605 Acc: 0.9330
val Loss: 1.1919 Acc: 0.7955
Epoch 32/73
----------
train Loss: 1.3050 Acc: 0.8947
val Loss: 1.1760 Acc: 0.7955
Epoch 33/73
----------
train Loss: 1.3635 Acc: 0.8660
val Loss: 1.2381 Acc: 0.7955
Epoch 34/73
----------
train Loss: 1.2978 Acc: 0.9474
val Loss: 1.2864 Acc: 0.7500
Epoch 35/73
----------
train Loss: 0.9965 Acc: 0.9713
val Loss: 1.3817 Acc: 0.7955
Epoch 36/73
----------
train Loss: 1.5471 Acc: 0.8660
val Loss: 1.3489 Acc: 0.7955
Epoch 37/73
----------
train Loss: 1.3283 Acc: 0.8230
val Loss: 1.4716 Acc: 0.7727
Epoch 38/73
----------
train Loss: 1.3486 Acc: 0.9426
val Loss: 1.3494 Acc: 0.7727
Epoch 39/73
----------
train Loss: 1.3892 Acc: 0.7608
val Loss: 1.4800 Acc: 0.7500
Epoch 40/73
----------
train Loss: 1.1829 Acc: 0.9139
val Loss: 1.3970 Acc: 0.7273
Epoch 41/73
----------
train Loss: 1.6363 Acc: 0.7225
val Loss: 1.2454 Acc: 0.8182
Epoch 42/73
----------
train Loss: 1.2138 Acc: 0.8804
val Loss: 1.2450 Acc: 0.7727
Epoch 43/73
----------
train Loss: 1.3486 Acc: 0.8900
val Loss: 1.2164 Acc: 0.7727
Epoch 44/73
----------
train Loss: 1.2191 Acc: 0.8804
val Loss: 1.3801 Acc: 0.7955
Epoch 45/73
----------
train Loss: 0.8145 Acc: 0.9617
val Loss: 1.3071 Acc: 0.7955
Epoch 46/73
----------
train Loss: 1.6263 Acc: 0.8182
val Loss: 1.4292 Acc: 0.7500
Epoch 47/73
----------
train Loss: 1.2617 Acc: 0.8900
val Loss: 1.3773 Acc: 0.7045
Epoch 48/73
----------
train Loss: 1.3442 Acc: 0.8517
val Loss: 1.3967 Acc: 0.7500
Epoch 49/73
----------
train Loss: 1.3197 Acc: 0.9522
val Loss: 1.4484 Acc: 0.7955
Epoch 50/73
----------
train Loss: 1.2686 Acc: 0.8756
val Loss: 1.4193 Acc: 0.7955
Epoch 51/73
----------
train Loss: 0.9764 Acc: 0.9809
val Loss: 1.2711 Acc: 0.8182
Epoch 52/73
----------
train Loss: 1.3358 Acc: 0.8373
val Loss: 1.2769 Acc: 0.7727
Epoch 53/73
----------
train Loss: 1.4832 Acc: 0.9091
val Loss: 1.3857 Acc: 0.7727
Epoch 54/73
----------
train Loss: 1.1716 Acc: 0.9378
val Loss: 1.4828 Acc: 0.7273
Epoch 55/73
----------
train Loss: 1.2206 Acc: 0.9522
val Loss: 1.6062 Acc: 0.6818
Epoch 56/73
----------
train Loss: 1.3900 Acc: 0.9187
val Loss: 1.3651 Acc: 0.7500
Epoch 57/73
----------
train Loss: 1.5399 Acc: 0.8421
val Loss: 1.3142 Acc: 0.7273
Epoch 58/73
----------
train Loss: 1.2461 Acc: 0.8421
val Loss: 1.3191 Acc: 0.7955
Epoch 59/73
----------
train Loss: 1.2916 Acc: 0.9091
val Loss: 1.3910 Acc: 0.7273
Epoch 60/73
----------
train Loss: 1.1079 Acc: 0.8852
val Loss: 1.3749 Acc: 0.7500
Epoch 61/73
----------
train Loss: 1.5401 Acc: 0.7512
val Loss: 1.3270 Acc: 0.7273
Epoch 62/73
----------
train Loss: 1.4427 Acc: 0.9474
val Loss: 1.4581 Acc: 0.6818
Epoch 63/73
----------
train Loss: 1.2583 Acc: 0.9378
val Loss: 1.4738 Acc: 0.7727
Epoch 64/73
----------
train Loss: 1.1366 Acc: 0.9378
val Loss: 1.4203 Acc: 0.7955
Epoch 65/73
----------
train Loss: 1.2699 Acc: 0.8756
val Loss: 1.5094 Acc: 0.6818
Epoch 66/73
----------
train Loss: 1.2817 Acc: 0.9091
val Loss: 1.4691 Acc: 0.7273
Epoch 67/73
----------
train Loss: 1.4433 Acc: 0.8660
val Loss: 1.5546 Acc: 0.7273
Epoch 68/73
----------
train Loss: 1.2097 Acc: 0.8995
val Loss: 1.4398 Acc: 0.8182
Epoch 69/73
----------
train Loss: 1.1550 Acc: 0.8947
val Loss: 1.2705 Acc: 0.7500
Epoch 70/73
----------
train Loss: 1.3328 Acc: 0.8995
val Loss: 1.1885 Acc: 0.7727
Epoch 71/73
----------
train Loss: 1.4194 Acc: 0.9139
val Loss: 1.2209 Acc: 0.7727
Epoch 72/73
----------
train Loss: 1.4271 Acc: 0.8660
val Loss: 1.3347 Acc: 0.7727
Epoch 73/73
----------
train Loss: 1.0223 Acc: 0.9665
[32m[I 2025-06-29 03:02:49,348][0m Trial 119 finished with value: 0.7727272727272727 and parameters: {'batch_size': 100, 'lr': 0.0002432192208806475, 'num_epochs': 73, 'weight_decay': 0.02413759147801146, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4333 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_100_lr_0.0002432192208806475_epoch_73_wd_0.02413759147801146_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.6279 Acc: 0.2919
val Loss: 3.3699 Acc: 0.5455
Epoch 2/78
----------
train Loss: 3.1422 Acc: 0.4785
val Loss: 2.8170 Acc: 0.6136
Epoch 3/78
----------
train Loss: 2.7522 Acc: 0.4976
val Loss: 2.2275 Acc: 0.6364
Epoch 4/78
----------
train Loss: 2.5036 Acc: 0.5120
val Loss: 2.0012 Acc: 0.6364
Epoch 5/78
----------
train Loss: 2.3665 Acc: 0.5215
val Loss: 1.8808 Acc: 0.6364
Epoch 6/78
----------
train Loss: 2.1912 Acc: 0.5502
val Loss: 1.7791 Acc: 0.6591
Epoch 7/78
----------
train Loss: 2.0770 Acc: 0.5885
val Loss: 1.7134 Acc: 0.6818
Epoch 8/78
----------
train Loss: 2.1346 Acc: 0.5885
val Loss: 1.6411 Acc: 0.7045
Epoch 9/78
----------
train Loss: 2.0660 Acc: 0.6316
val Loss: 1.6415 Acc: 0.7273
Epoch 10/78
----------
train Loss: 1.6190 Acc: 0.8230
val Loss: 1.5942 Acc: 0.7273
Epoch 11/78
----------
train Loss: 1.9180 Acc: 0.6603
val Loss: 1.5281 Acc: 0.7273
Epoch 12/78
----------
train Loss: 1.8915 Acc: 0.6507
val Loss: 1.5012 Acc: 0.7727
Epoch 13/78
----------
train Loss: 1.6449 Acc: 0.8038
val Loss: 1.4116 Acc: 0.7500
Epoch 14/78
----------
train Loss: 1.5107 Acc: 0.7895
val Loss: 1.4047 Acc: 0.7727
Epoch 15/78
----------
train Loss: 1.6185 Acc: 0.7608
val Loss: 1.3578 Acc: 0.7500
Epoch 16/78
----------
train Loss: 1.5858 Acc: 0.7656
val Loss: 1.3225 Acc: 0.7955
Epoch 17/78
----------
train Loss: 1.4871 Acc: 0.8469
val Loss: 1.3253 Acc: 0.8409
Epoch 18/78
----------
train Loss: 1.3840 Acc: 0.8421
val Loss: 1.2431 Acc: 0.8409
Epoch 19/78
----------
train Loss: 1.2955 Acc: 0.9234
val Loss: 1.2252 Acc: 0.7955
Epoch 20/78
----------
train Loss: 1.3978 Acc: 0.8756
val Loss: 1.2116 Acc: 0.7727
Epoch 21/78
----------
train Loss: 1.4813 Acc: 0.8612
val Loss: 1.2164 Acc: 0.7955
Epoch 22/78
----------
train Loss: 1.3372 Acc: 0.8517
val Loss: 1.2244 Acc: 0.7955
Epoch 23/78
----------
train Loss: 1.5116 Acc: 0.8565
val Loss: 1.1619 Acc: 0.8182
Epoch 24/78
----------
train Loss: 1.0728 Acc: 0.9282
val Loss: 1.1021 Acc: 0.8182
Epoch 25/78
----------
train Loss: 1.2840 Acc: 0.9330
val Loss: 1.1359 Acc: 0.8182
Epoch 26/78
----------
train Loss: 1.4142 Acc: 0.9187
val Loss: 1.1971 Acc: 0.8182
Epoch 27/78
----------
train Loss: 1.1399 Acc: 0.9761
val Loss: 1.3021 Acc: 0.8409
Epoch 28/78
----------
train Loss: 1.4076 Acc: 0.8708
val Loss: 1.2783 Acc: 0.7955
Epoch 29/78
----------
train Loss: 1.5232 Acc: 0.7560
val Loss: 1.1624 Acc: 0.8409
Epoch 30/78
----------
train Loss: 1.2865 Acc: 0.8708
val Loss: 1.1358 Acc: 0.8409
Epoch 31/78
----------
train Loss: 1.1364 Acc: 0.9330
val Loss: 1.1265 Acc: 0.8409
Epoch 32/78
----------
train Loss: 1.2979 Acc: 0.8756
val Loss: 1.1264 Acc: 0.8409
Epoch 33/78
----------
train Loss: 1.3381 Acc: 0.8947
val Loss: 1.1744 Acc: 0.7955
Epoch 34/78
----------
train Loss: 1.3069 Acc: 0.9330
val Loss: 1.2235 Acc: 0.7955
Epoch 35/78
----------
train Loss: 0.9859 Acc: 0.9856
val Loss: 1.3059 Acc: 0.7727
Epoch 36/78
----------
train Loss: 1.5241 Acc: 0.8421
val Loss: 1.3108 Acc: 0.7727
Epoch 37/78
----------
train Loss: 1.2698 Acc: 0.8086
val Loss: 1.2581 Acc: 0.8182
Epoch 38/78
----------
train Loss: 1.3122 Acc: 0.9426
val Loss: 1.2153 Acc: 0.8182
Epoch 39/78
----------
train Loss: 1.3904 Acc: 0.7799
val Loss: 1.2444 Acc: 0.7955
Epoch 40/78
----------
train Loss: 1.1322 Acc: 0.9043
val Loss: 1.3281 Acc: 0.7955
Epoch 41/78
----------
train Loss: 1.6187 Acc: 0.7225
val Loss: 1.3098 Acc: 0.8409
Epoch 42/78
----------
train Loss: 1.1160 Acc: 0.8900
val Loss: 1.2906 Acc: 0.8182
Epoch 43/78
----------
train Loss: 1.2990 Acc: 0.8852
val Loss: 1.2118 Acc: 0.8182
Epoch 44/78
----------
train Loss: 1.2076 Acc: 0.8756
val Loss: 1.2332 Acc: 0.8182
Epoch 45/78
----------
train Loss: 0.7601 Acc: 0.9713
val Loss: 1.2149 Acc: 0.7955
Epoch 46/78
----------
train Loss: 1.6176 Acc: 0.8086
val Loss: 1.2867 Acc: 0.7955
Epoch 47/78
----------
train Loss: 1.1807 Acc: 0.9139
val Loss: 1.2840 Acc: 0.7955
Epoch 48/78
----------
train Loss: 1.3059 Acc: 0.8708
val Loss: 1.2626 Acc: 0.7727
Epoch 49/78
----------
train Loss: 1.2595 Acc: 0.9617
val Loss: 1.3078 Acc: 0.7727
Epoch 50/78
----------
train Loss: 1.2312 Acc: 0.8852
val Loss: 1.3481 Acc: 0.7955
Epoch 51/78
----------
train Loss: 0.9300 Acc: 0.9904
val Loss: 1.2624 Acc: 0.7955
Epoch 52/78
----------
train Loss: 1.3137 Acc: 0.8469
val Loss: 1.2272 Acc: 0.7955
Epoch 53/78
----------
train Loss: 1.4938 Acc: 0.9091
val Loss: 1.2310 Acc: 0.8182
Epoch 54/78
----------
train Loss: 1.1228 Acc: 0.9378
val Loss: 1.2656 Acc: 0.7727
Epoch 55/78
----------
train Loss: 1.1660 Acc: 0.9522
val Loss: 1.3201 Acc: 0.7727
Epoch 56/78
----------
train Loss: 1.3531 Acc: 0.9187
val Loss: 1.2932 Acc: 0.7727
Epoch 57/78
----------
train Loss: 1.4891 Acc: 0.8469
val Loss: 1.2936 Acc: 0.8182
Epoch 58/78
----------
train Loss: 1.2264 Acc: 0.8182
val Loss: 1.2854 Acc: 0.8182
Epoch 59/78
----------
train Loss: 1.2501 Acc: 0.9139
val Loss: 1.3270 Acc: 0.8182
Epoch 60/78
----------
train Loss: 1.0397 Acc: 0.8995
val Loss: 1.3244 Acc: 0.7955
Epoch 61/78
----------
train Loss: 1.4604 Acc: 0.7608
val Loss: 1.2991 Acc: 0.7273
Epoch 62/78
----------
train Loss: 1.3676 Acc: 0.9522
val Loss: 1.2799 Acc: 0.7273
Epoch 63/78
----------
train Loss: 1.1931 Acc: 0.9378
val Loss: 1.3124 Acc: 0.7273
Epoch 64/78
----------
train Loss: 1.0780 Acc: 0.9617
val Loss: 1.3157 Acc: 0.7500
Epoch 65/78
----------
train Loss: 1.2242 Acc: 0.8612
val Loss: 1.3546 Acc: 0.7273
Epoch 66/78
----------
train Loss: 1.2092 Acc: 0.8995
val Loss: 1.3139 Acc: 0.7500
Epoch 67/78
----------
train Loss: 1.3985 Acc: 0.8804
val Loss: 1.3022 Acc: 0.7500
Epoch 68/78
----------
train Loss: 1.1337 Acc: 0.9043
val Loss: 1.3340 Acc: 0.7500
Epoch 69/78
----------
train Loss: 1.0886 Acc: 0.9139
val Loss: 1.2958 Acc: 0.7727
Epoch 70/78
----------
train Loss: 1.2632 Acc: 0.9091
val Loss: 1.2898 Acc: 0.7955
Epoch 71/78
----------
train Loss: 1.3238 Acc: 0.9522
val Loss: 1.2874 Acc: 0.7500
Epoch 72/78
----------
train Loss: 1.3235 Acc: 0.8900
val Loss: 1.3316 Acc: 0.7955
Epoch 73/78
----------
train Loss: 0.9703 Acc: 0.9713
val Loss: 1.3106 Acc: 0.7727
Epoch 74/78
----------
train Loss: 1.3494 Acc: 0.8852
val Loss: 1.2630 Acc: 0.7500
Epoch 75/78
----------
train Loss: 1.0594 Acc: 0.9809
val Loss: 1.2443 Acc: 0.8409
Epoch 76/78
----------
train Loss: 1.0798 Acc: 0.8852
val Loss: 1.2109 Acc: 0.8409
Epoch 77/78
----------
train Loss: 1.2852 Acc: 0.8852
val Loss: 1.2837 Acc: 0.8636
Epoch 78/78
----------
train Loss: 1.1850 Acc: 0.9091
[32m[I 2025-06-29 03:20:33,473][0m Trial 120 finished with value: 0.8636363636363636 and parameters: {'batch_size': 83, 'lr': 0.00017642738317617655, 'num_epochs': 78, 'weight_decay': 0.006217775362158661, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4598 Acc: 0.7955
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_83_lr_0.00017642738317617655_epoch_78_wd_0.006217775362158661_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/80
----------
train Loss: 3.5251 Acc: 0.3301
val Loss: 3.1776 Acc: 0.6136
Epoch 2/80
----------
train Loss: 2.8666 Acc: 0.5263
val Loss: 2.3085 Acc: 0.6364
Epoch 3/80
----------
train Loss: 2.4363 Acc: 0.5263
val Loss: 1.9103 Acc: 0.6364
Epoch 4/80
----------
train Loss: 2.2667 Acc: 0.5072
val Loss: 1.8069 Acc: 0.6591
Epoch 5/80
----------
train Loss: 2.1891 Acc: 0.5789
val Loss: 1.7097 Acc: 0.6818
Epoch 6/80
----------
train Loss: 2.0148 Acc: 0.6220
val Loss: 1.5956 Acc: 0.7500
Epoch 7/80
----------
train Loss: 1.8735 Acc: 0.6746
val Loss: 1.5323 Acc: 0.7500
Epoch 8/80
----------
train Loss: 1.9428 Acc: 0.6986
val Loss: 1.4245 Acc: 0.7500
Epoch 9/80
----------
train Loss: 1.8626 Acc: 0.7416
val Loss: 1.4469 Acc: 0.7727
Epoch 10/80
----------
train Loss: 1.2909 Acc: 0.9282
val Loss: 1.3551 Acc: 0.7955
Epoch 11/80
----------
train Loss: 1.7033 Acc: 0.7656
val Loss: 1.2859 Acc: 0.8409
Epoch 12/80
----------
train Loss: 1.6190 Acc: 0.7129
val Loss: 1.3761 Acc: 0.8409
Epoch 13/80
----------
train Loss: 1.3957 Acc: 0.8900
val Loss: 1.3065 Acc: 0.7727
Epoch 14/80
----------
train Loss: 1.2910 Acc: 0.8230
val Loss: 1.3753 Acc: 0.7273
Epoch 15/80
----------
train Loss: 1.4272 Acc: 0.8086
val Loss: 1.2597 Acc: 0.7273
Epoch 16/80
----------
train Loss: 1.4970 Acc: 0.7895
val Loss: 1.2159 Acc: 0.8182
Epoch 17/80
----------
train Loss: 1.3860 Acc: 0.8565
val Loss: 1.3455 Acc: 0.8409
Epoch 18/80
----------
train Loss: 1.3117 Acc: 0.8373
val Loss: 1.2357 Acc: 0.8409
Epoch 19/80
----------
train Loss: 1.2080 Acc: 0.9282
val Loss: 1.1732 Acc: 0.7955
Epoch 20/80
----------
train Loss: 1.3327 Acc: 0.8612
val Loss: 1.1466 Acc: 0.8182
Epoch 21/80
----------
train Loss: 1.4049 Acc: 0.8852
val Loss: 1.1487 Acc: 0.8182
Epoch 22/80
----------
train Loss: 1.2625 Acc: 0.8852
val Loss: 1.1666 Acc: 0.8182
Epoch 23/80
----------
train Loss: 1.4753 Acc: 0.8708
val Loss: 1.1266 Acc: 0.8409
Epoch 24/80
----------
train Loss: 1.0323 Acc: 0.9330
val Loss: 1.0996 Acc: 0.8182
Epoch 25/80
----------
train Loss: 1.2189 Acc: 0.9378
val Loss: 1.1812 Acc: 0.8182
Epoch 26/80
----------
train Loss: 1.4139 Acc: 0.9378
val Loss: 1.2230 Acc: 0.7955
Epoch 27/80
----------
train Loss: 1.1462 Acc: 0.9761
val Loss: 1.3174 Acc: 0.7955
Epoch 28/80
----------
train Loss: 1.3685 Acc: 0.8852
val Loss: 1.2527 Acc: 0.7500
Epoch 29/80
----------
train Loss: 1.4571 Acc: 0.7847
val Loss: 1.1426 Acc: 0.8182
Epoch 30/80
----------
train Loss: 1.2418 Acc: 0.8756
val Loss: 1.0899 Acc: 0.7955
Epoch 31/80
----------
train Loss: 1.1002 Acc: 0.9426
val Loss: 1.1039 Acc: 0.7955
Epoch 32/80
----------
train Loss: 1.2504 Acc: 0.8947
val Loss: 1.1312 Acc: 0.7727
Epoch 33/80
----------
train Loss: 1.2980 Acc: 0.8804
val Loss: 1.1878 Acc: 0.8182
Epoch 34/80
----------
train Loss: 1.2709 Acc: 0.9426
val Loss: 1.3026 Acc: 0.7273
Epoch 35/80
----------
train Loss: 0.9631 Acc: 0.9809
val Loss: 1.3666 Acc: 0.7273
Epoch 36/80
----------
train Loss: 1.5041 Acc: 0.8421
val Loss: 1.2614 Acc: 0.7727
Epoch 37/80
----------
train Loss: 1.2631 Acc: 0.8469
val Loss: 1.2777 Acc: 0.7955
Epoch 38/80
----------
train Loss: 1.3133 Acc: 0.9569
val Loss: 1.2252 Acc: 0.8182
Epoch 39/80
----------
train Loss: 1.3447 Acc: 0.7990
val Loss: 1.3162 Acc: 0.7500
Epoch 40/80
----------
train Loss: 1.1296 Acc: 0.9234
val Loss: 1.3757 Acc: 0.7500
Epoch 41/80
----------
train Loss: 1.5751 Acc: 0.6938
val Loss: 1.2606 Acc: 0.7500
Epoch 42/80
----------
train Loss: 1.1182 Acc: 0.8900
val Loss: 1.2255 Acc: 0.7500
Epoch 43/80
----------
train Loss: 1.2985 Acc: 0.8947
val Loss: 1.1954 Acc: 0.7727
Epoch 44/80
----------
train Loss: 1.1781 Acc: 0.9139
val Loss: 1.3008 Acc: 0.7955
Epoch 45/80
----------
train Loss: 0.7607 Acc: 0.9713
val Loss: 1.2624 Acc: 0.8182
Epoch 46/80
----------
train Loss: 1.5698 Acc: 0.8469
val Loss: 1.3859 Acc: 0.7727
Epoch 47/80
----------
train Loss: 1.1572 Acc: 0.9234
val Loss: 1.3655 Acc: 0.7727
Epoch 48/80
----------
train Loss: 1.2987 Acc: 0.8517
val Loss: 1.3878 Acc: 0.7273
Epoch 49/80
----------
train Loss: 1.2873 Acc: 0.9665
val Loss: 1.3740 Acc: 0.7500
Epoch 50/80
----------
train Loss: 1.2101 Acc: 0.9043
val Loss: 1.3833 Acc: 0.7500
Epoch 51/80
----------
train Loss: 0.9492 Acc: 0.9952
val Loss: 1.2540 Acc: 0.7727
Epoch 52/80
----------
train Loss: 1.2598 Acc: 0.8756
val Loss: 1.2775 Acc: 0.7955
Epoch 53/80
----------
train Loss: 1.4298 Acc: 0.9234
val Loss: 1.3119 Acc: 0.7500
Epoch 54/80
----------
train Loss: 1.1071 Acc: 0.9474
val Loss: 1.4187 Acc: 0.7045
Epoch 55/80
----------
train Loss: 1.1648 Acc: 0.9426
val Loss: 1.5018 Acc: 0.6818
Epoch 56/80
----------
train Loss: 1.3570 Acc: 0.9330
val Loss: 1.5364 Acc: 0.6818
Epoch 57/80
----------
train Loss: 1.4740 Acc: 0.8612
val Loss: 1.5212 Acc: 0.7500
Epoch 58/80
----------
train Loss: 1.1862 Acc: 0.8469
val Loss: 1.3900 Acc: 0.7045
Epoch 59/80
----------
train Loss: 1.2240 Acc: 0.9330
val Loss: 1.4671 Acc: 0.6591
Epoch 60/80
----------
train Loss: 1.0222 Acc: 0.8900
val Loss: 1.4941 Acc: 0.6591
Epoch 61/80
----------
train Loss: 1.4284 Acc: 0.7847
val Loss: 1.5439 Acc: 0.6818
Epoch 62/80
----------
train Loss: 1.3564 Acc: 0.9474
val Loss: 1.5473 Acc: 0.7045
Epoch 63/80
----------
train Loss: 1.2044 Acc: 0.9330
val Loss: 1.5761 Acc: 0.6818
Epoch 64/80
----------
train Loss: 1.0816 Acc: 0.9474
val Loss: 1.5869 Acc: 0.7273
Epoch 65/80
----------
train Loss: 1.2173 Acc: 0.8804
val Loss: 1.5534 Acc: 0.6591
Epoch 66/80
----------
train Loss: 1.2044 Acc: 0.8947
val Loss: 1.4899 Acc: 0.6818
Epoch 67/80
----------
train Loss: 1.3854 Acc: 0.8804
val Loss: 1.5060 Acc: 0.7273
Epoch 68/80
----------
train Loss: 1.1281 Acc: 0.9043
val Loss: 1.5089 Acc: 0.7727
Epoch 69/80
----------
train Loss: 1.0755 Acc: 0.9043
val Loss: 1.4572 Acc: 0.7727
Epoch 70/80
----------
train Loss: 1.2619 Acc: 0.9139
val Loss: 1.4069 Acc: 0.7500
Epoch 71/80
----------
train Loss: 1.3108 Acc: 0.9187
val Loss: 1.3910 Acc: 0.7500
Epoch 72/80
----------
train Loss: 1.3219 Acc: 0.8756
val Loss: 1.4569 Acc: 0.7955
Epoch 73/80
----------
train Loss: 0.9755 Acc: 0.9665
val Loss: 1.4154 Acc: 0.7500
Epoch 74/80
----------
train Loss: 1.3373 Acc: 0.9091
val Loss: 1.3497 Acc: 0.7500
Epoch 75/80
----------
train Loss: 1.0635 Acc: 0.9809
val Loss: 1.2934 Acc: 0.7955
Epoch 76/80
----------
train Loss: 1.0678 Acc: 0.8900
val Loss: 1.2718 Acc: 0.7727
Epoch 77/80
----------
train Loss: 1.2947 Acc: 0.8900
val Loss: 1.5082 Acc: 0.7727
Epoch 78/80
----------
train Loss: 1.1827 Acc: 0.9282
val Loss: 1.6189 Acc: 0.7500
Epoch 79/80
----------
train Loss: 1.3303 Acc: 0.9139
val Loss: 1.3263 Acc: 0.8182
Epoch 80/80
----------
train Loss: 1.2319 Acc: 0.8852
[32m[I 2025-06-29 03:38:45,356][0m Trial 121 finished with value: 0.7727272727272727 and parameters: {'batch_size': 85, 'lr': 0.0002740541563171707, 'num_epochs': 80, 'weight_decay': 0.006020703726386365, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3717 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_85_lr_0.0002740541563171707_epoch_80_wd_0.006020703726386365_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/71
----------
train Loss: 3.1455 Acc: 0.4019
val Loss: 2.2495 Acc: 0.6364
Epoch 2/71
----------
train Loss: 2.3830 Acc: 0.5311
val Loss: 1.9008 Acc: 0.6364
Epoch 3/71
----------
train Loss: 2.1305 Acc: 0.5742
val Loss: 1.9338 Acc: 0.7045
Epoch 4/71
----------
train Loss: 2.0060 Acc: 0.6172
val Loss: 1.8233 Acc: 0.7955
Epoch 5/71
----------
train Loss: 1.8377 Acc: 0.7608
val Loss: 1.5649 Acc: 0.7955
Epoch 6/71
----------
train Loss: 1.7487 Acc: 0.7368
val Loss: 1.4656 Acc: 0.8636
Epoch 7/71
----------
train Loss: 1.4818 Acc: 0.8756
val Loss: 1.5391 Acc: 0.7955
Epoch 8/71
----------
train Loss: 1.7074 Acc: 0.7703
val Loss: 1.5516 Acc: 0.7500
Epoch 9/71
----------
train Loss: 1.7020 Acc: 0.8038
val Loss: 2.1202 Acc: 0.7727
Epoch 10/71
----------
train Loss: 1.0695 Acc: 0.9187
val Loss: 1.2866 Acc: 0.7727
Epoch 11/71
----------
train Loss: 1.7221 Acc: 0.7990
[32m[I 2025-06-29 03:41:15,473][0m Trial 122 finished with value: 0.8636363636363636 and parameters: {'batch_size': 91, 'lr': 0.000763299987147723, 'num_epochs': 71, 'weight_decay': 0.010197293129987068, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6454 Acc: 0.7500
Early stopping at epoch 11 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_91_lr_0.000763299987147723_epoch_71_wd_0.010197293129987068_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 3.4261 Acc: 0.3493
val Loss: 3.0410 Acc: 0.6136
Epoch 2/81
----------
train Loss: 2.6777 Acc: 0.5263
val Loss: 2.1350 Acc: 0.6364
Epoch 3/81
----------
train Loss: 2.3171 Acc: 0.5072
val Loss: 1.9017 Acc: 0.6364
Epoch 4/81
----------
train Loss: 2.2052 Acc: 0.5072
val Loss: 1.8500 Acc: 0.7045
Epoch 5/81
----------
train Loss: 2.1332 Acc: 0.6268
val Loss: 1.7695 Acc: 0.7727
Epoch 6/81
----------
train Loss: 1.9528 Acc: 0.6459
val Loss: 1.6815 Acc: 0.8182
Epoch 7/81
----------
train Loss: 1.7872 Acc: 0.7273
val Loss: 1.5951 Acc: 0.8182
Epoch 8/81
----------
train Loss: 1.8507 Acc: 0.7177
val Loss: 1.4518 Acc: 0.7955
Epoch 9/81
----------
train Loss: 1.7791 Acc: 0.7608
val Loss: 1.5705 Acc: 0.7500
Epoch 10/81
----------
train Loss: 1.1762 Acc: 0.9378
val Loss: 1.3284 Acc: 0.7955
Epoch 11/81
----------
train Loss: 1.6900 Acc: 0.7799
val Loss: 1.1639 Acc: 0.8636
Epoch 12/81
----------
train Loss: 1.5276 Acc: 0.7512
val Loss: 1.6016 Acc: 0.7955
Epoch 13/81
----------
train Loss: 1.3352 Acc: 0.8947
val Loss: 1.5148 Acc: 0.7727
Epoch 14/81
----------
train Loss: 1.2555 Acc: 0.8421
val Loss: 1.4561 Acc: 0.7273
Epoch 15/81
----------
train Loss: 1.4030 Acc: 0.8038
val Loss: 1.1602 Acc: 0.7955
Epoch 16/81
----------
train Loss: 1.5029 Acc: 0.7943
[32m[I 2025-06-29 03:44:53,803][0m Trial 123 finished with value: 0.8636363636363636 and parameters: {'batch_size': 95, 'lr': 0.0004079663297247518, 'num_epochs': 81, 'weight_decay': 0.016509148631572497, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3904 Acc: 0.7955
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_95_lr_0.0004079663297247518_epoch_81_wd_0.016509148631572497_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/77
----------
train Loss: 3.4213 Acc: 0.3493
val Loss: 3.0350 Acc: 0.6136
Epoch 2/77
----------
train Loss: 2.6700 Acc: 0.5263
val Loss: 2.1292 Acc: 0.6364
Epoch 3/77
----------
train Loss: 2.3138 Acc: 0.5024
val Loss: 1.9044 Acc: 0.6364
Epoch 4/77
----------
train Loss: 2.2037 Acc: 0.5072
val Loss: 1.8585 Acc: 0.7045
Epoch 5/77
----------
train Loss: 2.1312 Acc: 0.6316
val Loss: 1.7799 Acc: 0.7727
Epoch 6/77
----------
train Loss: 1.9512 Acc: 0.6411
val Loss: 1.6904 Acc: 0.7955
Epoch 7/77
----------
train Loss: 1.7838 Acc: 0.7321
val Loss: 1.5987 Acc: 0.8182
Epoch 8/77
----------
train Loss: 1.8456 Acc: 0.7273
val Loss: 1.4587 Acc: 0.7955
Epoch 9/77
----------
train Loss: 1.7748 Acc: 0.7656
val Loss: 1.5645 Acc: 0.7500
Epoch 10/77
----------
train Loss: 1.1734 Acc: 0.9378
val Loss: 1.3349 Acc: 0.7955
Epoch 11/77
----------
train Loss: 1.6945 Acc: 0.7799
val Loss: 1.1763 Acc: 0.8636
Epoch 12/77
----------
train Loss: 1.5285 Acc: 0.7512
val Loss: 1.6551 Acc: 0.7955
Epoch 13/77
----------
train Loss: 1.3346 Acc: 0.8947
val Loss: 1.5324 Acc: 0.7955
Epoch 14/77
----------
train Loss: 1.2571 Acc: 0.8373
val Loss: 1.4638 Acc: 0.7273
Epoch 15/77
----------
train Loss: 1.4031 Acc: 0.8086
val Loss: 1.1623 Acc: 0.7955
Epoch 16/77
----------
train Loss: 1.5015 Acc: 0.7990
val Loss: 1.3920 Acc: 0.8182
Epoch 17/77
----------
train Loss: 1.4263 Acc: 0.8660
val Loss: 1.4686 Acc: 0.8636
Epoch 18/77
----------
train Loss: 1.3468 Acc: 0.8373
val Loss: 1.3454 Acc: 0.8182
Epoch 19/77
----------
train Loss: 1.2133 Acc: 0.9474
val Loss: 1.2578 Acc: 0.7727
Epoch 20/77
----------
train Loss: 1.3539 Acc: 0.8756
val Loss: 1.1956 Acc: 0.7500
Epoch 21/77
----------
train Loss: 1.4391 Acc: 0.8660
val Loss: 1.1628 Acc: 0.8182
Epoch 22/77
----------
train Loss: 1.2578 Acc: 0.8900
val Loss: 1.2767 Acc: 0.8182
Epoch 23/77
----------
train Loss: 1.4865 Acc: 0.8708
val Loss: 1.2667 Acc: 0.7955
Epoch 24/77
----------
train Loss: 1.1216 Acc: 0.9091
val Loss: 1.1839 Acc: 0.7955
Epoch 25/77
----------
train Loss: 1.2792 Acc: 0.9378
val Loss: 1.4346 Acc: 0.7727
Epoch 26/77
----------
train Loss: 1.4482 Acc: 0.9474
val Loss: 1.4156 Acc: 0.7727
Epoch 27/77
----------
train Loss: 1.1736 Acc: 0.9617
val Loss: 1.4814 Acc: 0.7500
Epoch 28/77
----------
train Loss: 1.3706 Acc: 0.8612
val Loss: 1.2275 Acc: 0.7727
Epoch 29/77
----------
train Loss: 1.5127 Acc: 0.7895
val Loss: 1.2396 Acc: 0.8409
Epoch 30/77
----------
train Loss: 1.3068 Acc: 0.8612
val Loss: 1.0409 Acc: 0.8864
Epoch 31/77
----------
train Loss: 1.1264 Acc: 0.9330
val Loss: 1.0596 Acc: 0.8409
Epoch 32/77
----------
train Loss: 1.2440 Acc: 0.8995
val Loss: 1.1597 Acc: 0.7955
Epoch 33/77
----------
train Loss: 1.3917 Acc: 0.8900
val Loss: 1.2668 Acc: 0.8182
Epoch 34/77
----------
train Loss: 1.3186 Acc: 0.9378
val Loss: 1.3202 Acc: 0.7273
Epoch 35/77
----------
train Loss: 1.0011 Acc: 0.9809
val Loss: 1.2410 Acc: 0.7273
Epoch 36/77
----------
train Loss: 1.5935 Acc: 0.8660
val Loss: 1.2929 Acc: 0.7500
Epoch 37/77
----------
train Loss: 1.3534 Acc: 0.8182
val Loss: 1.4717 Acc: 0.8182
Epoch 38/77
----------
train Loss: 1.4442 Acc: 0.9426
val Loss: 1.3014 Acc: 0.8409
Epoch 39/77
----------
train Loss: 1.3581 Acc: 0.7799
val Loss: 1.6976 Acc: 0.7500
Epoch 40/77
----------
train Loss: 1.2099 Acc: 0.9187
val Loss: 1.3960 Acc: 0.7955
Epoch 41/77
----------
train Loss: 1.5961 Acc: 0.6842
val Loss: 1.3302 Acc: 0.7727
Epoch 42/77
----------
train Loss: 1.2415 Acc: 0.8325
val Loss: 1.4893 Acc: 0.6818
Epoch 43/77
----------
train Loss: 1.2981 Acc: 0.8708
val Loss: 1.3607 Acc: 0.7727
Epoch 44/77
----------
train Loss: 1.2452 Acc: 0.8660
val Loss: 1.4456 Acc: 0.7273
Epoch 45/77
----------
train Loss: 0.8241 Acc: 0.9569
val Loss: 1.3187 Acc: 0.7273
Epoch 46/77
----------
train Loss: 1.6639 Acc: 0.8325
val Loss: 1.5378 Acc: 0.7045
Epoch 47/77
----------
train Loss: 1.2541 Acc: 0.9139
val Loss: 1.6269 Acc: 0.7273
Epoch 48/77
----------
train Loss: 1.3798 Acc: 0.8421
val Loss: 2.0096 Acc: 0.5909
Epoch 49/77
----------
train Loss: 1.3359 Acc: 0.9330
val Loss: 1.5349 Acc: 0.7955
Epoch 50/77
----------
train Loss: 1.3360 Acc: 0.8517
val Loss: 1.3578 Acc: 0.8182
Epoch 51/77
----------
train Loss: 0.9939 Acc: 0.9713
val Loss: 1.2513 Acc: 0.7955
Epoch 52/77
----------
train Loss: 1.3378 Acc: 0.8565
val Loss: 1.0945 Acc: 0.8182
Epoch 53/77
----------
train Loss: 1.5152 Acc: 0.9282
val Loss: 1.3992 Acc: 0.7727
Epoch 54/77
----------
train Loss: 1.2571 Acc: 0.9234
val Loss: 1.3223 Acc: 0.7955
Epoch 55/77
----------
train Loss: 1.2503 Acc: 0.9569
val Loss: 1.4896 Acc: 0.7500
Epoch 56/77
----------
train Loss: 1.3965 Acc: 0.8947
val Loss: 1.3316 Acc: 0.7273
Epoch 57/77
----------
train Loss: 1.5482 Acc: 0.8421
val Loss: 1.3001 Acc: 0.7500
Epoch 58/77
----------
train Loss: 1.2551 Acc: 0.8134
val Loss: 1.3140 Acc: 0.7727
Epoch 59/77
----------
train Loss: 1.3561 Acc: 0.9043
val Loss: 1.3596 Acc: 0.7500
Epoch 60/77
----------
train Loss: 1.0950 Acc: 0.9091
val Loss: 1.4775 Acc: 0.7273
Epoch 61/77
----------
train Loss: 1.5187 Acc: 0.7990
val Loss: 1.4559 Acc: 0.7500
Epoch 62/77
----------
train Loss: 1.4646 Acc: 0.9474
val Loss: 1.5812 Acc: 0.7045
Epoch 63/77
----------
train Loss: 1.2939 Acc: 0.9187
val Loss: 1.5657 Acc: 0.7045
Epoch 64/77
----------
train Loss: 1.1698 Acc: 0.9426
val Loss: 1.6154 Acc: 0.7727
Epoch 65/77
----------
train Loss: 1.3016 Acc: 0.8900
val Loss: 1.5158 Acc: 0.6818
Epoch 66/77
----------
train Loss: 1.3097 Acc: 0.8900
val Loss: 1.6818 Acc: 0.7045
Epoch 67/77
----------
train Loss: 1.4736 Acc: 0.8756
val Loss: 1.6021 Acc: 0.7727
Epoch 68/77
----------
train Loss: 1.2042 Acc: 0.8900
val Loss: 1.6829 Acc: 0.7273
Epoch 69/77
----------
train Loss: 1.1781 Acc: 0.8660
val Loss: 1.5761 Acc: 0.7727
Epoch 70/77
----------
train Loss: 1.2996 Acc: 0.8852
val Loss: 1.3826 Acc: 0.7727
Epoch 71/77
----------
train Loss: 1.4030 Acc: 0.8900
val Loss: 1.3870 Acc: 0.7727
Epoch 72/77
----------
train Loss: 1.4287 Acc: 0.8565
val Loss: 1.3128 Acc: 0.7955
Epoch 73/77
----------
train Loss: 1.0137 Acc: 0.9522
val Loss: 1.4562 Acc: 0.7727
Epoch 74/77
----------
train Loss: 1.4485 Acc: 0.8038
val Loss: 1.4399 Acc: 0.7727
Epoch 75/77
----------
train Loss: 1.1767 Acc: 0.9569
val Loss: 1.4582 Acc: 0.7727
Epoch 76/77
----------
train Loss: 1.1285 Acc: 0.8852
val Loss: 1.4410 Acc: 0.7500
Epoch 77/77
----------
train Loss: 1.4017 Acc: 0.8612
[32m[I 2025-06-29 04:02:25,361][0m Trial 124 finished with value: 0.75 and parameters: {'batch_size': 95, 'lr': 0.00041508212100298367, 'num_epochs': 77, 'weight_decay': 0.017015956350352357, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.8437 Acc: 0.6591
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_95_lr_0.00041508212100298367_epoch_77_wd_0.017015956350352357_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/60
----------
train Loss: 3.2953 Acc: 0.3732
val Loss: 2.5573 Acc: 0.6364
Epoch 2/60
----------
train Loss: 2.4590 Acc: 0.5407
val Loss: 1.9627 Acc: 0.6364
Epoch 3/60
----------
train Loss: 2.1746 Acc: 0.5359
val Loss: 1.7279 Acc: 0.6818
Epoch 4/60
----------
train Loss: 2.0665 Acc: 0.5789
val Loss: 1.6081 Acc: 0.7727
Epoch 5/60
----------
train Loss: 1.9674 Acc: 0.7368
val Loss: 1.4452 Acc: 0.8182
Epoch 6/60
----------
train Loss: 1.8002 Acc: 0.7033
val Loss: 1.3321 Acc: 0.8182
Epoch 7/60
----------
train Loss: 1.5134 Acc: 0.8517
val Loss: 1.2219 Acc: 0.8182
Epoch 8/60
----------
train Loss: 1.6925 Acc: 0.7703
val Loss: 1.2471 Acc: 0.8182
Epoch 9/60
----------
train Loss: 1.6775 Acc: 0.7847
val Loss: 1.4121 Acc: 0.7955
Epoch 10/60
----------
train Loss: 1.0224 Acc: 0.9426
val Loss: 1.1617 Acc: 0.8182
Epoch 11/60
----------
train Loss: 1.7292 Acc: 0.7799
val Loss: 1.2581 Acc: 0.8182
Epoch 12/60
----------
train Loss: 1.4566 Acc: 0.7703
val Loss: 1.6689 Acc: 0.7500
Epoch 13/60
----------
train Loss: 1.3444 Acc: 0.8900
val Loss: 1.4673 Acc: 0.8182
Epoch 14/60
----------
train Loss: 1.2170 Acc: 0.8325
val Loss: 1.4271 Acc: 0.7727
Epoch 15/60
----------
train Loss: 1.4022 Acc: 0.8325
val Loss: 1.2353 Acc: 0.8409
Epoch 16/60
----------
train Loss: 1.3947 Acc: 0.8182
val Loss: 1.3989 Acc: 0.8409
Epoch 17/60
----------
train Loss: 1.3847 Acc: 0.8565
val Loss: 1.3646 Acc: 0.7955
Epoch 18/60
----------
train Loss: 1.3112 Acc: 0.8278
val Loss: 1.2118 Acc: 0.8182
Epoch 19/60
----------
train Loss: 1.2187 Acc: 0.9426
val Loss: 1.0510 Acc: 0.8409
Epoch 20/60
----------
train Loss: 1.2893 Acc: 0.8852
val Loss: 1.0879 Acc: 0.8409
Epoch 21/60
----------
train Loss: 1.4019 Acc: 0.9043
val Loss: 1.0530 Acc: 0.8864
Epoch 22/60
----------
train Loss: 1.2527 Acc: 0.8756
val Loss: 1.1686 Acc: 0.8409
Epoch 23/60
----------
train Loss: 1.4840 Acc: 0.8900
val Loss: 1.2564 Acc: 0.8182
Epoch 24/60
----------
train Loss: 1.0618 Acc: 0.9330
val Loss: 1.2451 Acc: 0.8182
Epoch 25/60
----------
train Loss: 1.2162 Acc: 0.9378
val Loss: 1.3008 Acc: 0.8636
Epoch 26/60
----------
train Loss: 1.3977 Acc: 0.9522
val Loss: 1.1955 Acc: 0.8864
Epoch 27/60
----------
train Loss: 1.1433 Acc: 0.9665
val Loss: 1.2372 Acc: 0.8182
Epoch 28/60
----------
train Loss: 1.3411 Acc: 0.8517
val Loss: 1.1626 Acc: 0.8182
Epoch 29/60
----------
train Loss: 1.4296 Acc: 0.8038
val Loss: 1.2604 Acc: 0.8409
Epoch 30/60
----------
train Loss: 1.2401 Acc: 0.8947
val Loss: 1.2686 Acc: 0.7500
Epoch 31/60
----------
train Loss: 1.0948 Acc: 0.9378
val Loss: 1.2618 Acc: 0.7500
Epoch 32/60
----------
train Loss: 1.1823 Acc: 0.8995
val Loss: 1.2363 Acc: 0.8409
Epoch 33/60
----------
train Loss: 1.3232 Acc: 0.8804
val Loss: 1.3270 Acc: 0.7955
Epoch 34/60
----------
train Loss: 1.2525 Acc: 0.9330
val Loss: 1.4042 Acc: 0.8409
Epoch 35/60
----------
train Loss: 0.9769 Acc: 0.9522
val Loss: 1.3616 Acc: 0.7500
Epoch 36/60
----------
train Loss: 1.5113 Acc: 0.8804
val Loss: 1.2803 Acc: 0.7500
Epoch 37/60
----------
train Loss: 1.2997 Acc: 0.8230
val Loss: 1.2913 Acc: 0.7955
Epoch 38/60
----------
train Loss: 1.3417 Acc: 0.9522
val Loss: 1.1812 Acc: 0.7500
Epoch 39/60
----------
train Loss: 1.2919 Acc: 0.7990
val Loss: 1.2778 Acc: 0.6818
Epoch 40/60
----------
train Loss: 1.1607 Acc: 0.9282
val Loss: 1.2565 Acc: 0.6818
Epoch 41/60
----------
train Loss: 1.5687 Acc: 0.6938
val Loss: 1.1968 Acc: 0.7500
Epoch 42/60
----------
train Loss: 1.1125 Acc: 0.8947
val Loss: 1.3636 Acc: 0.6818
Epoch 43/60
----------
train Loss: 1.2653 Acc: 0.8804
val Loss: 1.3320 Acc: 0.7500
Epoch 44/60
----------
train Loss: 1.1690 Acc: 0.8804
val Loss: 1.6241 Acc: 0.7500
Epoch 45/60
----------
train Loss: 0.8085 Acc: 0.9617
val Loss: 1.2699 Acc: 0.7955
Epoch 46/60
----------
train Loss: 1.5748 Acc: 0.8038
val Loss: 1.2550 Acc: 0.8182
Epoch 47/60
----------
train Loss: 1.1983 Acc: 0.9282
val Loss: 1.3688 Acc: 0.7500
Epoch 48/60
----------
train Loss: 1.3042 Acc: 0.8612
val Loss: 1.3150 Acc: 0.7500
Epoch 49/60
----------
train Loss: 1.2713 Acc: 0.9522
val Loss: 1.2332 Acc: 0.7727
Epoch 50/60
----------
train Loss: 1.2509 Acc: 0.8660
val Loss: 1.3258 Acc: 0.7955
Epoch 51/60
----------
train Loss: 0.9480 Acc: 0.9952
val Loss: 1.2924 Acc: 0.7955
Epoch 52/60
----------
train Loss: 1.2425 Acc: 0.8373
val Loss: 1.0998 Acc: 0.7955
Epoch 53/60
----------
train Loss: 1.4540 Acc: 0.9091
val Loss: 1.2471 Acc: 0.7273
Epoch 54/60
----------
train Loss: 1.1438 Acc: 0.9187
val Loss: 1.3721 Acc: 0.6818
Epoch 55/60
----------
train Loss: 1.1715 Acc: 0.9665
val Loss: 1.6163 Acc: 0.7273
Epoch 56/60
----------
train Loss: 1.3651 Acc: 0.9426
val Loss: 1.3721 Acc: 0.7727
Epoch 57/60
----------
train Loss: 1.4557 Acc: 0.8565
val Loss: 1.3475 Acc: 0.7500
Epoch 58/60
----------
train Loss: 1.1771 Acc: 0.8278
val Loss: 1.4405 Acc: 0.7727
Epoch 59/60
----------
train Loss: 1.2484 Acc: 0.9234
val Loss: 1.4642 Acc: 0.7500
Epoch 60/60
----------
train Loss: 1.0076 Acc: 0.9282
[32m[I 2025-06-29 04:16:05,348][0m Trial 125 finished with value: 0.7272727272727273 and parameters: {'batch_size': 104, 'lr': 0.0005221895699914649, 'num_epochs': 60, 'weight_decay': 0.004029825380733314, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3413 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_104_lr_0.0005221895699914649_epoch_60_wd_0.004029825380733314_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/64
----------
train Loss: 3.8122 Acc: 0.2249
val Loss: 3.6756 Acc: 0.2045
Epoch 2/64
----------
train Loss: 3.7244 Acc: 0.2440
val Loss: 3.6240 Acc: 0.2500
Epoch 3/64
----------
train Loss: 3.6404 Acc: 0.2584
val Loss: 3.5264 Acc: 0.2500
Epoch 4/64
----------
train Loss: 3.5943 Acc: 0.2775
val Loss: 3.4788 Acc: 0.3409
Epoch 5/64
----------
train Loss: 3.5522 Acc: 0.2679
val Loss: 3.4498 Acc: 0.3636
Epoch 6/64
----------
train Loss: 3.4802 Acc: 0.3206
val Loss: 3.4041 Acc: 0.3636
Epoch 7/64
----------
train Loss: 3.4156 Acc: 0.3780
val Loss: 3.3415 Acc: 0.4091
Epoch 8/64
----------
train Loss: 3.3525 Acc: 0.4163
val Loss: 3.2985 Acc: 0.4773
Epoch 9/64
----------
train Loss: 3.3051 Acc: 0.4211
val Loss: 3.2253 Acc: 0.5227
Epoch 10/64
----------
train Loss: 3.1924 Acc: 0.4306
val Loss: 3.1385 Acc: 0.5000
Epoch 11/64
----------
train Loss: 3.1926 Acc: 0.4450
val Loss: 3.1064 Acc: 0.5455
Epoch 12/64
----------
train Loss: 3.1451 Acc: 0.4593
val Loss: 3.0607 Acc: 0.5455
Epoch 13/64
----------
train Loss: 3.0427 Acc: 0.5311
val Loss: 2.9564 Acc: 0.5909
Epoch 14/64
----------
train Loss: 2.9858 Acc: 0.4976
val Loss: 2.9253 Acc: 0.5909
Epoch 15/64
----------
train Loss: 2.9510 Acc: 0.5167
val Loss: 2.8774 Acc: 0.5909
Epoch 16/64
----------
train Loss: 2.8990 Acc: 0.5311
val Loss: 2.7914 Acc: 0.6136
Epoch 17/64
----------
train Loss: 2.8343 Acc: 0.5502
val Loss: 2.7211 Acc: 0.6364
Epoch 18/64
----------
train Loss: 2.8012 Acc: 0.5024
val Loss: 2.6521 Acc: 0.6364
Epoch 19/64
----------
train Loss: 2.7332 Acc: 0.5359
val Loss: 2.5912 Acc: 0.6364
Epoch 20/64
----------
train Loss: 2.6839 Acc: 0.5359
val Loss: 2.5326 Acc: 0.6818
Epoch 21/64
----------
train Loss: 2.6667 Acc: 0.5359
val Loss: 2.5116 Acc: 0.6818
Epoch 22/64
----------
train Loss: 2.6283 Acc: 0.5502
val Loss: 2.4609 Acc: 0.6818
Epoch 23/64
----------
train Loss: 2.5527 Acc: 0.5359
val Loss: 2.4065 Acc: 0.6818
Epoch 24/64
----------
train Loss: 2.4486 Acc: 0.5407
val Loss: 2.3194 Acc: 0.6818
Epoch 25/64
----------
train Loss: 2.4976 Acc: 0.5502
val Loss: 2.3151 Acc: 0.6591
Epoch 26/64
----------
train Loss: 2.4794 Acc: 0.5215
val Loss: 2.3028 Acc: 0.6591
Epoch 27/64
----------
train Loss: 2.3632 Acc: 0.5694
val Loss: 2.2363 Acc: 0.6818
Epoch 28/64
----------
train Loss: 2.4287 Acc: 0.5167
val Loss: 2.2095 Acc: 0.6818
Epoch 29/64
----------
train Loss: 2.4343 Acc: 0.5359
val Loss: 2.1768 Acc: 0.6818
Epoch 30/64
----------
train Loss: 2.3793 Acc: 0.5311
val Loss: 2.1719 Acc: 0.6818
Epoch 31/64
----------
train Loss: 2.2744 Acc: 0.5789
val Loss: 2.1259 Acc: 0.6818
Epoch 32/64
----------
train Loss: 2.2976 Acc: 0.5407
val Loss: 2.0929 Acc: 0.6818
Epoch 33/64
----------
train Loss: 2.3161 Acc: 0.5407
val Loss: 2.0721 Acc: 0.6818
Epoch 34/64
----------
train Loss: 2.2621 Acc: 0.5263
val Loss: 2.0512 Acc: 0.6818
Epoch 35/64
----------
train Loss: 2.1422 Acc: 0.5598
val Loss: 2.0145 Acc: 0.7045
Epoch 36/64
----------
train Loss: 2.3428 Acc: 0.5263
val Loss: 1.9740 Acc: 0.6818
Epoch 37/64
----------
train Loss: 2.1956 Acc: 0.5694
val Loss: 1.9734 Acc: 0.7045
Epoch 38/64
----------
train Loss: 2.2004 Acc: 0.5933
val Loss: 1.9537 Acc: 0.7045
Epoch 39/64
----------
train Loss: 2.2398 Acc: 0.5550
val Loss: 1.9753 Acc: 0.7045
Epoch 40/64
----------
train Loss: 2.1092 Acc: 0.5789
val Loss: 1.9512 Acc: 0.7045
Epoch 41/64
----------
train Loss: 2.2701 Acc: 0.5455
val Loss: 1.9313 Acc: 0.7045
Epoch 42/64
----------
train Loss: 2.1095 Acc: 0.5742
val Loss: 1.8971 Acc: 0.7045
Epoch 43/64
----------
train Loss: 2.1804 Acc: 0.5359
val Loss: 1.8807 Acc: 0.7045
Epoch 44/64
----------
train Loss: 2.0404 Acc: 0.5933
val Loss: 1.8610 Acc: 0.7045
Epoch 45/64
----------
train Loss: 1.8603 Acc: 0.6603
val Loss: 1.8377 Acc: 0.7045
Epoch 46/64
----------
train Loss: 2.2273 Acc: 0.5694
val Loss: 1.8449 Acc: 0.7273
Epoch 47/64
----------
train Loss: 2.0215 Acc: 0.5837
val Loss: 1.8300 Acc: 0.7273
Epoch 48/64
----------
train Loss: 2.0456 Acc: 0.5933
val Loss: 1.8119 Acc: 0.7045
Epoch 49/64
----------
train Loss: 2.0281 Acc: 0.6124
val Loss: 1.7822 Acc: 0.7045
Epoch 50/64
----------
train Loss: 2.0135 Acc: 0.5981
val Loss: 1.8023 Acc: 0.7273
Epoch 51/64
----------
train Loss: 1.8531 Acc: 0.6364
val Loss: 1.7527 Acc: 0.7273
Epoch 52/64
----------
train Loss: 2.0254 Acc: 0.6220
val Loss: 1.7554 Acc: 0.7273
Epoch 53/64
----------
train Loss: 2.1053 Acc: 0.5933
val Loss: 1.7496 Acc: 0.7500
Epoch 54/64
----------
train Loss: 1.8808 Acc: 0.6794
val Loss: 1.7364 Acc: 0.7500
Epoch 55/64
----------
train Loss: 1.9210 Acc: 0.6507
val Loss: 1.7044 Acc: 0.7500
Epoch 56/64
----------
train Loss: 2.0194 Acc: 0.6172
val Loss: 1.7033 Acc: 0.7273
Epoch 57/64
----------
train Loss: 2.0988 Acc: 0.5981
val Loss: 1.6866 Acc: 0.7273
Epoch 58/64
----------
train Loss: 1.9227 Acc: 0.6268
val Loss: 1.6997 Acc: 0.7727
Epoch 59/64
----------
train Loss: 1.9819 Acc: 0.6364
val Loss: 1.6823 Acc: 0.7727
Epoch 60/64
----------
train Loss: 1.8523 Acc: 0.6938
val Loss: 1.6728 Acc: 0.7727
Epoch 61/64
----------
train Loss: 2.0801 Acc: 0.5789
val Loss: 1.6548 Acc: 0.7727
Epoch 62/64
----------
train Loss: 1.9222 Acc: 0.6890
val Loss: 1.6470 Acc: 0.7955
Epoch 63/64
----------
train Loss: 1.8097 Acc: 0.7225
val Loss: 1.6297 Acc: 0.7955
Epoch 64/64
----------
train Loss: 1.7861 Acc: 0.6986
[32m[I 2025-06-29 04:30:39,888][0m Trial 126 finished with value: 0.8181818181818182 and parameters: {'batch_size': 109, 'lr': 2.067348242534605e-05, 'num_epochs': 64, 'weight_decay': 0.00030454814374864577, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6303 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_109_lr_2.067348242534605e-05_epoch_64_wd_0.00030454814374864577_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/75
----------
train Loss: 3.8286 Acc: 0.4067
val Loss: 25.6562 Acc: 0.3864
Epoch 2/75
----------
train Loss: 2.7841 Acc: 0.4450
val Loss: 8.4915 Acc: 0.6364
Epoch 3/75
----------
train Loss: 2.5223 Acc: 0.5167
val Loss: 3.0530 Acc: 0.5227
Epoch 4/75
----------
train Loss: 2.4718 Acc: 0.5455
val Loss: 2.0621 Acc: 0.6364
Epoch 5/75
----------
train Loss: 2.3830 Acc: 0.5598
val Loss: 2.0924 Acc: 0.6364
Epoch 6/75
----------
train Loss: 2.3911 Acc: 0.5311
val Loss: 2.2768 Acc: 0.6591
Epoch 7/75
----------
train Loss: 2.3092 Acc: 0.6077
val Loss: 2.7388 Acc: 0.2727
Epoch 8/75
----------
train Loss: 2.4281 Acc: 0.5933
val Loss: 2.8611 Acc: 0.2273
Epoch 9/75
----------
train Loss: 2.3748 Acc: 0.5407
val Loss: 3.3070 Acc: 0.1364
Epoch 10/75
----------
train Loss: 2.0448 Acc: 0.7081
val Loss: 4.2028 Acc: 0.1364
Epoch 11/75
----------
train Loss: 2.3814 Acc: 0.5742
val Loss: 2.3957 Acc: 0.6364
Epoch 12/75
----------
train Loss: 2.3974 Acc: 0.5407
val Loss: 2.6467 Acc: 0.6364
Epoch 13/75
----------
train Loss: 2.2790 Acc: 0.5789
val Loss: 2.4573 Acc: 0.1364
Epoch 14/75
----------
train Loss: 2.4327 Acc: 0.5215
val Loss: 2.1326 Acc: 0.6364
Epoch 15/75
----------
train Loss: 2.2688 Acc: 0.5215
val Loss: 2.0761 Acc: 0.6364
Epoch 16/75
----------
train Loss: 2.2734 Acc: 0.5550
val Loss: 2.8370 Acc: 0.4773
Epoch 17/75
----------
train Loss: 2.0606 Acc: 0.6316
val Loss: 4.3958 Acc: 0.1364
Epoch 18/75
----------
train Loss: 1.9274 Acc: 0.6986
val Loss: 3.3696 Acc: 0.1364
Epoch 19/75
----------
train Loss: 2.2995 Acc: 0.5837
val Loss: 3.6013 Acc: 0.6364
Epoch 20/75
----------
train Loss: 2.2449 Acc: 0.6124
val Loss: 2.6761 Acc: 0.6364
Epoch 21/75
----------
train Loss: 2.2488 Acc: 0.6124
val Loss: 2.0453 Acc: 0.6364
Epoch 22/75
----------
train Loss: 2.1407 Acc: 0.5598
val Loss: 3.1993 Acc: 0.0909
Epoch 23/75
----------
train Loss: 2.1101 Acc: 0.6364
val Loss: 4.6696 Acc: 0.1364
Epoch 24/75
----------
train Loss: 2.0360 Acc: 0.6555
val Loss: 3.7317 Acc: 0.1591
Epoch 25/75
----------
train Loss: 1.9644 Acc: 0.7033
val Loss: 2.9562 Acc: 0.1591
Epoch 26/75
----------
train Loss: 2.2242 Acc: 0.6555
val Loss: 2.6179 Acc: 0.5909
Epoch 27/75
----------
train Loss: 1.8726 Acc: 0.7368
val Loss: 2.4531 Acc: 0.6136
Epoch 28/75
----------
train Loss: 2.0751 Acc: 0.7081
val Loss: 2.8653 Acc: 0.6364
Epoch 29/75
----------
train Loss: 2.0900 Acc: 0.6411
val Loss: 2.7289 Acc: 0.6364
Epoch 30/75
----------
train Loss: 2.0249 Acc: 0.6316
val Loss: 2.6951 Acc: 0.2273
Epoch 31/75
----------
train Loss: 1.8571 Acc: 0.7129
val Loss: 2.3324 Acc: 0.6591
Epoch 32/75
----------
train Loss: 2.1858 Acc: 0.6220
val Loss: 3.6830 Acc: 0.1818
Epoch 33/75
----------
train Loss: 2.2194 Acc: 0.6172
val Loss: 5.1023 Acc: 0.1364
Epoch 34/75
----------
train Loss: 2.0249 Acc: 0.6699
val Loss: 3.5721 Acc: 0.0909
Epoch 35/75
----------
train Loss: 1.9607 Acc: 0.6746
val Loss: 4.6870 Acc: 0.0909
Epoch 36/75
----------
train Loss: 2.1986 Acc: 0.5981
[32m[I 2025-06-29 04:38:52,773][0m Trial 127 finished with value: 0.6590909090909091 and parameters: {'batch_size': 79, 'lr': 0.006864794755917549, 'num_epochs': 75, 'weight_decay': 0.0027329429678278902, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.2046 Acc: 0.1591
Early stopping at epoch 36 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.659091

Model weights saved at ./model_weights/efficientnetb0_bs_79_lr_0.006864794755917549_epoch_75_wd_0.0027329429678278902_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/67
----------
train Loss: 3.2747 Acc: 0.3780
val Loss: 2.7787 Acc: 0.6364
Epoch 2/67
----------
train Loss: 2.4731 Acc: 0.5359
val Loss: 1.9916 Acc: 0.6364
Epoch 3/67
----------
train Loss: 2.2262 Acc: 0.5215
val Loss: 2.1286 Acc: 0.6818
Epoch 4/67
----------
train Loss: 2.1264 Acc: 0.5694
val Loss: 2.4625 Acc: 0.7045
Epoch 5/67
----------
train Loss: 2.0306 Acc: 0.6699
val Loss: 2.1482 Acc: 0.7727
Epoch 6/67
----------
train Loss: 1.8704 Acc: 0.6986
val Loss: 1.7543 Acc: 0.7955
Epoch 7/67
----------
train Loss: 1.5871 Acc: 0.8373
val Loss: 1.6440 Acc: 0.7500
Epoch 8/67
----------
train Loss: 1.7365 Acc: 0.7464
val Loss: 1.6895 Acc: 0.7955
Epoch 9/67
----------
train Loss: 1.7261 Acc: 0.7512
val Loss: 1.9836 Acc: 0.8182
Epoch 10/67
----------
train Loss: 1.0683 Acc: 0.9474
val Loss: 1.2810 Acc: 0.8182
Epoch 11/67
----------
train Loss: 1.7983 Acc: 0.7608
val Loss: 1.6190 Acc: 0.8636
Epoch 12/67
----------
train Loss: 1.5152 Acc: 0.7751
val Loss: 2.9187 Acc: 0.5682
Epoch 13/67
----------
train Loss: 1.4129 Acc: 0.8660
val Loss: 1.8813 Acc: 0.7727
Epoch 14/67
----------
train Loss: 1.3218 Acc: 0.8134
val Loss: 1.5643 Acc: 0.7727
Epoch 15/67
----------
train Loss: 1.4465 Acc: 0.8182
val Loss: 1.6086 Acc: 0.7727
Epoch 16/67
----------
train Loss: 1.5041 Acc: 0.8086
val Loss: 1.9802 Acc: 0.8409
Epoch 17/67
----------
train Loss: 1.3905 Acc: 0.8325
val Loss: 1.8936 Acc: 0.8182
Epoch 18/67
----------
train Loss: 1.3566 Acc: 0.8134
val Loss: 1.4372 Acc: 0.7727
Epoch 19/67
----------
train Loss: 1.3016 Acc: 0.9139
val Loss: 1.4252 Acc: 0.7500
Epoch 20/67
----------
train Loss: 1.4288 Acc: 0.8612
val Loss: 1.6240 Acc: 0.7727
Epoch 21/67
----------
train Loss: 1.5005 Acc: 0.8804
val Loss: 2.5483 Acc: 0.7045
Epoch 22/67
----------
train Loss: 1.3283 Acc: 0.8708
val Loss: 1.8346 Acc: 0.7500
Epoch 23/67
----------
train Loss: 1.5928 Acc: 0.8517
val Loss: 1.5811 Acc: 0.7045
Epoch 24/67
----------
train Loss: 1.2218 Acc: 0.9043
val Loss: 1.6439 Acc: 0.8182
Epoch 25/67
----------
train Loss: 1.3602 Acc: 0.9234
val Loss: 1.5287 Acc: 0.7955
Epoch 26/67
----------
train Loss: 1.4867 Acc: 0.9378
val Loss: 1.5566 Acc: 0.6591
Epoch 27/67
----------
train Loss: 1.3169 Acc: 0.9474
val Loss: 1.8811 Acc: 0.7273
Epoch 28/67
----------
train Loss: 1.5302 Acc: 0.8325
val Loss: 1.5620 Acc: 0.8182
Epoch 29/67
----------
train Loss: 1.5926 Acc: 0.7608
val Loss: 1.5709 Acc: 0.7273
Epoch 30/67
----------
train Loss: 1.4731 Acc: 0.8134
val Loss: 1.5031 Acc: 0.7955
Epoch 31/67
----------
train Loss: 1.2412 Acc: 0.9330
val Loss: 1.4825 Acc: 0.7727
Epoch 32/67
----------
train Loss: 1.4039 Acc: 0.8756
val Loss: 1.6622 Acc: 0.7500
Epoch 33/67
----------
train Loss: 1.4560 Acc: 0.8517
val Loss: 1.7395 Acc: 0.7500
Epoch 34/67
----------
train Loss: 1.4451 Acc: 0.9091
val Loss: 1.5802 Acc: 0.7500
Epoch 35/67
----------
train Loss: 1.1224 Acc: 0.9522
val Loss: 1.3832 Acc: 0.7500
Epoch 36/67
----------
train Loss: 1.6014 Acc: 0.8278
val Loss: 1.4741 Acc: 0.7273
Epoch 37/67
----------
train Loss: 1.4309 Acc: 0.8278
val Loss: 1.6571 Acc: 0.7273
Epoch 38/67
----------
train Loss: 1.4627 Acc: 0.9187
val Loss: 1.5259 Acc: 0.7727
Epoch 39/67
----------
train Loss: 1.4796 Acc: 0.7464
val Loss: 1.7007 Acc: 0.8182
Epoch 40/67
----------
train Loss: 1.2966 Acc: 0.9091
val Loss: 1.4773 Acc: 0.7045
Epoch 41/67
----------
train Loss: 1.6620 Acc: 0.7081
val Loss: 1.6143 Acc: 0.7273
Epoch 42/67
----------
train Loss: 1.2965 Acc: 0.8660
val Loss: 1.7208 Acc: 0.7727
Epoch 43/67
----------
train Loss: 1.4016 Acc: 0.8086
val Loss: 1.9229 Acc: 0.7500
Epoch 44/67
----------
train Loss: 1.2951 Acc: 0.8947
val Loss: 1.7332 Acc: 0.7273
Epoch 45/67
----------
train Loss: 0.8661 Acc: 0.9522
val Loss: 1.5022 Acc: 0.7727
Epoch 46/67
----------
train Loss: 1.7470 Acc: 0.8038
val Loss: 1.7285 Acc: 0.6591
Epoch 47/67
----------
train Loss: 1.4307 Acc: 0.8660
val Loss: 1.7646 Acc: 0.7045
Epoch 48/67
----------
train Loss: 1.3988 Acc: 0.8230
val Loss: 2.1589 Acc: 0.5682
Epoch 49/67
----------
train Loss: 1.3478 Acc: 0.8995
val Loss: 1.8048 Acc: 0.7273
Epoch 50/67
----------
train Loss: 1.3429 Acc: 0.8182
val Loss: 1.5212 Acc: 0.7273
Epoch 51/67
----------
train Loss: 0.9936 Acc: 0.9665
val Loss: 1.6093 Acc: 0.7273
Epoch 52/67
----------
train Loss: 1.3726 Acc: 0.8469
val Loss: 2.0095 Acc: 0.6591
Epoch 53/67
----------
train Loss: 1.5893 Acc: 0.8756
val Loss: 1.5727 Acc: 0.7045
Epoch 54/67
----------
train Loss: 1.2909 Acc: 0.8995
val Loss: 1.4437 Acc: 0.7727
Epoch 55/67
----------
train Loss: 1.2542 Acc: 0.9330
val Loss: 1.5663 Acc: 0.7727
Epoch 56/67
----------
train Loss: 1.4322 Acc: 0.9043
val Loss: 1.5106 Acc: 0.7955
Epoch 57/67
----------
train Loss: 1.6307 Acc: 0.8038
val Loss: 1.5854 Acc: 0.7273
Epoch 58/67
----------
train Loss: 1.2772 Acc: 0.8134
val Loss: 1.8518 Acc: 0.7045
Epoch 59/67
----------
train Loss: 1.4055 Acc: 0.8804
val Loss: 2.0304 Acc: 0.6591
Epoch 60/67
----------
train Loss: 1.1793 Acc: 0.8517
val Loss: 1.5303 Acc: 0.6591
Epoch 61/67
----------
train Loss: 1.6191 Acc: 0.7751
[32m[I 2025-06-29 04:52:45,403][0m Trial 128 finished with value: 0.7954545454545455 and parameters: {'batch_size': 10, 'lr': 0.0006219109998202442, 'num_epochs': 67, 'weight_decay': 0.021959017332281217, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.8220 Acc: 0.7273
Early stopping at epoch 61 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_10_lr_0.0006219109998202442_epoch_67_wd_0.021959017332281217_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/82
----------
train Loss: 3.5080 Acc: 0.3349
val Loss: 3.2251 Acc: 0.5909
Epoch 2/82
----------
train Loss: 2.8599 Acc: 0.5215
val Loss: 2.5323 Acc: 0.6364
Epoch 3/82
----------
train Loss: 2.4751 Acc: 0.4976
val Loss: 2.0798 Acc: 0.6364
Epoch 4/82
----------
train Loss: 2.3207 Acc: 0.5024
val Loss: 1.9803 Acc: 0.6591
Epoch 5/82
----------
train Loss: 2.2496 Acc: 0.5455
val Loss: 1.9192 Acc: 0.6818
Epoch 6/82
----------
train Loss: 2.1016 Acc: 0.5646
val Loss: 1.8811 Acc: 0.7045
Epoch 7/82
----------
train Loss: 1.9736 Acc: 0.6268
val Loss: 1.8952 Acc: 0.7955
Epoch 8/82
----------
train Loss: 2.0322 Acc: 0.6364
val Loss: 1.7245 Acc: 0.7955
Epoch 9/82
----------
train Loss: 1.9541 Acc: 0.7033
val Loss: 1.7415 Acc: 0.7955
Epoch 10/82
----------
train Loss: 1.4541 Acc: 0.8900
val Loss: 1.5687 Acc: 0.7727
Epoch 11/82
----------
train Loss: 1.7723 Acc: 0.7321
val Loss: 1.3863 Acc: 0.7727
Epoch 12/82
----------
train Loss: 1.6901 Acc: 0.7129
val Loss: 1.5264 Acc: 0.7955
Epoch 13/82
----------
train Loss: 1.4444 Acc: 0.8660
val Loss: 1.4109 Acc: 0.7955
Epoch 14/82
----------
train Loss: 1.3328 Acc: 0.8038
val Loss: 1.5148 Acc: 0.7045
Epoch 15/82
----------
train Loss: 1.4983 Acc: 0.7799
val Loss: 1.3681 Acc: 0.7500
Epoch 16/82
----------
train Loss: 1.5125 Acc: 0.7608
val Loss: 1.5620 Acc: 0.7273
Epoch 17/82
----------
train Loss: 1.4487 Acc: 0.8421
val Loss: 1.6746 Acc: 0.7955
Epoch 18/82
----------
train Loss: 1.3882 Acc: 0.8086
val Loss: 1.4225 Acc: 0.8409
Epoch 19/82
----------
train Loss: 1.2608 Acc: 0.9426
val Loss: 1.3182 Acc: 0.7500
Epoch 20/82
----------
train Loss: 1.3974 Acc: 0.8517
val Loss: 1.2608 Acc: 0.7273
Epoch 21/82
----------
train Loss: 1.4685 Acc: 0.8660
val Loss: 1.3155 Acc: 0.7727
Epoch 22/82
----------
train Loss: 1.3193 Acc: 0.8660
val Loss: 1.4061 Acc: 0.7727
Epoch 23/82
----------
train Loss: 1.4815 Acc: 0.8708
[32m[I 2025-06-29 04:57:59,545][0m Trial 129 finished with value: 0.8409090909090909 and parameters: {'batch_size': 89, 'lr': 0.0003370018874719721, 'num_epochs': 82, 'weight_decay': 0.027501028267131005, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5128 Acc: 0.7727
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_89_lr_0.0003370018874719721_epoch_82_wd_0.027501028267131005_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/89
----------
train Loss: 0.6862 Acc: 0.2584
val Loss: 0.6615 Acc: 0.2955
Epoch 2/89
----------
train Loss: 0.6407 Acc: 0.4067
val Loss: 0.6206 Acc: 0.4545
Epoch 3/89
----------
train Loss: 0.6043 Acc: 0.4689
val Loss: 0.5662 Acc: 0.5909
Epoch 4/89
----------
train Loss: 0.5757 Acc: 0.4880
val Loss: 0.5260 Acc: 0.6364
Epoch 5/89
----------
train Loss: 0.5526 Acc: 0.5407
val Loss: 0.4984 Acc: 0.6591
Epoch 6/89
----------
train Loss: 0.5204 Acc: 0.5455
val Loss: 0.4664 Acc: 0.6818
Epoch 7/89
----------
train Loss: 0.4891 Acc: 0.5837
val Loss: 0.4385 Acc: 0.6818
Epoch 8/89
----------
train Loss: 0.4850 Acc: 0.5455
val Loss: 0.4124 Acc: 0.6818
Epoch 9/89
----------
train Loss: 0.4695 Acc: 0.5789
val Loss: 0.3936 Acc: 0.7045
Epoch 10/89
----------
train Loss: 0.4122 Acc: 0.6651
val Loss: 0.3791 Acc: 0.7045
Epoch 11/89
----------
train Loss: 0.4351 Acc: 0.5981
val Loss: 0.3651 Acc: 0.7273
Epoch 12/89
----------
train Loss: 0.4394 Acc: 0.6077
val Loss: 0.3613 Acc: 0.7273
Epoch 13/89
----------
train Loss: 0.4004 Acc: 0.6986
val Loss: 0.3452 Acc: 0.7273
Epoch 14/89
----------
train Loss: 0.3738 Acc: 0.7225
val Loss: 0.3326 Acc: 0.7273
Epoch 15/89
----------
train Loss: 0.3927 Acc: 0.6986
val Loss: 0.3234 Acc: 0.7727
Epoch 16/89
----------
train Loss: 0.3841 Acc: 0.7464
val Loss: 0.3217 Acc: 0.7500
Epoch 17/89
----------
train Loss: 0.3712 Acc: 0.7416
val Loss: 0.3206 Acc: 0.7727
Epoch 18/89
----------
train Loss: 0.3502 Acc: 0.7799
val Loss: 0.3101 Acc: 0.7955
Epoch 19/89
----------
train Loss: 0.3283 Acc: 0.8134
val Loss: 0.3027 Acc: 0.7955
Epoch 20/89
----------
train Loss: 0.3477 Acc: 0.7703
val Loss: 0.2907 Acc: 0.7727
Epoch 21/89
----------
train Loss: 0.3515 Acc: 0.7847
val Loss: 0.2792 Acc: 0.7955
Epoch 22/89
----------
train Loss: 0.3315 Acc: 0.8182
val Loss: 0.2769 Acc: 0.8182
Epoch 23/89
----------
train Loss: 0.3369 Acc: 0.8469
val Loss: 0.2722 Acc: 0.8409
Epoch 24/89
----------
train Loss: 0.2821 Acc: 0.8660
val Loss: 0.2574 Acc: 0.8182
Epoch 25/89
----------
train Loss: 0.3102 Acc: 0.8947
val Loss: 0.2632 Acc: 0.7955
Epoch 26/89
----------
train Loss: 0.3214 Acc: 0.8804
val Loss: 0.2672 Acc: 0.8182
Epoch 27/89
----------
train Loss: 0.2639 Acc: 0.9569
val Loss: 0.2772 Acc: 0.8182
Epoch 28/89
----------
train Loss: 0.3236 Acc: 0.8612
val Loss: 0.2755 Acc: 0.7500
Epoch 29/89
----------
train Loss: 0.3487 Acc: 0.7416
val Loss: 0.2751 Acc: 0.7955
Epoch 30/89
----------
train Loss: 0.2993 Acc: 0.8325
val Loss: 0.2602 Acc: 0.8409
Epoch 31/89
----------
train Loss: 0.2558 Acc: 0.9282
val Loss: 0.2494 Acc: 0.8182
Epoch 32/89
----------
train Loss: 0.2875 Acc: 0.8325
val Loss: 0.2466 Acc: 0.7955
Epoch 33/89
----------
train Loss: 0.3035 Acc: 0.8421
val Loss: 0.2463 Acc: 0.7955
Epoch 34/89
----------
train Loss: 0.2847 Acc: 0.8804
val Loss: 0.2517 Acc: 0.7727
Epoch 35/89
----------
train Loss: 0.2286 Acc: 0.9809
val Loss: 0.2638 Acc: 0.7500
Epoch 36/89
----------
train Loss: 0.3361 Acc: 0.7990
val Loss: 0.2685 Acc: 0.7500
Epoch 37/89
----------
train Loss: 0.2752 Acc: 0.8278
val Loss: 0.2693 Acc: 0.7500
Epoch 38/89
----------
train Loss: 0.2773 Acc: 0.9426
val Loss: 0.2583 Acc: 0.7727
Epoch 39/89
----------
train Loss: 0.3062 Acc: 0.7799
val Loss: 0.2631 Acc: 0.7727
Epoch 40/89
----------
train Loss: 0.2482 Acc: 0.8900
val Loss: 0.2617 Acc: 0.7727
Epoch 41/89
----------
train Loss: 0.3390 Acc: 0.7273
val Loss: 0.2549 Acc: 0.8182
Epoch 42/89
----------
train Loss: 0.2461 Acc: 0.8660
val Loss: 0.2506 Acc: 0.7955
Epoch 43/89
----------
train Loss: 0.2726 Acc: 0.8373
val Loss: 0.2491 Acc: 0.7955
Epoch 44/89
----------
train Loss: 0.2617 Acc: 0.8756
val Loss: 0.2572 Acc: 0.8182
Epoch 45/89
----------
train Loss: 0.1617 Acc: 0.9761
val Loss: 0.2603 Acc: 0.8182
Epoch 46/89
----------
train Loss: 0.3578 Acc: 0.8038
val Loss: 0.2638 Acc: 0.7727
Epoch 47/89
----------
train Loss: 0.2487 Acc: 0.8900
val Loss: 0.2552 Acc: 0.7955
Epoch 48/89
----------
train Loss: 0.2864 Acc: 0.8517
val Loss: 0.2572 Acc: 0.7500
Epoch 49/89
----------
train Loss: 0.2697 Acc: 0.9474
val Loss: 0.2604 Acc: 0.7727
Epoch 50/89
----------
train Loss: 0.2645 Acc: 0.8995
val Loss: 0.2614 Acc: 0.7727
Epoch 51/89
----------
train Loss: 0.1951 Acc: 0.9856
val Loss: 0.2530 Acc: 0.7727
Epoch 52/89
----------
train Loss: 0.2807 Acc: 0.8230
val Loss: 0.2505 Acc: 0.7727
Epoch 53/89
----------
train Loss: 0.3172 Acc: 0.8995
val Loss: 0.2476 Acc: 0.7727
Epoch 54/89
----------
train Loss: 0.2312 Acc: 0.9426
val Loss: 0.2477 Acc: 0.7955
Epoch 55/89
----------
train Loss: 0.2464 Acc: 0.9330
val Loss: 0.2564 Acc: 0.7727
Epoch 56/89
----------
train Loss: 0.2895 Acc: 0.9187
val Loss: 0.2596 Acc: 0.7500
Epoch 57/89
----------
train Loss: 0.3300 Acc: 0.8182
val Loss: 0.2603 Acc: 0.7727
Epoch 58/89
----------
train Loss: 0.2678 Acc: 0.7990
val Loss: 0.2538 Acc: 0.8182
Epoch 59/89
----------
train Loss: 0.2759 Acc: 0.8947
val Loss: 0.2572 Acc: 0.7955
Epoch 60/89
----------
train Loss: 0.2270 Acc: 0.9043
val Loss: 0.2574 Acc: 0.7955
Epoch 61/89
----------
train Loss: 0.3192 Acc: 0.7847
val Loss: 0.2622 Acc: 0.7727
Epoch 62/89
----------
train Loss: 0.2890 Acc: 0.9569
val Loss: 0.2613 Acc: 0.7727
Epoch 63/89
----------
train Loss: 0.2478 Acc: 0.9378
val Loss: 0.2605 Acc: 0.8182
Epoch 64/89
----------
train Loss: 0.2319 Acc: 0.9474
val Loss: 0.2580 Acc: 0.7955
Epoch 65/89
----------
train Loss: 0.2647 Acc: 0.8421
val Loss: 0.2628 Acc: 0.7727
Epoch 66/89
----------
train Loss: 0.2591 Acc: 0.9091
val Loss: 0.2702 Acc: 0.7955
Epoch 67/89
----------
train Loss: 0.2921 Acc: 0.8900
val Loss: 0.2648 Acc: 0.7500
Epoch 68/89
----------
train Loss: 0.2471 Acc: 0.8947
val Loss: 0.2682 Acc: 0.7727
Epoch 69/89
----------
train Loss: 0.2407 Acc: 0.9043
val Loss: 0.2622 Acc: 0.7727
Epoch 70/89
----------
train Loss: 0.2744 Acc: 0.9139
val Loss: 0.2616 Acc: 0.7727
Epoch 71/89
----------
train Loss: 0.2885 Acc: 0.9187
val Loss: 0.2550 Acc: 0.7727
Epoch 72/89
----------
train Loss: 0.2857 Acc: 0.9043
val Loss: 0.2620 Acc: 0.7955
Epoch 73/89
----------
train Loss: 0.2087 Acc: 0.9713
val Loss: 0.2690 Acc: 0.7955
Epoch 74/89
----------
train Loss: 0.3032 Acc: 0.8804
val Loss: 0.2646 Acc: 0.7500
Epoch 75/89
----------
train Loss: 0.2256 Acc: 0.9713
val Loss: 0.2594 Acc: 0.7727
Epoch 76/89
----------
train Loss: 0.2382 Acc: 0.8469
val Loss: 0.2563 Acc: 0.7500
Epoch 77/89
----------
train Loss: 0.2790 Acc: 0.8756
val Loss: 0.2586 Acc: 0.7727
Epoch 78/89
----------
train Loss: 0.2431 Acc: 0.8947
val Loss: 0.2624 Acc: 0.7955
Epoch 79/89
----------
train Loss: 0.2907 Acc: 0.8804
val Loss: 0.2605 Acc: 0.7955
Epoch 80/89
----------
train Loss: 0.2622 Acc: 0.8612
val Loss: 0.2621 Acc: 0.8409
Epoch 81/89
----------
train Loss: 0.3007 Acc: 0.8182
val Loss: 0.2729 Acc: 0.8182
Epoch 82/89
----------
train Loss: 0.2599 Acc: 0.8804
val Loss: 0.2765 Acc: 0.8182
Epoch 83/89
----------
train Loss: 0.2282 Acc: 0.9761
val Loss: 0.2766 Acc: 0.7727
Epoch 84/89
----------
train Loss: 0.2941 Acc: 0.7703
val Loss: 0.2711 Acc: 0.7727
Epoch 85/89
----------
train Loss: 0.2330 Acc: 0.8373
val Loss: 0.2658 Acc: 0.7727
Epoch 86/89
----------
train Loss: 0.2463 Acc: 0.8756
val Loss: 0.2545 Acc: 0.8182
Epoch 87/89
----------
train Loss: 0.2796 Acc: 0.9426
val Loss: 0.2536 Acc: 0.7955
Epoch 88/89
----------
train Loss: 0.2970 Acc: 0.9043
val Loss: 0.2538 Acc: 0.8182
Epoch 89/89
----------
train Loss: 0.3164 Acc: 0.8278
[32m[I 2025-06-29 05:18:14,767][0m Trial 130 finished with value: 0.8409090909090909 and parameters: {'batch_size': 17, 'lr': 8.967696776202382e-05, 'num_epochs': 89, 'weight_decay': 0.0005196379797904858, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2523 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_17_lr_8.967696776202382e-05_epoch_89_wd_0.0005196379797904858_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.6077 Acc: 0.2967
val Loss: 3.3515 Acc: 0.5682
Epoch 2/78
----------
train Loss: 3.0999 Acc: 0.4928
val Loss: 2.8328 Acc: 0.6364
Epoch 3/78
----------
train Loss: 2.7229 Acc: 0.5072
val Loss: 2.2861 Acc: 0.6364
Epoch 4/78
----------
train Loss: 2.4973 Acc: 0.4976
val Loss: 2.0580 Acc: 0.6364
Epoch 5/78
----------
train Loss: 2.3717 Acc: 0.5120
val Loss: 1.9540 Acc: 0.6364
Epoch 6/78
----------
train Loss: 2.2191 Acc: 0.5359
val Loss: 1.8705 Acc: 0.6818
Epoch 7/78
----------
train Loss: 2.1095 Acc: 0.5550
val Loss: 1.8369 Acc: 0.7045
Epoch 8/78
----------
train Loss: 2.1609 Acc: 0.5694
val Loss: 1.7477 Acc: 0.6818
Epoch 9/78
----------
train Loss: 2.0982 Acc: 0.6124
val Loss: 1.7553 Acc: 0.7500
Epoch 10/78
----------
train Loss: 1.6790 Acc: 0.8086
val Loss: 1.7018 Acc: 0.7500
Epoch 11/78
----------
train Loss: 1.9479 Acc: 0.6603
val Loss: 1.5913 Acc: 0.7500
Epoch 12/78
----------
train Loss: 1.9240 Acc: 0.6220
val Loss: 1.6044 Acc: 0.7727
Epoch 13/78
----------
train Loss: 1.6819 Acc: 0.8086
val Loss: 1.5020 Acc: 0.7500
Epoch 14/78
----------
train Loss: 1.5325 Acc: 0.7895
val Loss: 1.4619 Acc: 0.7500
Epoch 15/78
----------
train Loss: 1.6441 Acc: 0.7512
val Loss: 1.3834 Acc: 0.7500
Epoch 16/78
----------
train Loss: 1.5954 Acc: 0.7608
val Loss: 1.3700 Acc: 0.7727
Epoch 17/78
----------
train Loss: 1.5116 Acc: 0.8325
val Loss: 1.3974 Acc: 0.8409
Epoch 18/78
----------
train Loss: 1.4174 Acc: 0.8325
val Loss: 1.3212 Acc: 0.8182
Epoch 19/78
----------
train Loss: 1.3078 Acc: 0.9043
val Loss: 1.2976 Acc: 0.7955
Epoch 20/78
----------
train Loss: 1.4055 Acc: 0.8565
val Loss: 1.2527 Acc: 0.7727
Epoch 21/78
----------
train Loss: 1.4818 Acc: 0.8469
val Loss: 1.2493 Acc: 0.7955
Epoch 22/78
----------
train Loss: 1.3540 Acc: 0.8517
val Loss: 1.2878 Acc: 0.8409
Epoch 23/78
----------
train Loss: 1.5089 Acc: 0.8469
val Loss: 1.2592 Acc: 0.8409
Epoch 24/78
----------
train Loss: 1.0933 Acc: 0.9282
val Loss: 1.1862 Acc: 0.7955
Epoch 25/78
----------
train Loss: 1.2931 Acc: 0.9330
val Loss: 1.2738 Acc: 0.7727
Epoch 26/78
----------
train Loss: 1.4376 Acc: 0.9091
val Loss: 1.3354 Acc: 0.8409
Epoch 27/78
----------
train Loss: 1.1667 Acc: 0.9713
val Loss: 1.4189 Acc: 0.8182
Epoch 28/78
----------
train Loss: 1.4263 Acc: 0.8756
val Loss: 1.3258 Acc: 0.8409
Epoch 29/78
----------
train Loss: 1.5279 Acc: 0.7703
val Loss: 1.3050 Acc: 0.8182
Epoch 30/78
----------
train Loss: 1.3042 Acc: 0.8660
val Loss: 1.2536 Acc: 0.8182
Epoch 31/78
----------
train Loss: 1.1619 Acc: 0.9282
val Loss: 1.1687 Acc: 0.8182
Epoch 32/78
----------
train Loss: 1.3140 Acc: 0.8900
val Loss: 1.1508 Acc: 0.7955
Epoch 33/78
----------
train Loss: 1.3594 Acc: 0.8708
val Loss: 1.2060 Acc: 0.8182
Epoch 34/78
----------
train Loss: 1.3015 Acc: 0.9282
val Loss: 1.2506 Acc: 0.8182
Epoch 35/78
----------
train Loss: 0.9965 Acc: 0.9809
val Loss: 1.3452 Acc: 0.7955
Epoch 36/78
----------
train Loss: 1.5373 Acc: 0.8469
val Loss: 1.3251 Acc: 0.7955
Epoch 37/78
----------
train Loss: 1.2968 Acc: 0.8182
val Loss: 1.3743 Acc: 0.8182
Epoch 38/78
----------
train Loss: 1.3331 Acc: 0.9330
val Loss: 1.3012 Acc: 0.7955
Epoch 39/78
----------
train Loss: 1.3998 Acc: 0.7656
val Loss: 1.4200 Acc: 0.7727
Epoch 40/78
----------
train Loss: 1.1698 Acc: 0.9091
val Loss: 1.4118 Acc: 0.7273
Epoch 41/78
----------
train Loss: 1.6365 Acc: 0.7225
val Loss: 1.2803 Acc: 0.7727
Epoch 42/78
----------
train Loss: 1.1758 Acc: 0.8804
val Loss: 1.2357 Acc: 0.8182
Epoch 43/78
----------
train Loss: 1.3483 Acc: 0.8756
val Loss: 1.1721 Acc: 0.8409
Epoch 44/78
----------
train Loss: 1.2047 Acc: 0.8852
val Loss: 1.2786 Acc: 0.7955
Epoch 45/78
----------
train Loss: 0.7883 Acc: 0.9713
val Loss: 1.2058 Acc: 0.7955
Epoch 46/78
----------
train Loss: 1.6142 Acc: 0.8421
val Loss: 1.3285 Acc: 0.7955
Epoch 47/78
----------
train Loss: 1.2393 Acc: 0.8995
val Loss: 1.2523 Acc: 0.7955
Epoch 48/78
----------
train Loss: 1.3242 Acc: 0.8660
val Loss: 1.2812 Acc: 0.7955
Epoch 49/78
----------
train Loss: 1.3210 Acc: 0.9522
val Loss: 1.3559 Acc: 0.7727
Epoch 50/78
----------
train Loss: 1.2644 Acc: 0.8804
val Loss: 1.4016 Acc: 0.7955
Epoch 51/78
----------
train Loss: 0.9758 Acc: 0.9904
val Loss: 1.2517 Acc: 0.8409
Epoch 52/78
----------
train Loss: 1.3297 Acc: 0.8421
val Loss: 1.2668 Acc: 0.8182
Epoch 53/78
----------
train Loss: 1.4933 Acc: 0.9091
val Loss: 1.2985 Acc: 0.7500
Epoch 54/78
----------
train Loss: 1.1401 Acc: 0.9474
val Loss: 1.3822 Acc: 0.7727
Epoch 55/78
----------
train Loss: 1.1983 Acc: 0.9426
val Loss: 1.4581 Acc: 0.6818
Epoch 56/78
----------
train Loss: 1.3782 Acc: 0.9139
val Loss: 1.3109 Acc: 0.7500
Epoch 57/78
----------
train Loss: 1.5125 Acc: 0.8469
val Loss: 1.2685 Acc: 0.7727
Epoch 58/78
----------
train Loss: 1.2392 Acc: 0.8278
val Loss: 1.2671 Acc: 0.8182
Epoch 59/78
----------
train Loss: 1.2910 Acc: 0.8947
val Loss: 1.4055 Acc: 0.7500
Epoch 60/78
----------
train Loss: 1.1028 Acc: 0.8708
val Loss: 1.3719 Acc: 0.7727
Epoch 61/78
----------
train Loss: 1.5134 Acc: 0.7608
val Loss: 1.2654 Acc: 0.7500
Epoch 62/78
----------
train Loss: 1.4145 Acc: 0.9330
val Loss: 1.2895 Acc: 0.7500
Epoch 63/78
----------
train Loss: 1.2442 Acc: 0.9282
val Loss: 1.3709 Acc: 0.7727
Epoch 64/78
----------
train Loss: 1.1217 Acc: 0.9426
val Loss: 1.3169 Acc: 0.7727
Epoch 65/78
----------
train Loss: 1.2545 Acc: 0.8612
val Loss: 1.4054 Acc: 0.7500
Epoch 66/78
----------
train Loss: 1.2660 Acc: 0.9091
val Loss: 1.3533 Acc: 0.7500
Epoch 67/78
----------
train Loss: 1.4316 Acc: 0.8660
val Loss: 1.4100 Acc: 0.7500
Epoch 68/78
----------
train Loss: 1.1883 Acc: 0.9091
val Loss: 1.3195 Acc: 0.7727
Epoch 69/78
----------
train Loss: 1.1310 Acc: 0.8804
val Loss: 1.1583 Acc: 0.8182
Epoch 70/78
----------
train Loss: 1.3087 Acc: 0.8995
val Loss: 1.1019 Acc: 0.8636
Epoch 71/78
----------
train Loss: 1.3920 Acc: 0.9187
val Loss: 1.2216 Acc: 0.7727
Epoch 72/78
----------
train Loss: 1.3924 Acc: 0.9043
val Loss: 1.3316 Acc: 0.7500
Epoch 73/78
----------
train Loss: 1.0134 Acc: 0.9713
val Loss: 1.3622 Acc: 0.7727
Epoch 74/78
----------
train Loss: 1.4226 Acc: 0.8565
val Loss: 1.3270 Acc: 0.7500
Epoch 75/78
----------
train Loss: 1.0889 Acc: 0.9665
[32m[I 2025-06-29 05:35:17,901][0m Trial 131 finished with value: 0.8636363636363636 and parameters: {'batch_size': 27, 'lr': 0.00021478980667130582, 'num_epochs': 78, 'weight_decay': 0.019444614856058442, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2523 Acc: 0.7955
Early stopping at epoch 75 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_27_lr_0.00021478980667130582_epoch_78_wd_0.019444614856058442_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 3.4126 Acc: 0.3636
val Loss: 3.1064 Acc: 0.5909
Epoch 2/84
----------
train Loss: 2.6754 Acc: 0.5120
val Loss: 2.2908 Acc: 0.6364
Epoch 3/84
----------
train Loss: 2.3471 Acc: 0.5072
val Loss: 2.0576 Acc: 0.6591
Epoch 4/84
----------
train Loss: 2.2423 Acc: 0.5024
val Loss: 2.0904 Acc: 0.7045
Epoch 5/84
----------
train Loss: 2.1736 Acc: 0.5981
val Loss: 2.0934 Acc: 0.7727
Epoch 6/84
----------
train Loss: 2.0116 Acc: 0.6029
val Loss: 2.0647 Acc: 0.7955
Epoch 7/84
----------
train Loss: 1.8612 Acc: 0.6938
val Loss: 1.9822 Acc: 0.7955
Epoch 8/84
----------
train Loss: 1.9047 Acc: 0.7177
val Loss: 1.6660 Acc: 0.8182
Epoch 9/84
----------
train Loss: 1.8593 Acc: 0.7273
val Loss: 1.8983 Acc: 0.7727
Epoch 10/84
----------
train Loss: 1.2793 Acc: 0.9234
val Loss: 1.6312 Acc: 0.7955
Epoch 11/84
----------
train Loss: 1.6981 Acc: 0.7751
val Loss: 1.4157 Acc: 0.8636
Epoch 12/84
----------
train Loss: 1.5768 Acc: 0.7321
val Loss: 1.7929 Acc: 0.7727
Epoch 13/84
----------
train Loss: 1.3882 Acc: 0.8756
val Loss: 1.5914 Acc: 0.7727
Epoch 14/84
----------
train Loss: 1.2824 Acc: 0.8373
val Loss: 1.6393 Acc: 0.7273
Epoch 15/84
----------
train Loss: 1.4704 Acc: 0.7990
val Loss: 1.3991 Acc: 0.7500
Epoch 16/84
----------
train Loss: 1.5011 Acc: 0.7943
[32m[I 2025-06-29 05:38:57,743][0m Trial 132 finished with value: 0.8636363636363636 and parameters: {'batch_size': 74, 'lr': 0.00046174407692610165, 'num_epochs': 84, 'weight_decay': 0.03176907574517823, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6734 Acc: 0.7727
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_74_lr_0.00046174407692610165_epoch_84_wd_0.03176907574517823_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/79
----------
train Loss: 3.4306 Acc: 0.3493
val Loss: 3.0271 Acc: 0.6136
Epoch 2/79
----------
train Loss: 2.6790 Acc: 0.5263
val Loss: 2.1022 Acc: 0.6364
Epoch 3/79
----------
train Loss: 2.3100 Acc: 0.5072
val Loss: 1.8721 Acc: 0.6364
Epoch 4/79
----------
train Loss: 2.1963 Acc: 0.5120
val Loss: 1.7957 Acc: 0.7045
Epoch 5/79
----------
train Loss: 2.1233 Acc: 0.6316
val Loss: 1.7032 Acc: 0.7500
Epoch 6/79
----------
train Loss: 1.9379 Acc: 0.6507
val Loss: 1.6112 Acc: 0.8182
Epoch 7/79
----------
train Loss: 1.7680 Acc: 0.7512
val Loss: 1.5122 Acc: 0.8182
Epoch 8/79
----------
train Loss: 1.8334 Acc: 0.7368
val Loss: 1.3671 Acc: 0.7955
Epoch 9/79
----------
train Loss: 1.8153 Acc: 0.7368
val Loss: 1.5015 Acc: 0.7500
Epoch 10/79
----------
train Loss: 1.1835 Acc: 0.9426
val Loss: 1.3825 Acc: 0.7955
Epoch 11/79
----------
train Loss: 1.6981 Acc: 0.7847
val Loss: 1.2143 Acc: 0.8864
Epoch 12/79
----------
train Loss: 1.5238 Acc: 0.7464
val Loss: 1.4993 Acc: 0.8182
Epoch 13/79
----------
train Loss: 1.3377 Acc: 0.8900
val Loss: 1.4477 Acc: 0.7500
Epoch 14/79
----------
train Loss: 1.2570 Acc: 0.8373
val Loss: 1.3994 Acc: 0.7273
Epoch 15/79
----------
train Loss: 1.3964 Acc: 0.8230
val Loss: 1.1850 Acc: 0.7955
Epoch 16/79
----------
train Loss: 1.4825 Acc: 0.8038
[32m[I 2025-06-29 05:42:36,284][0m Trial 133 finished with value: 0.8863636363636364 and parameters: {'batch_size': 92, 'lr': 0.000392572173529112, 'num_epochs': 79, 'weight_decay': 0.01311204127076424, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2832 Acc: 0.8182
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_92_lr_0.000392572173529112_epoch_79_wd_0.01311204127076424_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/80
----------
train Loss: 3.0119 Acc: 0.4115
val Loss: 2.0561 Acc: 0.6364
Epoch 2/80
----------
train Loss: 2.3837 Acc: 0.5407
val Loss: 2.0447 Acc: 0.6364
Epoch 3/80
----------
train Loss: 2.0849 Acc: 0.6364
val Loss: 2.1358 Acc: 0.6818
Epoch 4/80
----------
train Loss: 2.0061 Acc: 0.6364
val Loss: 2.1644 Acc: 0.7273
Epoch 5/80
----------
train Loss: 1.8000 Acc: 0.7751
val Loss: 1.6367 Acc: 0.7955
Epoch 6/80
----------
train Loss: 1.7560 Acc: 0.7512
val Loss: 2.1625 Acc: 0.7500
Epoch 7/80
----------
train Loss: 1.5691 Acc: 0.8182
val Loss: 1.9735 Acc: 0.6818
Epoch 8/80
----------
train Loss: 1.7534 Acc: 0.7416
val Loss: 1.9497 Acc: 0.7500
Epoch 9/80
----------
train Loss: 1.7727 Acc: 0.7656
val Loss: 2.4770 Acc: 0.7500
Epoch 10/80
----------
train Loss: 1.1605 Acc: 0.9330
val Loss: 1.5306 Acc: 0.7955
Epoch 11/80
----------
train Loss: 1.8612 Acc: 0.7560
val Loss: 1.6912 Acc: 0.6818
Epoch 12/80
----------
train Loss: 1.6341 Acc: 0.7416
val Loss: 1.9630 Acc: 0.7273
Epoch 13/80
----------
train Loss: 1.5886 Acc: 0.8325
val Loss: 2.3343 Acc: 0.6364
Epoch 14/80
----------
train Loss: 1.4051 Acc: 0.8182
val Loss: 2.0213 Acc: 0.7500
Epoch 15/80
----------
train Loss: 1.6036 Acc: 0.8182
val Loss: 3.1368 Acc: 0.6591
Epoch 16/80
----------
train Loss: 1.7050 Acc: 0.7560
val Loss: 3.4483 Acc: 0.2727
Epoch 17/80
----------
train Loss: 1.5283 Acc: 0.8038
val Loss: 1.7358 Acc: 0.6136
Epoch 18/80
----------
train Loss: 1.4668 Acc: 0.7990
val Loss: 1.4485 Acc: 0.7273
Epoch 19/80
----------
train Loss: 1.2927 Acc: 0.9187
val Loss: 1.3883 Acc: 0.7955
Epoch 20/80
----------
train Loss: 1.4835 Acc: 0.8469
val Loss: 1.6955 Acc: 0.7727
Epoch 21/80
----------
train Loss: 1.5818 Acc: 0.8612
val Loss: 1.9456 Acc: 0.7045
Epoch 22/80
----------
train Loss: 1.3995 Acc: 0.8325
val Loss: 1.6332 Acc: 0.6591
Epoch 23/80
----------
train Loss: 1.5771 Acc: 0.8756
val Loss: 1.8486 Acc: 0.6364
Epoch 24/80
----------
train Loss: 1.2094 Acc: 0.8708
val Loss: 2.4188 Acc: 0.7045
Epoch 25/80
----------
train Loss: 1.3785 Acc: 0.9426
[32m[I 2025-06-29 05:48:18,906][0m Trial 134 finished with value: 0.7727272727272727 and parameters: {'batch_size': 91, 'lr': 0.001059410878435807, 'num_epochs': 80, 'weight_decay': 0.013148073223088171, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 2.8777 Acc: 0.5682
Early stopping at epoch 25 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_91_lr_0.001059410878435807_epoch_80_wd_0.013148073223088171_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/65
----------
train Loss: 3.7725 Acc: 0.2297
val Loss: 3.6092 Acc: 0.2955
Epoch 2/65
----------
train Loss: 3.5905 Acc: 0.3110
val Loss: 3.4756 Acc: 0.2955
Epoch 3/65
----------
train Loss: 3.4233 Acc: 0.3732
val Loss: 3.2759 Acc: 0.4318
Epoch 4/65
----------
train Loss: 3.3051 Acc: 0.3876
val Loss: 3.1412 Acc: 0.4545
Epoch 5/65
----------
train Loss: 3.1944 Acc: 0.4306
val Loss: 3.0288 Acc: 0.5455
Epoch 6/65
----------
train Loss: 3.0493 Acc: 0.4928
val Loss: 2.8828 Acc: 0.5909
Epoch 7/65
----------
train Loss: 2.9122 Acc: 0.5311
val Loss: 2.7217 Acc: 0.6364
Epoch 8/65
----------
train Loss: 2.8260 Acc: 0.5120
val Loss: 2.5891 Acc: 0.6364
Epoch 9/65
----------
train Loss: 2.7279 Acc: 0.5263
val Loss: 2.4525 Acc: 0.6364
Epoch 10/65
----------
train Loss: 2.5213 Acc: 0.5215
val Loss: 2.3371 Acc: 0.6364
Epoch 11/65
----------
train Loss: 2.5456 Acc: 0.5167
val Loss: 2.2655 Acc: 0.6591
Epoch 12/65
----------
train Loss: 2.5188 Acc: 0.5215
val Loss: 2.2191 Acc: 0.6591
Epoch 13/65
----------
train Loss: 2.3528 Acc: 0.5359
val Loss: 2.1225 Acc: 0.6591
Epoch 14/65
----------
train Loss: 2.2664 Acc: 0.5359
val Loss: 2.0851 Acc: 0.6818
Epoch 15/65
----------
train Loss: 2.3099 Acc: 0.5407
val Loss: 2.0420 Acc: 0.6818
Epoch 16/65
----------
train Loss: 2.2619 Acc: 0.5550
val Loss: 1.9874 Acc: 0.6818
Epoch 17/65
----------
train Loss: 2.1947 Acc: 0.5550
val Loss: 1.9385 Acc: 0.6818
Epoch 18/65
----------
train Loss: 2.1245 Acc: 0.5789
val Loss: 1.8901 Acc: 0.6818
Epoch 19/65
----------
train Loss: 2.0729 Acc: 0.5981
val Loss: 1.8669 Acc: 0.6818
Epoch 20/65
----------
train Loss: 2.0811 Acc: 0.5598
val Loss: 1.8216 Acc: 0.6818
Epoch 21/65
----------
train Loss: 2.0924 Acc: 0.5742
val Loss: 1.7956 Acc: 0.6818
Epoch 22/65
----------
train Loss: 2.0565 Acc: 0.6077
val Loss: 1.7638 Acc: 0.6818
Epoch 23/65
----------
train Loss: 2.0158 Acc: 0.6172
val Loss: 1.7202 Acc: 0.6818
Epoch 24/65
----------
train Loss: 1.8368 Acc: 0.6699
val Loss: 1.6650 Acc: 0.7045
Epoch 25/65
----------
train Loss: 1.9552 Acc: 0.6411
val Loss: 1.6699 Acc: 0.7273
Epoch 26/65
----------
train Loss: 1.9712 Acc: 0.6507
val Loss: 1.6747 Acc: 0.7500
Epoch 27/65
----------
train Loss: 1.7682 Acc: 0.7321
val Loss: 1.6527 Acc: 0.7727
Epoch 28/65
----------
train Loss: 1.9481 Acc: 0.6411
val Loss: 1.6324 Acc: 0.7727
Epoch 29/65
----------
train Loss: 1.9923 Acc: 0.6316
val Loss: 1.6138 Acc: 0.7955
Epoch 30/65
----------
train Loss: 1.8615 Acc: 0.6651
val Loss: 1.6144 Acc: 0.7727
Epoch 31/65
----------
train Loss: 1.6937 Acc: 0.7847
val Loss: 1.5761 Acc: 0.7955
Epoch 32/65
----------
train Loss: 1.8147 Acc: 0.6890
val Loss: 1.5365 Acc: 0.7955
Epoch 33/65
----------
train Loss: 1.8381 Acc: 0.7416
val Loss: 1.5310 Acc: 0.7955
Epoch 34/65
----------
train Loss: 1.7489 Acc: 0.7799
val Loss: 1.5148 Acc: 0.7955
Epoch 35/65
----------
train Loss: 1.5103 Acc: 0.8612
val Loss: 1.4939 Acc: 0.7727
Epoch 36/65
----------
train Loss: 1.9051 Acc: 0.7081
val Loss: 1.4672 Acc: 0.7500
Epoch 37/65
----------
train Loss: 1.6268 Acc: 0.7656
val Loss: 1.4734 Acc: 0.7727
Epoch 38/65
----------
train Loss: 1.6512 Acc: 0.8469
val Loss: 1.4516 Acc: 0.7955
Epoch 39/65
----------
train Loss: 1.7694 Acc: 0.6938
val Loss: 1.4989 Acc: 0.7955
Epoch 40/65
----------
train Loss: 1.4904 Acc: 0.8134
val Loss: 1.5027 Acc: 0.7955
Epoch 41/65
----------
train Loss: 1.8686 Acc: 0.7129
val Loss: 1.4721 Acc: 0.7955
Epoch 42/65
----------
train Loss: 1.5237 Acc: 0.7847
val Loss: 1.4379 Acc: 0.7955
Epoch 43/65
----------
train Loss: 1.6285 Acc: 0.8038
val Loss: 1.4247 Acc: 0.7955
Epoch 44/65
----------
train Loss: 1.4561 Acc: 0.8325
val Loss: 1.3941 Acc: 0.8182
Epoch 45/65
----------
train Loss: 1.0429 Acc: 0.9617
val Loss: 1.3633 Acc: 0.8409
Epoch 46/65
----------
train Loss: 1.8016 Acc: 0.7847
val Loss: 1.3771 Acc: 0.8182
Epoch 47/65
----------
train Loss: 1.4394 Acc: 0.8517
val Loss: 1.3611 Acc: 0.8409
Epoch 48/65
----------
train Loss: 1.5146 Acc: 0.8134
val Loss: 1.3535 Acc: 0.8182
Epoch 49/65
----------
train Loss: 1.4655 Acc: 0.8852
val Loss: 1.3503 Acc: 0.8182
Epoch 50/65
----------
train Loss: 1.4482 Acc: 0.8421
val Loss: 1.3806 Acc: 0.7955
Epoch 51/65
----------
train Loss: 1.1101 Acc: 0.9713
val Loss: 1.3422 Acc: 0.7955
Epoch 52/65
----------
train Loss: 1.5074 Acc: 0.7703
val Loss: 1.3410 Acc: 0.8182
Epoch 53/65
----------
train Loss: 1.6585 Acc: 0.8660
val Loss: 1.3374 Acc: 0.8182
Epoch 54/65
----------
train Loss: 1.2823 Acc: 0.9043
val Loss: 1.3152 Acc: 0.8409
Epoch 55/65
----------
train Loss: 1.3386 Acc: 0.9187
val Loss: 1.2931 Acc: 0.8409
Epoch 56/65
----------
train Loss: 1.5038 Acc: 0.8612
val Loss: 1.3018 Acc: 0.8409
Epoch 57/65
----------
train Loss: 1.6920 Acc: 0.7751
val Loss: 1.2809 Acc: 0.8182
Epoch 58/65
----------
train Loss: 1.4285 Acc: 0.8038
val Loss: 1.2816 Acc: 0.8409
Epoch 59/65
----------
train Loss: 1.4665 Acc: 0.8469
val Loss: 1.2864 Acc: 0.8182
Epoch 60/65
----------
train Loss: 1.2147 Acc: 0.8612
val Loss: 1.2977 Acc: 0.8409
Epoch 61/65
----------
train Loss: 1.6567 Acc: 0.7273
val Loss: 1.3066 Acc: 0.8182
Epoch 62/65
----------
train Loss: 1.4757 Acc: 0.9139
val Loss: 1.2999 Acc: 0.8409
Epoch 63/65
----------
train Loss: 1.2946 Acc: 0.9091
val Loss: 1.3038 Acc: 0.8409
Epoch 64/65
----------
train Loss: 1.2064 Acc: 0.9282
val Loss: 1.2994 Acc: 0.7955
Epoch 65/65
----------
train Loss: 1.4025 Acc: 0.7990
[32m[I 2025-06-29 06:03:05,589][0m Trial 135 finished with value: 0.8181818181818182 and parameters: {'batch_size': 101, 'lr': 5.38751705023021e-05, 'num_epochs': 65, 'weight_decay': 0.008133460477846239, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3179 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_101_lr_5.38751705023021e-05_epoch_65_wd_0.008133460477846239_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.4389 Acc: 0.3493
val Loss: 3.0329 Acc: 0.6136
Epoch 2/78
----------
train Loss: 2.6907 Acc: 0.5311
val Loss: 2.1035 Acc: 0.6364
Epoch 3/78
----------
train Loss: 2.3140 Acc: 0.5072
val Loss: 1.8640 Acc: 0.6591
Epoch 4/78
----------
train Loss: 2.1977 Acc: 0.5072
val Loss: 1.7752 Acc: 0.7045
Epoch 5/78
----------
train Loss: 2.1249 Acc: 0.6316
val Loss: 1.6815 Acc: 0.7500
Epoch 6/78
----------
train Loss: 1.9383 Acc: 0.6555
val Loss: 1.5850 Acc: 0.8182
Epoch 7/78
----------
train Loss: 1.7695 Acc: 0.7512
val Loss: 1.4875 Acc: 0.7955
Epoch 8/78
----------
train Loss: 1.8376 Acc: 0.7321
val Loss: 1.3554 Acc: 0.7727
Epoch 9/78
----------
train Loss: 1.8214 Acc: 0.7464
val Loss: 1.4879 Acc: 0.7500
Epoch 10/78
----------
train Loss: 1.1883 Acc: 0.9378
val Loss: 1.3967 Acc: 0.8409
Epoch 11/78
----------
train Loss: 1.6927 Acc: 0.7799
val Loss: 1.2083 Acc: 0.8864
Epoch 12/78
----------
train Loss: 1.5211 Acc: 0.7464
val Loss: 1.4435 Acc: 0.8409
Epoch 13/78
----------
train Loss: 1.3369 Acc: 0.8947
val Loss: 1.4277 Acc: 0.7727
Epoch 14/78
----------
train Loss: 1.2613 Acc: 0.8325
val Loss: 1.3904 Acc: 0.7273
Epoch 15/78
----------
train Loss: 1.3954 Acc: 0.8325
val Loss: 1.1904 Acc: 0.7955
Epoch 16/78
----------
train Loss: 1.4821 Acc: 0.7990
val Loss: 1.2708 Acc: 0.8409
Epoch 17/78
----------
train Loss: 1.4131 Acc: 0.8565
val Loss: 1.3990 Acc: 0.8409
Epoch 18/78
----------
train Loss: 1.3043 Acc: 0.8325
val Loss: 1.2530 Acc: 0.7727
Epoch 19/78
----------
train Loss: 1.2055 Acc: 0.9378
val Loss: 1.2463 Acc: 0.7955
Epoch 20/78
----------
train Loss: 1.3020 Acc: 0.8756
val Loss: 1.2512 Acc: 0.7955
Epoch 21/78
----------
train Loss: 1.4069 Acc: 0.9043
val Loss: 1.3147 Acc: 0.7273
Epoch 22/78
----------
train Loss: 1.2622 Acc: 0.8900
val Loss: 1.1965 Acc: 0.8409
Epoch 23/78
----------
train Loss: 1.4729 Acc: 0.8708
val Loss: 1.1736 Acc: 0.8182
Epoch 24/78
----------
train Loss: 1.0797 Acc: 0.9139
val Loss: 1.1139 Acc: 0.8636
Epoch 25/78
----------
train Loss: 1.2282 Acc: 0.9474
val Loss: 1.2373 Acc: 0.8409
Epoch 26/78
----------
train Loss: 1.4721 Acc: 0.9474
val Loss: 1.2191 Acc: 0.8182
Epoch 27/78
----------
train Loss: 1.1720 Acc: 0.9617
val Loss: 1.2989 Acc: 0.7955
Epoch 28/78
----------
train Loss: 1.3491 Acc: 0.8612
val Loss: 1.1606 Acc: 0.7727
Epoch 29/78
----------
train Loss: 1.4927 Acc: 0.8134
val Loss: 1.1311 Acc: 0.8636
Epoch 30/78
----------
train Loss: 1.2515 Acc: 0.8900
val Loss: 1.0379 Acc: 0.8409
Epoch 31/78
----------
train Loss: 1.1282 Acc: 0.9474
val Loss: 1.0267 Acc: 0.8409
Epoch 32/78
----------
train Loss: 1.2156 Acc: 0.9091
val Loss: 1.1474 Acc: 0.8182
Epoch 33/78
----------
train Loss: 1.3776 Acc: 0.8947
val Loss: 1.2472 Acc: 0.7955
Epoch 34/78
----------
train Loss: 1.2899 Acc: 0.9522
val Loss: 1.3288 Acc: 0.7500
Epoch 35/78
----------
train Loss: 1.0081 Acc: 0.9761
val Loss: 1.3480 Acc: 0.7955
Epoch 36/78
----------
train Loss: 1.5362 Acc: 0.8660
val Loss: 1.2534 Acc: 0.8182
Epoch 37/78
----------
train Loss: 1.3067 Acc: 0.8373
val Loss: 1.4658 Acc: 0.7727
Epoch 38/78
----------
train Loss: 1.3647 Acc: 0.9522
val Loss: 1.2810 Acc: 0.7955
Epoch 39/78
----------
train Loss: 1.3402 Acc: 0.7847
val Loss: 1.3726 Acc: 0.7727
Epoch 40/78
----------
train Loss: 1.1638 Acc: 0.9234
val Loss: 1.3014 Acc: 0.7727
Epoch 41/78
----------
train Loss: 1.6038 Acc: 0.7033
val Loss: 1.2453 Acc: 0.7727
Epoch 42/78
----------
train Loss: 1.2029 Acc: 0.8708
val Loss: 1.3901 Acc: 0.7500
Epoch 43/78
----------
train Loss: 1.2990 Acc: 0.8660
val Loss: 1.2174 Acc: 0.8182
Epoch 44/78
----------
train Loss: 1.1827 Acc: 0.8995
val Loss: 1.3374 Acc: 0.7955
Epoch 45/78
----------
train Loss: 0.8013 Acc: 0.9617
val Loss: 1.1943 Acc: 0.7500
Epoch 46/78
----------
train Loss: 1.6557 Acc: 0.8182
val Loss: 1.3788 Acc: 0.7727
Epoch 47/78
----------
train Loss: 1.2149 Acc: 0.9043
val Loss: 1.7495 Acc: 0.7727
Epoch 48/78
----------
train Loss: 1.3372 Acc: 0.8325
val Loss: 1.9047 Acc: 0.7045
Epoch 49/78
----------
train Loss: 1.3267 Acc: 0.9330
val Loss: 1.2884 Acc: 0.8409
Epoch 50/78
----------
train Loss: 1.2480 Acc: 0.8660
val Loss: 1.2577 Acc: 0.8182
Epoch 51/78
----------
train Loss: 0.9535 Acc: 0.9856
val Loss: 1.1927 Acc: 0.7955
Epoch 52/78
----------
train Loss: 1.2958 Acc: 0.8278
val Loss: 1.0686 Acc: 0.7955
Epoch 53/78
----------
train Loss: 1.4945 Acc: 0.9091
val Loss: 1.2757 Acc: 0.7273
Epoch 54/78
----------
train Loss: 1.1870 Acc: 0.9378
val Loss: 1.4357 Acc: 0.7727
Epoch 55/78
----------
train Loss: 1.2106 Acc: 0.9522
val Loss: 1.5425 Acc: 0.7727
Epoch 56/78
----------
train Loss: 1.3767 Acc: 0.9282
val Loss: 1.3534 Acc: 0.7727
Epoch 57/78
----------
train Loss: 1.5175 Acc: 0.8278
val Loss: 1.3940 Acc: 0.8182
Epoch 58/78
----------
train Loss: 1.2515 Acc: 0.8134
val Loss: 1.2847 Acc: 0.7727
Epoch 59/78
----------
train Loss: 1.2998 Acc: 0.9139
val Loss: 1.5151 Acc: 0.7045
Epoch 60/78
----------
train Loss: 1.0853 Acc: 0.8995
val Loss: 1.6578 Acc: 0.6591
Epoch 61/78
----------
train Loss: 1.4729 Acc: 0.8134
val Loss: 1.5624 Acc: 0.6818
Epoch 62/78
----------
train Loss: 1.4065 Acc: 0.9282
val Loss: 1.6109 Acc: 0.6818
Epoch 63/78
----------
train Loss: 1.2480 Acc: 0.9234
[32m[I 2025-06-29 06:17:25,255][0m Trial 136 finished with value: 0.7727272727272727 and parameters: {'batch_size': 98, 'lr': 0.00037913232009139167, 'num_epochs': 78, 'weight_decay': 0.01161903569409276, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.7419 Acc: 0.6818
Early stopping at epoch 63 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_98_lr_0.00037913232009139167_epoch_78_wd_0.01161903569409276_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/85
----------
train Loss: 3.2990 Acc: 0.3780
val Loss: 2.5828 Acc: 0.6364
Epoch 2/85
----------
train Loss: 2.4636 Acc: 0.5407
val Loss: 1.9542 Acc: 0.6364
Epoch 3/85
----------
train Loss: 2.1790 Acc: 0.5359
val Loss: 1.7357 Acc: 0.6818
Epoch 4/85
----------
train Loss: 2.0726 Acc: 0.5742
val Loss: 1.6414 Acc: 0.7727
Epoch 5/85
----------
train Loss: 1.9730 Acc: 0.7321
val Loss: 1.4758 Acc: 0.7955
Epoch 6/85
----------
train Loss: 1.8043 Acc: 0.7033
val Loss: 1.3611 Acc: 0.8182
Epoch 7/85
----------
train Loss: 1.5180 Acc: 0.8612
val Loss: 1.2336 Acc: 0.8182
Epoch 8/85
----------
train Loss: 1.6939 Acc: 0.7703
val Loss: 1.2633 Acc: 0.8182
Epoch 9/85
----------
train Loss: 1.6799 Acc: 0.7799
val Loss: 1.4285 Acc: 0.7955
Epoch 10/85
----------
train Loss: 1.0245 Acc: 0.9330
val Loss: 1.1716 Acc: 0.8182
Epoch 11/85
----------
train Loss: 1.7404 Acc: 0.7799
val Loss: 1.2579 Acc: 0.7955
Epoch 12/85
----------
train Loss: 1.4720 Acc: 0.7608
val Loss: 1.7289 Acc: 0.7500
Epoch 13/85
----------
train Loss: 1.3455 Acc: 0.8900
val Loss: 1.4863 Acc: 0.7727
Epoch 14/85
----------
train Loss: 1.2196 Acc: 0.8278
val Loss: 1.4386 Acc: 0.7500
Epoch 15/85
----------
train Loss: 1.4015 Acc: 0.8325
val Loss: 1.2566 Acc: 0.8409
Epoch 16/85
----------
train Loss: 1.3916 Acc: 0.8182
val Loss: 1.4423 Acc: 0.8182
Epoch 17/85
----------
train Loss: 1.3909 Acc: 0.8469
val Loss: 1.3940 Acc: 0.8182
Epoch 18/85
----------
train Loss: 1.3182 Acc: 0.8325
val Loss: 1.2433 Acc: 0.7955
Epoch 19/85
----------
train Loss: 1.2134 Acc: 0.9474
val Loss: 1.1102 Acc: 0.7727
Epoch 20/85
----------
train Loss: 1.2948 Acc: 0.8804
val Loss: 1.0915 Acc: 0.8409
Epoch 21/85
----------
train Loss: 1.4066 Acc: 0.8995
val Loss: 1.0202 Acc: 0.9091
Epoch 22/85
----------
train Loss: 1.2575 Acc: 0.8756
val Loss: 1.1562 Acc: 0.8409
Epoch 23/85
----------
train Loss: 1.4779 Acc: 0.8852
val Loss: 1.2716 Acc: 0.8182
Epoch 24/85
----------
train Loss: 1.0713 Acc: 0.9282
val Loss: 1.2302 Acc: 0.8636
Epoch 25/85
----------
train Loss: 1.2296 Acc: 0.9378
val Loss: 1.3163 Acc: 0.8409
Epoch 26/85
----------
train Loss: 1.4169 Acc: 0.9426
val Loss: 1.2096 Acc: 0.8182
Epoch 27/85
----------
train Loss: 1.1540 Acc: 0.9761
val Loss: 1.3262 Acc: 0.7955
Epoch 28/85
----------
train Loss: 1.3501 Acc: 0.8517
val Loss: 1.1675 Acc: 0.8864
Epoch 29/85
----------
train Loss: 1.4321 Acc: 0.8182
val Loss: 1.2739 Acc: 0.8409
Epoch 30/85
----------
train Loss: 1.2394 Acc: 0.8947
val Loss: 1.2609 Acc: 0.7500
Epoch 31/85
----------
train Loss: 1.1049 Acc: 0.9330
val Loss: 1.2235 Acc: 0.7500
Epoch 32/85
----------
train Loss: 1.1780 Acc: 0.9091
val Loss: 1.2377 Acc: 0.7955
Epoch 33/85
----------
train Loss: 1.3360 Acc: 0.8756
val Loss: 1.3748 Acc: 0.7500
Epoch 34/85
----------
train Loss: 1.2658 Acc: 0.9378
val Loss: 1.4277 Acc: 0.7727
Epoch 35/85
----------
train Loss: 0.9794 Acc: 0.9713
val Loss: 1.3942 Acc: 0.7500
Epoch 36/85
----------
train Loss: 1.5282 Acc: 0.8612
val Loss: 1.3678 Acc: 0.7273
Epoch 37/85
----------
train Loss: 1.3116 Acc: 0.8278
val Loss: 1.3750 Acc: 0.7955
Epoch 38/85
----------
train Loss: 1.3551 Acc: 0.9474
val Loss: 1.2555 Acc: 0.7273
Epoch 39/85
----------
train Loss: 1.3090 Acc: 0.8086
val Loss: 1.3038 Acc: 0.7727
Epoch 40/85
----------
train Loss: 1.1570 Acc: 0.9282
val Loss: 1.2904 Acc: 0.7273
Epoch 41/85
----------
train Loss: 1.5665 Acc: 0.7129
val Loss: 1.1715 Acc: 0.7955
Epoch 42/85
----------
train Loss: 1.1279 Acc: 0.8756
val Loss: 1.2895 Acc: 0.7955
Epoch 43/85
----------
train Loss: 1.2710 Acc: 0.8756
val Loss: 1.2305 Acc: 0.8182
Epoch 44/85
----------
train Loss: 1.1887 Acc: 0.8708
val Loss: 1.6655 Acc: 0.7273
Epoch 45/85
----------
train Loss: 0.8112 Acc: 0.9665
val Loss: 1.2809 Acc: 0.7955
Epoch 46/85
----------
train Loss: 1.6512 Acc: 0.8134
val Loss: 1.4443 Acc: 0.7500
Epoch 47/85
----------
train Loss: 1.2341 Acc: 0.8947
val Loss: 1.5785 Acc: 0.6591
Epoch 48/85
----------
train Loss: 1.3116 Acc: 0.8565
val Loss: 1.3378 Acc: 0.7727
Epoch 49/85
----------
train Loss: 1.2581 Acc: 0.9522
val Loss: 1.2701 Acc: 0.8182
Epoch 50/85
----------
train Loss: 1.2504 Acc: 0.8756
val Loss: 1.2750 Acc: 0.8182
Epoch 51/85
----------
train Loss: 0.9546 Acc: 0.9809
val Loss: 1.3636 Acc: 0.7955
Epoch 52/85
----------
train Loss: 1.2809 Acc: 0.7895
val Loss: 1.1457 Acc: 0.7727
Epoch 53/85
----------
train Loss: 1.4662 Acc: 0.8900
val Loss: 1.3714 Acc: 0.7045
Epoch 54/85
----------
train Loss: 1.1624 Acc: 0.9187
val Loss: 1.4172 Acc: 0.7727
Epoch 55/85
----------
train Loss: 1.1870 Acc: 0.9569
val Loss: 1.5053 Acc: 0.7273
Epoch 56/85
----------
train Loss: 1.3667 Acc: 0.9330
val Loss: 1.4435 Acc: 0.7273
Epoch 57/85
----------
train Loss: 1.4830 Acc: 0.8517
val Loss: 1.5168 Acc: 0.7500
Epoch 58/85
----------
train Loss: 1.2062 Acc: 0.8373
val Loss: 1.6211 Acc: 0.7045
Epoch 59/85
----------
train Loss: 1.2826 Acc: 0.8995
val Loss: 1.5821 Acc: 0.6818
Epoch 60/85
----------
train Loss: 1.0225 Acc: 0.9139
val Loss: 1.5788 Acc: 0.7273
Epoch 61/85
----------
train Loss: 1.4505 Acc: 0.8086
val Loss: 1.5490 Acc: 0.7500
Epoch 62/85
----------
train Loss: 1.3966 Acc: 0.9522
val Loss: 1.6051 Acc: 0.7045
Epoch 63/85
----------
train Loss: 1.2324 Acc: 0.9378
val Loss: 1.5472 Acc: 0.7273
Epoch 64/85
----------
train Loss: 1.0791 Acc: 0.9809
val Loss: 1.5709 Acc: 0.6591
Epoch 65/85
----------
train Loss: 1.2255 Acc: 0.9043
val Loss: 1.4944 Acc: 0.7273
Epoch 66/85
----------
train Loss: 1.2323 Acc: 0.9043
val Loss: 2.0858 Acc: 0.6591
Epoch 67/85
----------
train Loss: 1.3877 Acc: 0.8708
val Loss: 1.6135 Acc: 0.7500
Epoch 68/85
----------
train Loss: 1.1718 Acc: 0.8852
val Loss: 1.5694 Acc: 0.7273
Epoch 69/85
----------
train Loss: 1.1003 Acc: 0.8804
val Loss: 1.3907 Acc: 0.7955
Epoch 70/85
----------
train Loss: 1.3073 Acc: 0.8900
val Loss: 1.4260 Acc: 0.7955
Epoch 71/85
----------
train Loss: 1.3783 Acc: 0.8804
val Loss: 1.4066 Acc: 0.7955
Epoch 72/85
----------
train Loss: 1.3817 Acc: 0.8708
val Loss: 1.5351 Acc: 0.7955
Epoch 73/85
----------
train Loss: 0.9804 Acc: 0.9665
val Loss: 1.5005 Acc: 0.7500
Epoch 74/85
----------
train Loss: 1.3891 Acc: 0.8421
val Loss: 1.5472 Acc: 0.7273
Epoch 75/85
----------
train Loss: 1.0954 Acc: 0.9713
val Loss: 1.6112 Acc: 0.7955
Epoch 76/85
----------
train Loss: 1.0929 Acc: 0.8660
val Loss: 1.3683 Acc: 0.7273
Epoch 77/85
----------
train Loss: 1.3043 Acc: 0.8756
val Loss: 1.3645 Acc: 0.7727
Epoch 78/85
----------
train Loss: 1.2107 Acc: 0.9043
val Loss: 1.4463 Acc: 0.7273
Epoch 79/85
----------
train Loss: 1.3645 Acc: 0.8852
val Loss: 1.3329 Acc: 0.7727
Epoch 80/85
----------
train Loss: 1.2652 Acc: 0.8325
val Loss: 1.4627 Acc: 0.6818
Epoch 81/85
----------
train Loss: 1.4464 Acc: 0.7990
val Loss: 1.5940 Acc: 0.6591
Epoch 82/85
----------
train Loss: 1.2258 Acc: 0.8804
val Loss: 1.4166 Acc: 0.7045
Epoch 83/85
----------
train Loss: 1.1277 Acc: 0.9617
val Loss: 1.3506 Acc: 0.7727
Epoch 84/85
----------
train Loss: 1.4385 Acc: 0.7895
val Loss: 1.5313 Acc: 0.7045
Epoch 85/85
----------
train Loss: 1.0590 Acc: 0.8852
[32m[I 2025-06-29 06:36:44,626][0m Trial 137 finished with value: 0.7727272727272727 and parameters: {'batch_size': 73, 'lr': 0.0005216540841586904, 'num_epochs': 85, 'weight_decay': 0.005212382960624266, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6475 Acc: 0.6591
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_73_lr_0.0005216540841586904_epoch_85_wd_0.005212382960624266_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/73
----------
train Loss: 3.5162 Acc: 0.3301
val Loss: 3.1640 Acc: 0.6136
Epoch 2/73
----------
train Loss: 2.8466 Acc: 0.5263
val Loss: 2.2843 Acc: 0.6364
Epoch 3/73
----------
train Loss: 2.4202 Acc: 0.5263
val Loss: 1.9052 Acc: 0.6364
Epoch 4/73
----------
train Loss: 2.2582 Acc: 0.5072
val Loss: 1.8019 Acc: 0.6818
Epoch 5/73
----------
train Loss: 2.1822 Acc: 0.5837
val Loss: 1.7041 Acc: 0.6818
Epoch 6/73
----------
train Loss: 2.0071 Acc: 0.6220
val Loss: 1.5930 Acc: 0.7500
Epoch 7/73
----------
train Loss: 1.8638 Acc: 0.6746
val Loss: 1.5287 Acc: 0.7500
Epoch 8/73
----------
train Loss: 1.9341 Acc: 0.6986
val Loss: 1.4169 Acc: 0.7727
Epoch 9/73
----------
train Loss: 1.8536 Acc: 0.7512
val Loss: 1.4380 Acc: 0.7727
Epoch 10/73
----------
train Loss: 1.2758 Acc: 0.9282
val Loss: 1.3481 Acc: 0.7727
Epoch 11/73
----------
train Loss: 1.6966 Acc: 0.7703
val Loss: 1.2725 Acc: 0.8182
Epoch 12/73
----------
train Loss: 1.6043 Acc: 0.7129
val Loss: 1.3788 Acc: 0.8636
Epoch 13/73
----------
train Loss: 1.3868 Acc: 0.8947
val Loss: 1.3134 Acc: 0.7955
Epoch 14/73
----------
train Loss: 1.2832 Acc: 0.8230
val Loss: 1.3822 Acc: 0.7273
Epoch 15/73
----------
train Loss: 1.4219 Acc: 0.8086
val Loss: 1.2484 Acc: 0.7273
Epoch 16/73
----------
train Loss: 1.4974 Acc: 0.7895
val Loss: 1.2260 Acc: 0.8409
Epoch 17/73
----------
train Loss: 1.3888 Acc: 0.8660
val Loss: 1.3816 Acc: 0.8636
Epoch 18/73
----------
train Loss: 1.3126 Acc: 0.8373
val Loss: 1.2412 Acc: 0.8182
Epoch 19/73
----------
train Loss: 1.2088 Acc: 0.9282
val Loss: 1.1663 Acc: 0.7955
Epoch 20/73
----------
train Loss: 1.3323 Acc: 0.8612
val Loss: 1.1375 Acc: 0.8182
Epoch 21/73
----------
train Loss: 1.4025 Acc: 0.8900
val Loss: 1.1318 Acc: 0.8182
Epoch 22/73
----------
train Loss: 1.2601 Acc: 0.8804
val Loss: 1.1534 Acc: 0.7955
Epoch 23/73
----------
train Loss: 1.4741 Acc: 0.8660
val Loss: 1.1251 Acc: 0.8409
Epoch 24/73
----------
train Loss: 1.0334 Acc: 0.9330
val Loss: 1.1019 Acc: 0.8182
Epoch 25/73
----------
train Loss: 1.2177 Acc: 0.9426
val Loss: 1.1885 Acc: 0.8182
Epoch 26/73
----------
train Loss: 1.4189 Acc: 0.9330
val Loss: 1.2280 Acc: 0.7955
Epoch 27/73
----------
train Loss: 1.1483 Acc: 0.9761
val Loss: 1.3160 Acc: 0.7727
Epoch 28/73
----------
train Loss: 1.3664 Acc: 0.8852
val Loss: 1.2319 Acc: 0.7500
Epoch 29/73
----------
train Loss: 1.4561 Acc: 0.7799
val Loss: 1.1444 Acc: 0.8409
Epoch 30/73
----------
train Loss: 1.2433 Acc: 0.8852
val Loss: 1.0920 Acc: 0.8182
Epoch 31/73
----------
train Loss: 1.1017 Acc: 0.9426
val Loss: 1.1097 Acc: 0.7727
Epoch 32/73
----------
train Loss: 1.2450 Acc: 0.8995
val Loss: 1.1354 Acc: 0.7727
Epoch 33/73
----------
train Loss: 1.3048 Acc: 0.8852
val Loss: 1.1846 Acc: 0.8182
Epoch 34/73
----------
train Loss: 1.2708 Acc: 0.9569
val Loss: 1.3141 Acc: 0.7273
Epoch 35/73
----------
train Loss: 0.9651 Acc: 0.9809
val Loss: 1.3762 Acc: 0.7273
Epoch 36/73
----------
train Loss: 1.5077 Acc: 0.8469
val Loss: 1.2517 Acc: 0.7727
Epoch 37/73
----------
train Loss: 1.2665 Acc: 0.8469
val Loss: 1.2961 Acc: 0.7727
Epoch 38/73
----------
train Loss: 1.3249 Acc: 0.9665
val Loss: 1.2358 Acc: 0.7955
Epoch 39/73
----------
train Loss: 1.3372 Acc: 0.7895
val Loss: 1.3465 Acc: 0.7500
Epoch 40/73
----------
train Loss: 1.1355 Acc: 0.9234
val Loss: 1.3988 Acc: 0.7273
Epoch 41/73
----------
train Loss: 1.5826 Acc: 0.6986
val Loss: 1.2695 Acc: 0.7500
Epoch 42/73
----------
train Loss: 1.1260 Acc: 0.8852
val Loss: 1.2116 Acc: 0.7500
Epoch 43/73
----------
train Loss: 1.3091 Acc: 0.8852
val Loss: 1.2005 Acc: 0.7727
Epoch 44/73
----------
train Loss: 1.1800 Acc: 0.9139
val Loss: 1.3147 Acc: 0.7955
Epoch 45/73
----------
train Loss: 0.7656 Acc: 0.9665
val Loss: 1.2397 Acc: 0.8182
Epoch 46/73
----------
train Loss: 1.5660 Acc: 0.8421
val Loss: 1.3603 Acc: 0.7727
Epoch 47/73
----------
train Loss: 1.1648 Acc: 0.9234
val Loss: 1.3698 Acc: 0.7955
Epoch 48/73
----------
train Loss: 1.3032 Acc: 0.8469
val Loss: 1.4065 Acc: 0.7727
Epoch 49/73
----------
train Loss: 1.2916 Acc: 0.9665
val Loss: 1.3604 Acc: 0.7727
Epoch 50/73
----------
train Loss: 1.2124 Acc: 0.9043
val Loss: 1.3450 Acc: 0.7500
Epoch 51/73
----------
train Loss: 0.9486 Acc: 0.9952
val Loss: 1.2210 Acc: 0.7727
Epoch 52/73
----------
train Loss: 1.2695 Acc: 0.8612
val Loss: 1.2284 Acc: 0.7955
Epoch 53/73
----------
train Loss: 1.4275 Acc: 0.9187
val Loss: 1.3383 Acc: 0.7273
Epoch 54/73
----------
train Loss: 1.1133 Acc: 0.9474
val Loss: 1.4586 Acc: 0.7045
Epoch 55/73
----------
train Loss: 1.1768 Acc: 0.9426
val Loss: 1.5998 Acc: 0.7045
Epoch 56/73
----------
train Loss: 1.3561 Acc: 0.9330
val Loss: 1.5029 Acc: 0.7273
Epoch 57/73
----------
train Loss: 1.4729 Acc: 0.8612
[32m[I 2025-06-29 06:49:43,281][0m Trial 138 finished with value: 0.7954545454545455 and parameters: {'batch_size': 83, 'lr': 0.0002850209814215392, 'num_epochs': 73, 'weight_decay': 0.006952560915689948, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4934 Acc: 0.7273
Early stopping at epoch 57 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_83_lr_0.0002850209814215392_epoch_73_wd_0.006952560915689948_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/52
----------
train Loss: 5.9018 Acc: 0.2057
val Loss: 4.9927 Acc: 0.3636
Epoch 2/52
----------
train Loss: 4.9386 Acc: 0.5167
val Loss: 4.6973 Acc: 0.5909
Epoch 3/52
----------
train Loss: 4.2335 Acc: 0.6842
val Loss: 4.4835 Acc: 0.5455
Epoch 4/52
----------
train Loss: 3.6173 Acc: 0.7703
val Loss: 4.2328 Acc: 0.5909
Epoch 5/52
----------
train Loss: 2.9579 Acc: 0.8469
val Loss: 4.0214 Acc: 0.6136
Epoch 6/52
----------
train Loss: 2.4525 Acc: 0.8804
val Loss: 3.7685 Acc: 0.6591
Epoch 7/52
----------
train Loss: 1.8865 Acc: 0.9187
val Loss: 3.4758 Acc: 0.6818
Epoch 8/52
----------
train Loss: 1.4377 Acc: 0.9569
val Loss: 3.2654 Acc: 0.7500
Epoch 9/52
----------
train Loss: 1.1581 Acc: 0.9665
val Loss: 3.1566 Acc: 0.7273
Epoch 10/52
----------
train Loss: 0.9093 Acc: 0.9761
val Loss: 2.9792 Acc: 0.7727
Epoch 11/52
----------
train Loss: 0.7128 Acc: 0.9904
val Loss: 2.8686 Acc: 0.7955
Epoch 12/52
----------
train Loss: 0.5416 Acc: 0.9761
val Loss: 2.8946 Acc: 0.7955
Epoch 13/52
----------
train Loss: 0.4893 Acc: 0.9809
val Loss: 2.9407 Acc: 0.8182
Epoch 14/52
----------
train Loss: 0.4454 Acc: 0.9856
val Loss: 2.9520 Acc: 0.8182
Epoch 15/52
----------
train Loss: 0.2870 Acc: 1.0000
val Loss: 2.8816 Acc: 0.7955
Epoch 16/52
----------
train Loss: 0.1839 Acc: 1.0000
val Loss: 2.8460 Acc: 0.8182
Epoch 17/52
----------
train Loss: 0.1691 Acc: 0.9904
val Loss: 2.8194 Acc: 0.8182
Epoch 18/52
----------
train Loss: 0.1400 Acc: 1.0000
val Loss: 2.7837 Acc: 0.8182
Epoch 19/52
----------
train Loss: 0.1765 Acc: 1.0000
val Loss: 2.7664 Acc: 0.7955
Epoch 20/52
----------
train Loss: 0.1834 Acc: 0.9952
val Loss: 2.8397 Acc: 0.8182
Epoch 21/52
----------
train Loss: 0.1574 Acc: 0.9952
val Loss: 2.8361 Acc: 0.7955
Epoch 22/52
----------
train Loss: 0.1445 Acc: 1.0000
val Loss: 3.1225 Acc: 0.7727
Epoch 23/52
----------
train Loss: 0.1043 Acc: 1.0000
val Loss: 3.3063 Acc: 0.7727
Epoch 24/52
----------
train Loss: 0.0899 Acc: 1.0000
val Loss: 3.2330 Acc: 0.7955
Epoch 25/52
----------
train Loss: 0.0845 Acc: 1.0000
val Loss: 3.1916 Acc: 0.8182
Epoch 26/52
----------
train Loss: 0.0810 Acc: 1.0000
val Loss: 3.2269 Acc: 0.8182
Epoch 27/52
----------
train Loss: 0.0684 Acc: 1.0000
val Loss: 3.2181 Acc: 0.8182
Epoch 28/52
----------
train Loss: 0.1060 Acc: 0.9904
val Loss: 3.2902 Acc: 0.8182
Epoch 29/52
----------
train Loss: 0.0709 Acc: 1.0000
val Loss: 3.0923 Acc: 0.8182
Epoch 30/52
----------
train Loss: 0.0435 Acc: 1.0000
val Loss: 2.9541 Acc: 0.7955
Epoch 31/52
----------
train Loss: 0.0906 Acc: 0.9904
val Loss: 3.0406 Acc: 0.7955
Epoch 32/52
----------
train Loss: 0.0459 Acc: 1.0000
val Loss: 3.0704 Acc: 0.7955
Epoch 33/52
----------
train Loss: 0.0986 Acc: 0.9952
val Loss: 3.0395 Acc: 0.8182
Epoch 34/52
----------
train Loss: 0.0684 Acc: 1.0000
val Loss: 2.8993 Acc: 0.7955
Epoch 35/52
----------
train Loss: 0.0471 Acc: 1.0000
val Loss: 2.9050 Acc: 0.7727
Epoch 36/52
----------
train Loss: 0.1101 Acc: 0.9952
val Loss: 3.0208 Acc: 0.7955
Epoch 37/52
----------
train Loss: 0.0709 Acc: 0.9952
val Loss: 3.3788 Acc: 0.7727
Epoch 38/52
----------
train Loss: 0.0928 Acc: 0.9952
val Loss: 3.4761 Acc: 0.7500
Epoch 39/52
----------
train Loss: 0.0399 Acc: 1.0000
val Loss: 3.5572 Acc: 0.7500
Epoch 40/52
----------
train Loss: 0.0647 Acc: 1.0000
val Loss: 3.5511 Acc: 0.7500
Epoch 41/52
----------
train Loss: 0.0557 Acc: 1.0000
val Loss: 3.4331 Acc: 0.7500
Epoch 42/52
----------
train Loss: 0.0462 Acc: 1.0000
val Loss: 3.3288 Acc: 0.7500
Epoch 43/52
----------
train Loss: 0.0492 Acc: 0.9952
val Loss: 3.2303 Acc: 0.7727
Epoch 44/52
----------
train Loss: 0.0394 Acc: 1.0000
val Loss: 3.1697 Acc: 0.7727
Epoch 45/52
----------
train Loss: 0.0263 Acc: 1.0000
val Loss: 3.1041 Acc: 0.7727
Epoch 46/52
----------
train Loss: 0.0153 Acc: 1.0000
val Loss: 3.1217 Acc: 0.7727
Epoch 47/52
----------
train Loss: 0.0307 Acc: 1.0000
val Loss: 3.1142 Acc: 0.7955
Epoch 48/52
----------
train Loss: 0.0246 Acc: 1.0000
val Loss: 3.2783 Acc: 0.7955
Epoch 49/52
----------
train Loss: 0.1092 Acc: 0.9904
val Loss: 3.3122 Acc: 0.7955
Epoch 50/52
----------
train Loss: 0.0545 Acc: 0.9904
val Loss: 3.2305 Acc: 0.7500
Epoch 51/52
----------
train Loss: 0.0819 Acc: 0.9904
val Loss: 3.3016 Acc: 0.7727
Epoch 52/52
----------
train Loss: 0.0683 Acc: 0.9952
[32m[I 2025-06-29 07:01:34,763][0m Trial 139 finished with value: 0.7954545454545455 and parameters: {'batch_size': 84, 'lr': 0.00013441195373413835, 'num_epochs': 52, 'weight_decay': 0.00459798515769861, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.2741 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_84_lr_0.00013441195373413835_epoch_52_wd_0.00459798515769861_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 3.1674 Acc: 0.3923
val Loss: 2.8360 Acc: 0.6136
Epoch 2/81
----------
train Loss: 2.4311 Acc: 0.5359
val Loss: 2.5367 Acc: 0.6591
Epoch 3/81
----------
train Loss: 2.2324 Acc: 0.5407
val Loss: 3.2680 Acc: 0.5682
Epoch 4/81
----------
train Loss: 2.1305 Acc: 0.5837
val Loss: 3.8802 Acc: 0.5227
Epoch 5/81
----------
train Loss: 1.9975 Acc: 0.6938
val Loss: 3.2408 Acc: 0.6591
Epoch 6/81
----------
train Loss: 1.8659 Acc: 0.6938
val Loss: 2.6447 Acc: 0.7955
Epoch 7/81
----------
train Loss: 1.6089 Acc: 0.8325
val Loss: 3.8216 Acc: 0.5455
Epoch 8/81
----------
train Loss: 1.8375 Acc: 0.7416
val Loss: 3.6593 Acc: 0.6818
Epoch 9/81
----------
train Loss: 1.7913 Acc: 0.7560
val Loss: 4.6887 Acc: 0.3864
Epoch 10/81
----------
train Loss: 1.2081 Acc: 0.9187
val Loss: 2.8935 Acc: 0.7045
Epoch 11/81
----------
train Loss: 1.9293 Acc: 0.7129
[32m[I 2025-06-29 07:04:04,974][0m Trial 140 finished with value: 0.7954545454545455 and parameters: {'batch_size': 93, 'lr': 0.0008623312982539475, 'num_epochs': 81, 'weight_decay': 0.040766501383393036, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.6000 Acc: 0.6364
Early stopping at epoch 11 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_93_lr_0.0008623312982539475_epoch_81_wd_0.040766501383393036_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/67
----------
train Loss: 3.7980 Acc: 0.2297
val Loss: 3.6517 Acc: 0.2500
Epoch 2/67
----------
train Loss: 3.6766 Acc: 0.2632
val Loss: 3.5711 Acc: 0.2727
Epoch 3/67
----------
train Loss: 3.5623 Acc: 0.2967
val Loss: 3.4395 Acc: 0.2955
Epoch 4/67
----------
train Loss: 3.4898 Acc: 0.3110
val Loss: 3.3645 Acc: 0.3409
Epoch 5/67
----------
train Loss: 3.4224 Acc: 0.3206
val Loss: 3.3103 Acc: 0.4091
Epoch 6/67
----------
train Loss: 3.3252 Acc: 0.3780
val Loss: 3.2370 Acc: 0.5000
Epoch 7/67
----------
train Loss: 3.2345 Acc: 0.4450
val Loss: 3.1397 Acc: 0.5000
Epoch 8/67
----------
train Loss: 3.1582 Acc: 0.4593
val Loss: 3.0618 Acc: 0.5227
Epoch 9/67
----------
train Loss: 3.0866 Acc: 0.4641
val Loss: 2.9555 Acc: 0.6136
Epoch 10/67
----------
train Loss: 2.9412 Acc: 0.4785
val Loss: 2.8370 Acc: 0.6136
Epoch 11/67
----------
train Loss: 2.9356 Acc: 0.4833
val Loss: 2.7807 Acc: 0.6136
Epoch 12/67
----------
train Loss: 2.8847 Acc: 0.5120
val Loss: 2.7234 Acc: 0.6364
Epoch 13/67
----------
train Loss: 2.7534 Acc: 0.5263
val Loss: 2.6020 Acc: 0.6364
Epoch 14/67
----------
train Loss: 2.6768 Acc: 0.5359
val Loss: 2.5570 Acc: 0.6818
Epoch 15/67
----------
train Loss: 2.6586 Acc: 0.5120
val Loss: 2.4987 Acc: 0.6818
Epoch 16/67
----------
train Loss: 2.5999 Acc: 0.5455
val Loss: 2.4144 Acc: 0.6818
Epoch 17/67
----------
train Loss: 2.5318 Acc: 0.5263
val Loss: 2.3419 Acc: 0.6818
Epoch 18/67
----------
train Loss: 2.4782 Acc: 0.5167
val Loss: 2.2778 Acc: 0.6818
Epoch 19/67
----------
train Loss: 2.4194 Acc: 0.5455
val Loss: 2.2297 Acc: 0.6818
Epoch 20/67
----------
train Loss: 2.3863 Acc: 0.5311
val Loss: 2.1731 Acc: 0.6818
Epoch 21/67
----------
train Loss: 2.3807 Acc: 0.5455
val Loss: 2.1491 Acc: 0.6818
Epoch 22/67
----------
train Loss: 2.3477 Acc: 0.5550
val Loss: 2.1054 Acc: 0.6818
Epoch 23/67
----------
train Loss: 2.2792 Acc: 0.5455
val Loss: 2.0612 Acc: 0.6818
Epoch 24/67
----------
train Loss: 2.1620 Acc: 0.5502
val Loss: 1.9924 Acc: 0.6818
Epoch 25/67
----------
train Loss: 2.2458 Acc: 0.5502
val Loss: 1.9940 Acc: 0.6818
Epoch 26/67
----------
train Loss: 2.2433 Acc: 0.5359
val Loss: 1.9924 Acc: 0.6818
Epoch 27/67
----------
train Loss: 2.1024 Acc: 0.5789
val Loss: 1.9530 Acc: 0.6818
Epoch 28/67
----------
train Loss: 2.2069 Acc: 0.5311
val Loss: 1.9312 Acc: 0.7045
Epoch 29/67
----------
train Loss: 2.2405 Acc: 0.5550
val Loss: 1.9125 Acc: 0.6818
Epoch 30/67
----------
train Loss: 2.1654 Acc: 0.5550
val Loss: 1.9146 Acc: 0.7273
Epoch 31/67
----------
train Loss: 2.0415 Acc: 0.6077
val Loss: 1.8757 Acc: 0.7045
Epoch 32/67
----------
train Loss: 2.0983 Acc: 0.5885
val Loss: 1.8412 Acc: 0.7045
Epoch 33/67
----------
train Loss: 2.1260 Acc: 0.6124
val Loss: 1.8340 Acc: 0.7045
Epoch 34/67
----------
train Loss: 2.0668 Acc: 0.5598
val Loss: 1.8178 Acc: 0.7045
Epoch 35/67
----------
train Loss: 1.9131 Acc: 0.6603
val Loss: 1.7938 Acc: 0.7273
Epoch 36/67
----------
train Loss: 2.1816 Acc: 0.5646
val Loss: 1.7610 Acc: 0.7273
Epoch 37/67
----------
train Loss: 1.9954 Acc: 0.6316
val Loss: 1.7699 Acc: 0.7273
Epoch 38/67
----------
train Loss: 2.0004 Acc: 0.6507
val Loss: 1.7559 Acc: 0.7273
Epoch 39/67
----------
train Loss: 2.0707 Acc: 0.6077
val Loss: 1.7932 Acc: 0.7727
Epoch 40/67
----------
train Loss: 1.8931 Acc: 0.6699
val Loss: 1.7855 Acc: 0.7727
Epoch 41/67
----------
train Loss: 2.1228 Acc: 0.6124
val Loss: 1.7614 Acc: 0.7727
Epoch 42/67
----------
train Loss: 1.9097 Acc: 0.6507
val Loss: 1.7258 Acc: 0.7727
Epoch 43/67
----------
train Loss: 1.9914 Acc: 0.6077
val Loss: 1.7115 Acc: 0.7727
Epoch 44/67
----------
train Loss: 1.8244 Acc: 0.7081
val Loss: 1.6860 Acc: 0.7727
Epoch 45/67
----------
train Loss: 1.5596 Acc: 0.8038
val Loss: 1.6558 Acc: 0.7500
Epoch 46/67
----------
train Loss: 2.0623 Acc: 0.6890
val Loss: 1.6574 Acc: 0.7727
Epoch 47/67
----------
train Loss: 1.7984 Acc: 0.6986
val Loss: 1.6376 Acc: 0.8182
Epoch 48/67
----------
train Loss: 1.8276 Acc: 0.7129
val Loss: 1.6175 Acc: 0.8182
Epoch 49/67
----------
train Loss: 1.8152 Acc: 0.7416
val Loss: 1.5938 Acc: 0.7727
Epoch 50/67
----------
train Loss: 1.7828 Acc: 0.7321
val Loss: 1.6181 Acc: 0.7955
Epoch 51/67
----------
train Loss: 1.5583 Acc: 0.8612
val Loss: 1.5653 Acc: 0.7955
Epoch 52/67
----------
train Loss: 1.8156 Acc: 0.6986
val Loss: 1.5631 Acc: 0.7727
Epoch 53/67
----------
train Loss: 1.9186 Acc: 0.7177
val Loss: 1.5587 Acc: 0.8182
Epoch 54/67
----------
train Loss: 1.6204 Acc: 0.8325
val Loss: 1.5384 Acc: 0.8409
Epoch 55/67
----------
train Loss: 1.6691 Acc: 0.8086
val Loss: 1.5051 Acc: 0.8636
Epoch 56/67
----------
train Loss: 1.7953 Acc: 0.7751
val Loss: 1.5054 Acc: 0.8409
Epoch 57/67
----------
train Loss: 1.9197 Acc: 0.6651
val Loss: 1.4879 Acc: 0.8409
Epoch 58/67
----------
train Loss: 1.6915 Acc: 0.7560
val Loss: 1.4993 Acc: 0.8182
Epoch 59/67
----------
train Loss: 1.7492 Acc: 0.7560
val Loss: 1.4869 Acc: 0.8182
Epoch 60/67
----------
train Loss: 1.5542 Acc: 0.7703
val Loss: 1.4889 Acc: 0.8182
Epoch 61/67
----------
train Loss: 1.8914 Acc: 0.6794
val Loss: 1.4689 Acc: 0.7955
Epoch 62/67
----------
train Loss: 1.6967 Acc: 0.8373
val Loss: 1.4565 Acc: 0.8182
Epoch 63/67
----------
train Loss: 1.5387 Acc: 0.8612
val Loss: 1.4478 Acc: 0.8182
Epoch 64/67
----------
train Loss: 1.4993 Acc: 0.8660
val Loss: 1.4439 Acc: 0.8409
Epoch 65/67
----------
train Loss: 1.6336 Acc: 0.7512
val Loss: 1.4384 Acc: 0.8409
Epoch 66/67
----------
train Loss: 1.5786 Acc: 0.8278
val Loss: 1.4305 Acc: 0.8182
Epoch 67/67
----------
train Loss: 1.7034 Acc: 0.7847
[32m[I 2025-06-29 07:19:19,767][0m Trial 141 finished with value: 0.8181818181818182 and parameters: {'batch_size': 8, 'lr': 3.367219892607898e-05, 'num_epochs': 67, 'weight_decay': 0.009748778263288441, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4094 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_8_lr_3.367219892607898e-05_epoch_67_wd_0.009748778263288441_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/69
----------
train Loss: 3.1640 Acc: 0.3923
val Loss: 2.2414 Acc: 0.6364
Epoch 2/69
----------
train Loss: 2.3858 Acc: 0.5311
val Loss: 1.9241 Acc: 0.6364
Epoch 3/69
----------
train Loss: 2.1324 Acc: 0.5694
val Loss: 1.7735 Acc: 0.7273
Epoch 4/69
----------
train Loss: 2.0051 Acc: 0.6172
val Loss: 1.6781 Acc: 0.7955
Epoch 5/69
----------
train Loss: 1.8475 Acc: 0.7608
val Loss: 1.4509 Acc: 0.7955
Epoch 6/69
----------
train Loss: 1.7456 Acc: 0.7464
val Loss: 1.3220 Acc: 0.8409
Epoch 7/69
----------
train Loss: 1.4716 Acc: 0.8804
val Loss: 1.4118 Acc: 0.7727
Epoch 8/69
----------
train Loss: 1.6862 Acc: 0.7847
val Loss: 1.4353 Acc: 0.7500
Epoch 9/69
----------
train Loss: 1.6901 Acc: 0.7943
val Loss: 1.7568 Acc: 0.7727
Epoch 10/69
----------
train Loss: 1.0602 Acc: 0.9234
val Loss: 1.2132 Acc: 0.7955
Epoch 11/69
----------
train Loss: 1.6840 Acc: 0.8278
val Loss: 1.4098 Acc: 0.7727
Epoch 12/69
----------
train Loss: 1.4918 Acc: 0.7656
val Loss: 1.8708 Acc: 0.7500
Epoch 13/69
----------
train Loss: 1.4163 Acc: 0.8804
val Loss: 1.5229 Acc: 0.6818
Epoch 14/69
----------
train Loss: 1.2580 Acc: 0.8325
val Loss: 1.8031 Acc: 0.7045
Epoch 15/69
----------
train Loss: 1.4658 Acc: 0.8230
val Loss: 1.5079 Acc: 0.7045
Epoch 16/69
----------
train Loss: 1.4541 Acc: 0.8086
val Loss: 1.9108 Acc: 0.7727
Epoch 17/69
----------
train Loss: 1.3546 Acc: 0.8230
val Loss: 1.8874 Acc: 0.6591
Epoch 18/69
----------
train Loss: 1.3915 Acc: 0.8517
val Loss: 1.4241 Acc: 0.6818
Epoch 19/69
----------
train Loss: 1.2156 Acc: 0.9330
val Loss: 1.4234 Acc: 0.7045
Epoch 20/69
----------
train Loss: 1.3344 Acc: 0.8995
val Loss: 1.4337 Acc: 0.7500
Epoch 21/69
----------
train Loss: 1.4762 Acc: 0.8756
val Loss: 1.5238 Acc: 0.7273
Epoch 22/69
----------
train Loss: 1.2830 Acc: 0.8804
val Loss: 1.5676 Acc: 0.7500
Epoch 23/69
----------
train Loss: 1.5664 Acc: 0.8660
val Loss: 1.5968 Acc: 0.6591
Epoch 24/69
----------
train Loss: 1.1748 Acc: 0.9139
val Loss: 1.4421 Acc: 0.7273
Epoch 25/69
----------
train Loss: 1.2491 Acc: 0.9282
val Loss: 1.4749 Acc: 0.7727
Epoch 26/69
----------
train Loss: 1.4300 Acc: 0.9522
val Loss: 1.3617 Acc: 0.8182
Epoch 27/69
----------
train Loss: 1.2619 Acc: 0.9474
val Loss: 1.5438 Acc: 0.7273
Epoch 28/69
----------
train Loss: 1.4229 Acc: 0.8517
val Loss: 1.5269 Acc: 0.6818
Epoch 29/69
----------
train Loss: 1.4850 Acc: 0.7943
val Loss: 1.5142 Acc: 0.7045
Epoch 30/69
----------
train Loss: 1.2746 Acc: 0.8852
val Loss: 1.2382 Acc: 0.7727
Epoch 31/69
----------
train Loss: 1.1356 Acc: 0.9378
val Loss: 1.5379 Acc: 0.7500
Epoch 32/69
----------
train Loss: 1.2686 Acc: 0.8900
val Loss: 1.4818 Acc: 0.7955
Epoch 33/69
----------
train Loss: 1.3908 Acc: 0.8612
val Loss: 1.7093 Acc: 0.7273
Epoch 34/69
----------
train Loss: 1.2908 Acc: 0.9426
val Loss: 1.6570 Acc: 0.7273
Epoch 35/69
----------
train Loss: 0.9927 Acc: 0.9617
val Loss: 1.4839 Acc: 0.7045
Epoch 36/69
----------
train Loss: 1.5681 Acc: 0.8565
val Loss: 1.4830 Acc: 0.7045
Epoch 37/69
----------
train Loss: 1.3338 Acc: 0.8421
[32m[I 2025-06-29 07:27:45,069][0m Trial 142 finished with value: 0.7954545454545455 and parameters: {'batch_size': 91, 'lr': 0.0007152200291686446, 'num_epochs': 69, 'weight_decay': 0.0073012015973488486, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5114 Acc: 0.7273
Early stopping at epoch 37 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_91_lr_0.0007152200291686446_epoch_69_wd_0.0073012015973488486_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/76
----------
train Loss: 3.5890 Acc: 0.2967
val Loss: 3.3252 Acc: 0.5682
Epoch 2/76
----------
train Loss: 3.0501 Acc: 0.4880
val Loss: 2.7587 Acc: 0.6364
Epoch 3/76
----------
train Loss: 2.6628 Acc: 0.5167
val Loss: 2.2115 Acc: 0.6364
Epoch 4/76
----------
train Loss: 2.4470 Acc: 0.4976
val Loss: 2.0185 Acc: 0.6364
Epoch 5/76
----------
train Loss: 2.3352 Acc: 0.5167
val Loss: 1.9264 Acc: 0.6364
Epoch 6/76
----------
train Loss: 2.1884 Acc: 0.5407
val Loss: 1.8409 Acc: 0.6818
Epoch 7/76
----------
train Loss: 2.0774 Acc: 0.5694
val Loss: 1.8118 Acc: 0.7045
Epoch 8/76
----------
train Loss: 2.1303 Acc: 0.5742
val Loss: 1.7112 Acc: 0.7045
Epoch 9/76
----------
train Loss: 2.0606 Acc: 0.6364
val Loss: 1.7127 Acc: 0.7500
Epoch 10/76
----------
train Loss: 1.6231 Acc: 0.8230
val Loss: 1.6498 Acc: 0.7727
Epoch 11/76
----------
train Loss: 1.9049 Acc: 0.6794
val Loss: 1.5433 Acc: 0.7500
Epoch 12/76
----------
train Loss: 1.8764 Acc: 0.6364
val Loss: 1.5783 Acc: 0.7727
Epoch 13/76
----------
train Loss: 1.6218 Acc: 0.8230
val Loss: 1.4583 Acc: 0.7727
Epoch 14/76
----------
train Loss: 1.4711 Acc: 0.7943
val Loss: 1.4538 Acc: 0.7273
Epoch 15/76
----------
train Loss: 1.5930 Acc: 0.7703
val Loss: 1.3713 Acc: 0.7500
Epoch 16/76
----------
train Loss: 1.5568 Acc: 0.7608
val Loss: 1.3685 Acc: 0.7727
Epoch 17/76
----------
train Loss: 1.4761 Acc: 0.8230
val Loss: 1.4338 Acc: 0.8182
Epoch 18/76
----------
train Loss: 1.4058 Acc: 0.8230
val Loss: 1.3378 Acc: 0.8182
Epoch 19/76
----------
train Loss: 1.2789 Acc: 0.9330
val Loss: 1.2855 Acc: 0.7955
Epoch 20/76
----------
train Loss: 1.3921 Acc: 0.8517
val Loss: 1.2296 Acc: 0.7500
Epoch 21/76
----------
train Loss: 1.4602 Acc: 0.8565
val Loss: 1.2375 Acc: 0.7955
Epoch 22/76
----------
train Loss: 1.3384 Acc: 0.8565
val Loss: 1.2828 Acc: 0.8409
Epoch 23/76
----------
train Loss: 1.5027 Acc: 0.8517
val Loss: 1.2732 Acc: 0.8182
Epoch 24/76
----------
train Loss: 1.0891 Acc: 0.9234
val Loss: 1.1921 Acc: 0.7955
Epoch 25/76
----------
train Loss: 1.2854 Acc: 0.9378
val Loss: 1.3031 Acc: 0.7727
Epoch 26/76
----------
train Loss: 1.4425 Acc: 0.9091
val Loss: 1.3481 Acc: 0.8182
Epoch 27/76
----------
train Loss: 1.1737 Acc: 0.9665
val Loss: 1.4458 Acc: 0.8182
Epoch 28/76
----------
train Loss: 1.4192 Acc: 0.8708
val Loss: 1.3461 Acc: 0.8182
Epoch 29/76
----------
train Loss: 1.5115 Acc: 0.7703
val Loss: 1.3416 Acc: 0.7955
Epoch 30/76
----------
train Loss: 1.2964 Acc: 0.8660
val Loss: 1.2710 Acc: 0.7955
Epoch 31/76
----------
train Loss: 1.1558 Acc: 0.9330
val Loss: 1.1717 Acc: 0.7955
Epoch 32/76
----------
train Loss: 1.3009 Acc: 0.8947
val Loss: 1.1565 Acc: 0.7955
Epoch 33/76
----------
train Loss: 1.3534 Acc: 0.8756
val Loss: 1.2201 Acc: 0.8182
Epoch 34/76
----------
train Loss: 1.2977 Acc: 0.9330
val Loss: 1.2762 Acc: 0.7955
Epoch 35/76
----------
train Loss: 0.9896 Acc: 0.9713
val Loss: 1.3654 Acc: 0.7727
Epoch 36/76
----------
train Loss: 1.5405 Acc: 0.8517
val Loss: 1.3199 Acc: 0.8182
Epoch 37/76
----------
train Loss: 1.3089 Acc: 0.8182
val Loss: 1.3981 Acc: 0.8182
Epoch 38/76
----------
train Loss: 1.3352 Acc: 0.9474
val Loss: 1.3090 Acc: 0.7955
Epoch 39/76
----------
train Loss: 1.3873 Acc: 0.7608
val Loss: 1.4398 Acc: 0.7273
Epoch 40/76
----------
train Loss: 1.1759 Acc: 0.9043
val Loss: 1.3836 Acc: 0.7500
Epoch 41/76
----------
train Loss: 1.6312 Acc: 0.7081
val Loss: 1.2338 Acc: 0.7955
Epoch 42/76
----------
train Loss: 1.1907 Acc: 0.8756
val Loss: 1.2111 Acc: 0.7955
Epoch 43/76
----------
train Loss: 1.3476 Acc: 0.8852
val Loss: 1.1932 Acc: 0.7955
Epoch 44/76
----------
train Loss: 1.2090 Acc: 0.8852
val Loss: 1.3349 Acc: 0.7727
Epoch 45/76
----------
train Loss: 0.8005 Acc: 0.9617
val Loss: 1.2487 Acc: 0.7955
Epoch 46/76
----------
train Loss: 1.6073 Acc: 0.8325
val Loss: 1.3843 Acc: 0.7727
Epoch 47/76
----------
train Loss: 1.2462 Acc: 0.9043
val Loss: 1.3081 Acc: 0.7500
Epoch 48/76
----------
train Loss: 1.3296 Acc: 0.8565
val Loss: 1.3562 Acc: 0.7727
Epoch 49/76
----------
train Loss: 1.3153 Acc: 0.9522
val Loss: 1.4223 Acc: 0.8182
Epoch 50/76
----------
train Loss: 1.2630 Acc: 0.8804
val Loss: 1.4210 Acc: 0.7955
Epoch 51/76
----------
train Loss: 0.9788 Acc: 0.9856
val Loss: 1.2758 Acc: 0.8182
Epoch 52/76
----------
train Loss: 1.3269 Acc: 0.8565
val Loss: 1.2771 Acc: 0.7955
Epoch 53/76
----------
train Loss: 1.4817 Acc: 0.9139
val Loss: 1.3449 Acc: 0.7727
Epoch 54/76
----------
train Loss: 1.1508 Acc: 0.9330
val Loss: 1.4341 Acc: 0.7500
Epoch 55/76
----------
train Loss: 1.2095 Acc: 0.9426
val Loss: 1.5326 Acc: 0.7273
Epoch 56/76
----------
train Loss: 1.3789 Acc: 0.9091
val Loss: 1.3428 Acc: 0.7273
Epoch 57/76
----------
train Loss: 1.5202 Acc: 0.8373
val Loss: 1.3108 Acc: 0.7500
Epoch 58/76
----------
train Loss: 1.2355 Acc: 0.8373
val Loss: 1.3062 Acc: 0.7955
Epoch 59/76
----------
train Loss: 1.2896 Acc: 0.9091
val Loss: 1.3646 Acc: 0.7500
Epoch 60/76
----------
train Loss: 1.0972 Acc: 0.8756
val Loss: 1.3722 Acc: 0.7500
Epoch 61/76
----------
train Loss: 1.5244 Acc: 0.7416
val Loss: 1.2894 Acc: 0.7500
Epoch 62/76
----------
train Loss: 1.4235 Acc: 0.9378
val Loss: 1.3571 Acc: 0.7500
Epoch 63/76
----------
train Loss: 1.2613 Acc: 0.9234
val Loss: 1.4550 Acc: 0.7500
Epoch 64/76
----------
train Loss: 1.1246 Acc: 0.9522
val Loss: 1.4282 Acc: 0.7500
Epoch 65/76
----------
train Loss: 1.2588 Acc: 0.8708
val Loss: 1.4315 Acc: 0.7273
Epoch 66/76
----------
train Loss: 1.2660 Acc: 0.9043
val Loss: 1.3937 Acc: 0.7727
Epoch 67/76
----------
train Loss: 1.4317 Acc: 0.8708
val Loss: 1.4659 Acc: 0.7500
Epoch 68/76
----------
train Loss: 1.1887 Acc: 0.9043
val Loss: 1.3008 Acc: 0.7955
Epoch 69/76
----------
train Loss: 1.1387 Acc: 0.8852
val Loss: 1.1776 Acc: 0.8409
Epoch 70/76
----------
train Loss: 1.3277 Acc: 0.8995
val Loss: 1.1448 Acc: 0.8409
Epoch 71/76
----------
train Loss: 1.3914 Acc: 0.9187
val Loss: 1.2237 Acc: 0.7955
Epoch 72/76
----------
train Loss: 1.4006 Acc: 0.8756
val Loss: 1.3026 Acc: 0.7500
Epoch 73/76
----------
train Loss: 1.0132 Acc: 0.9665
val Loss: 1.3565 Acc: 0.7955
Epoch 74/76
----------
train Loss: 1.4230 Acc: 0.8756
val Loss: 1.3257 Acc: 0.8182
Epoch 75/76
----------
train Loss: 1.1009 Acc: 0.9522
val Loss: 1.3038 Acc: 0.7727
Epoch 76/76
----------
train Loss: 1.1240 Acc: 0.8947
[32m[I 2025-06-29 07:45:03,313][0m Trial 143 finished with value: 0.7272727272727273 and parameters: {'batch_size': 27, 'lr': 0.00023510448947757504, 'num_epochs': 76, 'weight_decay': 0.020072237187820318, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3746 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_27_lr_0.00023510448947757504_epoch_76_wd_0.020072237187820318_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.6359 Acc: 0.2775
val Loss: 3.3904 Acc: 0.5000
Epoch 2/78
----------
train Loss: 3.1740 Acc: 0.4689
val Loss: 2.9242 Acc: 0.5909
Epoch 3/78
----------
train Loss: 2.8115 Acc: 0.4880
val Loss: 2.3796 Acc: 0.6364
Epoch 4/78
----------
train Loss: 2.5744 Acc: 0.5072
val Loss: 2.1157 Acc: 0.6364
Epoch 5/78
----------
train Loss: 2.4272 Acc: 0.5167
val Loss: 1.9919 Acc: 0.6364
Epoch 6/78
----------
train Loss: 2.2556 Acc: 0.5263
val Loss: 1.8777 Acc: 0.6591
Epoch 7/78
----------
train Loss: 2.1461 Acc: 0.5455
val Loss: 1.8208 Acc: 0.6818
Epoch 8/78
----------
train Loss: 2.1939 Acc: 0.5455
val Loss: 1.7499 Acc: 0.6818
Epoch 9/78
----------
train Loss: 2.1352 Acc: 0.5933
val Loss: 1.7491 Acc: 0.7273
Epoch 10/78
----------
train Loss: 1.7313 Acc: 0.7273
val Loss: 1.7133 Acc: 0.7273
Epoch 11/78
----------
train Loss: 1.9905 Acc: 0.6220
val Loss: 1.6304 Acc: 0.7500
Epoch 12/78
----------
train Loss: 1.9751 Acc: 0.6172
val Loss: 1.6212 Acc: 0.7273
Epoch 13/78
----------
train Loss: 1.7416 Acc: 0.7895
val Loss: 1.5344 Acc: 0.7500
Epoch 14/78
----------
train Loss: 1.6054 Acc: 0.7751
val Loss: 1.5076 Acc: 0.7500
Epoch 15/78
----------
train Loss: 1.7117 Acc: 0.7368
val Loss: 1.4538 Acc: 0.7727
Epoch 16/78
----------
train Loss: 1.6636 Acc: 0.7751
val Loss: 1.4308 Acc: 0.8182
Epoch 17/78
----------
train Loss: 1.5640 Acc: 0.8325
val Loss: 1.4521 Acc: 0.8409
Epoch 18/78
----------
train Loss: 1.4365 Acc: 0.8325
val Loss: 1.3364 Acc: 0.8182
Epoch 19/78
----------
train Loss: 1.3545 Acc: 0.8947
val Loss: 1.3040 Acc: 0.7955
Epoch 20/78
----------
train Loss: 1.4386 Acc: 0.8469
val Loss: 1.2800 Acc: 0.7955
Epoch 21/78
----------
train Loss: 1.5176 Acc: 0.8325
val Loss: 1.2523 Acc: 0.7955
Epoch 22/78
----------
train Loss: 1.3793 Acc: 0.8517
val Loss: 1.2528 Acc: 0.8409
Epoch 23/78
----------
train Loss: 1.5193 Acc: 0.8469
val Loss: 1.2117 Acc: 0.8409
Epoch 24/78
----------
train Loss: 1.1053 Acc: 0.9378
val Loss: 1.1497 Acc: 0.8409
Epoch 25/78
----------
train Loss: 1.3070 Acc: 0.9282
val Loss: 1.2061 Acc: 0.7955
Epoch 26/78
----------
train Loss: 1.4296 Acc: 0.8995
val Loss: 1.2632 Acc: 0.8409
Epoch 27/78
----------
train Loss: 1.1598 Acc: 0.9713
val Loss: 1.3463 Acc: 0.8409
Epoch 28/78
----------
train Loss: 1.4351 Acc: 0.8804
val Loss: 1.3063 Acc: 0.7955
Epoch 29/78
----------
train Loss: 1.5473 Acc: 0.7751
val Loss: 1.2430 Acc: 0.8409
Epoch 30/78
----------
train Loss: 1.3093 Acc: 0.8612
val Loss: 1.2493 Acc: 0.7955
Epoch 31/78
----------
train Loss: 1.1591 Acc: 0.9139
val Loss: 1.2019 Acc: 0.7955
Epoch 32/78
----------
train Loss: 1.3251 Acc: 0.8756
val Loss: 1.1702 Acc: 0.7955
Epoch 33/78
----------
train Loss: 1.3633 Acc: 0.8852
val Loss: 1.2124 Acc: 0.8182
Epoch 34/78
----------
train Loss: 1.3159 Acc: 0.9139
val Loss: 1.2585 Acc: 0.7955
Epoch 35/78
----------
train Loss: 1.0040 Acc: 0.9856
val Loss: 1.3477 Acc: 0.7727
Epoch 36/78
----------
train Loss: 1.5352 Acc: 0.8278
val Loss: 1.3228 Acc: 0.7955
Epoch 37/78
----------
train Loss: 1.2832 Acc: 0.8230
val Loss: 1.3077 Acc: 0.8182
Epoch 38/78
----------
train Loss: 1.3264 Acc: 0.9378
val Loss: 1.2359 Acc: 0.8182
Epoch 39/78
----------
train Loss: 1.4132 Acc: 0.7703
val Loss: 1.3121 Acc: 0.8182
Epoch 40/78
----------
train Loss: 1.1553 Acc: 0.8995
val Loss: 1.3797 Acc: 0.8182
Epoch 41/78
----------
train Loss: 1.6475 Acc: 0.7273
val Loss: 1.3292 Acc: 0.8409
Epoch 42/78
----------
train Loss: 1.1411 Acc: 0.8900
val Loss: 1.2834 Acc: 0.8409
Epoch 43/78
----------
train Loss: 1.3400 Acc: 0.8756
val Loss: 1.2063 Acc: 0.8409
Epoch 44/78
----------
train Loss: 1.2042 Acc: 0.8708
val Loss: 1.2534 Acc: 0.8182
Epoch 45/78
----------
train Loss: 0.7761 Acc: 0.9713
val Loss: 1.2274 Acc: 0.7955
Epoch 46/78
----------
train Loss: 1.6319 Acc: 0.8278
val Loss: 1.3039 Acc: 0.7955
Epoch 47/78
----------
train Loss: 1.2093 Acc: 0.9091
val Loss: 1.2622 Acc: 0.8182
Epoch 48/78
----------
train Loss: 1.3095 Acc: 0.8804
val Loss: 1.2404 Acc: 0.7955
Epoch 49/78
----------
train Loss: 1.3034 Acc: 0.9378
val Loss: 1.2869 Acc: 0.7955
Epoch 50/78
----------
train Loss: 1.2514 Acc: 0.8900
val Loss: 1.3529 Acc: 0.7955
Epoch 51/78
----------
train Loss: 0.9566 Acc: 0.9904
val Loss: 1.2196 Acc: 0.8182
Epoch 52/78
----------
train Loss: 1.3254 Acc: 0.8469
val Loss: 1.2161 Acc: 0.8182
Epoch 53/78
----------
train Loss: 1.5053 Acc: 0.8947
val Loss: 1.2542 Acc: 0.7955
Epoch 54/78
----------
train Loss: 1.1365 Acc: 0.9234
val Loss: 1.3354 Acc: 0.7955
Epoch 55/78
----------
train Loss: 1.1843 Acc: 0.9378
val Loss: 1.4267 Acc: 0.7727
Epoch 56/78
----------
train Loss: 1.3877 Acc: 0.9139
val Loss: 1.3272 Acc: 0.8182
Epoch 57/78
----------
train Loss: 1.5026 Acc: 0.8421
val Loss: 1.2884 Acc: 0.8409
Epoch 58/78
----------
train Loss: 1.2393 Acc: 0.8182
val Loss: 1.2453 Acc: 0.8409
Epoch 59/78
----------
train Loss: 1.2860 Acc: 0.9091
val Loss: 1.3603 Acc: 0.7955
Epoch 60/78
----------
train Loss: 1.0698 Acc: 0.8804
val Loss: 1.3387 Acc: 0.8182
Epoch 61/78
----------
train Loss: 1.5009 Acc: 0.7416
val Loss: 1.2288 Acc: 0.7727
Epoch 62/78
----------
train Loss: 1.3818 Acc: 0.9426
val Loss: 1.2219 Acc: 0.7727
Epoch 63/78
----------
train Loss: 1.2138 Acc: 0.9426
val Loss: 1.2701 Acc: 0.7727
Epoch 64/78
----------
train Loss: 1.1052 Acc: 0.9617
val Loss: 1.2699 Acc: 0.7500
Epoch 65/78
----------
train Loss: 1.2539 Acc: 0.8612
val Loss: 1.3579 Acc: 0.7500
Epoch 66/78
----------
train Loss: 1.2384 Acc: 0.8995
val Loss: 1.3224 Acc: 0.7955
Epoch 67/78
----------
train Loss: 1.4240 Acc: 0.8708
val Loss: 1.2996 Acc: 0.7955
Epoch 68/78
----------
train Loss: 1.1632 Acc: 0.9043
val Loss: 1.3184 Acc: 0.7955
Epoch 69/78
----------
train Loss: 1.1205 Acc: 0.8995
val Loss: 1.2140 Acc: 0.7955
Epoch 70/78
----------
train Loss: 1.2827 Acc: 0.9091
val Loss: 1.1523 Acc: 0.8182
Epoch 71/78
----------
train Loss: 1.3662 Acc: 0.9234
val Loss: 1.2626 Acc: 0.7727
Epoch 72/78
----------
train Loss: 1.3507 Acc: 0.8852
val Loss: 1.3394 Acc: 0.7727
Epoch 73/78
----------
train Loss: 0.9932 Acc: 0.9665
val Loss: 1.2950 Acc: 0.8182
Epoch 74/78
----------
train Loss: 1.3945 Acc: 0.8756
val Loss: 1.2636 Acc: 0.7500
Epoch 75/78
----------
train Loss: 1.0706 Acc: 0.9761
val Loss: 1.2202 Acc: 0.7727
Epoch 76/78
----------
train Loss: 1.0998 Acc: 0.8852
val Loss: 1.1814 Acc: 0.8636
Epoch 77/78
----------
train Loss: 1.3128 Acc: 0.8852
val Loss: 1.3231 Acc: 0.8409
Epoch 78/78
----------
train Loss: 1.1907 Acc: 0.9187
[32m[I 2025-06-29 08:02:49,142][0m Trial 144 finished with value: 0.7954545454545455 and parameters: {'batch_size': 29, 'lr': 0.00018070706877484338, 'num_epochs': 78, 'weight_decay': 0.01485710826063217, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4720 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_29_lr_0.00018070706877484338_epoch_78_wd_0.01485710826063217_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/61
----------
train Loss: 3.1376 Acc: 0.3971
val Loss: 2.2046 Acc: 0.6364
Epoch 2/61
----------
train Loss: 2.3821 Acc: 0.5311
val Loss: 1.9128 Acc: 0.6364
Epoch 3/61
----------
train Loss: 2.1219 Acc: 0.5837
val Loss: 1.8783 Acc: 0.6818
Epoch 4/61
----------
train Loss: 1.9926 Acc: 0.6268
val Loss: 1.7071 Acc: 0.8182
Epoch 5/61
----------
train Loss: 1.8242 Acc: 0.7608
val Loss: 1.5402 Acc: 0.7727
Epoch 6/61
----------
train Loss: 1.7534 Acc: 0.7368
val Loss: 1.4455 Acc: 0.8636
Epoch 7/61
----------
train Loss: 1.4927 Acc: 0.8708
val Loss: 1.5560 Acc: 0.8182
Epoch 8/61
----------
train Loss: 1.7104 Acc: 0.7943
val Loss: 1.5964 Acc: 0.7273
Epoch 9/61
----------
train Loss: 1.7092 Acc: 0.7990
val Loss: 2.1606 Acc: 0.7727
Epoch 10/61
----------
train Loss: 1.0717 Acc: 0.9378
val Loss: 1.3741 Acc: 0.7955
Epoch 11/61
----------
train Loss: 1.7156 Acc: 0.7990
val Loss: 1.5001 Acc: 0.7500
Epoch 12/61
----------
train Loss: 1.5392 Acc: 0.7416
val Loss: 1.9583 Acc: 0.6818
Epoch 13/61
----------
train Loss: 1.4639 Acc: 0.8565
val Loss: 1.5108 Acc: 0.7273
Epoch 14/61
----------
train Loss: 1.2918 Acc: 0.8373
val Loss: 1.5503 Acc: 0.7273
Epoch 15/61
----------
train Loss: 1.4913 Acc: 0.8134
val Loss: 1.5343 Acc: 0.7500
Epoch 16/61
----------
train Loss: 1.4892 Acc: 0.8134
val Loss: 2.2755 Acc: 0.6818
Epoch 17/61
----------
train Loss: 1.4352 Acc: 0.8182
val Loss: 1.7832 Acc: 0.6818
Epoch 18/61
----------
train Loss: 1.4030 Acc: 0.8182
val Loss: 1.5013 Acc: 0.7045
Epoch 19/61
----------
train Loss: 1.2333 Acc: 0.9187
val Loss: 1.4817 Acc: 0.7273
Epoch 20/61
----------
train Loss: 1.3194 Acc: 0.8660
val Loss: 1.4872 Acc: 0.8182
Epoch 21/61
----------
train Loss: 1.4747 Acc: 0.8804
val Loss: 1.4887 Acc: 0.7955
Epoch 22/61
----------
train Loss: 1.3423 Acc: 0.8612
val Loss: 1.8669 Acc: 0.7273
Epoch 23/61
----------
train Loss: 1.5591 Acc: 0.8612
val Loss: 1.5535 Acc: 0.7500
Epoch 24/61
----------
train Loss: 1.1508 Acc: 0.9330
val Loss: 1.3779 Acc: 0.7500
Epoch 25/61
----------
train Loss: 1.2437 Acc: 0.9426
val Loss: 1.5164 Acc: 0.7727
Epoch 26/61
----------
train Loss: 1.4377 Acc: 0.9426
val Loss: 1.5192 Acc: 0.7273
Epoch 27/61
----------
train Loss: 1.2869 Acc: 0.9426
val Loss: 1.8960 Acc: 0.6818
Epoch 28/61
----------
train Loss: 1.4293 Acc: 0.8612
val Loss: 1.4498 Acc: 0.7500
Epoch 29/61
----------
train Loss: 1.5201 Acc: 0.7512
val Loss: 1.1872 Acc: 0.7955
Epoch 30/61
----------
train Loss: 1.2999 Acc: 0.8612
val Loss: 1.2503 Acc: 0.7500
Epoch 31/61
----------
train Loss: 1.1453 Acc: 0.9234
val Loss: 1.3682 Acc: 0.7727
Epoch 32/61
----------
train Loss: 1.3229 Acc: 0.9091
val Loss: 1.4665 Acc: 0.7500
Epoch 33/61
----------
train Loss: 1.3993 Acc: 0.8421
val Loss: 1.5535 Acc: 0.7727
Epoch 34/61
----------
train Loss: 1.3568 Acc: 0.9091
val Loss: 1.4757 Acc: 0.7955
Epoch 35/61
----------
train Loss: 1.0749 Acc: 0.9426
val Loss: 1.4624 Acc: 0.7955
Epoch 36/61
----------
train Loss: 1.6231 Acc: 0.8182
val Loss: 1.3826 Acc: 0.7727
Epoch 37/61
----------
train Loss: 1.4127 Acc: 0.8086
val Loss: 1.6359 Acc: 0.6818
Epoch 38/61
----------
train Loss: 1.4493 Acc: 0.8995
val Loss: 1.3385 Acc: 0.7727
Epoch 39/61
----------
train Loss: 1.4808 Acc: 0.7560
val Loss: 1.5643 Acc: 0.7727
Epoch 40/61
----------
train Loss: 1.2799 Acc: 0.8900
val Loss: 1.6057 Acc: 0.7273
Epoch 41/61
----------
train Loss: 1.6522 Acc: 0.7273
val Loss: 1.4668 Acc: 0.7273
Epoch 42/61
----------
train Loss: 1.2696 Acc: 0.8278
val Loss: 1.6959 Acc: 0.6591
Epoch 43/61
----------
train Loss: 1.3362 Acc: 0.8612
val Loss: 1.5580 Acc: 0.7273
Epoch 44/61
----------
train Loss: 1.2292 Acc: 0.8852
val Loss: 1.6231 Acc: 0.7045
Epoch 45/61
----------
train Loss: 0.8558 Acc: 0.9474
val Loss: 1.4114 Acc: 0.7500
Epoch 46/61
----------
train Loss: 1.7137 Acc: 0.8517
val Loss: 1.6369 Acc: 0.6818
Epoch 47/61
----------
train Loss: 1.3497 Acc: 0.8900
val Loss: 1.5599 Acc: 0.7727
Epoch 48/61
----------
train Loss: 1.3465 Acc: 0.8612
val Loss: 1.8789 Acc: 0.6591
Epoch 49/61
----------
train Loss: 1.3085 Acc: 0.9139
val Loss: 1.6448 Acc: 0.7273
Epoch 50/61
----------
train Loss: 1.3516 Acc: 0.8421
val Loss: 1.6967 Acc: 0.7500
Epoch 51/61
----------
train Loss: 1.0090 Acc: 0.9856
val Loss: 1.2865 Acc: 0.7273
Epoch 52/61
----------
train Loss: 1.3554 Acc: 0.8278
val Loss: 1.3494 Acc: 0.7045
Epoch 53/61
----------
train Loss: 1.6148 Acc: 0.8565
val Loss: 1.9463 Acc: 0.6591
Epoch 54/61
----------
train Loss: 1.1997 Acc: 0.9187
val Loss: 1.6684 Acc: 0.6818
Epoch 55/61
----------
train Loss: 1.2005 Acc: 0.9522
val Loss: 1.6063 Acc: 0.7045
Epoch 56/61
----------
train Loss: 1.3979 Acc: 0.8947
val Loss: 1.6480 Acc: 0.7500
Epoch 57/61
----------
train Loss: 1.5772 Acc: 0.8278
val Loss: 1.8594 Acc: 0.7273
Epoch 58/61
----------
train Loss: 1.3124 Acc: 0.8182
val Loss: 1.6172 Acc: 0.7500
Epoch 59/61
----------
train Loss: 1.3130 Acc: 0.8995
val Loss: 1.5666 Acc: 0.7273
Epoch 60/61
----------
train Loss: 1.0906 Acc: 0.8900
val Loss: 1.5105 Acc: 0.7045
Epoch 61/61
----------
train Loss: 1.5319 Acc: 0.8230
[32m[I 2025-06-29 08:16:42,568][0m Trial 145 finished with value: 0.6818181818181819 and parameters: {'batch_size': 100, 'lr': 0.0007706063910049965, 'num_epochs': 61, 'weight_decay': 0.008960466834328435, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6789 Acc: 0.6818
Best val Acc: 0.681818

Model weights saved at ./model_weights/efficientnetb0_bs_100_lr_0.0007706063910049965_epoch_61_wd_0.008960466834328435_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/70
----------
train Loss: 3.7838 Acc: 0.2297
val Loss: 3.6278 Acc: 0.2727
Epoch 2/70
----------
train Loss: 3.6290 Acc: 0.2823
val Loss: 3.5180 Acc: 0.2727
Epoch 3/70
----------
train Loss: 3.4855 Acc: 0.3397
val Loss: 3.3513 Acc: 0.3636
Epoch 4/70
----------
train Loss: 3.3876 Acc: 0.3445
val Loss: 3.2487 Acc: 0.4318
Epoch 5/70
----------
train Loss: 3.2967 Acc: 0.4019
val Loss: 3.1653 Acc: 0.4773
Epoch 6/70
----------
train Loss: 3.1742 Acc: 0.4258
val Loss: 3.0543 Acc: 0.4773
Epoch 7/70
----------
train Loss: 3.0579 Acc: 0.4785
val Loss: 2.9188 Acc: 0.6136
Epoch 8/70
----------
train Loss: 2.9734 Acc: 0.5024
val Loss: 2.8090 Acc: 0.6136
Epoch 9/70
----------
train Loss: 2.8842 Acc: 0.5263
val Loss: 2.6778 Acc: 0.6136
Epoch 10/70
----------
train Loss: 2.7056 Acc: 0.5167
val Loss: 2.5516 Acc: 0.6364
Epoch 11/70
----------
train Loss: 2.7088 Acc: 0.5024
val Loss: 2.4812 Acc: 0.6364
Epoch 12/70
----------
train Loss: 2.6670 Acc: 0.5167
val Loss: 2.4266 Acc: 0.6591
Epoch 13/70
----------
train Loss: 2.5149 Acc: 0.5359
val Loss: 2.3133 Acc: 0.6591
Epoch 14/70
----------
train Loss: 2.4295 Acc: 0.5359
val Loss: 2.2698 Acc: 0.6818
Epoch 15/70
----------
train Loss: 2.4433 Acc: 0.5359
val Loss: 2.2147 Acc: 0.6818
Epoch 16/70
----------
train Loss: 2.3892 Acc: 0.5311
val Loss: 2.1493 Acc: 0.6818
Epoch 17/70
----------
train Loss: 2.3238 Acc: 0.5359
val Loss: 2.0911 Acc: 0.6818
Epoch 18/70
----------
train Loss: 2.2604 Acc: 0.5359
val Loss: 2.0368 Acc: 0.6818
Epoch 19/70
----------
train Loss: 2.2097 Acc: 0.5502
val Loss: 2.0062 Acc: 0.6818
Epoch 20/70
----------
train Loss: 2.2002 Acc: 0.5215
val Loss: 1.9580 Acc: 0.6818
Epoch 21/70
----------
train Loss: 2.2063 Acc: 0.5502
val Loss: 1.9348 Acc: 0.6818
Epoch 22/70
----------
train Loss: 2.1751 Acc: 0.5933
val Loss: 1.8988 Acc: 0.6818
Epoch 23/70
----------
train Loss: 2.1203 Acc: 0.5789
val Loss: 1.8573 Acc: 0.6818
Epoch 24/70
----------
train Loss: 1.9764 Acc: 0.6029
val Loss: 1.7993 Acc: 0.6818
Epoch 25/70
----------
train Loss: 2.0841 Acc: 0.5885
val Loss: 1.8069 Acc: 0.6818
Epoch 26/70
----------
train Loss: 2.0913 Acc: 0.5837
val Loss: 1.8105 Acc: 0.7273
Epoch 27/70
----------
train Loss: 1.9187 Acc: 0.6507
val Loss: 1.7844 Acc: 0.7273
Epoch 28/70
----------
train Loss: 2.0641 Acc: 0.5981
val Loss: 1.7653 Acc: 0.7273
Epoch 29/70
----------
train Loss: 2.1079 Acc: 0.5789
val Loss: 1.7489 Acc: 0.7500
Epoch 30/70
----------
train Loss: 2.0054 Acc: 0.6077
val Loss: 1.7525 Acc: 0.7727
Epoch 31/70
----------
train Loss: 1.8571 Acc: 0.7033
val Loss: 1.7139 Acc: 0.7500
Epoch 32/70
----------
train Loss: 1.9459 Acc: 0.6364
val Loss: 1.6775 Acc: 0.7500
Epoch 33/70
----------
train Loss: 1.9734 Acc: 0.6507
val Loss: 1.6727 Acc: 0.7727
Epoch 34/70
----------
train Loss: 1.9002 Acc: 0.6986
val Loss: 1.6556 Acc: 0.7727
Epoch 35/70
----------
train Loss: 1.7048 Acc: 0.7416
val Loss: 1.6326 Acc: 0.7727
Epoch 36/70
----------
train Loss: 2.0361 Acc: 0.6268
val Loss: 1.6029 Acc: 0.7727
Epoch 37/70
----------
train Loss: 1.8011 Acc: 0.7033
val Loss: 1.6102 Acc: 0.7727
Epoch 38/70
----------
train Loss: 1.8119 Acc: 0.7751
val Loss: 1.5925 Acc: 0.7727
Epoch 39/70
----------
train Loss: 1.9069 Acc: 0.6603
val Loss: 1.6387 Acc: 0.7727
Epoch 40/70
----------
train Loss: 1.6736 Acc: 0.7464
val Loss: 1.6356 Acc: 0.7727
Epoch 41/70
----------
train Loss: 1.9825 Acc: 0.6603
val Loss: 1.6032 Acc: 0.7727
Epoch 42/70
----------
train Loss: 1.7027 Acc: 0.7321
val Loss: 1.5632 Acc: 0.7727
Epoch 43/70
----------
train Loss: 1.7927 Acc: 0.7273
val Loss: 1.5468 Acc: 0.7500
Epoch 44/70
----------
train Loss: 1.6084 Acc: 0.7943
val Loss: 1.5131 Acc: 0.7727
Epoch 45/70
----------
train Loss: 1.2562 Acc: 0.9139
val Loss: 1.4763 Acc: 0.8409
Epoch 46/70
----------
train Loss: 1.9033 Acc: 0.7799
val Loss: 1.4794 Acc: 0.8182
Epoch 47/70
----------
train Loss: 1.5815 Acc: 0.8182
val Loss: 1.4595 Acc: 0.8182
Epoch 48/70
----------
train Loss: 1.6309 Acc: 0.7703
val Loss: 1.4423 Acc: 0.8182
Epoch 49/70
----------
train Loss: 1.6048 Acc: 0.8517
val Loss: 1.4259 Acc: 0.8182
Epoch 50/70
----------
train Loss: 1.5759 Acc: 0.8038
val Loss: 1.4559 Acc: 0.7955
Epoch 51/70
----------
train Loss: 1.2776 Acc: 0.9282
val Loss: 1.4109 Acc: 0.7955
Epoch 52/70
----------
train Loss: 1.6245 Acc: 0.7512
val Loss: 1.4130 Acc: 0.8409
Epoch 53/70
----------
train Loss: 1.7543 Acc: 0.8182
val Loss: 1.4092 Acc: 0.8409
Epoch 54/70
----------
train Loss: 1.3961 Acc: 0.9091
val Loss: 1.3850 Acc: 0.8409
Epoch 55/70
----------
train Loss: 1.4538 Acc: 0.8947
val Loss: 1.3572 Acc: 0.8636
Epoch 56/70
----------
train Loss: 1.6051 Acc: 0.8421
val Loss: 1.3640 Acc: 0.8409
Epoch 57/70
----------
train Loss: 1.7667 Acc: 0.7608
val Loss: 1.3459 Acc: 0.8409
Epoch 58/70
----------
train Loss: 1.5153 Acc: 0.8134
val Loss: 1.3537 Acc: 0.8182
Epoch 59/70
----------
train Loss: 1.5638 Acc: 0.8325
val Loss: 1.3540 Acc: 0.8182
Epoch 60/70
----------
train Loss: 1.3227 Acc: 0.8230
val Loss: 1.3666 Acc: 0.8409
Epoch 61/70
----------
train Loss: 1.7408 Acc: 0.7081
val Loss: 1.3603 Acc: 0.8182
Epoch 62/70
----------
train Loss: 1.5407 Acc: 0.8995
val Loss: 1.3493 Acc: 0.8182
Epoch 63/70
----------
train Loss: 1.3647 Acc: 0.8900
val Loss: 1.3485 Acc: 0.8182
Epoch 64/70
----------
train Loss: 1.2932 Acc: 0.9282
val Loss: 1.3421 Acc: 0.8409
Epoch 65/70
----------
train Loss: 1.4683 Acc: 0.7751
val Loss: 1.3529 Acc: 0.8409
Epoch 66/70
----------
train Loss: 1.4022 Acc: 0.8612
val Loss: 1.3410 Acc: 0.8182
Epoch 67/70
----------
train Loss: 1.5791 Acc: 0.8660
val Loss: 1.3254 Acc: 0.8409
Epoch 68/70
----------
train Loss: 1.3079 Acc: 0.8947
val Loss: 1.3302 Acc: 0.8636
Epoch 69/70
----------
train Loss: 1.3242 Acc: 0.8660
val Loss: 1.3312 Acc: 0.8636
Epoch 70/70
----------
train Loss: 1.4736 Acc: 0.8708
[32m[I 2025-06-29 08:32:38,588][0m Trial 146 finished with value: 0.8409090909090909 and parameters: {'batch_size': 95, 'lr': 4.5492613662583847e-05, 'num_epochs': 70, 'weight_decay': 0.010595619430532537, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3235 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_95_lr_4.5492613662583847e-05_epoch_70_wd_0.010595619430532537_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 3.3890 Acc: 0.3589
val Loss: 3.0119 Acc: 0.6136
Epoch 2/87
----------
train Loss: 2.6233 Acc: 0.5167
val Loss: 2.1200 Acc: 0.6364
Epoch 3/87
----------
train Loss: 2.2984 Acc: 0.5167
val Loss: 1.9510 Acc: 0.6364
Epoch 4/87
----------
train Loss: 2.1961 Acc: 0.5167
val Loss: 1.9792 Acc: 0.7500
Epoch 5/87
----------
train Loss: 2.1232 Acc: 0.6316
val Loss: 1.9121 Acc: 0.7955
Epoch 6/87
----------
train Loss: 1.9494 Acc: 0.6411
val Loss: 1.8110 Acc: 0.7955
Epoch 7/87
----------
train Loss: 1.7715 Acc: 0.7273
val Loss: 1.6771 Acc: 0.8182
Epoch 8/87
----------
train Loss: 1.8303 Acc: 0.7416
val Loss: 1.5812 Acc: 0.7955
Epoch 9/87
----------
train Loss: 1.7688 Acc: 0.7560
val Loss: 1.7645 Acc: 0.7727
Epoch 10/87
----------
train Loss: 1.1630 Acc: 0.9378
val Loss: 1.3883 Acc: 0.8409
Epoch 11/87
----------
train Loss: 1.7139 Acc: 0.7943
val Loss: 1.2627 Acc: 0.8864
Epoch 12/87
----------
train Loss: 1.5329 Acc: 0.7416
val Loss: 1.8869 Acc: 0.7955
Epoch 13/87
----------
train Loss: 1.3506 Acc: 0.8900
val Loss: 1.6353 Acc: 0.7955
Epoch 14/87
----------
train Loss: 1.2666 Acc: 0.8373
val Loss: 1.5339 Acc: 0.7500
Epoch 15/87
----------
train Loss: 1.4150 Acc: 0.8230
val Loss: 1.1707 Acc: 0.7955
Epoch 16/87
----------
train Loss: 1.5019 Acc: 0.7990
[32m[I 2025-06-29 08:36:17,096][0m Trial 147 finished with value: 0.8863636363636364 and parameters: {'batch_size': 87, 'lr': 0.0004679640785505878, 'num_epochs': 87, 'weight_decay': 0.021894137140596646, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4458 Acc: 0.7727
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_87_lr_0.0004679640785505878_epoch_87_wd_0.021894137140596646_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 3.2427 Acc: 0.3876
val Loss: 2.5589 Acc: 0.6364
Epoch 2/84
----------
train Loss: 2.4308 Acc: 0.5455
val Loss: 1.9197 Acc: 0.6364
Epoch 3/84
----------
train Loss: 2.1769 Acc: 0.5359
val Loss: 1.9398 Acc: 0.7045
Epoch 4/84
----------
train Loss: 2.0696 Acc: 0.5742
val Loss: 2.1199 Acc: 0.7500
Epoch 5/84
----------
train Loss: 1.9608 Acc: 0.7081
val Loss: 1.7611 Acc: 0.7955
Epoch 6/84
----------
train Loss: 1.8073 Acc: 0.7177
val Loss: 1.4684 Acc: 0.7955
Epoch 7/84
----------
train Loss: 1.5085 Acc: 0.8900
val Loss: 1.4100 Acc: 0.7500
Epoch 8/84
----------
train Loss: 1.6887 Acc: 0.7368
val Loss: 1.4807 Acc: 0.7273
Epoch 9/84
----------
train Loss: 1.6872 Acc: 0.7560
val Loss: 1.6122 Acc: 0.8182
Epoch 10/84
----------
train Loss: 1.0493 Acc: 0.9426
val Loss: 1.0869 Acc: 0.8636
Epoch 11/84
----------
train Loss: 1.7733 Acc: 0.7799
val Loss: 1.5272 Acc: 0.7727
Epoch 12/84
----------
train Loss: 1.5086 Acc: 0.7751
val Loss: 2.1997 Acc: 0.6591
Epoch 13/84
----------
train Loss: 1.3885 Acc: 0.8900
val Loss: 1.5833 Acc: 0.7955
Epoch 14/84
----------
train Loss: 1.3256 Acc: 0.8134
val Loss: 1.4618 Acc: 0.7727
Epoch 15/84
----------
train Loss: 1.4655 Acc: 0.8134
[32m[I 2025-06-29 08:39:40,157][0m Trial 148 finished with value: 0.8636363636363636 and parameters: {'batch_size': 81, 'lr': 0.0006291657769694168, 'num_epochs': 84, 'weight_decay': 0.013088997587997964, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3809 Acc: 0.7727
Early stopping at epoch 15 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_81_lr_0.0006291657769694168_epoch_84_wd_0.013088997587997964_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/94
----------
train Loss: 3.3188 Acc: 0.3684
val Loss: 2.5855 Acc: 0.6364
Epoch 2/94
----------
train Loss: 2.4854 Acc: 0.5359
val Loss: 1.9762 Acc: 0.6364
Epoch 3/94
----------
train Loss: 2.1929 Acc: 0.5311
val Loss: 1.7837 Acc: 0.6364
Epoch 4/94
----------
train Loss: 2.0847 Acc: 0.5646
val Loss: 1.5792 Acc: 0.7727
Epoch 5/94
----------
train Loss: 1.9916 Acc: 0.7081
val Loss: 1.4174 Acc: 0.8182
Epoch 6/94
----------
train Loss: 1.8082 Acc: 0.6842
val Loss: 1.2998 Acc: 0.8182
Epoch 7/94
----------
train Loss: 1.5507 Acc: 0.8373
val Loss: 1.2331 Acc: 0.7955
Epoch 8/94
----------
train Loss: 1.7193 Acc: 0.7703
val Loss: 1.2470 Acc: 0.7955
Epoch 9/94
----------
train Loss: 1.6883 Acc: 0.7847
val Loss: 1.3518 Acc: 0.8409
Epoch 10/94
----------
train Loss: 1.0241 Acc: 0.9617
val Loss: 1.2148 Acc: 0.7727
Epoch 11/94
----------
train Loss: 1.7281 Acc: 0.7751
val Loss: 1.1872 Acc: 0.8636
Epoch 12/94
----------
train Loss: 1.4363 Acc: 0.7895
val Loss: 1.4252 Acc: 0.7955
Epoch 13/94
----------
train Loss: 1.3238 Acc: 0.9043
val Loss: 1.2836 Acc: 0.7955
Epoch 14/94
----------
train Loss: 1.2174 Acc: 0.8421
val Loss: 1.2263 Acc: 0.8182
Epoch 15/94
----------
train Loss: 1.3778 Acc: 0.8230
val Loss: 1.1055 Acc: 0.8409
Epoch 16/94
----------
train Loss: 1.3841 Acc: 0.8134
val Loss: 1.2035 Acc: 0.8636
Epoch 17/94
----------
train Loss: 1.3519 Acc: 0.8660
val Loss: 1.2803 Acc: 0.7955
Epoch 18/94
----------
train Loss: 1.2893 Acc: 0.8708
val Loss: 1.2421 Acc: 0.7500
Epoch 19/94
----------
train Loss: 1.2293 Acc: 0.9282
val Loss: 1.1581 Acc: 0.7955
Epoch 20/94
----------
train Loss: 1.3145 Acc: 0.8708
val Loss: 1.1511 Acc: 0.7955
Epoch 21/94
----------
train Loss: 1.4039 Acc: 0.8947
[32m[I 2025-06-29 08:44:27,550][0m Trial 149 finished with value: 0.8636363636363636 and parameters: {'batch_size': 80, 'lr': 0.0004807542510148169, 'num_epochs': 94, 'weight_decay': 0.0006294416380028182, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.0956 Acc: 0.7955
Early stopping at epoch 21 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_80_lr_0.0004807542510148169_epoch_94_wd_0.0006294416380028182_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/94
----------
train Loss: 3.8082 Acc: 0.2249
val Loss: 3.6664 Acc: 0.2500
Epoch 2/94
----------
train Loss: 3.7129 Acc: 0.2536
val Loss: 3.6084 Acc: 0.2500
Epoch 3/94
----------
train Loss: 3.6226 Acc: 0.2775
val Loss: 3.5017 Acc: 0.2500
Epoch 4/94
----------
train Loss: 3.5703 Acc: 0.2775
val Loss: 3.4513 Acc: 0.3636
Epoch 5/94
----------
train Loss: 3.5238 Acc: 0.2775
val Loss: 3.4225 Acc: 0.3636
Epoch 6/94
----------
train Loss: 3.4482 Acc: 0.3301
val Loss: 3.3762 Acc: 0.3864
Epoch 7/94
----------
train Loss: 3.3843 Acc: 0.3780
val Loss: 3.3110 Acc: 0.4318
Epoch 8/94
----------
train Loss: 3.3176 Acc: 0.4306
val Loss: 3.2693 Acc: 0.5000
Epoch 9/94
----------
train Loss: 3.2687 Acc: 0.4163
val Loss: 3.1987 Acc: 0.5227
Epoch 10/94
----------
train Loss: 3.1641 Acc: 0.4258
val Loss: 3.1120 Acc: 0.5227
Epoch 11/94
----------
train Loss: 3.1531 Acc: 0.4354
val Loss: 3.0798 Acc: 0.5227
Epoch 12/94
----------
train Loss: 3.1109 Acc: 0.4450
val Loss: 3.0380 Acc: 0.5909
Epoch 13/94
----------
train Loss: 3.0139 Acc: 0.5263
val Loss: 2.9410 Acc: 0.5682
Epoch 14/94
----------
train Loss: 2.9596 Acc: 0.4976
val Loss: 2.9119 Acc: 0.5909
Epoch 15/94
----------
train Loss: 2.9287 Acc: 0.5167
val Loss: 2.8678 Acc: 0.5682
Epoch 16/94
----------
train Loss: 2.8779 Acc: 0.5024
val Loss: 2.7845 Acc: 0.6136
Epoch 17/94
----------
train Loss: 2.8196 Acc: 0.5359
val Loss: 2.7180 Acc: 0.6364
Epoch 18/94
----------
train Loss: 2.7868 Acc: 0.4976
val Loss: 2.6505 Acc: 0.6136
Epoch 19/94
----------
train Loss: 2.7220 Acc: 0.5359
val Loss: 2.5969 Acc: 0.6136
Epoch 20/94
----------
train Loss: 2.6724 Acc: 0.5263
val Loss: 2.5462 Acc: 0.6591
Epoch 21/94
----------
train Loss: 2.6646 Acc: 0.5215
val Loss: 2.5254 Acc: 0.6591
Epoch 22/94
----------
train Loss: 2.6269 Acc: 0.5407
val Loss: 2.4805 Acc: 0.6591
Epoch 23/94
----------
train Loss: 2.5601 Acc: 0.5215
val Loss: 2.4264 Acc: 0.6818
Epoch 24/94
----------
train Loss: 2.4653 Acc: 0.5120
val Loss: 2.3424 Acc: 0.6818
Epoch 25/94
----------
train Loss: 2.5065 Acc: 0.5359
val Loss: 2.3377 Acc: 0.6818
Epoch 26/94
----------
train Loss: 2.4986 Acc: 0.5024
val Loss: 2.3328 Acc: 0.6818
Epoch 27/94
----------
train Loss: 2.3840 Acc: 0.5646
val Loss: 2.2802 Acc: 0.6818
Epoch 28/94
----------
train Loss: 2.4447 Acc: 0.5167
val Loss: 2.2563 Acc: 0.6818
Epoch 29/94
----------
train Loss: 2.4540 Acc: 0.5215
val Loss: 2.2312 Acc: 0.6818
Epoch 30/94
----------
train Loss: 2.4106 Acc: 0.5024
val Loss: 2.2266 Acc: 0.6818
Epoch 31/94
----------
train Loss: 2.3079 Acc: 0.5455
val Loss: 2.1794 Acc: 0.6818
Epoch 32/94
----------
train Loss: 2.3233 Acc: 0.5407
val Loss: 2.1473 Acc: 0.6818
Epoch 33/94
----------
train Loss: 2.3375 Acc: 0.5215
val Loss: 2.1300 Acc: 0.6818
Epoch 34/94
----------
train Loss: 2.2994 Acc: 0.5120
val Loss: 2.1089 Acc: 0.6818
Epoch 35/94
----------
train Loss: 2.1900 Acc: 0.5311
val Loss: 2.0745 Acc: 0.6818
Epoch 36/94
----------
train Loss: 2.3713 Acc: 0.5167
val Loss: 2.0478 Acc: 0.6818
Epoch 37/94
----------
train Loss: 2.2413 Acc: 0.5550
val Loss: 2.0430 Acc: 0.6818
Epoch 38/94
----------
train Loss: 2.2323 Acc: 0.5694
val Loss: 2.0240 Acc: 0.6818
Epoch 39/94
----------
train Loss: 2.2806 Acc: 0.5455
val Loss: 2.0539 Acc: 0.6818
Epoch 40/94
----------
train Loss: 2.1604 Acc: 0.5502
val Loss: 2.0340 Acc: 0.7045
Epoch 41/94
----------
train Loss: 2.3071 Acc: 0.5359
val Loss: 2.0102 Acc: 0.7045
Epoch 42/94
----------
train Loss: 2.1520 Acc: 0.5550
val Loss: 1.9836 Acc: 0.7045
Epoch 43/94
----------
train Loss: 2.2211 Acc: 0.5263
val Loss: 1.9730 Acc: 0.7045
Epoch 44/94
----------
train Loss: 2.0924 Acc: 0.5694
val Loss: 1.9546 Acc: 0.6818
Epoch 45/94
----------
train Loss: 1.9245 Acc: 0.6172
val Loss: 1.9335 Acc: 0.6818
Epoch 46/94
----------
train Loss: 2.2583 Acc: 0.5598
val Loss: 1.9434 Acc: 0.7045
Epoch 47/94
----------
train Loss: 2.0723 Acc: 0.5837
val Loss: 1.9277 Acc: 0.7045
Epoch 48/94
----------
train Loss: 2.0965 Acc: 0.5789
val Loss: 1.9010 Acc: 0.6818
Epoch 49/94
----------
train Loss: 2.0839 Acc: 0.5742
val Loss: 1.8792 Acc: 0.6818
Epoch 50/94
----------
train Loss: 2.0651 Acc: 0.5742
val Loss: 1.9019 Acc: 0.7045
Epoch 51/94
----------
train Loss: 1.9185 Acc: 0.5981
val Loss: 1.8441 Acc: 0.7045
Epoch 52/94
----------
train Loss: 2.0726 Acc: 0.5981
val Loss: 1.8485 Acc: 0.7045
Epoch 53/94
----------
train Loss: 2.1515 Acc: 0.5694
val Loss: 1.8474 Acc: 0.7045
Epoch 54/94
----------
train Loss: 1.9403 Acc: 0.6555
val Loss: 1.8370 Acc: 0.7045
Epoch 55/94
----------
train Loss: 1.9765 Acc: 0.6124
val Loss: 1.8053 Acc: 0.7045
Epoch 56/94
----------
train Loss: 2.0616 Acc: 0.6029
val Loss: 1.8039 Acc: 0.7045
Epoch 57/94
----------
train Loss: 2.1504 Acc: 0.5550
val Loss: 1.7825 Acc: 0.7045
Epoch 58/94
----------
train Loss: 1.9778 Acc: 0.6077
val Loss: 1.7981 Acc: 0.7045
Epoch 59/94
----------
train Loss: 2.0340 Acc: 0.6077
val Loss: 1.7740 Acc: 0.7045
Epoch 60/94
----------
train Loss: 1.9126 Acc: 0.6651
val Loss: 1.7711 Acc: 0.7727
Epoch 61/94
----------
train Loss: 2.1248 Acc: 0.5694
val Loss: 1.7423 Acc: 0.7273
Epoch 62/94
----------
train Loss: 1.9679 Acc: 0.6651
val Loss: 1.7371 Acc: 0.7045
Epoch 63/94
----------
train Loss: 1.8635 Acc: 0.6746
val Loss: 1.7206 Acc: 0.7273
Epoch 64/94
----------
train Loss: 1.8594 Acc: 0.6507
val Loss: 1.7169 Acc: 0.7955
Epoch 65/94
----------
train Loss: 1.9408 Acc: 0.6507
val Loss: 1.7030 Acc: 0.7727
Epoch 66/94
----------
train Loss: 1.9025 Acc: 0.7081
val Loss: 1.6957 Acc: 0.7500
Epoch 67/94
----------
train Loss: 1.9654 Acc: 0.6603
val Loss: 1.6644 Acc: 0.7727
Epoch 68/94
----------
train Loss: 1.8116 Acc: 0.6842
val Loss: 1.6527 Acc: 0.7273
Epoch 69/94
----------
train Loss: 1.8436 Acc: 0.7225
val Loss: 1.6623 Acc: 0.7955
Epoch 70/94
----------
train Loss: 1.9076 Acc: 0.7225
val Loss: 1.6653 Acc: 0.7955
Epoch 71/94
----------
train Loss: 2.0021 Acc: 0.6555
val Loss: 1.6412 Acc: 0.8182
Epoch 72/94
----------
train Loss: 1.9552 Acc: 0.6746
val Loss: 1.6597 Acc: 0.7955
Epoch 73/94
----------
train Loss: 1.6321 Acc: 0.7990
val Loss: 1.6321 Acc: 0.7955
Epoch 74/94
----------
train Loss: 2.0065 Acc: 0.6794
val Loss: 1.6092 Acc: 0.7955
Epoch 75/94
----------
train Loss: 1.7321 Acc: 0.7368
val Loss: 1.6048 Acc: 0.7955
Epoch 76/94
----------
train Loss: 1.8336 Acc: 0.6651
val Loss: 1.5945 Acc: 0.7955
Epoch 77/94
----------
train Loss: 1.8287 Acc: 0.7560
val Loss: 1.5881 Acc: 0.7955
Epoch 78/94
----------
train Loss: 1.7427 Acc: 0.7608
val Loss: 1.5879 Acc: 0.8182
Epoch 79/94
----------
train Loss: 1.9237 Acc: 0.6890
val Loss: 1.5754 Acc: 0.8182
Epoch 80/94
----------
train Loss: 1.7963 Acc: 0.6986
val Loss: 1.5640 Acc: 0.8409
Epoch 81/94
----------
train Loss: 1.9267 Acc: 0.6794
val Loss: 1.5718 Acc: 0.8182
Epoch 82/94
----------
train Loss: 1.7062 Acc: 0.7608
val Loss: 1.5771 Acc: 0.8182
Epoch 83/94
----------
train Loss: 1.5822 Acc: 0.8804
val Loss: 1.5483 Acc: 0.8409
Epoch 84/94
----------
train Loss: 1.9135 Acc: 0.6699
val Loss: 1.5728 Acc: 0.8182
Epoch 85/94
----------
train Loss: 1.6810 Acc: 0.7273
val Loss: 1.5624 Acc: 0.8182
Epoch 86/94
----------
train Loss: 1.6710 Acc: 0.7656
val Loss: 1.5369 Acc: 0.7955
Epoch 87/94
----------
train Loss: 1.7717 Acc: 0.7656
val Loss: 1.5222 Acc: 0.8409
Epoch 88/94
----------
train Loss: 1.8165 Acc: 0.7703
val Loss: 1.5059 Acc: 0.8182
Epoch 89/94
----------
train Loss: 1.9221 Acc: 0.6938
val Loss: 1.5166 Acc: 0.7727
Epoch 90/94
----------
train Loss: 1.6672 Acc: 0.7656
val Loss: 1.5091 Acc: 0.8409
Epoch 91/94
----------
train Loss: 1.5451 Acc: 0.8182
val Loss: 1.5153 Acc: 0.8182
Epoch 92/94
----------
train Loss: 1.5997 Acc: 0.8517
val Loss: 1.5083 Acc: 0.8182
Epoch 93/94
----------
train Loss: 1.6700 Acc: 0.7656
val Loss: 1.4852 Acc: 0.8182
Epoch 94/94
----------
train Loss: 1.4227 Acc: 0.8995
[32m[I 2025-06-29 09:05:49,833][0m Trial 150 finished with value: 0.8181818181818182 and parameters: {'batch_size': 112, 'lr': 2.7914834730427836e-05, 'num_epochs': 94, 'weight_decay': 0.02272336202563057, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4587 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_112_lr_2.7914834730427836e-05_epoch_94_wd_0.02272336202563057_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/82
----------
train Loss: 3.4782 Acc: 0.3445
val Loss: 3.2022 Acc: 0.5909
Epoch 2/82
----------
train Loss: 2.8022 Acc: 0.5167
val Loss: 2.5030 Acc: 0.6364
Epoch 3/82
----------
train Loss: 2.4374 Acc: 0.4976
val Loss: 2.1054 Acc: 0.6364
Epoch 4/82
----------
train Loss: 2.3039 Acc: 0.5024
val Loss: 2.0319 Acc: 0.6591
Epoch 5/82
----------
train Loss: 2.2386 Acc: 0.5455
val Loss: 2.0044 Acc: 0.7045
Epoch 6/82
----------
train Loss: 2.0910 Acc: 0.5742
val Loss: 1.9926 Acc: 0.7500
Epoch 7/82
----------
train Loss: 1.9619 Acc: 0.6316
val Loss: 2.0358 Acc: 0.7727
Epoch 8/82
----------
train Loss: 2.0125 Acc: 0.6603
val Loss: 1.8241 Acc: 0.8182
Epoch 9/82
----------
train Loss: 1.9349 Acc: 0.7081
val Loss: 1.8000 Acc: 0.7727
Epoch 10/82
----------
train Loss: 1.4278 Acc: 0.8900
val Loss: 1.5982 Acc: 0.7727
Epoch 11/82
----------
train Loss: 1.7527 Acc: 0.7368
val Loss: 1.3691 Acc: 0.7955
Epoch 12/82
----------
train Loss: 1.6561 Acc: 0.7177
val Loss: 1.5408 Acc: 0.7955
Epoch 13/82
----------
train Loss: 1.4191 Acc: 0.8756
val Loss: 1.4391 Acc: 0.7500
Epoch 14/82
----------
train Loss: 1.3111 Acc: 0.7895
val Loss: 1.5693 Acc: 0.6818
Epoch 15/82
----------
train Loss: 1.5075 Acc: 0.7895
val Loss: 1.4537 Acc: 0.7273
Epoch 16/82
----------
train Loss: 1.5223 Acc: 0.7799
val Loss: 1.7389 Acc: 0.7727
Epoch 17/82
----------
train Loss: 1.4620 Acc: 0.8373
val Loss: 1.8080 Acc: 0.7955
Epoch 18/82
----------
train Loss: 1.3885 Acc: 0.8134
val Loss: 1.4705 Acc: 0.7727
Epoch 19/82
----------
train Loss: 1.2657 Acc: 0.9330
val Loss: 1.3896 Acc: 0.7045
Epoch 20/82
----------
train Loss: 1.4089 Acc: 0.8373
val Loss: 1.3125 Acc: 0.6591
Epoch 21/82
----------
train Loss: 1.4823 Acc: 0.8565
val Loss: 1.4745 Acc: 0.7955
Epoch 22/82
----------
train Loss: 1.3372 Acc: 0.8660
val Loss: 1.6250 Acc: 0.7727
Epoch 23/82
----------
train Loss: 1.5032 Acc: 0.8612
val Loss: 1.6178 Acc: 0.7500
Epoch 24/82
----------
train Loss: 1.1374 Acc: 0.9091
val Loss: 1.5176 Acc: 0.7727
Epoch 25/82
----------
train Loss: 1.3566 Acc: 0.9234
val Loss: 1.8099 Acc: 0.7727
Epoch 26/82
----------
train Loss: 1.4832 Acc: 0.9091
val Loss: 1.5361 Acc: 0.7500
Epoch 27/82
----------
train Loss: 1.2352 Acc: 0.9522
val Loss: 1.6305 Acc: 0.7045
Epoch 28/82
----------
train Loss: 1.4354 Acc: 0.8804
val Loss: 1.3485 Acc: 0.7727
Epoch 29/82
----------
train Loss: 1.4941 Acc: 0.7990
val Loss: 1.3955 Acc: 0.8636
Epoch 30/82
----------
train Loss: 1.3286 Acc: 0.8469
val Loss: 1.3400 Acc: 0.7500
Epoch 31/82
----------
train Loss: 1.1503 Acc: 0.9282
val Loss: 1.3589 Acc: 0.8182
Epoch 32/82
----------
train Loss: 1.3169 Acc: 0.9043
val Loss: 1.2525 Acc: 0.7955
Epoch 33/82
----------
train Loss: 1.4406 Acc: 0.8708
val Loss: 1.3567 Acc: 0.7727
Epoch 34/82
----------
train Loss: 1.3415 Acc: 0.9187
val Loss: 1.6593 Acc: 0.7273
Epoch 35/82
----------
train Loss: 1.0643 Acc: 0.9665
val Loss: 1.4746 Acc: 0.7273
Epoch 36/82
----------
train Loss: 1.6421 Acc: 0.8660
val Loss: 1.5453 Acc: 0.6818
Epoch 37/82
----------
train Loss: 1.4283 Acc: 0.8038
val Loss: 1.9040 Acc: 0.6591
Epoch 38/82
----------
train Loss: 1.4935 Acc: 0.9234
val Loss: 1.4520 Acc: 0.7500
Epoch 39/82
----------
train Loss: 1.4394 Acc: 0.7608
val Loss: 1.9760 Acc: 0.7727
Epoch 40/82
----------
train Loss: 1.2750 Acc: 0.9091
val Loss: 1.3505 Acc: 0.8182
Epoch 41/82
----------
train Loss: 1.6271 Acc: 0.7177
val Loss: 1.3866 Acc: 0.7955
Epoch 42/82
----------
train Loss: 1.2890 Acc: 0.8421
val Loss: 1.6018 Acc: 0.7273
Epoch 43/82
----------
train Loss: 1.3529 Acc: 0.8756
val Loss: 1.2906 Acc: 0.8182
Epoch 44/82
----------
train Loss: 1.2534 Acc: 0.8660
val Loss: 1.6529 Acc: 0.7500
Epoch 45/82
----------
train Loss: 0.8493 Acc: 0.9569
val Loss: 1.3696 Acc: 0.7727
Epoch 46/82
----------
train Loss: 1.7470 Acc: 0.7943
val Loss: 1.6121 Acc: 0.7045
Epoch 47/82
----------
train Loss: 1.3720 Acc: 0.8756
val Loss: 1.4735 Acc: 0.7727
Epoch 48/82
----------
train Loss: 1.3489 Acc: 0.8804
val Loss: 1.3160 Acc: 0.7955
Epoch 49/82
----------
train Loss: 1.3394 Acc: 0.9187
val Loss: 1.3302 Acc: 0.7955
Epoch 50/82
----------
train Loss: 1.3458 Acc: 0.8660
val Loss: 1.7278 Acc: 0.7500
Epoch 51/82
----------
train Loss: 1.0511 Acc: 0.9569
val Loss: 1.7697 Acc: 0.7727
Epoch 52/82
----------
train Loss: 1.3426 Acc: 0.8325
val Loss: 1.3331 Acc: 0.7727
Epoch 53/82
----------
train Loss: 1.6226 Acc: 0.8947
val Loss: 1.4988 Acc: 0.7500
Epoch 54/82
----------
train Loss: 1.2609 Acc: 0.9330
val Loss: 1.4605 Acc: 0.7955
Epoch 55/82
----------
train Loss: 1.2668 Acc: 0.9474
val Loss: 1.7351 Acc: 0.7045
Epoch 56/82
----------
train Loss: 1.4174 Acc: 0.9091
val Loss: 1.7632 Acc: 0.7273
Epoch 57/82
----------
train Loss: 1.6022 Acc: 0.8230
val Loss: 1.7387 Acc: 0.7045
Epoch 58/82
----------
train Loss: 1.3615 Acc: 0.8182
val Loss: 1.4296 Acc: 0.7500
Epoch 59/82
----------
train Loss: 1.4399 Acc: 0.8660
val Loss: 1.5746 Acc: 0.6136
Epoch 60/82
----------
train Loss: 1.1439 Acc: 0.8900
val Loss: 1.6237 Acc: 0.6818
Epoch 61/82
----------
train Loss: 1.6591 Acc: 0.7560
val Loss: 1.5315 Acc: 0.6591
Epoch 62/82
----------
train Loss: 1.5674 Acc: 0.8995
val Loss: 1.6795 Acc: 0.6591
Epoch 63/82
----------
train Loss: 1.3776 Acc: 0.9091
val Loss: 1.7366 Acc: 0.7045
Epoch 64/82
----------
train Loss: 1.2040 Acc: 0.9378
val Loss: 1.3750 Acc: 0.7045
Epoch 65/82
----------
train Loss: 1.3397 Acc: 0.8565
val Loss: 1.3954 Acc: 0.7045
Epoch 66/82
----------
train Loss: 1.3328 Acc: 0.8947
val Loss: 1.4123 Acc: 0.7500
Epoch 67/82
----------
train Loss: 1.4933 Acc: 0.8565
val Loss: 1.7917 Acc: 0.7273
Epoch 68/82
----------
train Loss: 1.3130 Acc: 0.8804
val Loss: 1.8010 Acc: 0.7045
Epoch 69/82
----------
train Loss: 1.2461 Acc: 0.8517
val Loss: 1.6426 Acc: 0.7727
Epoch 70/82
----------
train Loss: 1.3997 Acc: 0.8947
val Loss: 1.4206 Acc: 0.7273
Epoch 71/82
----------
train Loss: 1.4378 Acc: 0.8900
val Loss: 1.4383 Acc: 0.7727
Epoch 72/82
----------
train Loss: 1.5180 Acc: 0.8421
val Loss: 1.3862 Acc: 0.7273
Epoch 73/82
----------
train Loss: 1.0632 Acc: 0.9522
val Loss: 1.5009 Acc: 0.7273
Epoch 74/82
----------
train Loss: 1.5253 Acc: 0.8086
val Loss: 1.5026 Acc: 0.6818
Epoch 75/82
----------
train Loss: 1.2374 Acc: 0.9187
val Loss: 1.7097 Acc: 0.7273
Epoch 76/82
----------
train Loss: 1.2210 Acc: 0.8612
val Loss: 1.4927 Acc: 0.7273
Epoch 77/82
----------
train Loss: 1.4285 Acc: 0.8565
val Loss: 1.7435 Acc: 0.6364
Epoch 78/82
----------
train Loss: 1.3245 Acc: 0.8804
val Loss: 1.7717 Acc: 0.6818
Epoch 79/82
----------
train Loss: 1.4477 Acc: 0.8852
val Loss: 1.3416 Acc: 0.8182
Epoch 80/82
----------
train Loss: 1.3758 Acc: 0.8708
val Loss: 1.5124 Acc: 0.7045
Epoch 81/82
----------
train Loss: 1.5320 Acc: 0.7943
val Loss: 1.7333 Acc: 0.6591
Epoch 82/82
----------
train Loss: 1.3040 Acc: 0.8421
[32m[I 2025-06-29 09:24:28,140][0m Trial 151 finished with value: 0.8181818181818182 and parameters: {'batch_size': 88, 'lr': 0.0003831217733489095, 'num_epochs': 82, 'weight_decay': 0.03384580079609686, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6377 Acc: 0.6818
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_88_lr_0.0003831217733489095_epoch_82_wd_0.03384580079609686_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 0.6950 Acc: 0.2297
val Loss: 0.6766 Acc: 0.2500
Epoch 2/88
----------
train Loss: 0.6700 Acc: 0.2823
val Loss: 0.6577 Acc: 0.2955
Epoch 3/88
----------
train Loss: 0.6497 Acc: 0.3541
val Loss: 0.6311 Acc: 0.3636
Epoch 4/88
----------
train Loss: 0.6349 Acc: 0.3780
val Loss: 0.6137 Acc: 0.4091
Epoch 5/88
----------
train Loss: 0.6242 Acc: 0.4258
val Loss: 0.6024 Acc: 0.5000
Epoch 6/88
----------
train Loss: 0.6052 Acc: 0.4785
val Loss: 0.5861 Acc: 0.5455
Epoch 7/88
----------
train Loss: 0.5857 Acc: 0.5359
val Loss: 0.5672 Acc: 0.6136
Epoch 8/88
----------
train Loss: 0.5747 Acc: 0.5359
val Loss: 0.5500 Acc: 0.6136
Epoch 9/88
----------
train Loss: 0.5602 Acc: 0.5598
val Loss: 0.5309 Acc: 0.6591
Epoch 10/88
----------
train Loss: 0.5314 Acc: 0.5742
val Loss: 0.5102 Acc: 0.6818
Epoch 11/88
----------
train Loss: 0.5347 Acc: 0.5407
val Loss: 0.4968 Acc: 0.6591
Epoch 12/88
----------
train Loss: 0.5279 Acc: 0.5502
val Loss: 0.4872 Acc: 0.6591
Epoch 13/88
----------
train Loss: 0.5005 Acc: 0.5981
val Loss: 0.4679 Acc: 0.6591
Epoch 14/88
----------
train Loss: 0.4827 Acc: 0.5885
val Loss: 0.4573 Acc: 0.6591
Epoch 15/88
----------
train Loss: 0.4834 Acc: 0.5694
val Loss: 0.4460 Acc: 0.7045
Epoch 16/88
----------
train Loss: 0.4737 Acc: 0.5789
val Loss: 0.4332 Acc: 0.6818
Epoch 17/88
----------
train Loss: 0.4630 Acc: 0.5789
val Loss: 0.4219 Acc: 0.6591
Epoch 18/88
----------
train Loss: 0.4520 Acc: 0.6316
val Loss: 0.4098 Acc: 0.6591
Epoch 19/88
----------
train Loss: 0.4359 Acc: 0.6842
val Loss: 0.4019 Acc: 0.7045
Epoch 20/88
----------
train Loss: 0.4376 Acc: 0.6411
val Loss: 0.3904 Acc: 0.7045
Epoch 21/88
----------
train Loss: 0.4344 Acc: 0.6459
val Loss: 0.3819 Acc: 0.7045
Epoch 22/88
----------
train Loss: 0.4275 Acc: 0.6364
val Loss: 0.3744 Acc: 0.7727
Epoch 23/88
----------
train Loss: 0.4184 Acc: 0.6507
val Loss: 0.3650 Acc: 0.7500
Epoch 24/88
----------
train Loss: 0.3881 Acc: 0.7273
val Loss: 0.3503 Acc: 0.7500
Epoch 25/88
----------
train Loss: 0.4085 Acc: 0.6842
val Loss: 0.3519 Acc: 0.7500
Epoch 26/88
----------
train Loss: 0.4079 Acc: 0.7033
val Loss: 0.3499 Acc: 0.7500
Epoch 27/88
----------
train Loss: 0.3676 Acc: 0.7512
val Loss: 0.3431 Acc: 0.7727
Epoch 28/88
----------
train Loss: 0.4017 Acc: 0.6986
val Loss: 0.3391 Acc: 0.7955
Epoch 29/88
----------
train Loss: 0.4185 Acc: 0.6555
val Loss: 0.3365 Acc: 0.7955
Epoch 30/88
----------
train Loss: 0.3910 Acc: 0.6842
val Loss: 0.3331 Acc: 0.7955
Epoch 31/88
----------
train Loss: 0.3537 Acc: 0.8086
val Loss: 0.3243 Acc: 0.7955
Epoch 32/88
----------
train Loss: 0.3713 Acc: 0.7321
val Loss: 0.3158 Acc: 0.7955
Epoch 33/88
----------
train Loss: 0.3888 Acc: 0.7129
val Loss: 0.3143 Acc: 0.7955
Epoch 34/88
----------
train Loss: 0.3628 Acc: 0.7751
val Loss: 0.3107 Acc: 0.7955
Epoch 35/88
----------
train Loss: 0.3237 Acc: 0.8612
val Loss: 0.3102 Acc: 0.7727
Epoch 36/88
----------
train Loss: 0.3970 Acc: 0.7321
val Loss: 0.3052 Acc: 0.8182
Epoch 37/88
----------
train Loss: 0.3479 Acc: 0.7703
val Loss: 0.3112 Acc: 0.7955
Epoch 38/88
----------
train Loss: 0.3466 Acc: 0.8421
val Loss: 0.3081 Acc: 0.7955
Epoch 39/88
----------
train Loss: 0.3685 Acc: 0.7033
val Loss: 0.3158 Acc: 0.7500
Epoch 40/88
----------
train Loss: 0.3228 Acc: 0.8134
val Loss: 0.3116 Acc: 0.7727
Epoch 41/88
----------
train Loss: 0.3788 Acc: 0.6938
val Loss: 0.3063 Acc: 0.7955
Epoch 42/88
----------
train Loss: 0.3257 Acc: 0.7703
val Loss: 0.2977 Acc: 0.7955
Epoch 43/88
----------
train Loss: 0.3469 Acc: 0.7895
val Loss: 0.2931 Acc: 0.7955
Epoch 44/88
----------
train Loss: 0.3154 Acc: 0.8325
val Loss: 0.2902 Acc: 0.7955
Epoch 45/88
----------
train Loss: 0.2308 Acc: 0.9282
val Loss: 0.2860 Acc: 0.7955
Epoch 46/88
----------
train Loss: 0.3869 Acc: 0.7751
val Loss: 0.2877 Acc: 0.7955
Epoch 47/88
----------
train Loss: 0.3053 Acc: 0.8660
val Loss: 0.2840 Acc: 0.8182
Epoch 48/88
----------
train Loss: 0.3329 Acc: 0.7751
val Loss: 0.2867 Acc: 0.7955
Epoch 49/88
----------
train Loss: 0.3176 Acc: 0.8756
val Loss: 0.2839 Acc: 0.7955
Epoch 50/88
----------
train Loss: 0.3079 Acc: 0.8278
val Loss: 0.2843 Acc: 0.7955
Epoch 51/88
----------
train Loss: 0.2508 Acc: 0.9474
val Loss: 0.2777 Acc: 0.7955
Epoch 52/88
----------
train Loss: 0.3243 Acc: 0.7560
val Loss: 0.2801 Acc: 0.7727
Epoch 53/88
----------
train Loss: 0.3538 Acc: 0.8469
val Loss: 0.2776 Acc: 0.7727
Epoch 54/88
----------
train Loss: 0.2694 Acc: 0.9139
val Loss: 0.2712 Acc: 0.7955
Epoch 55/88
----------
train Loss: 0.2874 Acc: 0.9091
val Loss: 0.2691 Acc: 0.8182
Epoch 56/88
----------
train Loss: 0.3279 Acc: 0.8325
val Loss: 0.2702 Acc: 0.7955
Epoch 57/88
----------
train Loss: 0.3600 Acc: 0.7799
val Loss: 0.2688 Acc: 0.8409
Epoch 58/88
----------
train Loss: 0.3031 Acc: 0.7943
val Loss: 0.2666 Acc: 0.8182
Epoch 59/88
----------
train Loss: 0.3184 Acc: 0.8325
val Loss: 0.2655 Acc: 0.8182
Epoch 60/88
----------
train Loss: 0.2735 Acc: 0.8278
val Loss: 0.2679 Acc: 0.7955
Epoch 61/88
----------
train Loss: 0.3558 Acc: 0.7129
val Loss: 0.2689 Acc: 0.7955
Epoch 62/88
----------
train Loss: 0.3141 Acc: 0.8947
val Loss: 0.2677 Acc: 0.8182
Epoch 63/88
----------
train Loss: 0.2741 Acc: 0.9091
val Loss: 0.2677 Acc: 0.7955
Epoch 64/88
----------
train Loss: 0.2635 Acc: 0.9234
val Loss: 0.2653 Acc: 0.7955
Epoch 65/88
----------
train Loss: 0.2963 Acc: 0.7990
val Loss: 0.2653 Acc: 0.7955
Epoch 66/88
----------
train Loss: 0.2866 Acc: 0.8756
val Loss: 0.2688 Acc: 0.7955
Epoch 67/88
----------
train Loss: 0.3174 Acc: 0.8565
val Loss: 0.2623 Acc: 0.7955
Epoch 68/88
----------
train Loss: 0.2689 Acc: 0.9043
val Loss: 0.2651 Acc: 0.8182
Epoch 69/88
----------
train Loss: 0.2705 Acc: 0.8900
val Loss: 0.2643 Acc: 0.7955
Epoch 70/88
----------
train Loss: 0.3011 Acc: 0.8756
val Loss: 0.2671 Acc: 0.7955
Epoch 71/88
----------
train Loss: 0.3165 Acc: 0.8804
val Loss: 0.2647 Acc: 0.7955
Epoch 72/88
----------
train Loss: 0.3176 Acc: 0.8565
val Loss: 0.2698 Acc: 0.7955
Epoch 73/88
----------
train Loss: 0.2249 Acc: 0.9665
val Loss: 0.2718 Acc: 0.7727
Epoch 74/88
----------
train Loss: 0.3306 Acc: 0.8278
val Loss: 0.2660 Acc: 0.7500
Epoch 75/88
----------
train Loss: 0.2496 Acc: 0.9282
val Loss: 0.2668 Acc: 0.7500
Epoch 76/88
----------
train Loss: 0.2737 Acc: 0.7799
val Loss: 0.2639 Acc: 0.7500
Epoch 77/88
----------
train Loss: 0.3037 Acc: 0.8278
val Loss: 0.2617 Acc: 0.7727
Epoch 78/88
----------
train Loss: 0.2636 Acc: 0.8708
val Loss: 0.2597 Acc: 0.7955
Epoch 79/88
----------
train Loss: 0.3270 Acc: 0.8230
val Loss: 0.2550 Acc: 0.7955
Epoch 80/88
----------
train Loss: 0.2859 Acc: 0.8421
val Loss: 0.2540 Acc: 0.8182
Epoch 81/88
----------
train Loss: 0.3264 Acc: 0.7847
val Loss: 0.2623 Acc: 0.7955
Epoch 82/88
----------
train Loss: 0.2830 Acc: 0.8278
val Loss: 0.2637 Acc: 0.7955
Epoch 83/88
----------
train Loss: 0.2423 Acc: 0.9378
val Loss: 0.2647 Acc: 0.7955
Epoch 84/88
----------
train Loss: 0.3244 Acc: 0.7560
val Loss: 0.2636 Acc: 0.7500
Epoch 85/88
----------
train Loss: 0.2604 Acc: 0.8182
val Loss: 0.2646 Acc: 0.7500
Epoch 86/88
----------
train Loss: 0.2693 Acc: 0.8756
val Loss: 0.2563 Acc: 0.7955
Epoch 87/88
----------
train Loss: 0.3043 Acc: 0.8756
val Loss: 0.2541 Acc: 0.8182
Epoch 88/88
----------
train Loss: 0.3144 Acc: 0.8995
[32m[I 2025-06-29 09:44:28,729][0m Trial 152 finished with value: 0.8409090909090909 and parameters: {'batch_size': 14, 'lr': 4.155774405944839e-05, 'num_epochs': 88, 'weight_decay': 0.00044396957262031483, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2512 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_14_lr_4.155774405944839e-05_epoch_88_wd_0.00044396957262031483_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/71
----------
train Loss: 3.8387 Acc: 0.2201
val Loss: 3.7213 Acc: 0.1591
Epoch 2/71
----------
train Loss: 3.8187 Acc: 0.2201
val Loss: 3.7273 Acc: 0.2045
Epoch 3/71
----------
train Loss: 3.8001 Acc: 0.2105
val Loss: 3.6970 Acc: 0.1591
Epoch 4/71
----------
train Loss: 3.8128 Acc: 0.2057
val Loss: 3.7033 Acc: 0.1591
Epoch 5/71
----------
train Loss: 3.8311 Acc: 0.1818
val Loss: 3.7245 Acc: 0.1591
Epoch 6/71
----------
train Loss: 3.8167 Acc: 0.2105
val Loss: 3.7284 Acc: 0.1818
Epoch 7/71
----------
train Loss: 3.8195 Acc: 0.1866
val Loss: 3.7230 Acc: 0.2045
Epoch 8/71
----------
train Loss: 3.7960 Acc: 0.2057
val Loss: 3.7355 Acc: 0.2273
Epoch 9/71
----------
train Loss: 3.8104 Acc: 0.2440
val Loss: 3.7327 Acc: 0.1591
Epoch 10/71
----------
train Loss: 3.7847 Acc: 0.1962
val Loss: 3.7375 Acc: 0.1818
Epoch 11/71
----------
train Loss: 3.7963 Acc: 0.2105
val Loss: 3.7354 Acc: 0.1818
Epoch 12/71
----------
train Loss: 3.7958 Acc: 0.2153
val Loss: 3.7318 Acc: 0.1591
Epoch 13/71
----------
train Loss: 3.7777 Acc: 0.2297
val Loss: 3.7213 Acc: 0.1818
Epoch 14/71
----------
train Loss: 3.7840 Acc: 0.2010
val Loss: 3.7213 Acc: 0.2045
Epoch 15/71
----------
train Loss: 3.7633 Acc: 0.2871
val Loss: 3.7317 Acc: 0.1818
Epoch 16/71
----------
train Loss: 3.7562 Acc: 0.2344
val Loss: 3.7003 Acc: 0.2045
Epoch 17/71
----------
train Loss: 3.7706 Acc: 0.1962
val Loss: 3.7162 Acc: 0.1818
Epoch 18/71
----------
train Loss: 3.7864 Acc: 0.2392
val Loss: 3.7097 Acc: 0.2045
Epoch 19/71
----------
train Loss: 3.7570 Acc: 0.2488
val Loss: 3.6998 Acc: 0.2273
Epoch 20/71
----------
train Loss: 3.7464 Acc: 0.2536
val Loss: 3.7047 Acc: 0.2045
Epoch 21/71
----------
train Loss: 3.7467 Acc: 0.2297
val Loss: 3.7006 Acc: 0.2273
Epoch 22/71
----------
train Loss: 3.7624 Acc: 0.1914
val Loss: 3.7043 Acc: 0.2500
Epoch 23/71
----------
train Loss: 3.7402 Acc: 0.2201
val Loss: 3.6969 Acc: 0.2045
Epoch 24/71
----------
train Loss: 3.7254 Acc: 0.2632
val Loss: 3.6788 Acc: 0.2273
Epoch 25/71
----------
train Loss: 3.7354 Acc: 0.3014
val Loss: 3.6917 Acc: 0.2500
Epoch 26/71
----------
train Loss: 3.7353 Acc: 0.2344
val Loss: 3.6966 Acc: 0.2273
Epoch 27/71
----------
train Loss: 3.7343 Acc: 0.2344
val Loss: 3.6746 Acc: 0.2273
Epoch 28/71
----------
train Loss: 3.7554 Acc: 0.2297
val Loss: 3.6697 Acc: 0.2500
Epoch 29/71
----------
train Loss: 3.7348 Acc: 0.2632
val Loss: 3.6790 Acc: 0.2273
Epoch 30/71
----------
train Loss: 3.7421 Acc: 0.2536
val Loss: 3.6738 Acc: 0.2500
Epoch 31/71
----------
train Loss: 3.7067 Acc: 0.2584
val Loss: 3.6633 Acc: 0.2500
Epoch 32/71
----------
train Loss: 3.7092 Acc: 0.3062
val Loss: 3.6727 Acc: 0.2273
Epoch 33/71
----------
train Loss: 3.7128 Acc: 0.2057
val Loss: 3.6737 Acc: 0.2045
Epoch 34/71
----------
train Loss: 3.7043 Acc: 0.2249
val Loss: 3.6782 Acc: 0.2045
Epoch 35/71
----------
train Loss: 3.6975 Acc: 0.2440
val Loss: 3.6746 Acc: 0.2045
Epoch 36/71
----------
train Loss: 3.7102 Acc: 0.2440
val Loss: 3.6686 Acc: 0.2500
Epoch 37/71
----------
train Loss: 3.7051 Acc: 0.2679
val Loss: 3.6503 Acc: 0.2500
Epoch 38/71
----------
train Loss: 3.6883 Acc: 0.2344
val Loss: 3.6481 Acc: 0.2273
Epoch 39/71
----------
train Loss: 3.6952 Acc: 0.2488
val Loss: 3.6499 Acc: 0.2273
Epoch 40/71
----------
train Loss: 3.6913 Acc: 0.3158
val Loss: 3.6332 Acc: 0.2273
Epoch 41/71
----------
train Loss: 3.6824 Acc: 0.2392
val Loss: 3.6300 Acc: 0.2045
Epoch 42/71
----------
train Loss: 3.6697 Acc: 0.2440
val Loss: 3.6308 Acc: 0.2273
Epoch 43/71
----------
train Loss: 3.6811 Acc: 0.2488
val Loss: 3.6262 Acc: 0.2045
Epoch 44/71
----------
train Loss: 3.6764 Acc: 0.2297
val Loss: 3.6173 Acc: 0.2273
Epoch 45/71
----------
train Loss: 3.6700 Acc: 0.2488
val Loss: 3.6014 Acc: 0.2273
Epoch 46/71
----------
train Loss: 3.6758 Acc: 0.3254
val Loss: 3.6234 Acc: 0.2045
Epoch 47/71
----------
train Loss: 3.6631 Acc: 0.2297
val Loss: 3.6152 Acc: 0.2273
Epoch 48/71
----------
train Loss: 3.6619 Acc: 0.3493
val Loss: 3.5991 Acc: 0.2273
Epoch 49/71
----------
train Loss: 3.6409 Acc: 0.3014
val Loss: 3.6001 Acc: 0.2500
Epoch 50/71
----------
train Loss: 3.6489 Acc: 0.2727
val Loss: 3.5973 Acc: 0.2273
Epoch 51/71
----------
train Loss: 3.6517 Acc: 0.2536
val Loss: 3.5760 Acc: 0.2273
Epoch 52/71
----------
train Loss: 3.6438 Acc: 0.3014
val Loss: 3.5859 Acc: 0.2273
Epoch 53/71
----------
train Loss: 3.6498 Acc: 0.2392
val Loss: 3.5956 Acc: 0.2273
Epoch 54/71
----------
train Loss: 3.6160 Acc: 0.3110
val Loss: 3.5930 Acc: 0.2045
Epoch 55/71
----------
train Loss: 3.6194 Acc: 0.2679
val Loss: 3.5783 Acc: 0.2500
Epoch 56/71
----------
train Loss: 3.6305 Acc: 0.2967
val Loss: 3.5966 Acc: 0.2500
Epoch 57/71
----------
train Loss: 3.6323 Acc: 0.2871
val Loss: 3.5867 Acc: 0.2727
Epoch 58/71
----------
train Loss: 3.6202 Acc: 0.3062
val Loss: 3.5863 Acc: 0.2273
Epoch 59/71
----------
train Loss: 3.5846 Acc: 0.3445
val Loss: 3.5858 Acc: 0.2273
Epoch 60/71
----------
train Loss: 3.6304 Acc: 0.2584
val Loss: 3.5803 Acc: 0.2273
Epoch 61/71
----------
train Loss: 3.6250 Acc: 0.3014
val Loss: 3.5798 Acc: 0.2273
Epoch 62/71
----------
train Loss: 3.5842 Acc: 0.3062
val Loss: 3.5712 Acc: 0.2500
Epoch 63/71
----------
train Loss: 3.5961 Acc: 0.2679
val Loss: 3.5771 Acc: 0.2500
Epoch 64/71
----------
train Loss: 3.5929 Acc: 0.2440
val Loss: 3.5850 Acc: 0.2500
Epoch 65/71
----------
train Loss: 3.5891 Acc: 0.3206
val Loss: 3.5787 Acc: 0.2045
Epoch 66/71
----------
train Loss: 3.6079 Acc: 0.3014
val Loss: 3.5584 Acc: 0.2500
Epoch 67/71
----------
train Loss: 3.6002 Acc: 0.2919
val Loss: 3.5502 Acc: 0.2500
Epoch 68/71
----------
train Loss: 3.5924 Acc: 0.2584
val Loss: 3.5421 Acc: 0.2273
Epoch 69/71
----------
train Loss: 3.6004 Acc: 0.2823
val Loss: 3.5426 Acc: 0.2273
Epoch 70/71
----------
train Loss: 3.5904 Acc: 0.2871
val Loss: 3.5401 Acc: 0.2727
Epoch 71/71
----------
train Loss: 3.5926 Acc: 0.2536
[32m[I 2025-06-29 10:00:39,202][0m Trial 153 finished with value: 0.2272727272727273 and parameters: {'batch_size': 86, 'lr': 1.230653132030311e-06, 'num_epochs': 71, 'weight_decay': 0.010391450481533207, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.5434 Acc: 0.2273
Best val Acc: 0.227273

Model weights saved at ./model_weights/efficientnetb0_bs_86_lr_1.230653132030311e-06_epoch_71_wd_0.010391450481533207_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/75
----------
train Loss: 3.5254 Acc: 0.3254
val Loss: 3.2509 Acc: 0.5682
Epoch 2/75
----------
train Loss: 2.8999 Acc: 0.5263
val Loss: 2.6003 Acc: 0.6364
Epoch 3/75
----------
train Loss: 2.5137 Acc: 0.5024
val Loss: 2.1185 Acc: 0.6364
Epoch 4/75
----------
train Loss: 2.3467 Acc: 0.4976
val Loss: 1.9987 Acc: 0.6591
Epoch 5/75
----------
train Loss: 2.2707 Acc: 0.5311
val Loss: 1.9296 Acc: 0.6818
Epoch 6/75
----------
train Loss: 2.1297 Acc: 0.5550
val Loss: 1.8803 Acc: 0.7045
Epoch 7/75
----------
train Loss: 2.0063 Acc: 0.6124
val Loss: 1.8951 Acc: 0.7273
Epoch 8/75
----------
train Loss: 2.0635 Acc: 0.6077
val Loss: 1.7365 Acc: 0.7955
Epoch 9/75
----------
train Loss: 1.9861 Acc: 0.6842
val Loss: 1.7454 Acc: 0.7955
Epoch 10/75
----------
train Loss: 1.5092 Acc: 0.8660
val Loss: 1.5805 Acc: 0.7500
Epoch 11/75
----------
train Loss: 1.8091 Acc: 0.7129
val Loss: 1.4252 Acc: 0.7955
Epoch 12/75
----------
train Loss: 1.7424 Acc: 0.6890
val Loss: 1.5570 Acc: 0.7727
Epoch 13/75
----------
train Loss: 1.4860 Acc: 0.8660
val Loss: 1.4206 Acc: 0.7727
Epoch 14/75
----------
train Loss: 1.3625 Acc: 0.8038
val Loss: 1.5197 Acc: 0.7045
Epoch 15/75
----------
train Loss: 1.5180 Acc: 0.7799
val Loss: 1.3852 Acc: 0.7500
Epoch 16/75
----------
train Loss: 1.5139 Acc: 0.7751
val Loss: 1.5370 Acc: 0.7500
Epoch 17/75
----------
train Loss: 1.4516 Acc: 0.8373
val Loss: 1.6854 Acc: 0.7727
Epoch 18/75
----------
train Loss: 1.3976 Acc: 0.8373
val Loss: 1.4495 Acc: 0.7955
Epoch 19/75
----------
train Loss: 1.2677 Acc: 0.9282
val Loss: 1.3270 Acc: 0.7500
Epoch 20/75
----------
train Loss: 1.3928 Acc: 0.8469
val Loss: 1.2710 Acc: 0.7045
Epoch 21/75
----------
train Loss: 1.4593 Acc: 0.8756
val Loss: 1.2773 Acc: 0.7727
Epoch 22/75
----------
train Loss: 1.3215 Acc: 0.8612
val Loss: 1.3860 Acc: 0.7727
Epoch 23/75
----------
train Loss: 1.4888 Acc: 0.8660
val Loss: 1.4800 Acc: 0.8409
Epoch 24/75
----------
train Loss: 1.1051 Acc: 0.9139
val Loss: 1.3450 Acc: 0.7727
Epoch 25/75
----------
train Loss: 1.3124 Acc: 0.9282
val Loss: 1.5598 Acc: 0.7727
Epoch 26/75
----------
train Loss: 1.4647 Acc: 0.9139
val Loss: 1.3909 Acc: 0.7727
Epoch 27/75
----------
train Loss: 1.1972 Acc: 0.9617
val Loss: 1.4167 Acc: 0.7955
Epoch 28/75
----------
train Loss: 1.4004 Acc: 0.8612
val Loss: 1.3739 Acc: 0.7500
Epoch 29/75
----------
train Loss: 1.4821 Acc: 0.8038
val Loss: 1.4209 Acc: 0.7955
Epoch 30/75
----------
train Loss: 1.3061 Acc: 0.8565
val Loss: 1.2752 Acc: 0.7727
Epoch 31/75
----------
train Loss: 1.1397 Acc: 0.9330
val Loss: 1.2546 Acc: 0.7727
Epoch 32/75
----------
train Loss: 1.2895 Acc: 0.8947
val Loss: 1.1735 Acc: 0.7955
Epoch 33/75
----------
train Loss: 1.3986 Acc: 0.8804
val Loss: 1.2047 Acc: 0.7955
Epoch 34/75
----------
train Loss: 1.3098 Acc: 0.9378
val Loss: 1.3710 Acc: 0.7273
Epoch 35/75
----------
train Loss: 1.0220 Acc: 0.9522
val Loss: 1.3605 Acc: 0.7727
Epoch 36/75
----------
train Loss: 1.6005 Acc: 0.8660
val Loss: 1.3349 Acc: 0.7500
Epoch 37/75
----------
train Loss: 1.3622 Acc: 0.7990
val Loss: 1.6228 Acc: 0.7045
Epoch 38/75
----------
train Loss: 1.4381 Acc: 0.9282
val Loss: 1.4223 Acc: 0.7273
Epoch 39/75
----------
train Loss: 1.4050 Acc: 0.7703
val Loss: 1.6135 Acc: 0.7955
Epoch 40/75
----------
train Loss: 1.2472 Acc: 0.9187
val Loss: 1.3603 Acc: 0.7273
Epoch 41/75
----------
train Loss: 1.6290 Acc: 0.7129
val Loss: 1.3229 Acc: 0.7273
Epoch 42/75
----------
train Loss: 1.2601 Acc: 0.8565
val Loss: 1.4290 Acc: 0.7500
Epoch 43/75
----------
train Loss: 1.3379 Acc: 0.8804
val Loss: 1.2759 Acc: 0.7500
Epoch 44/75
----------
train Loss: 1.2609 Acc: 0.8804
val Loss: 1.3851 Acc: 0.7955
Epoch 45/75
----------
train Loss: 0.8200 Acc: 0.9617
val Loss: 1.3121 Acc: 0.7727
Epoch 46/75
----------
train Loss: 1.6675 Acc: 0.8469
val Loss: 1.4573 Acc: 0.7273
Epoch 47/75
----------
train Loss: 1.2605 Acc: 0.8995
val Loss: 1.5251 Acc: 0.7273
Epoch 48/75
----------
train Loss: 1.3555 Acc: 0.8852
val Loss: 1.4847 Acc: 0.7955
Epoch 49/75
----------
train Loss: 1.3215 Acc: 0.9426
val Loss: 1.4828 Acc: 0.8182
Epoch 50/75
----------
train Loss: 1.3045 Acc: 0.8612
val Loss: 1.4205 Acc: 0.7955
Epoch 51/75
----------
train Loss: 1.0130 Acc: 0.9809
val Loss: 1.2318 Acc: 0.7955
Epoch 52/75
----------
train Loss: 1.3273 Acc: 0.8469
val Loss: 1.1839 Acc: 0.7727
Epoch 53/75
----------
train Loss: 1.5254 Acc: 0.9187
val Loss: 1.3596 Acc: 0.7273
Epoch 54/75
----------
train Loss: 1.2197 Acc: 0.9330
val Loss: 1.5808 Acc: 0.7500
Epoch 55/75
----------
train Loss: 1.2670 Acc: 0.9426
val Loss: 1.5677 Acc: 0.7500
Epoch 56/75
----------
train Loss: 1.4406 Acc: 0.8756
val Loss: 1.3812 Acc: 0.7727
Epoch 57/75
----------
train Loss: 1.5878 Acc: 0.8086
val Loss: 1.6393 Acc: 0.6818
Epoch 58/75
----------
train Loss: 1.3368 Acc: 0.8278
val Loss: 1.2878 Acc: 0.7727
Epoch 59/75
----------
train Loss: 1.3609 Acc: 0.8804
val Loss: 1.4552 Acc: 0.7045
Epoch 60/75
----------
train Loss: 1.1305 Acc: 0.9139
val Loss: 1.4226 Acc: 0.7273
Epoch 61/75
----------
train Loss: 1.5552 Acc: 0.7703
val Loss: 1.4736 Acc: 0.7045
Epoch 62/75
----------
train Loss: 1.5307 Acc: 0.9139
val Loss: 1.5671 Acc: 0.6591
Epoch 63/75
----------
train Loss: 1.3102 Acc: 0.9187
val Loss: 1.4666 Acc: 0.7045
Epoch 64/75
----------
train Loss: 1.1830 Acc: 0.9426
val Loss: 1.3882 Acc: 0.7500
Epoch 65/75
----------
train Loss: 1.3421 Acc: 0.8612
val Loss: 1.5797 Acc: 0.7045
Epoch 66/75
----------
train Loss: 1.3081 Acc: 0.9139
val Loss: 1.5193 Acc: 0.7727
Epoch 67/75
----------
train Loss: 1.4763 Acc: 0.8565
val Loss: 1.4706 Acc: 0.7500
Epoch 68/75
----------
train Loss: 1.2378 Acc: 0.8756
val Loss: 1.6802 Acc: 0.7727
Epoch 69/75
----------
train Loss: 1.2152 Acc: 0.8756
val Loss: 1.3069 Acc: 0.7500
Epoch 70/75
----------
train Loss: 1.3669 Acc: 0.8804
val Loss: 1.2105 Acc: 0.7727
Epoch 71/75
----------
train Loss: 1.4338 Acc: 0.8947
val Loss: 1.3508 Acc: 0.7273
Epoch 72/75
----------
train Loss: 1.4418 Acc: 0.8660
val Loss: 1.4565 Acc: 0.7500
Epoch 73/75
----------
train Loss: 1.0289 Acc: 0.9426
val Loss: 1.4376 Acc: 0.7727
Epoch 74/75
----------
train Loss: 1.4762 Acc: 0.8086
val Loss: 1.4175 Acc: 0.7955
Epoch 75/75
----------
train Loss: 1.1542 Acc: 0.9665
[32m[I 2025-06-29 10:17:43,296][0m Trial 154 finished with value: 0.8409090909090909 and parameters: {'batch_size': 86, 'lr': 0.0003184076899136745, 'num_epochs': 75, 'weight_decay': 0.028415964352179364, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4343 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_86_lr_0.0003184076899136745_epoch_75_wd_0.028415964352179364_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 0.6124 Acc: 0.3732
val Loss: 0.4864 Acc: 0.6364
Epoch 2/87
----------
train Loss: 0.4816 Acc: 0.5837
val Loss: 0.3588 Acc: 0.6364
Epoch 3/87
----------
train Loss: 0.4297 Acc: 0.6364
val Loss: 0.3084 Acc: 0.7045
Epoch 4/87
----------
train Loss: 0.4019 Acc: 0.6316
val Loss: 0.2958 Acc: 0.7500
Epoch 5/87
----------
train Loss: 0.3869 Acc: 0.7751
val Loss: 0.2890 Acc: 0.7500
Epoch 6/87
----------
train Loss: 0.3562 Acc: 0.7368
val Loss: 0.2460 Acc: 0.8409
Epoch 7/87
----------
train Loss: 0.3157 Acc: 0.8660
val Loss: 0.2442 Acc: 0.7727
Epoch 8/87
----------
train Loss: 0.3367 Acc: 0.8278
val Loss: 0.2436 Acc: 0.7955
Epoch 9/87
----------
train Loss: 0.3440 Acc: 0.7895
val Loss: 0.3211 Acc: 0.7500
Epoch 10/87
----------
train Loss: 0.2182 Acc: 0.9474
val Loss: 0.2369 Acc: 0.7955
Epoch 11/87
----------
train Loss: 0.3354 Acc: 0.7943
val Loss: 0.2293 Acc: 0.7727
Epoch 12/87
----------
train Loss: 0.2855 Acc: 0.8038
val Loss: 0.3278 Acc: 0.6591
Epoch 13/87
----------
train Loss: 0.2810 Acc: 0.9091
val Loss: 0.2964 Acc: 0.7955
Epoch 14/87
----------
train Loss: 0.2548 Acc: 0.8230
val Loss: 0.3505 Acc: 0.7273
Epoch 15/87
----------
train Loss: 0.2844 Acc: 0.8373
val Loss: 0.3001 Acc: 0.7727
Epoch 16/87
----------
train Loss: 0.2885 Acc: 0.8469
val Loss: 0.3143 Acc: 0.7045
Epoch 17/87
----------
train Loss: 0.2748 Acc: 0.8756
val Loss: 0.3021 Acc: 0.7727
Epoch 18/87
----------
train Loss: 0.2664 Acc: 0.8517
val Loss: 0.2361 Acc: 0.8409
Epoch 19/87
----------
train Loss: 0.2439 Acc: 0.9330
val Loss: 0.2429 Acc: 0.8409
Epoch 20/87
----------
train Loss: 0.2665 Acc: 0.9282
val Loss: 0.2445 Acc: 0.8182
Epoch 21/87
----------
train Loss: 0.2861 Acc: 0.8900
val Loss: 0.2320 Acc: 0.8409
Epoch 22/87
----------
train Loss: 0.2600 Acc: 0.8756
val Loss: 0.2292 Acc: 0.8409
Epoch 23/87
----------
train Loss: 0.2921 Acc: 0.8660
val Loss: 0.2448 Acc: 0.7727
Epoch 24/87
----------
train Loss: 0.2217 Acc: 0.9139
val Loss: 0.2392 Acc: 0.7955
Epoch 25/87
----------
train Loss: 0.2515 Acc: 0.9522
val Loss: 0.2478 Acc: 0.7727
Epoch 26/87
----------
train Loss: 0.2820 Acc: 0.9522
val Loss: 0.2405 Acc: 0.7727
Epoch 27/87
----------
train Loss: 0.2319 Acc: 0.9856
val Loss: 0.2663 Acc: 0.7955
Epoch 28/87
----------
train Loss: 0.2774 Acc: 0.8517
val Loss: 0.2618 Acc: 0.8182
Epoch 29/87
----------
train Loss: 0.3064 Acc: 0.7703
val Loss: 0.2487 Acc: 0.7955
Epoch 30/87
----------
train Loss: 0.2546 Acc: 0.8804
val Loss: 0.2625 Acc: 0.7727
Epoch 31/87
----------
train Loss: 0.2232 Acc: 0.9474
val Loss: 0.2488 Acc: 0.7273
Epoch 32/87
----------
train Loss: 0.2403 Acc: 0.9234
val Loss: 0.2430 Acc: 0.8409
Epoch 33/87
----------
train Loss: 0.2667 Acc: 0.9139
val Loss: 0.2485 Acc: 0.7727
Epoch 34/87
----------
train Loss: 0.2576 Acc: 0.9569
val Loss: 0.2912 Acc: 0.7727
Epoch 35/87
----------
train Loss: 0.2062 Acc: 0.9761
val Loss: 0.2740 Acc: 0.6818
Epoch 36/87
----------
train Loss: 0.3151 Acc: 0.8565
val Loss: 0.2562 Acc: 0.7955
Epoch 37/87
----------
train Loss: 0.2686 Acc: 0.8421
val Loss: 0.2759 Acc: 0.7500
Epoch 38/87
----------
train Loss: 0.2700 Acc: 0.9713
val Loss: 0.2738 Acc: 0.7273
Epoch 39/87
----------
train Loss: 0.2692 Acc: 0.7847
val Loss: 0.2779 Acc: 0.7955
Epoch 40/87
----------
train Loss: 0.2378 Acc: 0.9522
val Loss: 0.2868 Acc: 0.7500
Epoch 41/87
----------
train Loss: 0.3134 Acc: 0.7081
val Loss: 0.2981 Acc: 0.7727
Epoch 42/87
----------
train Loss: 0.2306 Acc: 0.8804
val Loss: 0.3085 Acc: 0.7500
Epoch 43/87
----------
train Loss: 0.2561 Acc: 0.8995
val Loss: 0.2994 Acc: 0.7273
Epoch 44/87
----------
train Loss: 0.2451 Acc: 0.8756
val Loss: 0.3169 Acc: 0.7955
Epoch 45/87
----------
train Loss: 0.1586 Acc: 0.9713
val Loss: 0.2704 Acc: 0.7727
Epoch 46/87
----------
train Loss: 0.3370 Acc: 0.8373
val Loss: 0.2890 Acc: 0.7500
Epoch 47/87
----------
train Loss: 0.2389 Acc: 0.9282
val Loss: 0.3023 Acc: 0.6591
Epoch 48/87
----------
train Loss: 0.2731 Acc: 0.8612
val Loss: 0.3562 Acc: 0.6364
Epoch 49/87
----------
train Loss: 0.2671 Acc: 0.9474
val Loss: 0.3018 Acc: 0.6818
Epoch 50/87
----------
train Loss: 0.2499 Acc: 0.8852
val Loss: 0.2890 Acc: 0.7500
Epoch 51/87
----------
train Loss: 0.2006 Acc: 0.9856
val Loss: 0.2430 Acc: 0.7727
Epoch 52/87
----------
train Loss: 0.2654 Acc: 0.8230
val Loss: 0.2572 Acc: 0.7500
Epoch 53/87
----------
train Loss: 0.2963 Acc: 0.9043
val Loss: 0.2969 Acc: 0.6818
Epoch 54/87
----------
train Loss: 0.2250 Acc: 0.9234
val Loss: 0.2846 Acc: 0.7045
Epoch 55/87
----------
train Loss: 0.2378 Acc: 0.9522
val Loss: 0.3084 Acc: 0.7045
Epoch 56/87
----------
train Loss: 0.2774 Acc: 0.9378
val Loss: 0.2932 Acc: 0.6818
Epoch 57/87
----------
train Loss: 0.3072 Acc: 0.8612
val Loss: 0.2932 Acc: 0.7273
Epoch 58/87
----------
train Loss: 0.2469 Acc: 0.8421
val Loss: 0.3230 Acc: 0.7045
Epoch 59/87
----------
train Loss: 0.2603 Acc: 0.9282
val Loss: 0.3354 Acc: 0.6818
Epoch 60/87
----------
train Loss: 0.2109 Acc: 0.9282
val Loss: 0.3043 Acc: 0.7500
Epoch 61/87
----------
train Loss: 0.2981 Acc: 0.8182
val Loss: 0.3074 Acc: 0.7045
Epoch 62/87
----------
train Loss: 0.2844 Acc: 0.9282
val Loss: 0.3258 Acc: 0.5909
Epoch 63/87
----------
train Loss: 0.2473 Acc: 0.9474
val Loss: 0.3217 Acc: 0.7273
Epoch 64/87
----------
train Loss: 0.2277 Acc: 0.9522
val Loss: 0.3277 Acc: 0.6818
Epoch 65/87
----------
train Loss: 0.2453 Acc: 0.9139
val Loss: 0.3022 Acc: 0.7045
Epoch 66/87
----------
train Loss: 0.2484 Acc: 0.9091
val Loss: 0.3664 Acc: 0.7045
Epoch 67/87
----------
train Loss: 0.2863 Acc: 0.8804
val Loss: 0.3033 Acc: 0.7727
Epoch 68/87
----------
train Loss: 0.2453 Acc: 0.8995
val Loss: 0.2658 Acc: 0.7727
Epoch 69/87
----------
train Loss: 0.2311 Acc: 0.8660
val Loss: 0.2731 Acc: 0.7273
Epoch 70/87
----------
train Loss: 0.2660 Acc: 0.9139
val Loss: 0.2810 Acc: 0.7500
Epoch 71/87
----------
train Loss: 0.2788 Acc: 0.8947
val Loss: 0.2896 Acc: 0.7727
Epoch 72/87
----------
train Loss: 0.2732 Acc: 0.8708
val Loss: 0.3368 Acc: 0.7955
Epoch 73/87
----------
train Loss: 0.2023 Acc: 0.9713
val Loss: 0.2918 Acc: 0.7727
Epoch 74/87
----------
train Loss: 0.2870 Acc: 0.8612
val Loss: 0.2844 Acc: 0.7273
Epoch 75/87
----------
train Loss: 0.2143 Acc: 0.9952
val Loss: 0.2721 Acc: 0.7500
Epoch 76/87
----------
train Loss: 0.2187 Acc: 0.8852
val Loss: 0.2893 Acc: 0.7727
Epoch 77/87
----------
train Loss: 0.2798 Acc: 0.8660
val Loss: 0.3215 Acc: 0.7273
Epoch 78/87
----------
train Loss: 0.2487 Acc: 0.9282
val Loss: 0.2827 Acc: 0.7500
Epoch 79/87
----------
train Loss: 0.2786 Acc: 0.9139
val Loss: 0.2489 Acc: 0.7727
Epoch 80/87
----------
train Loss: 0.2596 Acc: 0.8708
val Loss: 0.3027 Acc: 0.7500
Epoch 81/87
----------
train Loss: 0.2951 Acc: 0.7751
val Loss: 0.3147 Acc: 0.7273
Epoch 82/87
----------
train Loss: 0.2591 Acc: 0.8900
val Loss: 0.2893 Acc: 0.7955
Epoch 83/87
----------
train Loss: 0.2248 Acc: 0.9809
val Loss: 0.2889 Acc: 0.7273
Epoch 84/87
----------
train Loss: 0.2802 Acc: 0.8230
val Loss: 0.3307 Acc: 0.7045
Epoch 85/87
----------
train Loss: 0.2249 Acc: 0.9187
val Loss: 0.3376 Acc: 0.7045
Epoch 86/87
----------
train Loss: 0.2359 Acc: 0.9091
val Loss: 0.2909 Acc: 0.7045
Epoch 87/87
----------
train Loss: 0.2715 Acc: 0.9426
[32m[I 2025-06-29 10:37:32,062][0m Trial 155 finished with value: 0.7954545454545455 and parameters: {'batch_size': 76, 'lr': 0.0006108352749430553, 'num_epochs': 87, 'weight_decay': 0.0005237271843079001, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2918 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_76_lr_0.0006108352749430553_epoch_87_wd_0.0005237271843079001_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/73
----------
train Loss: 3.4278 Acc: 0.3493
val Loss: 3.0575 Acc: 0.6136
Epoch 2/73
----------
train Loss: 2.6845 Acc: 0.5263
val Loss: 2.1626 Acc: 0.6364
Epoch 3/73
----------
train Loss: 2.3253 Acc: 0.5024
val Loss: 1.9215 Acc: 0.6364
Epoch 4/73
----------
train Loss: 2.2134 Acc: 0.5120
val Loss: 1.8804 Acc: 0.7045
Epoch 5/73
----------
train Loss: 2.1425 Acc: 0.6172
val Loss: 1.8058 Acc: 0.7727
Epoch 6/73
----------
train Loss: 1.9640 Acc: 0.6364
val Loss: 1.7197 Acc: 0.8182
Epoch 7/73
----------
train Loss: 1.8030 Acc: 0.7033
val Loss: 1.6500 Acc: 0.8182
Epoch 8/73
----------
train Loss: 1.8628 Acc: 0.7177
val Loss: 1.4951 Acc: 0.7955
Epoch 9/73
----------
train Loss: 1.7888 Acc: 0.7608
val Loss: 1.5945 Acc: 0.7500
Epoch 10/73
----------
train Loss: 1.1948 Acc: 0.9330
val Loss: 1.3616 Acc: 0.7955
Epoch 11/73
----------
train Loss: 1.6882 Acc: 0.7751
val Loss: 1.1910 Acc: 0.8636
Epoch 12/73
----------
train Loss: 1.5344 Acc: 0.7416
val Loss: 1.6183 Acc: 0.8182
Epoch 13/73
----------
train Loss: 1.3365 Acc: 0.8947
val Loss: 1.5348 Acc: 0.7500
Epoch 14/73
----------
train Loss: 1.2614 Acc: 0.8325
val Loss: 1.4776 Acc: 0.7273
Epoch 15/73
----------
train Loss: 1.4100 Acc: 0.8086
val Loss: 1.1696 Acc: 0.7727
Epoch 16/73
----------
train Loss: 1.5113 Acc: 0.7943
val Loss: 1.4379 Acc: 0.7500
Epoch 17/73
----------
train Loss: 1.4296 Acc: 0.8804
val Loss: 1.5170 Acc: 0.8636
Epoch 18/73
----------
train Loss: 1.3508 Acc: 0.8325
val Loss: 1.3860 Acc: 0.8182
Epoch 19/73
----------
train Loss: 1.2219 Acc: 0.9426
val Loss: 1.3163 Acc: 0.7955
Epoch 20/73
----------
train Loss: 1.3556 Acc: 0.8660
val Loss: 1.2291 Acc: 0.7500
Epoch 21/73
----------
train Loss: 1.4417 Acc: 0.8708
val Loss: 1.2044 Acc: 0.8182
Epoch 22/73
----------
train Loss: 1.2713 Acc: 0.8900
val Loss: 1.3036 Acc: 0.8409
Epoch 23/73
----------
train Loss: 1.4925 Acc: 0.8612
val Loss: 1.3101 Acc: 0.8182
Epoch 24/73
----------
train Loss: 1.1272 Acc: 0.9091
val Loss: 1.2125 Acc: 0.8182
Epoch 25/73
----------
train Loss: 1.2818 Acc: 0.9378
val Loss: 1.4358 Acc: 0.7727
Epoch 26/73
----------
train Loss: 1.4466 Acc: 0.9378
val Loss: 1.3921 Acc: 0.7727
Epoch 27/73
----------
train Loss: 1.1747 Acc: 0.9617
val Loss: 1.4382 Acc: 0.7727
Epoch 28/73
----------
train Loss: 1.3772 Acc: 0.8612
val Loss: 1.2207 Acc: 0.7727
Epoch 29/73
----------
train Loss: 1.5017 Acc: 0.7990
val Loss: 1.2290 Acc: 0.8864
Epoch 30/73
----------
train Loss: 1.3064 Acc: 0.8660
val Loss: 1.0830 Acc: 0.8864
Epoch 31/73
----------
train Loss: 1.1261 Acc: 0.9330
val Loss: 1.0705 Acc: 0.8409
Epoch 32/73
----------
train Loss: 1.2440 Acc: 0.9091
val Loss: 1.1509 Acc: 0.7955
Epoch 33/73
----------
train Loss: 1.3825 Acc: 0.9043
val Loss: 1.2183 Acc: 0.8182
Epoch 34/73
----------
train Loss: 1.3133 Acc: 0.9330
val Loss: 1.2871 Acc: 0.7273
Epoch 35/73
----------
train Loss: 0.9986 Acc: 0.9617
val Loss: 1.2521 Acc: 0.7273
Epoch 36/73
----------
train Loss: 1.5753 Acc: 0.8612
val Loss: 1.3207 Acc: 0.7727
Epoch 37/73
----------
train Loss: 1.3738 Acc: 0.8182
val Loss: 1.4550 Acc: 0.7955
Epoch 38/73
----------
train Loss: 1.4678 Acc: 0.9330
val Loss: 1.2906 Acc: 0.7727
Epoch 39/73
----------
train Loss: 1.3634 Acc: 0.7751
val Loss: 1.7965 Acc: 0.7500
Epoch 40/73
----------
train Loss: 1.2406 Acc: 0.8947
val Loss: 1.3925 Acc: 0.7500
Epoch 41/73
----------
train Loss: 1.5937 Acc: 0.7033
val Loss: 1.3027 Acc: 0.7045
Epoch 42/73
----------
train Loss: 1.2432 Acc: 0.8469
val Loss: 1.4942 Acc: 0.6818
Epoch 43/73
----------
train Loss: 1.3067 Acc: 0.8565
val Loss: 1.3885 Acc: 0.7045
Epoch 44/73
----------
train Loss: 1.2394 Acc: 0.8708
val Loss: 1.3885 Acc: 0.7500
Epoch 45/73
----------
train Loss: 0.8292 Acc: 0.9569
val Loss: 1.2264 Acc: 0.7727
Epoch 46/73
----------
train Loss: 1.7040 Acc: 0.8325
val Loss: 1.4767 Acc: 0.7273
Epoch 47/73
----------
train Loss: 1.2832 Acc: 0.8995
val Loss: 1.5465 Acc: 0.7273
Epoch 48/73
----------
train Loss: 1.3782 Acc: 0.8325
val Loss: 1.8093 Acc: 0.6818
Epoch 49/73
----------
train Loss: 1.3275 Acc: 0.9330
val Loss: 1.6614 Acc: 0.7273
Epoch 50/73
----------
train Loss: 1.3132 Acc: 0.8612
val Loss: 1.7158 Acc: 0.7955
Epoch 51/73
----------
train Loss: 0.9891 Acc: 0.9713
val Loss: 1.4435 Acc: 0.7045
Epoch 52/73
----------
train Loss: 1.3456 Acc: 0.8517
val Loss: 1.2346 Acc: 0.7727
Epoch 53/73
----------
train Loss: 1.5396 Acc: 0.9330
val Loss: 1.4281 Acc: 0.7727
Epoch 54/73
----------
train Loss: 1.2237 Acc: 0.9378
val Loss: 1.4695 Acc: 0.7727
Epoch 55/73
----------
train Loss: 1.2574 Acc: 0.9426
val Loss: 1.5452 Acc: 0.7500
Epoch 56/73
----------
train Loss: 1.3979 Acc: 0.8756
val Loss: 1.3465 Acc: 0.7500
Epoch 57/73
----------
train Loss: 1.5736 Acc: 0.8038
val Loss: 1.5251 Acc: 0.7273
Epoch 58/73
----------
train Loss: 1.2619 Acc: 0.8134
val Loss: 1.3730 Acc: 0.7727
Epoch 59/73
----------
train Loss: 1.3378 Acc: 0.9043
val Loss: 1.5713 Acc: 0.6818
Epoch 60/73
----------
train Loss: 1.0803 Acc: 0.9091
val Loss: 1.5560 Acc: 0.6591
Epoch 61/73
----------
train Loss: 1.5279 Acc: 0.7751
val Loss: 1.5845 Acc: 0.6591
Epoch 62/73
----------
train Loss: 1.4489 Acc: 0.9378
val Loss: 1.6317 Acc: 0.7273
Epoch 63/73
----------
train Loss: 1.2846 Acc: 0.9522
val Loss: 1.6174 Acc: 0.7500
Epoch 64/73
----------
train Loss: 1.1069 Acc: 0.9474
val Loss: 1.6808 Acc: 0.7045
Epoch 65/73
----------
train Loss: 1.2730 Acc: 0.8852
val Loss: 1.4533 Acc: 0.7727
Epoch 66/73
----------
train Loss: 1.3001 Acc: 0.8804
val Loss: 1.6427 Acc: 0.7500
Epoch 67/73
----------
train Loss: 1.4780 Acc: 0.8612
val Loss: 1.5200 Acc: 0.7727
Epoch 68/73
----------
train Loss: 1.1825 Acc: 0.8756
val Loss: 1.8209 Acc: 0.7045
Epoch 69/73
----------
train Loss: 1.1591 Acc: 0.8756
val Loss: 1.3892 Acc: 0.7955
Epoch 70/73
----------
train Loss: 1.3002 Acc: 0.9043
val Loss: 1.5270 Acc: 0.7273
Epoch 71/73
----------
train Loss: 1.3909 Acc: 0.8947
val Loss: 1.3271 Acc: 0.7955
Epoch 72/73
----------
train Loss: 1.4403 Acc: 0.8708
val Loss: 1.4941 Acc: 0.7045
Epoch 73/73
----------
train Loss: 1.0410 Acc: 0.9330
[32m[I 2025-06-29 10:54:11,134][0m Trial 156 finished with value: 0.75 and parameters: {'batch_size': 90, 'lr': 0.00041083293803504913, 'num_epochs': 73, 'weight_decay': 0.018300670214267425, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5828 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_90_lr_0.00041083293803504913_epoch_73_wd_0.018300670214267425_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 1.3506 Acc: 0.3397
val Loss: 1.1724 Acc: 0.6818
Epoch 2/84
----------
train Loss: 0.9406 Acc: 0.7799
val Loss: 0.9131 Acc: 0.6818
Epoch 3/84
----------
train Loss: 0.6644 Acc: 0.8756
val Loss: 0.8000 Acc: 0.7045
Epoch 4/84
----------
train Loss: 0.4505 Acc: 0.9474
val Loss: 0.7311 Acc: 0.7500
Epoch 5/84
----------
train Loss: 0.2946 Acc: 0.9952
val Loss: 0.6692 Acc: 0.7727
Epoch 6/84
----------
train Loss: 0.2006 Acc: 0.9952
val Loss: 0.6277 Acc: 0.8182
Epoch 7/84
----------
train Loss: 0.1090 Acc: 1.0000
val Loss: 0.6231 Acc: 0.8182
Epoch 8/84
----------
train Loss: 0.0661 Acc: 1.0000
val Loss: 0.6289 Acc: 0.7727
Epoch 9/84
----------
train Loss: 0.0526 Acc: 0.9952
val Loss: 0.6519 Acc: 0.7727
Epoch 10/84
----------
train Loss: 0.0397 Acc: 0.9952
val Loss: 0.6633 Acc: 0.7955
Epoch 11/84
----------
train Loss: 0.0301 Acc: 1.0000
val Loss: 0.6457 Acc: 0.8182
Epoch 12/84
----------
train Loss: 0.0222 Acc: 1.0000
val Loss: 0.6239 Acc: 0.8182
Epoch 13/84
----------
train Loss: 0.0314 Acc: 0.9952
val Loss: 0.6730 Acc: 0.7955
Epoch 14/84
----------
train Loss: 0.0359 Acc: 0.9904
val Loss: 0.6759 Acc: 0.7955
Epoch 15/84
----------
train Loss: 0.0178 Acc: 1.0000
val Loss: 0.6601 Acc: 0.7955
Epoch 16/84
----------
train Loss: 0.0110 Acc: 1.0000
val Loss: 0.6475 Acc: 0.7955
Epoch 17/84
----------
train Loss: 0.0130 Acc: 1.0000
val Loss: 0.6356 Acc: 0.7955
Epoch 18/84
----------
train Loss: 0.0084 Acc: 1.0000
val Loss: 0.6736 Acc: 0.7955
Epoch 19/84
----------
train Loss: 0.0392 Acc: 0.9904
val Loss: 0.6172 Acc: 0.7955
Epoch 20/84
----------
train Loss: 0.0297 Acc: 0.9952
val Loss: 0.6612 Acc: 0.7500
Epoch 21/84
----------
train Loss: 0.0224 Acc: 0.9952
val Loss: 0.7510 Acc: 0.7273
Epoch 22/84
----------
train Loss: 0.0135 Acc: 1.0000
val Loss: 0.8408 Acc: 0.7500
Epoch 23/84
----------
train Loss: 0.0206 Acc: 0.9904
val Loss: 0.8595 Acc: 0.7727
Epoch 24/84
----------
train Loss: 0.0078 Acc: 1.0000
val Loss: 0.8288 Acc: 0.7500
Epoch 25/84
----------
train Loss: 0.0114 Acc: 1.0000
val Loss: 0.7964 Acc: 0.7727
Epoch 26/84
----------
train Loss: 0.0176 Acc: 0.9952
val Loss: 0.8917 Acc: 0.7273
Epoch 27/84
----------
train Loss: 0.0110 Acc: 0.9952
val Loss: 0.9613 Acc: 0.7273
Epoch 28/84
----------
train Loss: 0.0207 Acc: 0.9952
val Loss: 0.9252 Acc: 0.7500
Epoch 29/84
----------
train Loss: 0.0241 Acc: 1.0000
val Loss: 0.7749 Acc: 0.7955
Epoch 30/84
----------
train Loss: 0.0201 Acc: 0.9952
val Loss: 0.7339 Acc: 0.8409
Epoch 31/84
----------
train Loss: 0.0151 Acc: 0.9904
val Loss: 0.8223 Acc: 0.8409
Epoch 32/84
----------
train Loss: 0.0148 Acc: 1.0000
val Loss: 0.8956 Acc: 0.7500
Epoch 33/84
----------
train Loss: 0.0364 Acc: 0.9856
val Loss: 0.8979 Acc: 0.7727
Epoch 34/84
----------
train Loss: 0.0275 Acc: 0.9904
val Loss: 0.9148 Acc: 0.7500
Epoch 35/84
----------
train Loss: 0.0367 Acc: 0.9904
val Loss: 1.0503 Acc: 0.7045
Epoch 36/84
----------
train Loss: 0.0433 Acc: 0.9809
[32m[I 2025-06-29 11:02:23,378][0m Trial 157 finished with value: 0.8409090909090909 and parameters: {'batch_size': 70, 'lr': 0.0002537948002312315, 'num_epochs': 84, 'weight_decay': 0.0009261496941586785, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.1287 Acc: 0.7500
Early stopping at epoch 36 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_70_lr_0.0002537948002312315_epoch_84_wd_0.0009261496941586785_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 0.6347 Acc: 0.3636
val Loss: 0.6008 Acc: 0.5909
Epoch 2/92
----------
train Loss: 0.5241 Acc: 0.5072
val Loss: 0.5176 Acc: 0.6136
Epoch 3/92
----------
train Loss: 0.4842 Acc: 0.5072
val Loss: 0.4935 Acc: 0.6364
Epoch 4/92
----------
train Loss: 0.4652 Acc: 0.5167
val Loss: 0.5083 Acc: 0.6591
Epoch 5/92
----------
train Loss: 0.4485 Acc: 0.5981
val Loss: 0.5023 Acc: 0.7500
Epoch 6/92
----------
train Loss: 0.4218 Acc: 0.6172
val Loss: 0.5065 Acc: 0.7500
Epoch 7/92
----------
train Loss: 0.3818 Acc: 0.6986
val Loss: 0.5074 Acc: 0.6818
Epoch 8/92
----------
train Loss: 0.3951 Acc: 0.7033
val Loss: 0.4864 Acc: 0.6364
Epoch 9/92
----------
train Loss: 0.3913 Acc: 0.7225
val Loss: 0.4946 Acc: 0.7500
Epoch 10/92
----------
train Loss: 0.2880 Acc: 0.8900
val Loss: 0.3742 Acc: 0.7500
Epoch 11/92
----------
train Loss: 0.3530 Acc: 0.7560
val Loss: 0.4454 Acc: 0.7045
Epoch 12/92
----------
train Loss: 0.3531 Acc: 0.6890
val Loss: 0.5580 Acc: 0.6364
Epoch 13/92
----------
train Loss: 0.3184 Acc: 0.8421
val Loss: 0.4693 Acc: 0.6364
Epoch 14/92
----------
train Loss: 0.2863 Acc: 0.7990
val Loss: 0.4438 Acc: 0.7045
Epoch 15/92
----------
train Loss: 0.3126 Acc: 0.8134
val Loss: 0.4408 Acc: 0.6591
Epoch 16/92
----------
train Loss: 0.3308 Acc: 0.7799
val Loss: 0.5606 Acc: 0.6364
Epoch 17/92
----------
train Loss: 0.3035 Acc: 0.8278
val Loss: 0.5609 Acc: 0.5455
Epoch 18/92
----------
train Loss: 0.2909 Acc: 0.8421
val Loss: 0.4137 Acc: 0.7045
Epoch 19/92
----------
train Loss: 0.2728 Acc: 0.8995
val Loss: 0.4322 Acc: 0.7727
Epoch 20/92
----------
train Loss: 0.3160 Acc: 0.8230
val Loss: 0.3756 Acc: 0.8182
Epoch 21/92
----------
train Loss: 0.3174 Acc: 0.8517
val Loss: 0.4839 Acc: 0.6818
Epoch 22/92
----------
train Loss: 0.2991 Acc: 0.8325
val Loss: 0.4544 Acc: 0.7045
Epoch 23/92
----------
train Loss: 0.3258 Acc: 0.8278
val Loss: 0.3381 Acc: 0.6818
Epoch 24/92
----------
train Loss: 0.2478 Acc: 0.9091
val Loss: 0.3640 Acc: 0.7273
Epoch 25/92
----------
train Loss: 0.2920 Acc: 0.8804
[32m[I 2025-06-29 11:08:04,364][0m Trial 158 finished with value: 0.8181818181818182 and parameters: {'batch_size': 12, 'lr': 0.0005755505640878894, 'num_epochs': 92, 'weight_decay': 0.013147501220706985, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.4011 Acc: 0.7500
Early stopping at epoch 25 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_0.0005755505640878894_epoch_92_wd_0.013147501220706985_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/96
----------
train Loss: 0.6925 Acc: 0.2392
val Loss: 0.6723 Acc: 0.2955
Epoch 2/96
----------
train Loss: 0.6616 Acc: 0.3158
val Loss: 0.6479 Acc: 0.3409
Epoch 3/96
----------
train Loss: 0.6364 Acc: 0.3876
val Loss: 0.6141 Acc: 0.4318
Epoch 4/96
----------
train Loss: 0.6175 Acc: 0.4354
val Loss: 0.5909 Acc: 0.5000
Epoch 5/96
----------
train Loss: 0.6028 Acc: 0.4880
val Loss: 0.5746 Acc: 0.5682
Epoch 6/96
----------
train Loss: 0.5793 Acc: 0.5072
val Loss: 0.5522 Acc: 0.6136
Epoch 7/96
----------
train Loss: 0.5552 Acc: 0.5550
val Loss: 0.5273 Acc: 0.6136
Epoch 8/96
----------
train Loss: 0.5443 Acc: 0.5359
val Loss: 0.5049 Acc: 0.6818
Epoch 9/96
----------
train Loss: 0.5279 Acc: 0.5646
val Loss: 0.4831 Acc: 0.6818
Epoch 10/96
----------
train Loss: 0.4913 Acc: 0.5789
val Loss: 0.4625 Acc: 0.6591
Epoch 11/96
----------
train Loss: 0.4983 Acc: 0.5598
val Loss: 0.4471 Acc: 0.6818
Epoch 12/96
----------
train Loss: 0.4945 Acc: 0.5646
val Loss: 0.4385 Acc: 0.6818
Epoch 13/96
----------
train Loss: 0.4626 Acc: 0.6220
val Loss: 0.4203 Acc: 0.6591
Epoch 14/96
----------
train Loss: 0.4422 Acc: 0.6124
val Loss: 0.4084 Acc: 0.6818
Epoch 15/96
----------
train Loss: 0.4487 Acc: 0.5981
val Loss: 0.3977 Acc: 0.7273
Epoch 16/96
----------
train Loss: 0.4393 Acc: 0.6316
val Loss: 0.3874 Acc: 0.7500
Epoch 17/96
----------
train Loss: 0.4282 Acc: 0.6316
val Loss: 0.3781 Acc: 0.7500
Epoch 18/96
----------
train Loss: 0.4144 Acc: 0.6699
val Loss: 0.3666 Acc: 0.7273
Epoch 19/96
----------
train Loss: 0.3962 Acc: 0.7416
val Loss: 0.3602 Acc: 0.7500
Epoch 20/96
----------
train Loss: 0.4038 Acc: 0.7081
val Loss: 0.3486 Acc: 0.7500
Epoch 21/96
----------
train Loss: 0.4019 Acc: 0.7129
val Loss: 0.3392 Acc: 0.7727
Epoch 22/96
----------
train Loss: 0.3929 Acc: 0.7129
val Loss: 0.3338 Acc: 0.7727
Epoch 23/96
----------
train Loss: 0.3872 Acc: 0.7273
val Loss: 0.3252 Acc: 0.7955
Epoch 24/96
----------
train Loss: 0.3497 Acc: 0.7943
val Loss: 0.3110 Acc: 0.7727
Epoch 25/96
----------
train Loss: 0.3726 Acc: 0.7177
val Loss: 0.3138 Acc: 0.7955
Epoch 26/96
----------
train Loss: 0.3761 Acc: 0.7895
val Loss: 0.3135 Acc: 0.7955
Epoch 27/96
----------
train Loss: 0.3275 Acc: 0.8565
val Loss: 0.3112 Acc: 0.7955
Epoch 28/96
----------
train Loss: 0.3729 Acc: 0.7512
val Loss: 0.3089 Acc: 0.7955
Epoch 29/96
----------
train Loss: 0.3934 Acc: 0.6890
val Loss: 0.3087 Acc: 0.8182
Epoch 30/96
----------
train Loss: 0.3568 Acc: 0.7225
val Loss: 0.3027 Acc: 0.7955
Epoch 31/96
----------
train Loss: 0.3143 Acc: 0.8517
val Loss: 0.2932 Acc: 0.7727
Epoch 32/96
----------
train Loss: 0.3384 Acc: 0.7751
val Loss: 0.2864 Acc: 0.7727
Epoch 33/96
----------
train Loss: 0.3574 Acc: 0.7799
val Loss: 0.2859 Acc: 0.7955
Epoch 34/96
----------
train Loss: 0.3309 Acc: 0.8421
val Loss: 0.2845 Acc: 0.7727
Epoch 35/96
----------
train Loss: 0.2825 Acc: 0.9234
val Loss: 0.2878 Acc: 0.7955
Epoch 36/96
----------
train Loss: 0.3714 Acc: 0.7368
val Loss: 0.2852 Acc: 0.7955
Epoch 37/96
----------
train Loss: 0.3149 Acc: 0.7943
val Loss: 0.2913 Acc: 0.7727
Epoch 38/96
----------
train Loss: 0.3133 Acc: 0.9234
val Loss: 0.2855 Acc: 0.7955
Epoch 39/96
----------
train Loss: 0.3427 Acc: 0.7273
val Loss: 0.2921 Acc: 0.7500
Epoch 40/96
----------
train Loss: 0.2876 Acc: 0.8469
val Loss: 0.2885 Acc: 0.7727
Epoch 41/96
----------
train Loss: 0.3594 Acc: 0.7321
val Loss: 0.2817 Acc: 0.7955
Epoch 42/96
----------
train Loss: 0.2912 Acc: 0.8230
val Loss: 0.2733 Acc: 0.7955
Epoch 43/96
----------
train Loss: 0.3137 Acc: 0.8230
val Loss: 0.2705 Acc: 0.7955
Epoch 44/96
----------
train Loss: 0.2877 Acc: 0.8517
val Loss: 0.2704 Acc: 0.8182
Epoch 45/96
----------
train Loss: 0.1934 Acc: 0.9617
val Loss: 0.2689 Acc: 0.7955
Epoch 46/96
----------
train Loss: 0.3703 Acc: 0.8182
val Loss: 0.2720 Acc: 0.8182
Epoch 47/96
----------
train Loss: 0.2774 Acc: 0.8708
val Loss: 0.2678 Acc: 0.8182
Epoch 48/96
----------
train Loss: 0.3093 Acc: 0.8134
val Loss: 0.2708 Acc: 0.8182
Epoch 49/96
----------
train Loss: 0.2929 Acc: 0.9091
val Loss: 0.2699 Acc: 0.7955
Epoch 50/96
----------
train Loss: 0.2850 Acc: 0.8612
val Loss: 0.2710 Acc: 0.7955
Epoch 51/96
----------
train Loss: 0.2180 Acc: 0.9809
val Loss: 0.2649 Acc: 0.7955
Epoch 52/96
----------
train Loss: 0.3008 Acc: 0.7943
val Loss: 0.2667 Acc: 0.7727
Epoch 53/96
----------
train Loss: 0.3335 Acc: 0.9043
val Loss: 0.2647 Acc: 0.7727
Epoch 54/96
----------
train Loss: 0.2474 Acc: 0.9234
val Loss: 0.2586 Acc: 0.7955
Epoch 55/96
----------
train Loss: 0.2637 Acc: 0.9234
val Loss: 0.2591 Acc: 0.7955
Epoch 56/96
----------
train Loss: 0.3069 Acc: 0.8565
val Loss: 0.2600 Acc: 0.7727
Epoch 57/96
----------
train Loss: 0.3447 Acc: 0.7943
val Loss: 0.2581 Acc: 0.7955
Epoch 58/96
----------
train Loss: 0.2858 Acc: 0.7990
val Loss: 0.2555 Acc: 0.8182
Epoch 59/96
----------
train Loss: 0.2968 Acc: 0.8660
val Loss: 0.2552 Acc: 0.7955
Epoch 60/96
----------
train Loss: 0.2497 Acc: 0.8565
val Loss: 0.2578 Acc: 0.7955
Epoch 61/96
----------
train Loss: 0.3383 Acc: 0.7416
val Loss: 0.2602 Acc: 0.7955
Epoch 62/96
----------
train Loss: 0.3000 Acc: 0.9426
val Loss: 0.2596 Acc: 0.7727
Epoch 63/96
----------
train Loss: 0.2595 Acc: 0.9330
val Loss: 0.2594 Acc: 0.7727
Epoch 64/96
----------
train Loss: 0.2461 Acc: 0.9330
val Loss: 0.2577 Acc: 0.7955
Epoch 65/96
----------
train Loss: 0.2802 Acc: 0.8182
val Loss: 0.2604 Acc: 0.7955
Epoch 66/96
----------
train Loss: 0.2723 Acc: 0.8947
val Loss: 0.2646 Acc: 0.7955
Epoch 67/96
----------
train Loss: 0.3055 Acc: 0.8660
val Loss: 0.2586 Acc: 0.8182
Epoch 68/96
----------
train Loss: 0.2557 Acc: 0.8995
val Loss: 0.2621 Acc: 0.7955
Epoch 69/96
----------
train Loss: 0.2548 Acc: 0.8852
val Loss: 0.2589 Acc: 0.7955
Epoch 70/96
----------
train Loss: 0.2881 Acc: 0.8947
val Loss: 0.2605 Acc: 0.7727
Epoch 71/96
----------
train Loss: 0.3023 Acc: 0.9091
val Loss: 0.2586 Acc: 0.7727
Epoch 72/96
----------
train Loss: 0.3037 Acc: 0.8852
val Loss: 0.2645 Acc: 0.7727
Epoch 73/96
----------
train Loss: 0.2159 Acc: 0.9665
val Loss: 0.2689 Acc: 0.7727
Epoch 74/96
----------
train Loss: 0.3175 Acc: 0.8517
val Loss: 0.2632 Acc: 0.7727
Epoch 75/96
----------
train Loss: 0.2356 Acc: 0.9378
val Loss: 0.2611 Acc: 0.7500
Epoch 76/96
----------
train Loss: 0.2568 Acc: 0.8230
val Loss: 0.2580 Acc: 0.7727
Epoch 77/96
----------
train Loss: 0.2935 Acc: 0.8517
val Loss: 0.2574 Acc: 0.7727
Epoch 78/96
----------
train Loss: 0.2535 Acc: 0.8708
val Loss: 0.2578 Acc: 0.7955
Epoch 79/96
----------
train Loss: 0.3119 Acc: 0.8469
val Loss: 0.2545 Acc: 0.7955
Epoch 80/96
----------
train Loss: 0.2742 Acc: 0.8469
val Loss: 0.2543 Acc: 0.8636
Epoch 81/96
----------
train Loss: 0.3165 Acc: 0.7847
val Loss: 0.2641 Acc: 0.7955
Epoch 82/96
----------
train Loss: 0.2726 Acc: 0.8373
val Loss: 0.2675 Acc: 0.7727
Epoch 83/96
----------
train Loss: 0.2358 Acc: 0.9665
val Loss: 0.2683 Acc: 0.7955
Epoch 84/96
----------
train Loss: 0.3123 Acc: 0.7799
val Loss: 0.2646 Acc: 0.7727
Epoch 85/96
----------
train Loss: 0.2469 Acc: 0.8230
[32m[I 2025-06-29 11:27:23,148][0m Trial 159 finished with value: 0.8636363636363636 and parameters: {'batch_size': 104, 'lr': 5.556179407019463e-05, 'num_epochs': 96, 'weight_decay': 0.0007314330867183207, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2624 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_104_lr_5.556179407019463e-05_epoch_96_wd_0.0007314330867183207_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/65
----------
train Loss: 0.6955 Acc: 0.2249
val Loss: 0.6775 Acc: 0.2500
Epoch 2/65
----------
train Loss: 0.6719 Acc: 0.2775
val Loss: 0.6600 Acc: 0.2727
Epoch 3/65
----------
train Loss: 0.6528 Acc: 0.3541
val Loss: 0.6350 Acc: 0.3636
Epoch 4/65
----------
train Loss: 0.6391 Acc: 0.3684
val Loss: 0.6190 Acc: 0.4091
Epoch 5/65
----------
train Loss: 0.6294 Acc: 0.3923
val Loss: 0.6091 Acc: 0.4545
Epoch 6/65
----------
train Loss: 0.6115 Acc: 0.4593
val Loss: 0.5944 Acc: 0.5227
Epoch 7/65
----------
train Loss: 0.5935 Acc: 0.5167
val Loss: 0.5770 Acc: 0.5909
Epoch 8/65
----------
train Loss: 0.5826 Acc: 0.5359
val Loss: 0.5616 Acc: 0.6364
Epoch 9/65
----------
train Loss: 0.5689 Acc: 0.5550
val Loss: 0.5439 Acc: 0.6364
Epoch 10/65
----------
train Loss: 0.5426 Acc: 0.5598
val Loss: 0.5239 Acc: 0.6591
Epoch 11/65
----------
train Loss: 0.5450 Acc: 0.5407
val Loss: 0.5112 Acc: 0.6591
Epoch 12/65
----------
train Loss: 0.5379 Acc: 0.5455
val Loss: 0.5019 Acc: 0.6591
Epoch 13/65
----------
train Loss: 0.5119 Acc: 0.5981
val Loss: 0.4828 Acc: 0.6591
Epoch 14/65
----------
train Loss: 0.4950 Acc: 0.5885
val Loss: 0.4730 Acc: 0.6591
Epoch 15/65
----------
train Loss: 0.4946 Acc: 0.5598
val Loss: 0.4619 Acc: 0.6818
Epoch 16/65
----------
train Loss: 0.4847 Acc: 0.5742
val Loss: 0.4485 Acc: 0.6818
Epoch 17/65
----------
train Loss: 0.4744 Acc: 0.5837
val Loss: 0.4369 Acc: 0.6591
Epoch 18/65
----------
train Loss: 0.4639 Acc: 0.6029
val Loss: 0.4252 Acc: 0.6591
Epoch 19/65
----------
train Loss: 0.4484 Acc: 0.6507
val Loss: 0.4166 Acc: 0.6591
Epoch 20/65
----------
train Loss: 0.4485 Acc: 0.6172
val Loss: 0.4050 Acc: 0.6818
Epoch 21/65
----------
train Loss: 0.4452 Acc: 0.6172
val Loss: 0.3969 Acc: 0.7045
Epoch 22/65
----------
train Loss: 0.4387 Acc: 0.6124
val Loss: 0.3889 Acc: 0.7045
Epoch 23/65
----------
train Loss: 0.4284 Acc: 0.6411
val Loss: 0.3794 Acc: 0.7273
Epoch 24/65
----------
train Loss: 0.4002 Acc: 0.7129
val Loss: 0.3640 Acc: 0.7273
Epoch 25/65
----------
train Loss: 0.4197 Acc: 0.6699
val Loss: 0.3657 Acc: 0.7500
Epoch 26/65
----------
train Loss: 0.4183 Acc: 0.6794
val Loss: 0.3635 Acc: 0.7727
Epoch 27/65
----------
train Loss: 0.3803 Acc: 0.7321
val Loss: 0.3555 Acc: 0.7727
Epoch 28/65
----------
train Loss: 0.4109 Acc: 0.6842
val Loss: 0.3514 Acc: 0.7500
Epoch 29/65
----------
train Loss: 0.4267 Acc: 0.6411
val Loss: 0.3481 Acc: 0.7727
Epoch 30/65
----------
train Loss: 0.4018 Acc: 0.6603
val Loss: 0.3451 Acc: 0.7955
Epoch 31/65
----------
train Loss: 0.3661 Acc: 0.7847
val Loss: 0.3362 Acc: 0.7955
Epoch 32/65
----------
train Loss: 0.3817 Acc: 0.7081
val Loss: 0.3275 Acc: 0.7955
Epoch 33/65
----------
train Loss: 0.3979 Acc: 0.7033
val Loss: 0.3256 Acc: 0.7955
Epoch 34/65
----------
train Loss: 0.3732 Acc: 0.7560
val Loss: 0.3213 Acc: 0.7955
Epoch 35/65
----------
train Loss: 0.3367 Acc: 0.8278
val Loss: 0.3200 Acc: 0.7955
Epoch 36/65
----------
train Loss: 0.4050 Acc: 0.7081
val Loss: 0.3143 Acc: 0.8182
Epoch 37/65
----------
train Loss: 0.3587 Acc: 0.7464
val Loss: 0.3197 Acc: 0.8182
Epoch 38/65
----------
train Loss: 0.3573 Acc: 0.8230
val Loss: 0.3170 Acc: 0.8182
Epoch 39/65
----------
train Loss: 0.3770 Acc: 0.6890
val Loss: 0.3244 Acc: 0.7955
Epoch 40/65
----------
train Loss: 0.3344 Acc: 0.8038
val Loss: 0.3205 Acc: 0.7955
Epoch 41/65
----------
train Loss: 0.3862 Acc: 0.6938
val Loss: 0.3154 Acc: 0.7955
Epoch 42/65
----------
train Loss: 0.3363 Acc: 0.7321
val Loss: 0.3073 Acc: 0.7955
Epoch 43/65
----------
train Loss: 0.3567 Acc: 0.7703
val Loss: 0.3022 Acc: 0.7955
Epoch 44/65
----------
train Loss: 0.3255 Acc: 0.8182
val Loss: 0.2987 Acc: 0.7955
Epoch 45/65
----------
train Loss: 0.2443 Acc: 0.9234
val Loss: 0.2937 Acc: 0.7955
Epoch 46/65
----------
train Loss: 0.3926 Acc: 0.7751
val Loss: 0.2952 Acc: 0.7955
Epoch 47/65
----------
train Loss: 0.3147 Acc: 0.8660
val Loss: 0.2920 Acc: 0.7955
Epoch 48/65
----------
train Loss: 0.3407 Acc: 0.7608
val Loss: 0.2939 Acc: 0.7955
Epoch 49/65
----------
train Loss: 0.3261 Acc: 0.8660
val Loss: 0.2906 Acc: 0.7955
Epoch 50/65
----------
train Loss: 0.3161 Acc: 0.8134
val Loss: 0.2908 Acc: 0.7955
Epoch 51/65
----------
train Loss: 0.2625 Acc: 0.9474
val Loss: 0.2841 Acc: 0.7955
Epoch 52/65
----------
train Loss: 0.3326 Acc: 0.7464
val Loss: 0.2862 Acc: 0.7727
Epoch 53/65
----------
train Loss: 0.3604 Acc: 0.8230
val Loss: 0.2841 Acc: 0.7955
Epoch 54/65
----------
train Loss: 0.2779 Acc: 0.9139
val Loss: 0.2779 Acc: 0.7955
Epoch 55/65
----------
train Loss: 0.2962 Acc: 0.8995
val Loss: 0.2755 Acc: 0.7955
Epoch 56/65
----------
train Loss: 0.3342 Acc: 0.8325
val Loss: 0.2763 Acc: 0.7955
Epoch 57/65
----------
train Loss: 0.3664 Acc: 0.7703
val Loss: 0.2751 Acc: 0.8409
Epoch 58/65
----------
train Loss: 0.3096 Acc: 0.7990
val Loss: 0.2733 Acc: 0.8182
Epoch 59/65
----------
train Loss: 0.3265 Acc: 0.8278
val Loss: 0.2724 Acc: 0.8182
Epoch 60/65
----------
train Loss: 0.2824 Acc: 0.8278
val Loss: 0.2739 Acc: 0.7955
Epoch 61/65
----------
train Loss: 0.3616 Acc: 0.7081
val Loss: 0.2747 Acc: 0.7955
Epoch 62/65
----------
train Loss: 0.3195 Acc: 0.8852
val Loss: 0.2731 Acc: 0.8182
Epoch 63/65
----------
train Loss: 0.2806 Acc: 0.9139
val Loss: 0.2729 Acc: 0.8182
Epoch 64/65
----------
train Loss: 0.2707 Acc: 0.9187
val Loss: 0.2701 Acc: 0.7955
Epoch 65/65
----------
train Loss: 0.3024 Acc: 0.7943
[32m[I 2025-06-29 11:42:11,624][0m Trial 160 finished with value: 0.7954545454545455 and parameters: {'batch_size': 105, 'lr': 3.9152570536517336e-05, 'num_epochs': 65, 'weight_decay': 0.0007450568766389362, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2693 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_105_lr_3.9152570536517336e-05_epoch_65_wd_0.0007450568766389362_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/80
----------
train Loss: 3.7616 Acc: 0.2344
val Loss: 3.5886 Acc: 0.2955
Epoch 2/80
----------
train Loss: 3.5580 Acc: 0.3301
val Loss: 3.4376 Acc: 0.4091
Epoch 3/80
----------
train Loss: 3.3751 Acc: 0.3541
val Loss: 3.2243 Acc: 0.4318
Epoch 4/80
----------
train Loss: 3.2442 Acc: 0.4067
val Loss: 3.0834 Acc: 0.5227
Epoch 5/80
----------
train Loss: 3.1263 Acc: 0.4593
val Loss: 2.9698 Acc: 0.5455
Epoch 6/80
----------
train Loss: 2.9785 Acc: 0.4880
val Loss: 2.8164 Acc: 0.6364
Epoch 7/80
----------
train Loss: 2.8427 Acc: 0.5072
val Loss: 2.6596 Acc: 0.6364
Epoch 8/80
----------
train Loss: 2.7611 Acc: 0.5024
val Loss: 2.5277 Acc: 0.6364
Epoch 9/80
----------
train Loss: 2.6689 Acc: 0.5167
val Loss: 2.4037 Acc: 0.6364
Epoch 10/80
----------
train Loss: 2.4672 Acc: 0.5120
val Loss: 2.3005 Acc: 0.6364
Epoch 11/80
----------
train Loss: 2.4952 Acc: 0.5072
val Loss: 2.2321 Acc: 0.6591
Epoch 12/80
----------
train Loss: 2.4808 Acc: 0.5167
val Loss: 2.1957 Acc: 0.6818
Epoch 13/80
----------
train Loss: 2.3206 Acc: 0.5407
val Loss: 2.1058 Acc: 0.6818
Epoch 14/80
----------
train Loss: 2.2336 Acc: 0.5215
val Loss: 2.0713 Acc: 0.6818
Epoch 15/80
----------
train Loss: 2.2905 Acc: 0.5311
val Loss: 2.0402 Acc: 0.6818
Epoch 16/80
----------
train Loss: 2.2465 Acc: 0.5311
val Loss: 2.0010 Acc: 0.6818
Epoch 17/80
----------
train Loss: 2.1834 Acc: 0.5455
val Loss: 1.9612 Acc: 0.6818
Epoch 18/80
----------
train Loss: 2.1121 Acc: 0.5646
val Loss: 1.9079 Acc: 0.6818
Epoch 19/80
----------
train Loss: 2.0592 Acc: 0.5933
val Loss: 1.8844 Acc: 0.6818
Epoch 20/80
----------
train Loss: 2.0674 Acc: 0.5742
val Loss: 1.8446 Acc: 0.6818
Epoch 21/80
----------
train Loss: 2.0945 Acc: 0.5837
val Loss: 1.8155 Acc: 0.6818
Epoch 22/80
----------
train Loss: 2.0511 Acc: 0.6077
val Loss: 1.7790 Acc: 0.7045
Epoch 23/80
----------
train Loss: 2.0032 Acc: 0.6268
val Loss: 1.7372 Acc: 0.7273
Epoch 24/80
----------
train Loss: 1.8288 Acc: 0.6746
val Loss: 1.6762 Acc: 0.7273
Epoch 25/80
----------
train Loss: 1.9468 Acc: 0.6555
val Loss: 1.6871 Acc: 0.7273
Epoch 26/80
----------
train Loss: 1.9728 Acc: 0.6603
val Loss: 1.7014 Acc: 0.7500
Epoch 27/80
----------
train Loss: 1.7569 Acc: 0.7321
val Loss: 1.6901 Acc: 0.7727
Epoch 28/80
----------
train Loss: 1.9346 Acc: 0.6507
val Loss: 1.6700 Acc: 0.7727
Epoch 29/80
----------
train Loss: 1.9886 Acc: 0.6268
val Loss: 1.6501 Acc: 0.7955
Epoch 30/80
----------
train Loss: 1.8551 Acc: 0.6746
val Loss: 1.6495 Acc: 0.7955
Epoch 31/80
----------
train Loss: 1.6769 Acc: 0.7990
val Loss: 1.6041 Acc: 0.7955
Epoch 32/80
----------
train Loss: 1.7944 Acc: 0.6986
val Loss: 1.5649 Acc: 0.7955
Epoch 33/80
----------
train Loss: 1.8203 Acc: 0.7656
val Loss: 1.5541 Acc: 0.7955
Epoch 34/80
----------
train Loss: 1.7311 Acc: 0.7799
val Loss: 1.5387 Acc: 0.7955
Epoch 35/80
----------
train Loss: 1.4850 Acc: 0.8660
val Loss: 1.5153 Acc: 0.7727
Epoch 36/80
----------
train Loss: 1.8834 Acc: 0.7273
val Loss: 1.5034 Acc: 0.7500
Epoch 37/80
----------
train Loss: 1.6043 Acc: 0.7847
val Loss: 1.5133 Acc: 0.7727
Epoch 38/80
----------
train Loss: 1.6174 Acc: 0.8756
val Loss: 1.4890 Acc: 0.8182
Epoch 39/80
----------
train Loss: 1.7467 Acc: 0.6938
val Loss: 1.5485 Acc: 0.8182
Epoch 40/80
----------
train Loss: 1.4706 Acc: 0.8182
val Loss: 1.5526 Acc: 0.8182
Epoch 41/80
----------
train Loss: 1.8528 Acc: 0.7081
val Loss: 1.5082 Acc: 0.8182
Epoch 42/80
----------
train Loss: 1.4898 Acc: 0.8134
val Loss: 1.4741 Acc: 0.8182
Epoch 43/80
----------
train Loss: 1.5874 Acc: 0.8038
val Loss: 1.4646 Acc: 0.8182
Epoch 44/80
----------
train Loss: 1.4296 Acc: 0.8517
val Loss: 1.4332 Acc: 0.8182
Epoch 45/80
----------
train Loss: 1.0125 Acc: 0.9617
val Loss: 1.4044 Acc: 0.8182
Epoch 46/80
----------
train Loss: 1.7925 Acc: 0.7703
val Loss: 1.4265 Acc: 0.8409
Epoch 47/80
----------
train Loss: 1.4216 Acc: 0.8517
val Loss: 1.4181 Acc: 0.8182
Epoch 48/80
----------
train Loss: 1.4892 Acc: 0.8230
val Loss: 1.3988 Acc: 0.8409
Epoch 49/80
----------
train Loss: 1.4396 Acc: 0.8900
val Loss: 1.3894 Acc: 0.7955
Epoch 50/80
----------
train Loss: 1.4134 Acc: 0.8565
val Loss: 1.4376 Acc: 0.7500
Epoch 51/80
----------
train Loss: 1.0888 Acc: 0.9665
val Loss: 1.3863 Acc: 0.7955
Epoch 52/80
----------
train Loss: 1.4829 Acc: 0.7895
val Loss: 1.3753 Acc: 0.7955
Epoch 53/80
----------
train Loss: 1.6525 Acc: 0.8804
val Loss: 1.3632 Acc: 0.8409
Epoch 54/80
----------
train Loss: 1.2686 Acc: 0.9091
val Loss: 1.3487 Acc: 0.8409
Epoch 55/80
----------
train Loss: 1.3136 Acc: 0.9234
val Loss: 1.3386 Acc: 0.8409
Epoch 56/80
----------
train Loss: 1.4894 Acc: 0.8756
val Loss: 1.3499 Acc: 0.7955
Epoch 57/80
----------
train Loss: 1.6962 Acc: 0.7703
val Loss: 1.3209 Acc: 0.8182
Epoch 58/80
----------
train Loss: 1.4234 Acc: 0.8038
val Loss: 1.3215 Acc: 0.8182
Epoch 59/80
----------
train Loss: 1.4594 Acc: 0.8373
val Loss: 1.3328 Acc: 0.7955
Epoch 60/80
----------
train Loss: 1.2046 Acc: 0.8421
val Loss: 1.3495 Acc: 0.7955
Epoch 61/80
----------
train Loss: 1.6571 Acc: 0.7321
val Loss: 1.3547 Acc: 0.7955
Epoch 62/80
----------
train Loss: 1.4555 Acc: 0.9282
val Loss: 1.3340 Acc: 0.7727
Epoch 63/80
----------
train Loss: 1.2878 Acc: 0.9139
val Loss: 1.3278 Acc: 0.8182
Epoch 64/80
----------
train Loss: 1.2051 Acc: 0.9426
val Loss: 1.3066 Acc: 0.8409
Epoch 65/80
----------
train Loss: 1.3823 Acc: 0.8038
val Loss: 1.3205 Acc: 0.8409
Epoch 66/80
----------
train Loss: 1.3221 Acc: 0.8660
val Loss: 1.3045 Acc: 0.8182
Epoch 67/80
----------
train Loss: 1.5099 Acc: 0.8660
val Loss: 1.2986 Acc: 0.8636
Epoch 68/80
----------
train Loss: 1.2298 Acc: 0.9043
val Loss: 1.3044 Acc: 0.8182
Epoch 69/80
----------
train Loss: 1.2419 Acc: 0.8852
val Loss: 1.3097 Acc: 0.8409
Epoch 70/80
----------
train Loss: 1.4092 Acc: 0.8804
val Loss: 1.3071 Acc: 0.8182
Epoch 71/80
----------
train Loss: 1.4940 Acc: 0.8995
val Loss: 1.3404 Acc: 0.7955
Epoch 72/80
----------
train Loss: 1.4950 Acc: 0.8565
val Loss: 1.3873 Acc: 0.8409
Epoch 73/80
----------
train Loss: 1.0644 Acc: 0.9569
val Loss: 1.3612 Acc: 0.8182
Epoch 74/80
----------
train Loss: 1.5321 Acc: 0.8278
val Loss: 1.2953 Acc: 0.7955
Epoch 75/80
----------
train Loss: 1.1593 Acc: 0.9234
val Loss: 1.2729 Acc: 0.8182
Epoch 76/80
----------
train Loss: 1.2718 Acc: 0.7895
val Loss: 1.2844 Acc: 0.8182
Epoch 77/80
----------
train Loss: 1.4171 Acc: 0.8278
val Loss: 1.3053 Acc: 0.8182
Epoch 78/80
----------
train Loss: 1.2573 Acc: 0.8660
val Loss: 1.3307 Acc: 0.8636
Epoch 79/80
----------
train Loss: 1.5150 Acc: 0.8421
val Loss: 1.3303 Acc: 0.8636
Epoch 80/80
----------
train Loss: 1.3532 Acc: 0.8469
[32m[I 2025-06-29 12:00:25,875][0m Trial 161 finished with value: 0.8409090909090909 and parameters: {'batch_size': 92, 'lr': 6.840733729280321e-05, 'num_epochs': 80, 'weight_decay': 0.019865141541286567, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3230 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_92_lr_6.840733729280321e-05_epoch_80_wd_0.019865141541286567_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 3.3820 Acc: 0.3636
val Loss: 2.9467 Acc: 0.6136
Epoch 2/86
----------
train Loss: 2.5998 Acc: 0.5311
val Loss: 2.0412 Acc: 0.6364
Epoch 3/86
----------
train Loss: 2.2734 Acc: 0.5120
val Loss: 1.8828 Acc: 0.6364
Epoch 4/86
----------
train Loss: 2.1689 Acc: 0.5311
val Loss: 1.8551 Acc: 0.7500
Epoch 5/86
----------
train Loss: 2.0940 Acc: 0.6316
val Loss: 1.7547 Acc: 0.7955
Epoch 6/86
----------
train Loss: 1.9115 Acc: 0.6699
val Loss: 1.6360 Acc: 0.7955
Epoch 7/86
----------
train Loss: 1.7174 Acc: 0.7895
val Loss: 1.5013 Acc: 0.8182
Epoch 8/86
----------
train Loss: 1.7816 Acc: 0.7512
val Loss: 1.4483 Acc: 0.7955
Epoch 9/86
----------
train Loss: 1.7314 Acc: 0.7608
val Loss: 1.6079 Acc: 0.7727
Epoch 10/86
----------
train Loss: 1.1102 Acc: 0.9378
val Loss: 1.2992 Acc: 0.7955
Epoch 11/86
----------
train Loss: 1.7365 Acc: 0.7895
val Loss: 1.2278 Acc: 0.8636
Epoch 12/86
----------
train Loss: 1.5242 Acc: 0.7608
val Loss: 1.8672 Acc: 0.7500
Epoch 13/86
----------
train Loss: 1.3363 Acc: 0.9043
val Loss: 1.5712 Acc: 0.7727
Epoch 14/86
----------
train Loss: 1.2453 Acc: 0.8373
val Loss: 1.4614 Acc: 0.7500
Epoch 15/86
----------
train Loss: 1.3950 Acc: 0.8373
val Loss: 1.1455 Acc: 0.7955
Epoch 16/86
----------
train Loss: 1.4731 Acc: 0.7943
val Loss: 1.3594 Acc: 0.8409
Epoch 17/86
----------
train Loss: 1.4170 Acc: 0.8660
val Loss: 1.4653 Acc: 0.8182
Epoch 18/86
----------
train Loss: 1.3468 Acc: 0.8325
val Loss: 1.3748 Acc: 0.7727
Epoch 19/86
----------
train Loss: 1.2242 Acc: 0.9426
val Loss: 1.3079 Acc: 0.7500
Epoch 20/86
----------
train Loss: 1.3615 Acc: 0.8708
val Loss: 1.1977 Acc: 0.7727
Epoch 21/86
----------
train Loss: 1.4372 Acc: 0.8852
val Loss: 1.1498 Acc: 0.8409
Epoch 22/86
----------
train Loss: 1.2704 Acc: 0.8900
val Loss: 1.3548 Acc: 0.7955
Epoch 23/86
----------
train Loss: 1.4890 Acc: 0.8756
val Loss: 1.3527 Acc: 0.8182
Epoch 24/86
----------
train Loss: 1.1507 Acc: 0.9187
val Loss: 1.1767 Acc: 0.8182
Epoch 25/86
----------
train Loss: 1.2565 Acc: 0.9378
val Loss: 1.3898 Acc: 0.7500
Epoch 26/86
----------
train Loss: 1.4739 Acc: 0.9378
val Loss: 1.3303 Acc: 0.7727
Epoch 27/86
----------
train Loss: 1.2045 Acc: 0.9569
val Loss: 1.4913 Acc: 0.7955
Epoch 28/86
----------
train Loss: 1.3947 Acc: 0.8373
val Loss: 1.1770 Acc: 0.7955
Epoch 29/86
----------
train Loss: 1.5119 Acc: 0.7847
val Loss: 1.2431 Acc: 0.8636
Epoch 30/86
----------
train Loss: 1.3117 Acc: 0.8660
val Loss: 1.1652 Acc: 0.8409
Epoch 31/86
----------
train Loss: 1.1274 Acc: 0.9522
val Loss: 1.1575 Acc: 0.7955
Epoch 32/86
----------
train Loss: 1.2428 Acc: 0.8947
val Loss: 1.2609 Acc: 0.7727
Epoch 33/86
----------
train Loss: 1.4291 Acc: 0.8804
val Loss: 1.4998 Acc: 0.7955
Epoch 34/86
----------
train Loss: 1.3488 Acc: 0.9234
val Loss: 1.4349 Acc: 0.7045
Epoch 35/86
----------
train Loss: 1.0707 Acc: 0.9474
val Loss: 1.3010 Acc: 0.7273
Epoch 36/86
----------
train Loss: 1.5933 Acc: 0.8421
val Loss: 1.3157 Acc: 0.7500
Epoch 37/86
----------
train Loss: 1.3916 Acc: 0.8373
val Loss: 1.3880 Acc: 0.8182
Epoch 38/86
----------
train Loss: 1.4544 Acc: 0.9378
val Loss: 1.3095 Acc: 0.7955
Epoch 39/86
----------
train Loss: 1.3928 Acc: 0.7847
val Loss: 1.8693 Acc: 0.7273
Epoch 40/86
----------
train Loss: 1.2207 Acc: 0.9139
val Loss: 1.3988 Acc: 0.7955
Epoch 41/86
----------
train Loss: 1.6056 Acc: 0.6890
val Loss: 1.6195 Acc: 0.7727
Epoch 42/86
----------
train Loss: 1.2166 Acc: 0.8612
val Loss: 1.5359 Acc: 0.6818
Epoch 43/86
----------
train Loss: 1.3384 Acc: 0.8900
val Loss: 1.3808 Acc: 0.7273
Epoch 44/86
----------
train Loss: 1.2465 Acc: 0.8565
val Loss: 1.4197 Acc: 0.7500
Epoch 45/86
----------
train Loss: 0.8690 Acc: 0.9569
val Loss: 1.3775 Acc: 0.7727
Epoch 46/86
----------
train Loss: 1.7088 Acc: 0.8373
val Loss: 1.7103 Acc: 0.6818
Epoch 47/86
----------
train Loss: 1.2996 Acc: 0.9139
val Loss: 1.6897 Acc: 0.6136
Epoch 48/86
----------
train Loss: 1.3872 Acc: 0.8373
val Loss: 2.0338 Acc: 0.5909
Epoch 49/86
----------
train Loss: 1.3341 Acc: 0.9091
val Loss: 1.3878 Acc: 0.7500
Epoch 50/86
----------
train Loss: 1.3134 Acc: 0.8469
val Loss: 1.2533 Acc: 0.7727
Epoch 51/86
----------
train Loss: 1.0101 Acc: 0.9665
val Loss: 1.4094 Acc: 0.7500
Epoch 52/86
----------
train Loss: 1.3444 Acc: 0.8421
val Loss: 1.0971 Acc: 0.7727
Epoch 53/86
----------
train Loss: 1.5119 Acc: 0.9282
val Loss: 1.1952 Acc: 0.7955
Epoch 54/86
----------
train Loss: 1.2106 Acc: 0.9187
val Loss: 1.2815 Acc: 0.7955
Epoch 55/86
----------
train Loss: 1.2339 Acc: 0.9474
val Loss: 1.5014 Acc: 0.7955
Epoch 56/86
----------
train Loss: 1.3845 Acc: 0.9282
val Loss: 1.5700 Acc: 0.7727
Epoch 57/86
----------
train Loss: 1.5228 Acc: 0.8230
val Loss: 1.5746 Acc: 0.7727
Epoch 58/86
----------
train Loss: 1.2929 Acc: 0.8325
val Loss: 1.4353 Acc: 0.7500
Epoch 59/86
----------
train Loss: 1.3458 Acc: 0.9043
val Loss: 1.5081 Acc: 0.6591
Epoch 60/86
----------
train Loss: 1.0746 Acc: 0.9091
val Loss: 1.4771 Acc: 0.7273
Epoch 61/86
----------
train Loss: 1.5367 Acc: 0.8086
val Loss: 1.8013 Acc: 0.6818
Epoch 62/86
----------
train Loss: 1.4982 Acc: 0.9330
val Loss: 1.7497 Acc: 0.6136
Epoch 63/86
----------
train Loss: 1.3301 Acc: 0.9139
val Loss: 1.6759 Acc: 0.6818
Epoch 64/86
----------
train Loss: 1.1654 Acc: 0.9474
val Loss: 1.3998 Acc: 0.7500
Epoch 65/86
----------
train Loss: 1.2962 Acc: 0.8852
val Loss: 1.3642 Acc: 0.7273
Epoch 66/86
----------
train Loss: 1.3092 Acc: 0.8708
val Loss: 1.5935 Acc: 0.7955
Epoch 67/86
----------
train Loss: 1.4633 Acc: 0.8708
val Loss: 1.4950 Acc: 0.7727
Epoch 68/86
----------
train Loss: 1.2067 Acc: 0.8995
val Loss: 1.4790 Acc: 0.7273
Epoch 69/86
----------
train Loss: 1.1697 Acc: 0.8660
val Loss: 1.2651 Acc: 0.8182
Epoch 70/86
----------
train Loss: 1.4040 Acc: 0.8852
val Loss: 1.5510 Acc: 0.7955
Epoch 71/86
----------
train Loss: 1.4141 Acc: 0.8756
val Loss: 1.4113 Acc: 0.8636
Epoch 72/86
----------
train Loss: 1.4175 Acc: 0.8708
val Loss: 1.6006 Acc: 0.7273
Epoch 73/86
----------
train Loss: 1.0010 Acc: 0.9522
val Loss: 1.4865 Acc: 0.8409
Epoch 74/86
----------
train Loss: 1.4285 Acc: 0.8612
val Loss: 1.4662 Acc: 0.7727
Epoch 75/86
----------
train Loss: 1.1985 Acc: 0.9378
val Loss: 1.6542 Acc: 0.7500
Epoch 76/86
----------
train Loss: 1.1515 Acc: 0.8804
val Loss: 1.4218 Acc: 0.7273
Epoch 77/86
----------
train Loss: 1.3459 Acc: 0.8660
val Loss: 1.4414 Acc: 0.7273
Epoch 78/86
----------
train Loss: 1.2884 Acc: 0.9234
[32m[I 2025-06-29 12:18:11,194][0m Trial 162 finished with value: 0.8409090909090909 and parameters: {'batch_size': 20, 'lr': 0.00045923908277130865, 'num_epochs': 86, 'weight_decay': 0.015944397870401236, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.8529 Acc: 0.6818
Early stopping at epoch 78 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_20_lr_0.00045923908277130865_epoch_86_wd_0.015944397870401236_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 3.4606 Acc: 0.3397
val Loss: 2.9908 Acc: 0.6364
Epoch 2/83
----------
train Loss: 2.7159 Acc: 0.5550
val Loss: 2.0429 Acc: 0.6364
Epoch 3/83
----------
train Loss: 2.3154 Acc: 0.5167
val Loss: 1.8569 Acc: 0.6364
Epoch 4/83
----------
train Loss: 2.1875 Acc: 0.5167
val Loss: 1.7155 Acc: 0.6818
Epoch 5/83
----------
train Loss: 2.1173 Acc: 0.6316
val Loss: 1.5973 Acc: 0.7273
Epoch 6/83
----------
train Loss: 1.9177 Acc: 0.6651
val Loss: 1.4488 Acc: 0.7500
Epoch 7/83
----------
train Loss: 1.7564 Acc: 0.7560
val Loss: 1.3600 Acc: 0.7955
Epoch 8/83
----------
train Loss: 1.8366 Acc: 0.7273
val Loss: 1.3053 Acc: 0.8182
Epoch 9/83
----------
train Loss: 1.7632 Acc: 0.7560
val Loss: 1.3842 Acc: 0.7727
Epoch 10/83
----------
train Loss: 1.1444 Acc: 0.9426
val Loss: 1.2798 Acc: 0.7955
Epoch 11/83
----------
train Loss: 1.6704 Acc: 0.7751
val Loss: 1.1983 Acc: 0.8409
Epoch 12/83
----------
train Loss: 1.4982 Acc: 0.7656
val Loss: 1.3712 Acc: 0.7500
Epoch 13/83
----------
train Loss: 1.3382 Acc: 0.9091
val Loss: 1.3030 Acc: 0.8182
Epoch 14/83
----------
train Loss: 1.2429 Acc: 0.8421
val Loss: 1.3226 Acc: 0.7955
Epoch 15/83
----------
train Loss: 1.3836 Acc: 0.8278
val Loss: 1.2116 Acc: 0.8409
Epoch 16/83
----------
train Loss: 1.4618 Acc: 0.7943
val Loss: 1.2115 Acc: 0.7955
Epoch 17/83
----------
train Loss: 1.3725 Acc: 0.8469
val Loss: 1.3845 Acc: 0.7727
Epoch 18/83
----------
train Loss: 1.2803 Acc: 0.8421
val Loss: 1.3193 Acc: 0.7500
Epoch 19/83
----------
train Loss: 1.2012 Acc: 0.9234
val Loss: 1.2788 Acc: 0.7727
Epoch 20/83
----------
train Loss: 1.3150 Acc: 0.8804
val Loss: 1.2368 Acc: 0.7955
Epoch 21/83
----------
train Loss: 1.4080 Acc: 0.8900
val Loss: 1.2023 Acc: 0.7955
Epoch 22/83
----------
train Loss: 1.2389 Acc: 0.8804
val Loss: 1.2367 Acc: 0.7273
Epoch 23/83
----------
train Loss: 1.4610 Acc: 0.8612
val Loss: 1.1974 Acc: 0.7955
Epoch 24/83
----------
train Loss: 1.0397 Acc: 0.9282
val Loss: 1.1838 Acc: 0.7727
Epoch 25/83
----------
train Loss: 1.2163 Acc: 0.9378
val Loss: 1.2459 Acc: 0.7955
Epoch 26/83
----------
train Loss: 1.3938 Acc: 0.9378
val Loss: 1.3308 Acc: 0.7500
Epoch 27/83
----------
train Loss: 1.1335 Acc: 0.9809
val Loss: 1.3921 Acc: 0.7955
Epoch 28/83
----------
train Loss: 1.3436 Acc: 0.8804
val Loss: 1.3417 Acc: 0.7955
Epoch 29/83
----------
train Loss: 1.4347 Acc: 0.8038
val Loss: 1.1280 Acc: 0.8182
Epoch 30/83
----------
train Loss: 1.2286 Acc: 0.8660
val Loss: 1.0667 Acc: 0.7955
Epoch 31/83
----------
train Loss: 1.0619 Acc: 0.9426
val Loss: 1.1480 Acc: 0.7955
Epoch 32/83
----------
train Loss: 1.2189 Acc: 0.8995
val Loss: 1.1616 Acc: 0.7955
Epoch 33/83
----------
train Loss: 1.2963 Acc: 0.8995
val Loss: 1.1664 Acc: 0.7955
Epoch 34/83
----------
train Loss: 1.2344 Acc: 0.9665
val Loss: 1.2330 Acc: 0.7727
Epoch 35/83
----------
train Loss: 0.9440 Acc: 0.9665
val Loss: 1.3389 Acc: 0.7500
Epoch 36/83
----------
train Loss: 1.4828 Acc: 0.8565
val Loss: 1.2396 Acc: 0.7727
Epoch 37/83
----------
train Loss: 1.2489 Acc: 0.8325
val Loss: 1.2119 Acc: 0.7955
Epoch 38/83
----------
train Loss: 1.2974 Acc: 0.9569
val Loss: 1.2105 Acc: 0.7955
Epoch 39/83
----------
train Loss: 1.3056 Acc: 0.7799
val Loss: 1.2315 Acc: 0.7955
Epoch 40/83
----------
train Loss: 1.1126 Acc: 0.9282
val Loss: 1.3068 Acc: 0.7955
Epoch 41/83
----------
train Loss: 1.5227 Acc: 0.7081
val Loss: 1.2816 Acc: 0.7955
Epoch 42/83
----------
train Loss: 1.0899 Acc: 0.8852
val Loss: 1.3166 Acc: 0.7500
Epoch 43/83
----------
train Loss: 1.2360 Acc: 0.8804
val Loss: 1.2976 Acc: 0.7500
Epoch 44/83
----------
train Loss: 1.1314 Acc: 0.9043
val Loss: 1.3415 Acc: 0.7955
Epoch 45/83
----------
train Loss: 0.7386 Acc: 0.9713
val Loss: 1.3009 Acc: 0.7955
Epoch 46/83
----------
train Loss: 1.5573 Acc: 0.8230
val Loss: 1.3822 Acc: 0.7955
Epoch 47/83
----------
train Loss: 1.1660 Acc: 0.9378
val Loss: 1.4630 Acc: 0.7727
Epoch 48/83
----------
train Loss: 1.2596 Acc: 0.8469
val Loss: 1.4519 Acc: 0.6818
Epoch 49/83
----------
train Loss: 1.2432 Acc: 0.9713
val Loss: 1.4052 Acc: 0.7273
Epoch 50/83
----------
train Loss: 1.1967 Acc: 0.8995
val Loss: 1.3656 Acc: 0.7273
Epoch 51/83
----------
train Loss: 0.9180 Acc: 1.0000
val Loss: 1.3225 Acc: 0.7500
Epoch 52/83
----------
train Loss: 1.2241 Acc: 0.8900
val Loss: 1.3550 Acc: 0.7500
Epoch 53/83
----------
train Loss: 1.4288 Acc: 0.9139
val Loss: 1.3323 Acc: 0.7500
Epoch 54/83
----------
train Loss: 1.0684 Acc: 0.9474
val Loss: 1.3590 Acc: 0.7273
Epoch 55/83
----------
train Loss: 1.1445 Acc: 0.9378
val Loss: 1.4137 Acc: 0.7045
Epoch 56/83
----------
train Loss: 1.3384 Acc: 0.9378
val Loss: 1.3966 Acc: 0.7273
Epoch 57/83
----------
train Loss: 1.4355 Acc: 0.8565
val Loss: 1.4354 Acc: 0.7273
Epoch 58/83
----------
train Loss: 1.1631 Acc: 0.8182
val Loss: 1.4105 Acc: 0.7273
Epoch 59/83
----------
train Loss: 1.1718 Acc: 0.9378
val Loss: 1.4485 Acc: 0.6818
Epoch 60/83
----------
train Loss: 0.9892 Acc: 0.9234
val Loss: 1.4282 Acc: 0.7273
Epoch 61/83
----------
train Loss: 1.3667 Acc: 0.8182
val Loss: 1.4256 Acc: 0.7045
Epoch 62/83
----------
train Loss: 1.3448 Acc: 0.9474
val Loss: 1.4464 Acc: 0.6818
Epoch 63/83
----------
train Loss: 1.1506 Acc: 0.9569
val Loss: 1.5112 Acc: 0.7045
Epoch 64/83
----------
train Loss: 1.0353 Acc: 0.9617
val Loss: 1.4627 Acc: 0.7727
Epoch 65/83
----------
train Loss: 1.1949 Acc: 0.8852
val Loss: 1.5062 Acc: 0.7273
Epoch 66/83
----------
train Loss: 1.1728 Acc: 0.9139
val Loss: 1.4461 Acc: 0.7273
Epoch 67/83
----------
train Loss: 1.3382 Acc: 0.8804
val Loss: 1.4577 Acc: 0.7273
Epoch 68/83
----------
train Loss: 1.0977 Acc: 0.9043
val Loss: 1.5829 Acc: 0.7500
Epoch 69/83
----------
train Loss: 1.0585 Acc: 0.9043
val Loss: 1.5903 Acc: 0.7500
Epoch 70/83
----------
train Loss: 1.2085 Acc: 0.9187
val Loss: 1.5573 Acc: 0.7273
Epoch 71/83
----------
train Loss: 1.2708 Acc: 0.9330
val Loss: 1.5177 Acc: 0.7727
Epoch 72/83
----------
train Loss: 1.2930 Acc: 0.8756
val Loss: 1.4926 Acc: 0.7500
Epoch 73/83
----------
train Loss: 0.9386 Acc: 0.9665
val Loss: 1.5212 Acc: 0.7727
Epoch 74/83
----------
train Loss: 1.2858 Acc: 0.9043
val Loss: 1.5164 Acc: 0.7500
Epoch 75/83
----------
train Loss: 1.0259 Acc: 0.9809
val Loss: 1.4404 Acc: 0.7500
Epoch 76/83
----------
train Loss: 1.0269 Acc: 0.8995
val Loss: 1.3556 Acc: 0.7500
Epoch 77/83
----------
train Loss: 1.2438 Acc: 0.9091
val Loss: 1.4264 Acc: 0.7500
Epoch 78/83
----------
train Loss: 1.1186 Acc: 0.9234
val Loss: 1.5660 Acc: 0.7500
Epoch 79/83
----------
train Loss: 1.2826 Acc: 0.9282
val Loss: 1.5019 Acc: 0.7500
Epoch 80/83
----------
train Loss: 1.1859 Acc: 0.9234
val Loss: 1.5261 Acc: 0.7500
Epoch 81/83
----------
train Loss: 1.3566 Acc: 0.8421
val Loss: 1.5978 Acc: 0.7045
Epoch 82/83
----------
train Loss: 1.1398 Acc: 0.8947
val Loss: 1.6667 Acc: 0.6818
Epoch 83/83
----------
train Loss: 1.0522 Acc: 0.9809
[32m[I 2025-06-29 12:37:05,268][0m Trial 163 finished with value: 0.6590909090909091 and parameters: {'batch_size': 14, 'lr': 0.0003261291394378145, 'num_epochs': 83, 'weight_decay': 0.00021522747338788384, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6991 Acc: 0.6591
Best val Acc: 0.659091

Model weights saved at ./model_weights/efficientnetb0_bs_14_lr_0.0003261291394378145_epoch_83_wd_0.00021522747338788384_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 3.2088 Acc: 0.3876
val Loss: 2.2262 Acc: 0.6364
Epoch 2/84
----------
train Loss: 2.4026 Acc: 0.5550
val Loss: 2.0719 Acc: 0.6364
Epoch 3/84
----------
train Loss: 2.1526 Acc: 0.5550
val Loss: 1.6421 Acc: 0.6818
Epoch 4/84
----------
train Loss: 2.0126 Acc: 0.6124
val Loss: 1.5565 Acc: 0.7727
Epoch 5/84
----------
train Loss: 1.8980 Acc: 0.7608
val Loss: 1.4145 Acc: 0.8182
Epoch 6/84
----------
train Loss: 1.7614 Acc: 0.7416
val Loss: 1.3051 Acc: 0.7955
Epoch 7/84
----------
train Loss: 1.4789 Acc: 0.8708
val Loss: 1.3599 Acc: 0.7500
Epoch 8/84
----------
train Loss: 1.6812 Acc: 0.7751
val Loss: 1.3391 Acc: 0.7500
Epoch 9/84
----------
train Loss: 1.6569 Acc: 0.8038
val Loss: 1.4900 Acc: 0.7727
Epoch 10/84
----------
train Loss: 1.0078 Acc: 0.9378
val Loss: 1.3291 Acc: 0.7955
Epoch 11/84
----------
train Loss: 1.6950 Acc: 0.8038
val Loss: 1.4410 Acc: 0.7727
Epoch 12/84
----------
train Loss: 1.4356 Acc: 0.7608
val Loss: 1.6926 Acc: 0.7500
Epoch 13/84
----------
train Loss: 1.3421 Acc: 0.8900
val Loss: 1.3170 Acc: 0.7727
Epoch 14/84
----------
train Loss: 1.2081 Acc: 0.8325
val Loss: 1.3026 Acc: 0.7500
Epoch 15/84
----------
train Loss: 1.4401 Acc: 0.8182
val Loss: 1.2520 Acc: 0.7727
Epoch 16/84
----------
train Loss: 1.4307 Acc: 0.8038
val Loss: 1.3178 Acc: 0.7727
Epoch 17/84
----------
train Loss: 1.3298 Acc: 0.8708
val Loss: 1.3351 Acc: 0.7500
Epoch 18/84
----------
train Loss: 1.3082 Acc: 0.8756
val Loss: 1.2306 Acc: 0.7727
Epoch 19/84
----------
train Loss: 1.1882 Acc: 0.9426
val Loss: 1.2079 Acc: 0.7273
Epoch 20/84
----------
train Loss: 1.2845 Acc: 0.8756
val Loss: 1.1401 Acc: 0.8409
Epoch 21/84
----------
train Loss: 1.3676 Acc: 0.8947
val Loss: 1.0656 Acc: 0.8409
Epoch 22/84
----------
train Loss: 1.2005 Acc: 0.8804
val Loss: 1.0257 Acc: 0.8636
Epoch 23/84
----------
train Loss: 1.4953 Acc: 0.8708
val Loss: 1.1508 Acc: 0.8182
Epoch 24/84
----------
train Loss: 1.0777 Acc: 0.9234
val Loss: 1.2724 Acc: 0.7727
Epoch 25/84
----------
train Loss: 1.2011 Acc: 0.9522
val Loss: 1.3467 Acc: 0.7500
Epoch 26/84
----------
train Loss: 1.3800 Acc: 0.9474
val Loss: 1.3168 Acc: 0.8182
Epoch 27/84
----------
train Loss: 1.1426 Acc: 0.9713
val Loss: 1.3216 Acc: 0.7727
Epoch 28/84
----------
train Loss: 1.2905 Acc: 0.8756
val Loss: 1.2542 Acc: 0.7727
Epoch 29/84
----------
train Loss: 1.3975 Acc: 0.7990
val Loss: 1.2374 Acc: 0.7955
Epoch 30/84
----------
train Loss: 1.2052 Acc: 0.8708
val Loss: 1.2522 Acc: 0.7045
Epoch 31/84
----------
train Loss: 1.0697 Acc: 0.9282
val Loss: 1.3548 Acc: 0.7500
Epoch 32/84
----------
train Loss: 1.1689 Acc: 0.9091
val Loss: 1.3291 Acc: 0.7955
Epoch 33/84
----------
train Loss: 1.2836 Acc: 0.8804
val Loss: 1.3189 Acc: 0.7955
Epoch 34/84
----------
train Loss: 1.2316 Acc: 0.9569
val Loss: 1.3850 Acc: 0.8182
Epoch 35/84
----------
train Loss: 0.9442 Acc: 0.9665
val Loss: 1.4599 Acc: 0.7955
Epoch 36/84
----------
train Loss: 1.4645 Acc: 0.8708
val Loss: 1.3416 Acc: 0.7955
Epoch 37/84
----------
train Loss: 1.2692 Acc: 0.8373
val Loss: 1.3487 Acc: 0.8409
Epoch 38/84
----------
train Loss: 1.3182 Acc: 0.9474
val Loss: 1.2615 Acc: 0.7727
Epoch 39/84
----------
train Loss: 1.2216 Acc: 0.8134
val Loss: 1.2619 Acc: 0.7955
Epoch 40/84
----------
train Loss: 1.0921 Acc: 0.9282
val Loss: 1.2983 Acc: 0.7045
Epoch 41/84
----------
train Loss: 1.4910 Acc: 0.7225
val Loss: 1.3016 Acc: 0.7045
Epoch 42/84
----------
train Loss: 1.0519 Acc: 0.9282
val Loss: 1.3608 Acc: 0.7273
Epoch 43/84
----------
train Loss: 1.2184 Acc: 0.8852
val Loss: 1.2687 Acc: 0.7727
Epoch 44/84
----------
train Loss: 1.1126 Acc: 0.8947
val Loss: 1.3108 Acc: 0.8182
Epoch 45/84
----------
train Loss: 0.7608 Acc: 0.9617
val Loss: 1.2489 Acc: 0.8182
Epoch 46/84
----------
train Loss: 1.5200 Acc: 0.8469
val Loss: 1.2902 Acc: 0.7955
Epoch 47/84
----------
train Loss: 1.1366 Acc: 0.9378
val Loss: 1.3431 Acc: 0.7727
Epoch 48/84
----------
train Loss: 1.2415 Acc: 0.8517
val Loss: 1.3863 Acc: 0.6818
Epoch 49/84
----------
train Loss: 1.2319 Acc: 0.9665
val Loss: 1.2493 Acc: 0.8182
Epoch 50/84
----------
train Loss: 1.1840 Acc: 0.8852
val Loss: 1.2217 Acc: 0.8409
Epoch 51/84
----------
train Loss: 0.9530 Acc: 0.9856
val Loss: 1.2608 Acc: 0.8409
Epoch 52/84
----------
train Loss: 1.2229 Acc: 0.8708
val Loss: 1.2521 Acc: 0.7955
Epoch 53/84
----------
train Loss: 1.4008 Acc: 0.9234
val Loss: 1.2176 Acc: 0.7045
Epoch 54/84
----------
train Loss: 1.1035 Acc: 0.9474
val Loss: 1.3640 Acc: 0.7500
Epoch 55/84
----------
train Loss: 1.1430 Acc: 0.9569
val Loss: 1.4387 Acc: 0.7273
Epoch 56/84
----------
train Loss: 1.3174 Acc: 0.9522
val Loss: 1.2340 Acc: 0.7045
Epoch 57/84
----------
train Loss: 1.4096 Acc: 0.8995
val Loss: 1.2490 Acc: 0.7500
Epoch 58/84
----------
train Loss: 1.1119 Acc: 0.8469
val Loss: 1.2762 Acc: 0.7500
Epoch 59/84
----------
train Loss: 1.1713 Acc: 0.9426
val Loss: 1.3403 Acc: 0.7045
Epoch 60/84
----------
train Loss: 0.9734 Acc: 0.9282
val Loss: 1.2183 Acc: 0.7045
Epoch 61/84
----------
train Loss: 1.3692 Acc: 0.7990
val Loss: 1.2650 Acc: 0.6818
Epoch 62/84
----------
train Loss: 1.3642 Acc: 0.9617
val Loss: 1.4071 Acc: 0.6818
Epoch 63/84
----------
train Loss: 1.1729 Acc: 0.9569
val Loss: 1.4541 Acc: 0.6364
Epoch 64/84
----------
train Loss: 1.0219 Acc: 0.9569
val Loss: 1.4627 Acc: 0.6364
Epoch 65/84
----------
train Loss: 1.1948 Acc: 0.8900
val Loss: 1.4325 Acc: 0.6591
Epoch 66/84
----------
train Loss: 1.1791 Acc: 0.8995
val Loss: 1.4167 Acc: 0.7273
Epoch 67/84
----------
train Loss: 1.3290 Acc: 0.8804
val Loss: 1.4468 Acc: 0.7045
Epoch 68/84
----------
train Loss: 1.1218 Acc: 0.9091
val Loss: 1.3986 Acc: 0.7500
Epoch 69/84
----------
train Loss: 1.0416 Acc: 0.8947
val Loss: 1.4222 Acc: 0.7500
Epoch 70/84
----------
train Loss: 1.2282 Acc: 0.9091
val Loss: 1.4149 Acc: 0.7500
Epoch 71/84
----------
train Loss: 1.2889 Acc: 0.9187
val Loss: 1.3904 Acc: 0.7273
Epoch 72/84
----------
train Loss: 1.2964 Acc: 0.8852
val Loss: 1.2920 Acc: 0.7955
Epoch 73/84
----------
train Loss: 0.9261 Acc: 0.9761
val Loss: 1.3618 Acc: 0.8182
Epoch 74/84
----------
train Loss: 1.3107 Acc: 0.8947
val Loss: 1.4030 Acc: 0.7500
Epoch 75/84
----------
train Loss: 1.0374 Acc: 0.9952
val Loss: 1.3466 Acc: 0.7727
Epoch 76/84
----------
train Loss: 1.0324 Acc: 0.9043
val Loss: 1.3048 Acc: 0.7500
Epoch 77/84
----------
train Loss: 1.2450 Acc: 0.8900
val Loss: 1.3835 Acc: 0.7500
Epoch 78/84
----------
train Loss: 1.1365 Acc: 0.9282
val Loss: 1.3747 Acc: 0.7273
Epoch 79/84
----------
train Loss: 1.2580 Acc: 0.9522
val Loss: 1.2636 Acc: 0.7727
Epoch 80/84
----------
train Loss: 1.1791 Acc: 0.8900
val Loss: 1.2658 Acc: 0.7273
Epoch 81/84
----------
train Loss: 1.3385 Acc: 0.8469
val Loss: 1.4177 Acc: 0.7273
Epoch 82/84
----------
train Loss: 1.1517 Acc: 0.9091
val Loss: 1.5079 Acc: 0.6591
Epoch 83/84
----------
train Loss: 1.0547 Acc: 0.9856
val Loss: 1.5522 Acc: 0.7273
Epoch 84/84
----------
train Loss: 1.3057 Acc: 0.8278
[32m[I 2025-06-29 12:56:11,441][0m Trial 164 finished with value: 0.7272727272727273 and parameters: {'batch_size': 76, 'lr': 0.0006176471553763782, 'num_epochs': 84, 'weight_decay': 0.00027816371749252703, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5234 Acc: 0.6591
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_76_lr_0.0006176471553763782_epoch_84_wd_0.00027816371749252703_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 3.3929 Acc: 0.3589
val Loss: 3.0175 Acc: 0.6136
Epoch 2/87
----------
train Loss: 2.6293 Acc: 0.5215
val Loss: 2.1257 Acc: 0.6364
Epoch 3/87
----------
train Loss: 2.3014 Acc: 0.5167
val Loss: 1.9491 Acc: 0.6364
Epoch 4/87
----------
train Loss: 2.1986 Acc: 0.5120
val Loss: 1.9706 Acc: 0.7500
Epoch 5/87
----------
train Loss: 2.1256 Acc: 0.6316
val Loss: 1.9047 Acc: 0.7727
Epoch 6/87
----------
train Loss: 1.9514 Acc: 0.6411
val Loss: 1.8070 Acc: 0.7955
Epoch 7/87
----------
train Loss: 1.7758 Acc: 0.7273
val Loss: 1.6792 Acc: 0.8182
Epoch 8/87
----------
train Loss: 1.8344 Acc: 0.7368
val Loss: 1.5762 Acc: 0.7955
Epoch 9/87
----------
train Loss: 1.7723 Acc: 0.7560
val Loss: 1.7500 Acc: 0.7727
Epoch 10/87
----------
train Loss: 1.1663 Acc: 0.9378
val Loss: 1.3917 Acc: 0.8409
Epoch 11/87
----------
train Loss: 1.7095 Acc: 0.7895
val Loss: 1.2468 Acc: 0.8864
Epoch 12/87
----------
train Loss: 1.5296 Acc: 0.7416
val Loss: 1.8337 Acc: 0.7955
Epoch 13/87
----------
train Loss: 1.3520 Acc: 0.8900
val Loss: 1.6217 Acc: 0.7727
Epoch 14/87
----------
train Loss: 1.2745 Acc: 0.8373
val Loss: 1.5193 Acc: 0.7727
Epoch 15/87
----------
train Loss: 1.4184 Acc: 0.8230
val Loss: 1.1846 Acc: 0.7955
Epoch 16/87
----------
train Loss: 1.5067 Acc: 0.8134
[32m[I 2025-06-29 12:59:50,356][0m Trial 165 finished with value: 0.8863636363636364 and parameters: {'batch_size': 98, 'lr': 0.0004625918864316006, 'num_epochs': 87, 'weight_decay': 0.021709399136759587, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4940 Acc: 0.7955
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.886364

Model weights saved at ./model_weights/efficientnetb0_bs_98_lr_0.0004625918864316006_epoch_87_wd_0.021709399136759587_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 3.4591 Acc: 0.3493
val Loss: 3.1459 Acc: 0.5909
Epoch 2/86
----------
train Loss: 2.7541 Acc: 0.5215
val Loss: 2.3417 Acc: 0.6364
Epoch 3/86
----------
train Loss: 2.3856 Acc: 0.5072
val Loss: 2.0033 Acc: 0.6364
Epoch 4/86
----------
train Loss: 2.2619 Acc: 0.5024
val Loss: 1.9559 Acc: 0.6818
Epoch 5/86
----------
train Loss: 2.1946 Acc: 0.5742
val Loss: 1.9049 Acc: 0.7273
Epoch 6/86
----------
train Loss: 2.0292 Acc: 0.5837
val Loss: 1.8773 Acc: 0.7727
Epoch 7/86
----------
train Loss: 1.8885 Acc: 0.6746
val Loss: 1.8461 Acc: 0.7955
Epoch 8/86
----------
train Loss: 1.9430 Acc: 0.6842
val Loss: 1.6498 Acc: 0.7955
Epoch 9/86
----------
train Loss: 1.8595 Acc: 0.7368
val Loss: 1.7146 Acc: 0.7273
Epoch 10/86
----------
train Loss: 1.3113 Acc: 0.9234
val Loss: 1.5123 Acc: 0.7955
Epoch 11/86
----------
train Loss: 1.7054 Acc: 0.7560
val Loss: 1.3032 Acc: 0.8409
Epoch 12/86
----------
train Loss: 1.5849 Acc: 0.7416
val Loss: 1.5344 Acc: 0.8182
Epoch 13/86
----------
train Loss: 1.3766 Acc: 0.8947
val Loss: 1.4659 Acc: 0.7727
Epoch 14/86
----------
train Loss: 1.2659 Acc: 0.8230
val Loss: 1.5162 Acc: 0.7045
Epoch 15/86
----------
train Loss: 1.4668 Acc: 0.8134
val Loss: 1.3051 Acc: 0.7500
Epoch 16/86
----------
train Loss: 1.5258 Acc: 0.7847
val Loss: 1.7470 Acc: 0.7273
Epoch 17/86
----------
train Loss: 1.4593 Acc: 0.8565
val Loss: 1.6904 Acc: 0.7955
Epoch 18/86
----------
train Loss: 1.3643 Acc: 0.8086
val Loss: 1.3772 Acc: 0.8409
Epoch 19/86
----------
train Loss: 1.2520 Acc: 0.9378
val Loss: 1.3427 Acc: 0.7273
Epoch 20/86
----------
train Loss: 1.3883 Acc: 0.8517
val Loss: 1.2795 Acc: 0.6818
Epoch 21/86
----------
train Loss: 1.4854 Acc: 0.8708
val Loss: 1.2922 Acc: 0.7500
Epoch 22/86
----------
train Loss: 1.3120 Acc: 0.8804
val Loss: 1.3654 Acc: 0.7955
Epoch 23/86
----------
train Loss: 1.5148 Acc: 0.8565
val Loss: 1.4534 Acc: 0.7955
Epoch 24/86
----------
train Loss: 1.1245 Acc: 0.9234
val Loss: 1.3272 Acc: 0.7727
Epoch 25/86
----------
train Loss: 1.3185 Acc: 0.9234
val Loss: 1.6224 Acc: 0.7955
Epoch 26/86
----------
train Loss: 1.4559 Acc: 0.9378
val Loss: 1.3913 Acc: 0.7727
Epoch 27/86
----------
train Loss: 1.2079 Acc: 0.9522
val Loss: 1.4370 Acc: 0.7727
Epoch 28/86
----------
train Loss: 1.3968 Acc: 0.8517
val Loss: 1.2481 Acc: 0.7955
Epoch 29/86
----------
train Loss: 1.4788 Acc: 0.7990
val Loss: 1.3390 Acc: 0.8636
Epoch 30/86
----------
train Loss: 1.3066 Acc: 0.8517
val Loss: 1.1731 Acc: 0.8636
Epoch 31/86
----------
train Loss: 1.1425 Acc: 0.9426
val Loss: 1.2091 Acc: 0.8636
Epoch 32/86
----------
train Loss: 1.2983 Acc: 0.9091
val Loss: 1.1642 Acc: 0.7955
Epoch 33/86
----------
train Loss: 1.4279 Acc: 0.8900
val Loss: 1.2442 Acc: 0.8182
Epoch 34/86
----------
train Loss: 1.3242 Acc: 0.9282
val Loss: 1.5517 Acc: 0.7500
Epoch 35/86
----------
train Loss: 1.0727 Acc: 0.9474
val Loss: 1.4681 Acc: 0.7500
Epoch 36/86
----------
train Loss: 1.6104 Acc: 0.8612
val Loss: 1.4291 Acc: 0.7500
Epoch 37/86
----------
train Loss: 1.4201 Acc: 0.8086
val Loss: 1.6210 Acc: 0.7273
Epoch 38/86
----------
train Loss: 1.4788 Acc: 0.9282
val Loss: 1.2101 Acc: 0.7955
Epoch 39/86
----------
train Loss: 1.3850 Acc: 0.7799
val Loss: 1.6597 Acc: 0.7727
Epoch 40/86
----------
train Loss: 1.2283 Acc: 0.9187
val Loss: 1.3039 Acc: 0.7500
Epoch 41/86
----------
train Loss: 1.5968 Acc: 0.7129
val Loss: 1.2675 Acc: 0.7273
Epoch 42/86
----------
train Loss: 1.2598 Acc: 0.8325
val Loss: 1.5066 Acc: 0.7045
Epoch 43/86
----------
train Loss: 1.3304 Acc: 0.8900
val Loss: 1.4387 Acc: 0.7273
Epoch 44/86
----------
train Loss: 1.2474 Acc: 0.8804
val Loss: 1.5910 Acc: 0.7727
Epoch 45/86
----------
train Loss: 0.8362 Acc: 0.9569
val Loss: 1.4810 Acc: 0.7955
Epoch 46/86
----------
train Loss: 1.7126 Acc: 0.8086
val Loss: 1.5511 Acc: 0.7500
Epoch 47/86
----------
train Loss: 1.2965 Acc: 0.8756
val Loss: 1.6342 Acc: 0.7045
Epoch 48/86
----------
train Loss: 1.3846 Acc: 0.8565
val Loss: 1.5794 Acc: 0.7045
Epoch 49/86
----------
train Loss: 1.3372 Acc: 0.9474
val Loss: 1.4594 Acc: 0.8409
Epoch 50/86
----------
train Loss: 1.2917 Acc: 0.8660
val Loss: 1.4466 Acc: 0.7500
Epoch 51/86
----------
train Loss: 1.0042 Acc: 0.9665
val Loss: 1.4276 Acc: 0.7045
Epoch 52/86
----------
train Loss: 1.3573 Acc: 0.8421
val Loss: 1.3283 Acc: 0.7500
Epoch 53/86
----------
train Loss: 1.5502 Acc: 0.8995
val Loss: 1.6396 Acc: 0.7045
Epoch 54/86
----------
train Loss: 1.2480 Acc: 0.9234
val Loss: 1.5403 Acc: 0.7955
Epoch 55/86
----------
train Loss: 1.2557 Acc: 0.9522
val Loss: 1.5884 Acc: 0.7273
Epoch 56/86
----------
train Loss: 1.4414 Acc: 0.9091
val Loss: 1.4594 Acc: 0.7273
Epoch 57/86
----------
train Loss: 1.5791 Acc: 0.8230
val Loss: 1.4679 Acc: 0.7045
Epoch 58/86
----------
train Loss: 1.2855 Acc: 0.8278
val Loss: 1.5180 Acc: 0.7955
Epoch 59/86
----------
train Loss: 1.4220 Acc: 0.8517
val Loss: 1.6059 Acc: 0.6591
Epoch 60/86
----------
train Loss: 1.1551 Acc: 0.8852
val Loss: 1.3508 Acc: 0.7273
Epoch 61/86
----------
train Loss: 1.5648 Acc: 0.7703
val Loss: 1.3252 Acc: 0.7273
Epoch 62/86
----------
train Loss: 1.4953 Acc: 0.9187
val Loss: 1.5604 Acc: 0.7045
Epoch 63/86
----------
train Loss: 1.3280 Acc: 0.9139
[32m[I 2025-06-29 13:14:11,581][0m Trial 166 finished with value: 0.7954545454545455 and parameters: {'batch_size': 97, 'lr': 0.00038988446082790926, 'num_epochs': 86, 'weight_decay': 0.025018718404852792, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6013 Acc: 0.7045
Early stopping at epoch 63 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_97_lr_0.00038988446082790926_epoch_86_wd_0.025018718404852792_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 3.3351 Acc: 0.3684
val Loss: 2.8375 Acc: 0.6364
Epoch 2/90
----------
train Loss: 2.5295 Acc: 0.5407
val Loss: 1.9834 Acc: 0.6364
Epoch 3/90
----------
train Loss: 2.2390 Acc: 0.5215
val Loss: 1.8895 Acc: 0.6591
Epoch 4/90
----------
train Loss: 2.1386 Acc: 0.5455
val Loss: 1.9210 Acc: 0.7273
Epoch 5/90
----------
train Loss: 2.0552 Acc: 0.6507
val Loss: 1.7771 Acc: 0.7727
Epoch 6/90
----------
train Loss: 1.8758 Acc: 0.6794
val Loss: 1.6047 Acc: 0.7955
Epoch 7/90
----------
train Loss: 1.6428 Acc: 0.7990
val Loss: 1.4522 Acc: 0.7955
Epoch 8/90
----------
train Loss: 1.7278 Acc: 0.7656
val Loss: 1.4974 Acc: 0.7955
Epoch 9/90
----------
train Loss: 1.7126 Acc: 0.7512
val Loss: 1.6293 Acc: 0.7727
Epoch 10/90
----------
train Loss: 1.0608 Acc: 0.9426
val Loss: 1.2085 Acc: 0.8182
Epoch 11/90
----------
train Loss: 1.7704 Acc: 0.7943
val Loss: 1.3607 Acc: 0.8636
Epoch 12/90
----------
train Loss: 1.5138 Acc: 0.7560
val Loss: 2.1871 Acc: 0.7500
Epoch 13/90
----------
train Loss: 1.3611 Acc: 0.8947
val Loss: 1.6112 Acc: 0.7955
Epoch 14/90
----------
train Loss: 1.2669 Acc: 0.8278
val Loss: 1.5152 Acc: 0.7500
Epoch 15/90
----------
train Loss: 1.4072 Acc: 0.8469
val Loss: 1.1793 Acc: 0.8182
Epoch 16/90
----------
train Loss: 1.4478 Acc: 0.8038
val Loss: 1.4004 Acc: 0.8636
Epoch 17/90
----------
train Loss: 1.4302 Acc: 0.8469
val Loss: 1.3992 Acc: 0.7955
Epoch 18/90
----------
train Loss: 1.3559 Acc: 0.8278
val Loss: 1.2864 Acc: 0.7955
Epoch 19/90
----------
train Loss: 1.2525 Acc: 0.9091
val Loss: 1.3254 Acc: 0.8182
Epoch 20/90
----------
train Loss: 1.3560 Acc: 0.8660
val Loss: 1.2804 Acc: 0.7045
Epoch 21/90
----------
train Loss: 1.4643 Acc: 0.8852
val Loss: 1.2657 Acc: 0.7500
Epoch 22/90
----------
train Loss: 1.2976 Acc: 0.8612
val Loss: 1.5672 Acc: 0.7727
Epoch 23/90
----------
train Loss: 1.5201 Acc: 0.8804
val Loss: 1.4377 Acc: 0.7500
Epoch 24/90
----------
train Loss: 1.1965 Acc: 0.8900
val Loss: 1.3203 Acc: 0.7727
Epoch 25/90
----------
train Loss: 1.2689 Acc: 0.9330
val Loss: 1.6061 Acc: 0.7273
Epoch 26/90
----------
train Loss: 1.4341 Acc: 0.9282
val Loss: 1.4509 Acc: 0.7727
Epoch 27/90
----------
train Loss: 1.2129 Acc: 0.9617
val Loss: 1.4824 Acc: 0.7955
Epoch 28/90
----------
train Loss: 1.4387 Acc: 0.8373
val Loss: 1.2380 Acc: 0.8409
Epoch 29/90
----------
train Loss: 1.5113 Acc: 0.7847
val Loss: 1.2929 Acc: 0.8409
Epoch 30/90
----------
train Loss: 1.3493 Acc: 0.8325
val Loss: 1.1312 Acc: 0.7955
Epoch 31/90
----------
train Loss: 1.1373 Acc: 0.9426
val Loss: 1.2601 Acc: 0.7727
Epoch 32/90
----------
train Loss: 1.2484 Acc: 0.8947
val Loss: 1.3701 Acc: 0.7727
Epoch 33/90
----------
train Loss: 1.4280 Acc: 0.8756
val Loss: 1.4649 Acc: 0.7273
Epoch 34/90
----------
train Loss: 1.3689 Acc: 0.9234
val Loss: 1.5495 Acc: 0.7727
Epoch 35/90
----------
train Loss: 1.0671 Acc: 0.9569
val Loss: 1.4071 Acc: 0.7273
Epoch 36/90
----------
train Loss: 1.5907 Acc: 0.8660
val Loss: 1.2824 Acc: 0.8182
Epoch 37/90
----------
train Loss: 1.3726 Acc: 0.8469
val Loss: 1.3460 Acc: 0.7727
Epoch 38/90
----------
train Loss: 1.4476 Acc: 0.9474
val Loss: 1.4535 Acc: 0.7955
Epoch 39/90
----------
train Loss: 1.3913 Acc: 0.7703
val Loss: 1.7860 Acc: 0.7955
Epoch 40/90
----------
train Loss: 1.2579 Acc: 0.9043
val Loss: 1.4755 Acc: 0.7500
Epoch 41/90
----------
train Loss: 1.6667 Acc: 0.7081
val Loss: 1.7411 Acc: 0.7500
Epoch 42/90
----------
train Loss: 1.3155 Acc: 0.8373
val Loss: 1.7657 Acc: 0.6818
Epoch 43/90
----------
train Loss: 1.3394 Acc: 0.8660
val Loss: 1.5055 Acc: 0.7045
Epoch 44/90
----------
train Loss: 1.2422 Acc: 0.8804
val Loss: 1.5310 Acc: 0.7045
Epoch 45/90
----------
train Loss: 0.8375 Acc: 0.9569
val Loss: 1.6107 Acc: 0.7045
Epoch 46/90
----------
train Loss: 1.6947 Acc: 0.8134
val Loss: 1.6639 Acc: 0.6818
Epoch 47/90
----------
train Loss: 1.3587 Acc: 0.8612
val Loss: 1.6546 Acc: 0.6591
Epoch 48/90
----------
train Loss: 1.3516 Acc: 0.8325
val Loss: 1.8155 Acc: 0.7727
Epoch 49/90
----------
train Loss: 1.3492 Acc: 0.8900
val Loss: 1.5615 Acc: 0.7500
Epoch 50/90
----------
train Loss: 1.2967 Acc: 0.8565
val Loss: 1.3227 Acc: 0.7045
Epoch 51/90
----------
train Loss: 1.0170 Acc: 0.9713
val Loss: 1.7442 Acc: 0.7500
Epoch 52/90
----------
train Loss: 1.3075 Acc: 0.8517
val Loss: 1.3112 Acc: 0.7500
Epoch 53/90
----------
train Loss: 1.4834 Acc: 0.9282
val Loss: 1.4336 Acc: 0.7500
Epoch 54/90
----------
train Loss: 1.2626 Acc: 0.8947
val Loss: 1.3406 Acc: 0.7955
Epoch 55/90
----------
train Loss: 1.2549 Acc: 0.9330
val Loss: 1.5762 Acc: 0.7500
Epoch 56/90
----------
train Loss: 1.4419 Acc: 0.9043
val Loss: 1.5097 Acc: 0.7500
Epoch 57/90
----------
train Loss: 1.5881 Acc: 0.8373
val Loss: 1.5722 Acc: 0.7955
Epoch 58/90
----------
train Loss: 1.2827 Acc: 0.8325
val Loss: 1.4292 Acc: 0.6818
Epoch 59/90
----------
train Loss: 1.3589 Acc: 0.8804
val Loss: 1.6957 Acc: 0.6591
Epoch 60/90
----------
train Loss: 1.0993 Acc: 0.9091
val Loss: 1.5085 Acc: 0.7273
Epoch 61/90
----------
train Loss: 1.5593 Acc: 0.7799
val Loss: 1.5580 Acc: 0.7045
Epoch 62/90
----------
train Loss: 1.5209 Acc: 0.9091
[32m[I 2025-06-29 13:28:18,461][0m Trial 167 finished with value: 0.7954545454545455 and parameters: {'batch_size': 80, 'lr': 0.0005175817845595156, 'num_epochs': 90, 'weight_decay': 0.015813994816349094, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5355 Acc: 0.7273
Early stopping at epoch 62 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_80_lr_0.0005175817845595156_epoch_90_wd_0.015813994816349094_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/96
----------
train Loss: 3.3059 Acc: 0.3780
val Loss: 2.5384 Acc: 0.6364
Epoch 2/96
----------
train Loss: 2.4713 Acc: 0.5407
val Loss: 1.9852 Acc: 0.6364
Epoch 3/96
----------
train Loss: 2.1862 Acc: 0.5311
val Loss: 1.7760 Acc: 0.6591
Epoch 4/96
----------
train Loss: 2.0782 Acc: 0.5646
val Loss: 1.5734 Acc: 0.7727
Epoch 5/96
----------
train Loss: 1.9815 Acc: 0.7129
val Loss: 1.4076 Acc: 0.8182
Epoch 6/96
----------
train Loss: 1.8024 Acc: 0.6938
val Loss: 1.2892 Acc: 0.8409
Epoch 7/96
----------
train Loss: 1.5400 Acc: 0.8469
val Loss: 1.2139 Acc: 0.7955
Epoch 8/96
----------
train Loss: 1.7143 Acc: 0.7703
val Loss: 1.2462 Acc: 0.8182
Epoch 9/96
----------
train Loss: 1.6826 Acc: 0.7847
val Loss: 1.3929 Acc: 0.7955
Epoch 10/96
----------
train Loss: 1.0163 Acc: 0.9522
val Loss: 1.2589 Acc: 0.7727
Epoch 11/96
----------
train Loss: 1.7220 Acc: 0.7847
val Loss: 1.2429 Acc: 0.7727
Epoch 12/96
----------
train Loss: 1.4427 Acc: 0.7847
val Loss: 1.5559 Acc: 0.7500
Epoch 13/96
----------
train Loss: 1.3344 Acc: 0.8995
val Loss: 1.3335 Acc: 0.7727
Epoch 14/96
----------
train Loss: 1.2164 Acc: 0.8421
val Loss: 1.2561 Acc: 0.8409
Epoch 15/96
----------
train Loss: 1.3830 Acc: 0.8278
val Loss: 1.1507 Acc: 0.8182
Epoch 16/96
----------
train Loss: 1.3852 Acc: 0.7990
val Loss: 1.2559 Acc: 0.8409
Epoch 17/96
----------
train Loss: 1.3543 Acc: 0.8660
val Loss: 1.3245 Acc: 0.7727
Epoch 18/96
----------
train Loss: 1.3008 Acc: 0.8756
val Loss: 1.2291 Acc: 0.7500
Epoch 19/96
----------
train Loss: 1.2027 Acc: 0.9378
val Loss: 1.1069 Acc: 0.7500
Epoch 20/96
----------
train Loss: 1.3138 Acc: 0.8708
val Loss: 1.1005 Acc: 0.7955
Epoch 21/96
----------
train Loss: 1.4155 Acc: 0.8900
val Loss: 1.0884 Acc: 0.8409
Epoch 22/96
----------
train Loss: 1.2131 Acc: 0.8900
val Loss: 1.1718 Acc: 0.7955
Epoch 23/96
----------
train Loss: 1.4925 Acc: 0.8469
val Loss: 1.2910 Acc: 0.7273
Epoch 24/96
----------
train Loss: 1.0444 Acc: 0.9426
val Loss: 1.3695 Acc: 0.7273
Epoch 25/96
----------
train Loss: 1.2023 Acc: 0.9569
val Loss: 1.3989 Acc: 0.7273
Epoch 26/96
----------
train Loss: 1.3987 Acc: 0.9569
val Loss: 1.3295 Acc: 0.7727
Epoch 27/96
----------
train Loss: 1.1263 Acc: 0.9665
val Loss: 1.3122 Acc: 0.7955
Epoch 28/96
----------
train Loss: 1.2950 Acc: 0.8565
val Loss: 1.2583 Acc: 0.7727
Epoch 29/96
----------
train Loss: 1.4232 Acc: 0.8086
val Loss: 1.0581 Acc: 0.7727
Epoch 30/96
----------
train Loss: 1.2222 Acc: 0.8612
val Loss: 0.9934 Acc: 0.8182
Epoch 31/96
----------
train Loss: 1.0744 Acc: 0.9282
val Loss: 1.0648 Acc: 0.8409
Epoch 32/96
----------
train Loss: 1.1809 Acc: 0.9091
val Loss: 1.1165 Acc: 0.7727
Epoch 33/96
----------
train Loss: 1.2957 Acc: 0.8852
val Loss: 1.1492 Acc: 0.7955
Epoch 34/96
----------
train Loss: 1.2114 Acc: 0.9713
val Loss: 1.2551 Acc: 0.7955
Epoch 35/96
----------
train Loss: 0.9475 Acc: 0.9713
val Loss: 1.3739 Acc: 0.7500
Epoch 36/96
----------
train Loss: 1.4945 Acc: 0.8469
val Loss: 1.2211 Acc: 0.8182
Epoch 37/96
----------
train Loss: 1.2574 Acc: 0.8230
val Loss: 1.2512 Acc: 0.8182
Epoch 38/96
----------
train Loss: 1.3087 Acc: 0.9569
val Loss: 1.2031 Acc: 0.8182
Epoch 39/96
----------
train Loss: 1.2484 Acc: 0.7990
val Loss: 1.2601 Acc: 0.7727
Epoch 40/96
----------
train Loss: 1.0847 Acc: 0.9234
val Loss: 1.2212 Acc: 0.7500
Epoch 41/96
----------
train Loss: 1.4910 Acc: 0.7225
val Loss: 1.1589 Acc: 0.7727
Epoch 42/96
----------
train Loss: 1.0853 Acc: 0.9234
val Loss: 1.2200 Acc: 0.7500
Epoch 43/96
----------
train Loss: 1.2375 Acc: 0.8804
val Loss: 1.2175 Acc: 0.7500
Epoch 44/96
----------
train Loss: 1.1451 Acc: 0.8852
val Loss: 1.2563 Acc: 0.7727
Epoch 45/96
----------
train Loss: 0.7561 Acc: 0.9617
val Loss: 1.2044 Acc: 0.7727
Epoch 46/96
----------
train Loss: 1.5450 Acc: 0.8373
val Loss: 1.2544 Acc: 0.7500
Epoch 47/96
----------
train Loss: 1.1554 Acc: 0.9426
val Loss: 1.3546 Acc: 0.7273
Epoch 48/96
----------
train Loss: 1.2314 Acc: 0.8852
val Loss: 1.3153 Acc: 0.7955
Epoch 49/96
----------
train Loss: 1.2651 Acc: 0.9522
val Loss: 1.1971 Acc: 0.7045
Epoch 50/96
----------
train Loss: 1.1981 Acc: 0.8804
val Loss: 1.2161 Acc: 0.7500
Epoch 51/96
----------
train Loss: 0.9333 Acc: 0.9952
val Loss: 1.2206 Acc: 0.7955
Epoch 52/96
----------
train Loss: 1.2105 Acc: 0.8852
val Loss: 1.2266 Acc: 0.7727
Epoch 53/96
----------
train Loss: 1.4040 Acc: 0.9474
val Loss: 1.2072 Acc: 0.8182
Epoch 54/96
----------
train Loss: 1.0873 Acc: 0.9474
val Loss: 1.2638 Acc: 0.8182
Epoch 55/96
----------
train Loss: 1.1366 Acc: 0.9522
val Loss: 1.4096 Acc: 0.7273
Epoch 56/96
----------
train Loss: 1.2995 Acc: 0.9522
val Loss: 1.2945 Acc: 0.7045
Epoch 57/96
----------
train Loss: 1.4302 Acc: 0.8756
val Loss: 1.3368 Acc: 0.7273
Epoch 58/96
----------
train Loss: 1.1278 Acc: 0.8421
val Loss: 1.3179 Acc: 0.7273
Epoch 59/96
----------
train Loss: 1.1825 Acc: 0.9330
[32m[I 2025-06-29 13:41:45,661][0m Trial 168 finished with value: 0.8181818181818182 and parameters: {'batch_size': 82, 'lr': 0.0004953375930392174, 'num_epochs': 96, 'weight_decay': 0.00034525961576433546, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3856 Acc: 0.6818
Early stopping at epoch 59 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_82_lr_0.0004953375930392174_epoch_96_wd_0.00034525961576433546_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/71
----------
train Loss: 5.3976 Acc: 0.3541
val Loss: 4.4958 Acc: 0.6591
Epoch 2/71
----------
train Loss: 2.4322 Acc: 0.8230
val Loss: 4.4422 Acc: 0.7955
Epoch 3/71
----------
train Loss: 0.6858 Acc: 0.9617
val Loss: 6.5218 Acc: 0.7045
Epoch 4/71
----------
train Loss: 0.4456 Acc: 0.9761
val Loss: 3.5171 Acc: 0.7500
Epoch 5/71
----------
train Loss: 0.4147 Acc: 0.9617
val Loss: 3.0063 Acc: 0.7500
Epoch 6/71
----------
train Loss: 0.8537 Acc: 0.9474
val Loss: 3.6515 Acc: 0.7727
Epoch 7/71
----------
train Loss: 1.0382 Acc: 0.9187
val Loss: 3.3478 Acc: 0.7045
Epoch 8/71
----------
train Loss: 1.0120 Acc: 0.8947
val Loss: 4.9838 Acc: 0.6818
Epoch 9/71
----------
train Loss: 1.0105 Acc: 0.9378
val Loss: 2.6059 Acc: 0.7727
Epoch 10/71
----------
train Loss: 1.3079 Acc: 0.8947
val Loss: 2.7068 Acc: 0.7500
Epoch 11/71
----------
train Loss: 0.9917 Acc: 0.9234
val Loss: 4.3599 Acc: 0.6364
Epoch 12/71
----------
train Loss: 0.4944 Acc: 0.9617
val Loss: 3.5703 Acc: 0.6591
Epoch 13/71
----------
train Loss: 0.6772 Acc: 0.9569
val Loss: 2.5932 Acc: 0.6818
Epoch 14/71
----------
train Loss: 0.5291 Acc: 0.9569
val Loss: 3.0337 Acc: 0.6818
Epoch 15/71
----------
train Loss: 0.6960 Acc: 0.9378
[32m[I 2025-06-29 13:45:10,219][0m Trial 169 finished with value: 0.75 and parameters: {'batch_size': 65, 'lr': 0.0010323024514854852, 'num_epochs': 71, 'weight_decay': 0.020249686376768345, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 5.3473 Acc: 0.6591
Early stopping at epoch 15 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_65_lr_0.0010323024514854852_epoch_71_wd_0.020249686376768345_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/87
----------
train Loss: 3.1813 Acc: 0.3971
val Loss: 2.4028 Acc: 0.6364
Epoch 2/87
----------
train Loss: 2.3965 Acc: 0.5455
val Loss: 1.9024 Acc: 0.6364
Epoch 3/87
----------
train Loss: 2.1500 Acc: 0.5694
val Loss: 2.0447 Acc: 0.7045
Epoch 4/87
----------
train Loss: 2.0366 Acc: 0.5933
val Loss: 2.1067 Acc: 0.7955
Epoch 5/87
----------
train Loss: 1.8948 Acc: 0.7321
val Loss: 1.7524 Acc: 0.7955
Epoch 6/87
----------
train Loss: 1.7705 Acc: 0.7464
val Loss: 1.4774 Acc: 0.8182
Epoch 7/87
----------
train Loss: 1.4860 Acc: 0.8900
val Loss: 1.5255 Acc: 0.7955
Epoch 8/87
----------
train Loss: 1.7095 Acc: 0.7656
val Loss: 1.6611 Acc: 0.7500
Epoch 9/87
----------
train Loss: 1.7150 Acc: 0.7656
val Loss: 1.9608 Acc: 0.8182
Epoch 10/87
----------
train Loss: 1.0749 Acc: 0.9378
val Loss: 1.4012 Acc: 0.7727
Epoch 11/87
----------
train Loss: 1.7576 Acc: 0.8086
val Loss: 2.1704 Acc: 0.6364
Epoch 12/87
----------
train Loss: 1.5066 Acc: 0.7847
val Loss: 2.1010 Acc: 0.7045
Epoch 13/87
----------
train Loss: 1.3996 Acc: 0.8804
val Loss: 1.5468 Acc: 0.7727
Epoch 14/87
----------
train Loss: 1.3426 Acc: 0.8373
val Loss: 1.6475 Acc: 0.7273
Epoch 15/87
----------
train Loss: 1.4870 Acc: 0.8469
val Loss: 1.8004 Acc: 0.7273
Epoch 16/87
----------
train Loss: 1.5103 Acc: 0.7990
val Loss: 2.4618 Acc: 0.7045
Epoch 17/87
----------
train Loss: 1.3933 Acc: 0.8325
val Loss: 1.7894 Acc: 0.7500
Epoch 18/87
----------
train Loss: 1.3950 Acc: 0.8325
val Loss: 1.2669 Acc: 0.7727
Epoch 19/87
----------
train Loss: 1.2798 Acc: 0.8995
val Loss: 1.5226 Acc: 0.7045
Epoch 20/87
----------
train Loss: 1.4054 Acc: 0.8469
val Loss: 1.5933 Acc: 0.7500
Epoch 21/87
----------
train Loss: 1.5127 Acc: 0.8804
val Loss: 1.7632 Acc: 0.7955
Epoch 22/87
----------
train Loss: 1.3350 Acc: 0.8612
val Loss: 1.6596 Acc: 0.7273
Epoch 23/87
----------
train Loss: 1.5830 Acc: 0.8469
val Loss: 1.3418 Acc: 0.7273
Epoch 24/87
----------
train Loss: 1.2031 Acc: 0.9282
val Loss: 1.3953 Acc: 0.7955
Epoch 25/87
----------
train Loss: 1.3141 Acc: 0.9234
val Loss: 1.8307 Acc: 0.7500
Epoch 26/87
----------
train Loss: 1.4706 Acc: 0.9139
val Loss: 1.4982 Acc: 0.7500
Epoch 27/87
----------
train Loss: 1.2651 Acc: 0.9378
val Loss: 1.7612 Acc: 0.7273
Epoch 28/87
----------
train Loss: 1.4395 Acc: 0.8373
val Loss: 1.7905 Acc: 0.7500
Epoch 29/87
----------
train Loss: 1.5200 Acc: 0.7799
val Loss: 1.5705 Acc: 0.7500
Epoch 30/87
----------
train Loss: 1.3947 Acc: 0.7799
val Loss: 1.3407 Acc: 0.7955
Epoch 31/87
----------
train Loss: 1.1624 Acc: 0.9187
val Loss: 1.4028 Acc: 0.7955
Epoch 32/87
----------
train Loss: 1.3278 Acc: 0.8804
val Loss: 1.1753 Acc: 0.7955
Epoch 33/87
----------
train Loss: 1.4215 Acc: 0.8708
val Loss: 1.5640 Acc: 0.7500
Epoch 34/87
----------
train Loss: 1.3674 Acc: 0.9234
val Loss: 1.4678 Acc: 0.7500
Epoch 35/87
----------
train Loss: 1.0544 Acc: 0.9617
val Loss: 1.3989 Acc: 0.7955
Epoch 36/87
----------
train Loss: 1.5909 Acc: 0.8373
val Loss: 1.3613 Acc: 0.6818
Epoch 37/87
----------
train Loss: 1.4332 Acc: 0.7895
val Loss: 1.6047 Acc: 0.7273
Epoch 38/87
----------
train Loss: 1.4739 Acc: 0.9282
val Loss: 1.3753 Acc: 0.7955
Epoch 39/87
----------
train Loss: 1.3714 Acc: 0.7751
val Loss: 1.7392 Acc: 0.7500
Epoch 40/87
----------
train Loss: 1.2620 Acc: 0.9043
val Loss: 1.7987 Acc: 0.7273
Epoch 41/87
----------
train Loss: 1.6429 Acc: 0.6890
val Loss: 1.4929 Acc: 0.7045
Epoch 42/87
----------
train Loss: 1.3147 Acc: 0.8230
val Loss: 1.9340 Acc: 0.7045
Epoch 43/87
----------
train Loss: 1.4286 Acc: 0.8660
val Loss: 1.5989 Acc: 0.6818
Epoch 44/87
----------
train Loss: 1.3566 Acc: 0.8756
val Loss: 1.7210 Acc: 0.7045
Epoch 45/87
----------
train Loss: 0.8499 Acc: 0.9617
val Loss: 1.3899 Acc: 0.7727
Epoch 46/87
----------
train Loss: 1.7264 Acc: 0.8134
val Loss: 1.7866 Acc: 0.7273
Epoch 47/87
----------
train Loss: 1.4222 Acc: 0.8612
val Loss: 1.7927 Acc: 0.7727
Epoch 48/87
----------
train Loss: 1.3659 Acc: 0.8565
val Loss: 1.3894 Acc: 0.7500
Epoch 49/87
----------
train Loss: 1.3592 Acc: 0.8947
val Loss: 1.6128 Acc: 0.7273
Epoch 50/87
----------
train Loss: 1.3573 Acc: 0.8325
val Loss: 1.8844 Acc: 0.7500
Epoch 51/87
----------
train Loss: 1.0258 Acc: 0.9665
val Loss: 1.6779 Acc: 0.7045
Epoch 52/87
----------
train Loss: 1.3713 Acc: 0.8134
val Loss: 1.6219 Acc: 0.6591
Epoch 53/87
----------
train Loss: 1.5816 Acc: 0.8804
val Loss: 1.5587 Acc: 0.6591
Epoch 54/87
----------
train Loss: 1.1987 Acc: 0.9234
val Loss: 1.7033 Acc: 0.7045
Epoch 55/87
----------
train Loss: 1.2150 Acc: 0.9617
val Loss: 1.7422 Acc: 0.7273
Epoch 56/87
----------
train Loss: 1.4373 Acc: 0.9139
val Loss: 1.5264 Acc: 0.7727
Epoch 57/87
----------
train Loss: 1.5951 Acc: 0.8230
val Loss: 1.6772 Acc: 0.7955
Epoch 58/87
----------
train Loss: 1.3330 Acc: 0.8038
val Loss: 1.6295 Acc: 0.6818
Epoch 59/87
----------
train Loss: 1.3763 Acc: 0.8852
val Loss: 1.6067 Acc: 0.7273
Epoch 60/87
----------
train Loss: 1.1361 Acc: 0.8947
val Loss: 1.5243 Acc: 0.6818
Epoch 61/87
----------
train Loss: 1.5928 Acc: 0.7847
val Loss: 2.3700 Acc: 0.6364
Epoch 62/87
----------
train Loss: 1.5098 Acc: 0.8947
[32m[I 2025-06-29 13:59:18,042][0m Trial 170 finished with value: 0.7954545454545455 and parameters: {'batch_size': 74, 'lr': 0.0007198533224422626, 'num_epochs': 87, 'weight_decay': 0.013007947833151217, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5675 Acc: 0.6818
Early stopping at epoch 62 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_74_lr_0.0007198533224422626_epoch_87_wd_0.013007947833151217_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/90
----------
train Loss: 3.0656 Acc: 0.3971
val Loss: 1.9853 Acc: 0.6364
Epoch 2/90
----------
train Loss: 2.3918 Acc: 0.5502
val Loss: 2.1817 Acc: 0.6364
Epoch 3/90
----------
train Loss: 2.0976 Acc: 0.6172
val Loss: 1.5506 Acc: 0.7500
Epoch 4/90
----------
train Loss: 1.9764 Acc: 0.6172
val Loss: 1.5902 Acc: 0.7727
Epoch 5/90
----------
train Loss: 1.7968 Acc: 0.7895
val Loss: 1.3650 Acc: 0.7955
Epoch 6/90
----------
train Loss: 1.6844 Acc: 0.7703
val Loss: 1.2373 Acc: 0.7955
Epoch 7/90
----------
train Loss: 1.4531 Acc: 0.8756
val Loss: 1.5967 Acc: 0.6818
Epoch 8/90
----------
train Loss: 1.6695 Acc: 0.7847
val Loss: 1.5527 Acc: 0.7500
Epoch 9/90
----------
train Loss: 1.6867 Acc: 0.7799
val Loss: 1.5634 Acc: 0.7273
Epoch 10/90
----------
train Loss: 1.0376 Acc: 0.9474
val Loss: 1.3281 Acc: 0.7500
Epoch 11/90
----------
train Loss: 1.6871 Acc: 0.8086
val Loss: 1.2052 Acc: 0.8182
Epoch 12/90
----------
train Loss: 1.4571 Acc: 0.7895
val Loss: 1.8211 Acc: 0.7500
Epoch 13/90
----------
train Loss: 1.3560 Acc: 0.8852
val Loss: 1.6823 Acc: 0.7500
Epoch 14/90
----------
train Loss: 1.2371 Acc: 0.8517
val Loss: 1.5215 Acc: 0.6818
Epoch 15/90
----------
train Loss: 1.4546 Acc: 0.8038
val Loss: 1.3656 Acc: 0.7727
Epoch 16/90
----------
train Loss: 1.4568 Acc: 0.7895
val Loss: 1.6530 Acc: 0.7045
Epoch 17/90
----------
train Loss: 1.3369 Acc: 0.8565
val Loss: 1.5208 Acc: 0.7273
Epoch 18/90
----------
train Loss: 1.3227 Acc: 0.8612
val Loss: 1.2646 Acc: 0.7045
Epoch 19/90
----------
train Loss: 1.1460 Acc: 0.9569
val Loss: 1.2088 Acc: 0.7727
Epoch 20/90
----------
train Loss: 1.2892 Acc: 0.8995
val Loss: 1.2276 Acc: 0.7273
Epoch 21/90
----------
train Loss: 1.3743 Acc: 0.9139
val Loss: 1.2719 Acc: 0.7955
Epoch 22/90
----------
train Loss: 1.2267 Acc: 0.8660
val Loss: 1.2722 Acc: 0.8182
Epoch 23/90
----------
train Loss: 1.4922 Acc: 0.8804
val Loss: 1.2986 Acc: 0.8182
Epoch 24/90
----------
train Loss: 1.0849 Acc: 0.9139
val Loss: 1.3350 Acc: 0.7727
Epoch 25/90
----------
train Loss: 1.1918 Acc: 0.9569
val Loss: 1.5413 Acc: 0.7273
Epoch 26/90
----------
train Loss: 1.3525 Acc: 0.9522
val Loss: 1.6048 Acc: 0.6818
Epoch 27/90
----------
train Loss: 1.1598 Acc: 0.9569
val Loss: 1.6158 Acc: 0.7045
Epoch 28/90
----------
train Loss: 1.3040 Acc: 0.8469
val Loss: 1.5058 Acc: 0.7273
Epoch 29/90
----------
train Loss: 1.3998 Acc: 0.8230
val Loss: 1.4715 Acc: 0.7273
Epoch 30/90
----------
train Loss: 1.2329 Acc: 0.8852
val Loss: 1.3779 Acc: 0.6818
Epoch 31/90
----------
train Loss: 1.0821 Acc: 0.9522
val Loss: 1.3798 Acc: 0.7273
Epoch 32/90
----------
train Loss: 1.1913 Acc: 0.9234
val Loss: 1.3480 Acc: 0.7500
Epoch 33/90
----------
train Loss: 1.3011 Acc: 0.8900
val Loss: 1.4617 Acc: 0.7273
Epoch 34/90
----------
train Loss: 1.2452 Acc: 0.9426
val Loss: 1.5626 Acc: 0.6364
Epoch 35/90
----------
train Loss: 0.9701 Acc: 0.9617
val Loss: 1.5256 Acc: 0.6591
Epoch 36/90
----------
train Loss: 1.4645 Acc: 0.8660
val Loss: 1.4663 Acc: 0.7273
Epoch 37/90
----------
train Loss: 1.2176 Acc: 0.8517
val Loss: 1.3314 Acc: 0.7955
Epoch 38/90
----------
train Loss: 1.2833 Acc: 0.9713
val Loss: 1.2585 Acc: 0.7500
Epoch 39/90
----------
train Loss: 1.2646 Acc: 0.7847
val Loss: 1.3399 Acc: 0.7500
Epoch 40/90
----------
train Loss: 1.1079 Acc: 0.9282
val Loss: 1.3867 Acc: 0.7500
Epoch 41/90
----------
train Loss: 1.5233 Acc: 0.6938
val Loss: 1.2940 Acc: 0.7273
Epoch 42/90
----------
train Loss: 1.0663 Acc: 0.8947
val Loss: 1.4427 Acc: 0.6818
Epoch 43/90
----------
train Loss: 1.2238 Acc: 0.8947
val Loss: 1.4054 Acc: 0.7500
Epoch 44/90
----------
train Loss: 1.0949 Acc: 0.9091
val Loss: 1.5936 Acc: 0.7500
Epoch 45/90
----------
train Loss: 0.7761 Acc: 0.9665
val Loss: 1.4393 Acc: 0.7955
Epoch 46/90
----------
train Loss: 1.5211 Acc: 0.8182
val Loss: 1.4325 Acc: 0.8636
Epoch 47/90
----------
train Loss: 1.1648 Acc: 0.9330
val Loss: 1.6165 Acc: 0.7500
Epoch 48/90
----------
train Loss: 1.2249 Acc: 0.8325
val Loss: 1.6034 Acc: 0.6818
Epoch 49/90
----------
train Loss: 1.2252 Acc: 0.9474
val Loss: 1.5127 Acc: 0.7045
Epoch 50/90
----------
train Loss: 1.1872 Acc: 0.8947
val Loss: 1.4396 Acc: 0.7500
Epoch 51/90
----------
train Loss: 0.9223 Acc: 0.9952
[32m[I 2025-06-29 14:10:53,827][0m Trial 171 finished with value: 0.8636363636363636 and parameters: {'batch_size': 83, 'lr': 0.0008484698788769433, 'num_epochs': 90, 'weight_decay': 0.0005839446498224038, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4548 Acc: 0.7045
Early stopping at epoch 51 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_83_lr_0.0008484698788769433_epoch_90_wd_0.0005839446498224038_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/91
----------
train Loss: 0.6950 Acc: 0.2297
val Loss: 0.6748 Acc: 0.2727
Epoch 2/91
----------
train Loss: 0.6713 Acc: 0.2871
val Loss: 0.6586 Acc: 0.2727
Epoch 3/91
----------
train Loss: 0.6523 Acc: 0.3110
val Loss: 0.6361 Acc: 0.3409
Epoch 4/91
----------
train Loss: 0.6382 Acc: 0.3254
val Loss: 0.6231 Acc: 0.3864
Epoch 5/91
----------
train Loss: 0.6299 Acc: 0.3732
val Loss: 0.6158 Acc: 0.4091
Epoch 6/91
----------
train Loss: 0.6140 Acc: 0.3971
val Loss: 0.6054 Acc: 0.4773
Epoch 7/91
----------
train Loss: 0.6007 Acc: 0.4641
val Loss: 0.5940 Acc: 0.5227
Epoch 8/91
----------
train Loss: 0.5890 Acc: 0.4785
val Loss: 0.5848 Acc: 0.5227
Epoch 9/91
----------
train Loss: 0.5782 Acc: 0.4976
val Loss: 0.5739 Acc: 0.5455
Epoch 10/91
----------
train Loss: 0.5659 Acc: 0.4880
val Loss: 0.5588 Acc: 0.5909
Epoch 11/91
----------
train Loss: 0.5618 Acc: 0.4928
val Loss: 0.5518 Acc: 0.6136
Epoch 12/91
----------
train Loss: 0.5562 Acc: 0.4976
val Loss: 0.5471 Acc: 0.6136
Epoch 13/91
----------
train Loss: 0.5403 Acc: 0.5072
val Loss: 0.5341 Acc: 0.6364
Epoch 14/91
----------
train Loss: 0.5309 Acc: 0.5072
val Loss: 0.5277 Acc: 0.6364
Epoch 15/91
----------
train Loss: 0.5304 Acc: 0.4833
val Loss: 0.5200 Acc: 0.6364
Epoch 16/91
----------
train Loss: 0.5233 Acc: 0.5024
val Loss: 0.5108 Acc: 0.6364
Epoch 17/91
----------
train Loss: 0.5183 Acc: 0.4928
val Loss: 0.5042 Acc: 0.6364
Epoch 18/91
----------
train Loss: 0.5108 Acc: 0.5024
val Loss: 0.4928 Acc: 0.6364
Epoch 19/91
----------
train Loss: 0.5020 Acc: 0.5072
val Loss: 0.4843 Acc: 0.6364
Epoch 20/91
----------
train Loss: 0.4984 Acc: 0.5072
val Loss: 0.4795 Acc: 0.6364
Epoch 21/91
----------
train Loss: 0.5000 Acc: 0.5024
val Loss: 0.4769 Acc: 0.6364
Epoch 22/91
----------
train Loss: 0.4937 Acc: 0.5120
val Loss: 0.4714 Acc: 0.6364
Epoch 23/91
----------
train Loss: 0.4862 Acc: 0.5024
val Loss: 0.4646 Acc: 0.6364
Epoch 24/91
----------
train Loss: 0.4734 Acc: 0.5072
val Loss: 0.4509 Acc: 0.6364
Epoch 25/91
----------
train Loss: 0.4819 Acc: 0.5120
val Loss: 0.4515 Acc: 0.6364
Epoch 26/91
----------
train Loss: 0.4821 Acc: 0.4976
val Loss: 0.4491 Acc: 0.6364
Epoch 27/91
----------
train Loss: 0.4605 Acc: 0.5215
val Loss: 0.4445 Acc: 0.6591
Epoch 28/91
----------
train Loss: 0.4728 Acc: 0.5024
val Loss: 0.4402 Acc: 0.6591
Epoch 29/91
----------
train Loss: 0.4779 Acc: 0.5215
val Loss: 0.4353 Acc: 0.6591
Epoch 30/91
----------
train Loss: 0.4722 Acc: 0.5072
val Loss: 0.4317 Acc: 0.6591
Epoch 31/91
----------
train Loss: 0.4530 Acc: 0.5311
val Loss: 0.4232 Acc: 0.6591
Epoch 32/91
----------
train Loss: 0.4532 Acc: 0.5311
val Loss: 0.4162 Acc: 0.6591
Epoch 33/91
----------
train Loss: 0.4627 Acc: 0.5120
val Loss: 0.4162 Acc: 0.6591
Epoch 34/91
----------
train Loss: 0.4550 Acc: 0.5167
val Loss: 0.4121 Acc: 0.6591
Epoch 35/91
----------
train Loss: 0.4362 Acc: 0.5167
val Loss: 0.4063 Acc: 0.7045
Epoch 36/91
----------
train Loss: 0.4659 Acc: 0.5263
val Loss: 0.4013 Acc: 0.6591
Epoch 37/91
----------
train Loss: 0.4450 Acc: 0.5455
val Loss: 0.4008 Acc: 0.6818
Epoch 38/91
----------
train Loss: 0.4435 Acc: 0.5885
val Loss: 0.3986 Acc: 0.7045
Epoch 39/91
----------
train Loss: 0.4481 Acc: 0.5646
val Loss: 0.4028 Acc: 0.7045
Epoch 40/91
----------
train Loss: 0.4296 Acc: 0.5742
val Loss: 0.3975 Acc: 0.7045
Epoch 41/91
----------
train Loss: 0.4550 Acc: 0.5502
val Loss: 0.3920 Acc: 0.7045
Epoch 42/91
----------
train Loss: 0.4258 Acc: 0.6029
val Loss: 0.3885 Acc: 0.7045
Epoch 43/91
----------
train Loss: 0.4370 Acc: 0.5646
val Loss: 0.3837 Acc: 0.7045
Epoch 44/91
----------
train Loss: 0.4232 Acc: 0.6220
val Loss: 0.3837 Acc: 0.7045
Epoch 45/91
----------
train Loss: 0.3778 Acc: 0.6651
val Loss: 0.3769 Acc: 0.7045
Epoch 46/91
----------
train Loss: 0.4468 Acc: 0.6220
val Loss: 0.3723 Acc: 0.7045
Epoch 47/91
----------
train Loss: 0.4081 Acc: 0.6316
val Loss: 0.3691 Acc: 0.7273
Epoch 48/91
----------
train Loss: 0.4205 Acc: 0.5981
val Loss: 0.3616 Acc: 0.7273
Epoch 49/91
----------
train Loss: 0.4168 Acc: 0.6268
val Loss: 0.3572 Acc: 0.7500
Epoch 50/91
----------
train Loss: 0.4062 Acc: 0.6124
val Loss: 0.3585 Acc: 0.7500
Epoch 51/91
----------
train Loss: 0.3767 Acc: 0.6651
val Loss: 0.3499 Acc: 0.7727
Epoch 52/91
----------
train Loss: 0.4130 Acc: 0.6124
val Loss: 0.3524 Acc: 0.7727
Epoch 53/91
----------
train Loss: 0.4284 Acc: 0.6220
val Loss: 0.3511 Acc: 0.7500
Epoch 54/91
----------
train Loss: 0.3775 Acc: 0.7129
val Loss: 0.3458 Acc: 0.7500
Epoch 55/91
----------
train Loss: 0.3925 Acc: 0.6938
val Loss: 0.3443 Acc: 0.7727
Epoch 56/91
----------
train Loss: 0.4060 Acc: 0.6746
val Loss: 0.3423 Acc: 0.7727
Epoch 57/91
----------
train Loss: 0.4322 Acc: 0.6268
val Loss: 0.3433 Acc: 0.7500
Epoch 58/91
----------
train Loss: 0.3889 Acc: 0.6746
val Loss: 0.3360 Acc: 0.7727
Epoch 59/91
----------
train Loss: 0.4075 Acc: 0.6794
val Loss: 0.3322 Acc: 0.7500
Epoch 60/91
----------
train Loss: 0.3819 Acc: 0.6842
val Loss: 0.3394 Acc: 0.7727
Epoch 61/91
----------
train Loss: 0.4273 Acc: 0.6029
val Loss: 0.3411 Acc: 0.7727
Epoch 62/91
----------
train Loss: 0.3949 Acc: 0.7129
val Loss: 0.3396 Acc: 0.7727
Epoch 63/91
----------
train Loss: 0.3688 Acc: 0.7608
val Loss: 0.3366 Acc: 0.7500
Epoch 64/91
----------
train Loss: 0.3670 Acc: 0.7608
val Loss: 0.3273 Acc: 0.7727
Epoch 65/91
----------
train Loss: 0.3786 Acc: 0.6938
val Loss: 0.3215 Acc: 0.7727
Epoch 66/91
----------
train Loss: 0.3765 Acc: 0.7416
val Loss: 0.3216 Acc: 0.7727
Epoch 67/91
----------
train Loss: 0.3895 Acc: 0.7129
val Loss: 0.3123 Acc: 0.7955
Epoch 68/91
----------
train Loss: 0.3567 Acc: 0.7895
val Loss: 0.3134 Acc: 0.7500
Epoch 69/91
----------
train Loss: 0.3684 Acc: 0.7321
val Loss: 0.3150 Acc: 0.7955
Epoch 70/91
----------
train Loss: 0.3790 Acc: 0.7368
val Loss: 0.3203 Acc: 0.7727
Epoch 71/91
----------
train Loss: 0.3952 Acc: 0.6938
val Loss: 0.3215 Acc: 0.7727
Epoch 72/91
----------
train Loss: 0.3911 Acc: 0.7129
val Loss: 0.3265 Acc: 0.7727
Epoch 73/91
----------
train Loss: 0.3171 Acc: 0.8373
val Loss: 0.3192 Acc: 0.7500
Epoch 74/91
----------
train Loss: 0.3986 Acc: 0.6842
val Loss: 0.3136 Acc: 0.7500
Epoch 75/91
----------
train Loss: 0.3407 Acc: 0.7847
val Loss: 0.3090 Acc: 0.7500
Epoch 76/91
----------
train Loss: 0.3688 Acc: 0.6746
val Loss: 0.3047 Acc: 0.7955
Epoch 77/91
----------
train Loss: 0.3729 Acc: 0.7799
val Loss: 0.3071 Acc: 0.8182
Epoch 78/91
----------
train Loss: 0.3357 Acc: 0.8134
val Loss: 0.3066 Acc: 0.7955
Epoch 79/91
----------
train Loss: 0.3945 Acc: 0.7129
val Loss: 0.3018 Acc: 0.7500
Epoch 80/91
----------
train Loss: 0.3603 Acc: 0.7464
val Loss: 0.3030 Acc: 0.7955
Epoch 81/91
----------
train Loss: 0.3896 Acc: 0.6938
val Loss: 0.3074 Acc: 0.7955
Epoch 82/91
----------
train Loss: 0.3458 Acc: 0.7703
val Loss: 0.3101 Acc: 0.7727
Epoch 83/91
----------
train Loss: 0.3134 Acc: 0.8947
val Loss: 0.3028 Acc: 0.7727
Epoch 84/91
----------
train Loss: 0.3815 Acc: 0.6651
val Loss: 0.3004 Acc: 0.7727
Epoch 85/91
----------
train Loss: 0.3454 Acc: 0.7464
val Loss: 0.2991 Acc: 0.7727
Epoch 86/91
----------
train Loss: 0.3345 Acc: 0.8038
val Loss: 0.2905 Acc: 0.7727
Epoch 87/91
----------
train Loss: 0.3614 Acc: 0.7799
val Loss: 0.2881 Acc: 0.7955
Epoch 88/91
----------
train Loss: 0.3672 Acc: 0.8182
val Loss: 0.2857 Acc: 0.7955
Epoch 89/91
----------
train Loss: 0.3859 Acc: 0.7129
val Loss: 0.2898 Acc: 0.7955
Epoch 90/91
----------
train Loss: 0.3447 Acc: 0.7943
val Loss: 0.2957 Acc: 0.7727
Epoch 91/91
----------
train Loss: 0.3145 Acc: 0.8421
[32m[I 2025-06-29 14:31:37,538][0m Trial 172 finished with value: 0.7727272727272727 and parameters: {'batch_size': 24, 'lr': 5.956714693203883e-05, 'num_epochs': 91, 'weight_decay': 0.022585212285140727, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2978 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_24_lr_5.956714693203883e-05_epoch_91_wd_0.022585212285140727_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/82
----------
train Loss: 3.5070 Acc: 0.3349
val Loss: 3.1885 Acc: 0.5909
Epoch 2/82
----------
train Loss: 2.8440 Acc: 0.5263
val Loss: 2.3965 Acc: 0.6364
Epoch 3/82
----------
train Loss: 2.4402 Acc: 0.5167
val Loss: 1.9798 Acc: 0.6364
Epoch 4/82
----------
train Loss: 2.2853 Acc: 0.5072
val Loss: 1.8832 Acc: 0.6591
Epoch 5/82
----------
train Loss: 2.2128 Acc: 0.5598
val Loss: 1.7950 Acc: 0.6818
Epoch 6/82
----------
train Loss: 2.0491 Acc: 0.5789
val Loss: 1.7240 Acc: 0.7500
Epoch 7/82
----------
train Loss: 1.9127 Acc: 0.6555
val Loss: 1.6973 Acc: 0.7955
Epoch 8/82
----------
train Loss: 1.9790 Acc: 0.6794
val Loss: 1.5313 Acc: 0.7955
Epoch 9/82
----------
train Loss: 1.9022 Acc: 0.7129
val Loss: 1.6132 Acc: 0.7727
Epoch 10/82
----------
train Loss: 1.3560 Acc: 0.9043
val Loss: 1.4580 Acc: 0.7727
Epoch 11/82
----------
train Loss: 1.7242 Acc: 0.7608
val Loss: 1.3215 Acc: 0.7955
Epoch 12/82
----------
train Loss: 1.6319 Acc: 0.6938
val Loss: 1.4667 Acc: 0.8409
Epoch 13/82
----------
train Loss: 1.4044 Acc: 0.8804
val Loss: 1.3953 Acc: 0.7955
Epoch 14/82
----------
train Loss: 1.3020 Acc: 0.8325
val Loss: 1.4773 Acc: 0.7045
Epoch 15/82
----------
train Loss: 1.4570 Acc: 0.7847
val Loss: 1.2786 Acc: 0.7273
Epoch 16/82
----------
train Loss: 1.5083 Acc: 0.7608
val Loss: 1.4074 Acc: 0.7955
Epoch 17/82
----------
train Loss: 1.4249 Acc: 0.8421
val Loss: 1.5947 Acc: 0.8182
Epoch 18/82
----------
train Loss: 1.3646 Acc: 0.8325
val Loss: 1.3132 Acc: 0.8409
Epoch 19/82
----------
train Loss: 1.2320 Acc: 0.9378
val Loss: 1.2322 Acc: 0.7727
Epoch 20/82
----------
train Loss: 1.3657 Acc: 0.8565
val Loss: 1.2146 Acc: 0.7955
Epoch 21/82
----------
train Loss: 1.4342 Acc: 0.8900
val Loss: 1.1786 Acc: 0.7727
Epoch 22/82
----------
train Loss: 1.2859 Acc: 0.8708
val Loss: 1.2255 Acc: 0.7727
Epoch 23/82
----------
train Loss: 1.4864 Acc: 0.8660
val Loss: 1.2907 Acc: 0.8409
Epoch 24/82
----------
train Loss: 1.0577 Acc: 0.9282
val Loss: 1.2345 Acc: 0.8182
Epoch 25/82
----------
train Loss: 1.2436 Acc: 0.9330
val Loss: 1.4141 Acc: 0.7955
Epoch 26/82
----------
train Loss: 1.4343 Acc: 0.9234
val Loss: 1.3571 Acc: 0.7727
Epoch 27/82
----------
train Loss: 1.1735 Acc: 0.9713
val Loss: 1.4113 Acc: 0.7500
Epoch 28/82
----------
train Loss: 1.3673 Acc: 0.8612
val Loss: 1.2632 Acc: 0.7727
Epoch 29/82
----------
train Loss: 1.4762 Acc: 0.7895
val Loss: 1.2389 Acc: 0.7727
Epoch 30/82
----------
train Loss: 1.2733 Acc: 0.8804
val Loss: 1.1551 Acc: 0.7727
Epoch 31/82
----------
train Loss: 1.1295 Acc: 0.9426
val Loss: 1.1330 Acc: 0.7955
Epoch 32/82
----------
train Loss: 1.2448 Acc: 0.9091
val Loss: 1.0988 Acc: 0.7955
Epoch 33/82
----------
train Loss: 1.3562 Acc: 0.8900
val Loss: 1.1241 Acc: 0.7955
Epoch 34/82
----------
train Loss: 1.2989 Acc: 0.9426
val Loss: 1.2741 Acc: 0.7273
Epoch 35/82
----------
train Loss: 0.9941 Acc: 0.9761
val Loss: 1.2547 Acc: 0.7727
Epoch 36/82
----------
train Loss: 1.5439 Acc: 0.8708
val Loss: 1.1995 Acc: 0.8182
Epoch 37/82
----------
train Loss: 1.3243 Acc: 0.8086
val Loss: 1.4076 Acc: 0.7045
Epoch 38/82
----------
train Loss: 1.3676 Acc: 0.9378
val Loss: 1.2777 Acc: 0.7955
Epoch 39/82
----------
train Loss: 1.3689 Acc: 0.7799
val Loss: 1.4600 Acc: 0.7500
Epoch 40/82
----------
train Loss: 1.1845 Acc: 0.9426
val Loss: 1.4329 Acc: 0.7045
Epoch 41/82
----------
train Loss: 1.6027 Acc: 0.6986
val Loss: 1.2978 Acc: 0.7727
Epoch 42/82
----------
train Loss: 1.2127 Acc: 0.8660
val Loss: 1.3158 Acc: 0.7273
Epoch 43/82
----------
train Loss: 1.3320 Acc: 0.8660
val Loss: 1.2458 Acc: 0.7727
Epoch 44/82
----------
train Loss: 1.2183 Acc: 0.8708
val Loss: 1.4687 Acc: 0.7727
Epoch 45/82
----------
train Loss: 0.8227 Acc: 0.9665
val Loss: 1.3603 Acc: 0.7955
Epoch 46/82
----------
train Loss: 1.6197 Acc: 0.8134
val Loss: 1.5049 Acc: 0.7045
Epoch 47/82
----------
train Loss: 1.2333 Acc: 0.9091
val Loss: 1.4808 Acc: 0.6818
Epoch 48/82
----------
train Loss: 1.3067 Acc: 0.8612
val Loss: 1.4738 Acc: 0.7955
Epoch 49/82
----------
train Loss: 1.3236 Acc: 0.9330
val Loss: 1.3736 Acc: 0.8409
Epoch 50/82
----------
train Loss: 1.2824 Acc: 0.8947
val Loss: 1.3516 Acc: 0.7955
Epoch 51/82
----------
train Loss: 0.9696 Acc: 0.9904
val Loss: 1.1970 Acc: 0.8409
Epoch 52/82
----------
train Loss: 1.2969 Acc: 0.8756
val Loss: 1.1053 Acc: 0.8182
Epoch 53/82
----------
train Loss: 1.5045 Acc: 0.9378
val Loss: 1.3075 Acc: 0.7500
Epoch 54/82
----------
train Loss: 1.1969 Acc: 0.9378
val Loss: 1.4451 Acc: 0.7273
Epoch 55/82
----------
train Loss: 1.2437 Acc: 0.9474
val Loss: 1.5653 Acc: 0.7955
Epoch 56/82
----------
train Loss: 1.3985 Acc: 0.9282
val Loss: 1.3879 Acc: 0.7727
Epoch 57/82
----------
train Loss: 1.5538 Acc: 0.8278
val Loss: 1.4261 Acc: 0.7045
Epoch 58/82
----------
train Loss: 1.2598 Acc: 0.8373
val Loss: 1.3804 Acc: 0.7045
Epoch 59/82
----------
train Loss: 1.3102 Acc: 0.9187
val Loss: 1.3787 Acc: 0.6591
Epoch 60/82
----------
train Loss: 1.0708 Acc: 0.9043
val Loss: 1.4086 Acc: 0.7273
Epoch 61/82
----------
train Loss: 1.4956 Acc: 0.7703
val Loss: 1.3998 Acc: 0.7273
Epoch 62/82
----------
train Loss: 1.4531 Acc: 0.9426
val Loss: 1.4893 Acc: 0.7500
Epoch 63/82
----------
train Loss: 1.2439 Acc: 0.9378
val Loss: 1.5105 Acc: 0.7045
Epoch 64/82
----------
train Loss: 1.1275 Acc: 0.9569
val Loss: 1.3994 Acc: 0.7727
Epoch 65/82
----------
train Loss: 1.2621 Acc: 0.8852
val Loss: 1.3937 Acc: 0.7045
Epoch 66/82
----------
train Loss: 1.2946 Acc: 0.8900
val Loss: 1.6330 Acc: 0.7273
Epoch 67/82
----------
train Loss: 1.4156 Acc: 0.8804
val Loss: 1.4888 Acc: 0.7273
Epoch 68/82
----------
train Loss: 1.1970 Acc: 0.8900
val Loss: 1.4653 Acc: 0.7727
Epoch 69/82
----------
train Loss: 1.1504 Acc: 0.8804
val Loss: 1.2419 Acc: 0.7955
Epoch 70/82
----------
train Loss: 1.3427 Acc: 0.8947
val Loss: 1.1529 Acc: 0.7955
Epoch 71/82
----------
train Loss: 1.4242 Acc: 0.8852
val Loss: 1.1498 Acc: 0.7500
Epoch 72/82
----------
train Loss: 1.3999 Acc: 0.8708
val Loss: 1.3501 Acc: 0.8182
Epoch 73/82
----------
train Loss: 1.0339 Acc: 0.9522
val Loss: 1.3921 Acc: 0.7273
Epoch 74/82
----------
train Loss: 1.4377 Acc: 0.8182
val Loss: 1.3192 Acc: 0.8182
Epoch 75/82
----------
train Loss: 1.1325 Acc: 0.9617
val Loss: 1.4573 Acc: 0.7727
Epoch 76/82
----------
train Loss: 1.1317 Acc: 0.8612
val Loss: 1.2168 Acc: 0.7955
Epoch 77/82
----------
train Loss: 1.3770 Acc: 0.8756
val Loss: 1.3967 Acc: 0.7955
Epoch 78/82
----------
train Loss: 1.2651 Acc: 0.9139
val Loss: 1.4478 Acc: 0.8182
Epoch 79/82
----------
train Loss: 1.4196 Acc: 0.8708
val Loss: 1.2252 Acc: 0.7955
Epoch 80/82
----------
train Loss: 1.2930 Acc: 0.8660
val Loss: 1.2919 Acc: 0.7955
Epoch 81/82
----------
train Loss: 1.4654 Acc: 0.8134
val Loss: 1.5697 Acc: 0.7955
Epoch 82/82
----------
train Loss: 1.2363 Acc: 0.8947
[32m[I 2025-06-29 14:50:18,342][0m Trial 173 finished with value: 0.7954545454545455 and parameters: {'batch_size': 16, 'lr': 0.0003176405440670763, 'num_epochs': 82, 'weight_decay': 0.016924064274268805, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4155 Acc: 0.7273
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_16_lr_0.0003176405440670763_epoch_82_wd_0.016924064274268805_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/85
----------
train Loss: 5.7030 Acc: 0.3206
val Loss: 4.6250 Acc: 0.6364
Epoch 2/85
----------
train Loss: 3.7340 Acc: 0.7081
val Loss: 4.0819 Acc: 0.7045
Epoch 3/85
----------
train Loss: 2.2295 Acc: 0.8660
val Loss: 3.3039 Acc: 0.7500
Epoch 4/85
----------
train Loss: 1.1473 Acc: 0.9522
val Loss: 2.9809 Acc: 0.7727
Epoch 5/85
----------
train Loss: 0.5059 Acc: 0.9904
val Loss: 3.0859 Acc: 0.7955
Epoch 6/85
----------
train Loss: 0.2704 Acc: 0.9904
val Loss: 2.9944 Acc: 0.7955
Epoch 7/85
----------
train Loss: 0.1559 Acc: 0.9952
val Loss: 2.8871 Acc: 0.7727
Epoch 8/85
----------
train Loss: 0.1577 Acc: 1.0000
val Loss: 2.7161 Acc: 0.7727
Epoch 9/85
----------
train Loss: 0.1703 Acc: 0.9904
val Loss: 2.3968 Acc: 0.7955
Epoch 10/85
----------
train Loss: 0.1731 Acc: 0.9952
val Loss: 2.4570 Acc: 0.7955
Epoch 11/85
----------
train Loss: 0.2188 Acc: 0.9952
val Loss: 2.5904 Acc: 0.8182
Epoch 12/85
----------
train Loss: 0.1638 Acc: 0.9952
val Loss: 2.6213 Acc: 0.8182
Epoch 13/85
----------
train Loss: 0.3189 Acc: 0.9713
val Loss: 2.5299 Acc: 0.8636
Epoch 14/85
----------
train Loss: 0.1964 Acc: 0.9856
val Loss: 2.7290 Acc: 0.7727
Epoch 15/85
----------
train Loss: 0.3409 Acc: 0.9617
val Loss: 2.9281 Acc: 0.7955
Epoch 16/85
----------
train Loss: 0.2044 Acc: 0.9904
val Loss: 3.3837 Acc: 0.8409
Epoch 17/85
----------
train Loss: 0.2557 Acc: 0.9856
val Loss: 3.7708 Acc: 0.7273
Epoch 18/85
----------
train Loss: 0.3978 Acc: 0.9856
val Loss: 4.4622 Acc: 0.7500
Epoch 19/85
----------
train Loss: 0.2762 Acc: 0.9761
val Loss: 4.8467 Acc: 0.6591
Epoch 20/85
----------
train Loss: 0.6928 Acc: 0.9330
val Loss: 3.7684 Acc: 0.7955
Epoch 21/85
----------
train Loss: 0.9354 Acc: 0.9234
val Loss: 3.3935 Acc: 0.8182
Epoch 22/85
----------
train Loss: 0.6928 Acc: 0.9474
val Loss: 5.0611 Acc: 0.7273
Epoch 23/85
----------
train Loss: 0.5192 Acc: 0.9569
val Loss: 3.7279 Acc: 0.7273
Epoch 24/85
----------
train Loss: 0.3329 Acc: 0.9617
val Loss: 2.8831 Acc: 0.7500
Epoch 25/85
----------
train Loss: 0.1709 Acc: 0.9904
val Loss: 3.8427 Acc: 0.7273
Epoch 26/85
----------
train Loss: 0.2307 Acc: 0.9809
[32m[I 2025-06-29 14:56:14,421][0m Trial 174 finished with value: 0.8181818181818182 and parameters: {'batch_size': 79, 'lr': 0.00044951337390138513, 'num_epochs': 85, 'weight_decay': 0.030229151344253663, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.9151 Acc: 0.6818
Early stopping at epoch 26 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_79_lr_0.00044951337390138513_epoch_85_wd_0.030229151344253663_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/80
----------
train Loss: 2.9152 Acc: 0.4306
val Loss: 1.9685 Acc: 0.6364
Epoch 2/80
----------
train Loss: 2.4066 Acc: 0.5933
val Loss: 3.8827 Acc: 0.2727
Epoch 3/80
----------
train Loss: 2.0688 Acc: 0.6986
val Loss: 2.1772 Acc: 0.6364
Epoch 4/80
----------
train Loss: 2.1146 Acc: 0.5837
val Loss: 2.3243 Acc: 0.7045
Epoch 5/80
----------
train Loss: 1.9376 Acc: 0.7129
val Loss: 3.0114 Acc: 0.5909
Epoch 6/80
----------
train Loss: 1.8735 Acc: 0.7129
val Loss: 1.8773 Acc: 0.7727
Epoch 7/80
----------
train Loss: 1.6232 Acc: 0.8517
val Loss: 2.8536 Acc: 0.7500
Epoch 8/80
----------
train Loss: 1.8311 Acc: 0.7512
val Loss: 3.0437 Acc: 0.6591
Epoch 9/80
----------
train Loss: 1.8832 Acc: 0.7225
val Loss: 3.1110 Acc: 0.4318
Epoch 10/80
----------
train Loss: 1.2497 Acc: 0.8947
val Loss: 1.6136 Acc: 0.7500
Epoch 11/80
----------
train Loss: 2.0113 Acc: 0.7512
val Loss: 2.4367 Acc: 0.5227
Epoch 12/80
----------
train Loss: 1.8676 Acc: 0.6459
val Loss: 1.5749 Acc: 0.7500
Epoch 13/80
----------
train Loss: 1.6283 Acc: 0.7943
val Loss: 1.6451 Acc: 0.7273
Epoch 14/80
----------
train Loss: 1.4492 Acc: 0.8134
val Loss: 1.9997 Acc: 0.6136
Epoch 15/80
----------
train Loss: 1.8394 Acc: 0.7033
val Loss: 2.2064 Acc: 0.6591
Epoch 16/80
----------
train Loss: 1.8059 Acc: 0.7273
val Loss: 2.0546 Acc: 0.5909
Epoch 17/80
----------
train Loss: 1.6394 Acc: 0.7847
val Loss: 1.6698 Acc: 0.6591
Epoch 18/80
----------
train Loss: 1.5440 Acc: 0.7703
[32m[I 2025-06-29 15:00:20,787][0m Trial 175 finished with value: 0.7272727272727273 and parameters: {'batch_size': 95, 'lr': 0.0014838193613523015, 'num_epochs': 80, 'weight_decay': 0.012037140201357904, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 2.1554 Acc: 0.5682
Early stopping at epoch 18 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_95_lr_0.0014838193613523015_epoch_80_wd_0.012037140201357904_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/69
----------
train Loss: 3.4380 Acc: 0.3493
val Loss: 3.0163 Acc: 0.6136
Epoch 2/69
----------
train Loss: 2.6848 Acc: 0.5407
val Loss: 2.0789 Acc: 0.6364
Epoch 3/69
----------
train Loss: 2.3062 Acc: 0.5167
val Loss: 1.8508 Acc: 0.6591
Epoch 4/69
----------
train Loss: 2.1896 Acc: 0.5120
val Loss: 1.7483 Acc: 0.7045
Epoch 5/69
----------
train Loss: 2.1163 Acc: 0.6364
val Loss: 1.6489 Acc: 0.7500
Epoch 6/69
----------
train Loss: 1.9260 Acc: 0.6555
val Loss: 1.5466 Acc: 0.7955
Epoch 7/69
----------
train Loss: 1.7539 Acc: 0.7560
val Loss: 1.4473 Acc: 0.7955
Epoch 8/69
----------
train Loss: 1.8235 Acc: 0.7273
val Loss: 1.3386 Acc: 0.7727
Epoch 9/69
----------
train Loss: 1.8141 Acc: 0.7512
val Loss: 1.4652 Acc: 0.7500
Epoch 10/69
----------
train Loss: 1.1718 Acc: 0.9426
val Loss: 1.3707 Acc: 0.8409
Epoch 11/69
----------
train Loss: 1.6916 Acc: 0.7799
val Loss: 1.1984 Acc: 0.8864
Epoch 12/69
----------
train Loss: 1.5154 Acc: 0.7512
val Loss: 1.4217 Acc: 0.8182
Epoch 13/69
----------
train Loss: 1.3326 Acc: 0.8947
val Loss: 1.4146 Acc: 0.7727
Epoch 14/69
----------
train Loss: 1.2585 Acc: 0.8373
val Loss: 1.3808 Acc: 0.7273
Epoch 15/69
----------
train Loss: 1.3860 Acc: 0.8182
val Loss: 1.1882 Acc: 0.7727
Epoch 16/69
----------
train Loss: 1.4755 Acc: 0.8038
val Loss: 1.2590 Acc: 0.8409
Epoch 17/69
----------
train Loss: 1.4060 Acc: 0.8517
val Loss: 1.4258 Acc: 0.8409
Epoch 18/69
----------
train Loss: 1.3048 Acc: 0.8421
val Loss: 1.2541 Acc: 0.7727
Epoch 19/69
----------
train Loss: 1.2050 Acc: 0.9282
val Loss: 1.2171 Acc: 0.7955
Epoch 20/69
----------
train Loss: 1.2950 Acc: 0.8708
val Loss: 1.2400 Acc: 0.8409
Epoch 21/69
----------
train Loss: 1.3990 Acc: 0.8995
val Loss: 1.3029 Acc: 0.7500
Epoch 22/69
----------
train Loss: 1.2582 Acc: 0.8900
val Loss: 1.2179 Acc: 0.7955
Epoch 23/69
----------
train Loss: 1.4704 Acc: 0.8756
val Loss: 1.1755 Acc: 0.8182
Epoch 24/69
----------
train Loss: 1.0713 Acc: 0.9139
val Loss: 1.1184 Acc: 0.8409
Epoch 25/69
----------
train Loss: 1.2283 Acc: 0.9474
val Loss: 1.2314 Acc: 0.8182
Epoch 26/69
----------
train Loss: 1.4665 Acc: 0.9522
val Loss: 1.2473 Acc: 0.7955
Epoch 27/69
----------
train Loss: 1.1637 Acc: 0.9713
val Loss: 1.3165 Acc: 0.7955
Epoch 28/69
----------
train Loss: 1.3449 Acc: 0.8565
val Loss: 1.1962 Acc: 0.7955
Epoch 29/69
----------
train Loss: 1.4810 Acc: 0.7895
val Loss: 1.1309 Acc: 0.8182
Epoch 30/69
----------
train Loss: 1.2501 Acc: 0.8900
val Loss: 1.0607 Acc: 0.7955
Epoch 31/69
----------
train Loss: 1.1257 Acc: 0.9474
val Loss: 1.0861 Acc: 0.8409
Epoch 32/69
----------
train Loss: 1.2144 Acc: 0.9043
val Loss: 1.1726 Acc: 0.8182
Epoch 33/69
----------
train Loss: 1.3633 Acc: 0.8900
val Loss: 1.2191 Acc: 0.7955
Epoch 34/69
----------
train Loss: 1.2731 Acc: 0.9474
val Loss: 1.2752 Acc: 0.7273
Epoch 35/69
----------
train Loss: 0.9960 Acc: 0.9761
val Loss: 1.3107 Acc: 0.7727
Epoch 36/69
----------
train Loss: 1.5227 Acc: 0.8517
val Loss: 1.2060 Acc: 0.8182
Epoch 37/69
----------
train Loss: 1.2980 Acc: 0.8373
val Loss: 1.4391 Acc: 0.7955
Epoch 38/69
----------
train Loss: 1.3586 Acc: 0.9522
val Loss: 1.2880 Acc: 0.7727
Epoch 39/69
----------
train Loss: 1.3477 Acc: 0.7608
val Loss: 1.3462 Acc: 0.8182
Epoch 40/69
----------
train Loss: 1.1496 Acc: 0.9330
val Loss: 1.2862 Acc: 0.7727
Epoch 41/69
----------
train Loss: 1.5888 Acc: 0.7177
val Loss: 1.2742 Acc: 0.7500
Epoch 42/69
----------
train Loss: 1.1677 Acc: 0.8612
val Loss: 1.3561 Acc: 0.7273
Epoch 43/69
----------
train Loss: 1.2919 Acc: 0.8708
val Loss: 1.1926 Acc: 0.7955
Epoch 44/69
----------
train Loss: 1.1565 Acc: 0.9091
val Loss: 1.3585 Acc: 0.8409
Epoch 45/69
----------
train Loss: 0.8014 Acc: 0.9617
val Loss: 1.2080 Acc: 0.7955
Epoch 46/69
----------
train Loss: 1.6206 Acc: 0.8325
val Loss: 1.3381 Acc: 0.7727
Epoch 47/69
----------
train Loss: 1.2038 Acc: 0.9091
val Loss: 1.4716 Acc: 0.7273
Epoch 48/69
----------
train Loss: 1.3207 Acc: 0.8565
val Loss: 1.8194 Acc: 0.7273
Epoch 49/69
----------
train Loss: 1.3164 Acc: 0.9378
val Loss: 1.2717 Acc: 0.8182
Epoch 50/69
----------
train Loss: 1.2402 Acc: 0.8804
val Loss: 1.3246 Acc: 0.8409
Epoch 51/69
----------
train Loss: 0.9517 Acc: 0.9904
val Loss: 1.1462 Acc: 0.8409
Epoch 52/69
----------
train Loss: 1.2698 Acc: 0.8708
val Loss: 1.0996 Acc: 0.7727
Epoch 53/69
----------
train Loss: 1.4635 Acc: 0.9187
val Loss: 1.3451 Acc: 0.7045
Epoch 54/69
----------
train Loss: 1.1850 Acc: 0.9426
val Loss: 1.4985 Acc: 0.7500
Epoch 55/69
----------
train Loss: 1.2214 Acc: 0.9569
val Loss: 1.6620 Acc: 0.7045
Epoch 56/69
----------
train Loss: 1.3811 Acc: 0.9234
[32m[I 2025-06-29 15:13:05,444][0m Trial 176 finished with value: 0.8409090909090909 and parameters: {'batch_size': 99, 'lr': 0.0003748539321762966, 'num_epochs': 69, 'weight_decay': 0.009837913368615244, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4131 Acc: 0.7500
Early stopping at epoch 56 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_99_lr_0.0003748539321762966_epoch_69_wd_0.009837913368615244_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 3.6109 Acc: 0.2967
val Loss: 3.3546 Acc: 0.5682
Epoch 2/88
----------
train Loss: 3.1080 Acc: 0.4880
val Loss: 2.8412 Acc: 0.6364
Epoch 3/88
----------
train Loss: 2.7321 Acc: 0.5072
val Loss: 2.2943 Acc: 0.6364
Epoch 4/88
----------
train Loss: 2.5049 Acc: 0.4976
val Loss: 2.0619 Acc: 0.6364
Epoch 5/88
----------
train Loss: 2.3767 Acc: 0.5167
val Loss: 1.9559 Acc: 0.6364
Epoch 6/88
----------
train Loss: 2.2227 Acc: 0.5359
val Loss: 1.8715 Acc: 0.6818
Epoch 7/88
----------
train Loss: 2.1130 Acc: 0.5550
val Loss: 1.8357 Acc: 0.7045
Epoch 8/88
----------
train Loss: 2.1642 Acc: 0.5646
val Loss: 1.7480 Acc: 0.6818
Epoch 9/88
----------
train Loss: 2.1023 Acc: 0.6124
val Loss: 1.7613 Acc: 0.7500
Epoch 10/88
----------
train Loss: 1.6845 Acc: 0.8038
val Loss: 1.7096 Acc: 0.7500
Epoch 11/88
----------
train Loss: 1.9529 Acc: 0.6507
val Loss: 1.6010 Acc: 0.7500
Epoch 12/88
----------
train Loss: 1.9289 Acc: 0.6172
val Loss: 1.6060 Acc: 0.7727
Epoch 13/88
----------
train Loss: 1.6898 Acc: 0.8038
val Loss: 1.5076 Acc: 0.7500
Epoch 14/88
----------
train Loss: 1.5414 Acc: 0.7847
val Loss: 1.4683 Acc: 0.7500
Epoch 15/88
----------
train Loss: 1.6503 Acc: 0.7512
val Loss: 1.3865 Acc: 0.7500
Epoch 16/88
----------
train Loss: 1.6022 Acc: 0.7656
val Loss: 1.3663 Acc: 0.7955
Epoch 17/88
----------
train Loss: 1.5169 Acc: 0.8325
val Loss: 1.3812 Acc: 0.8409
Epoch 18/88
----------
train Loss: 1.4190 Acc: 0.8325
val Loss: 1.3101 Acc: 0.8182
Epoch 19/88
----------
train Loss: 1.3124 Acc: 0.9043
val Loss: 1.2940 Acc: 0.7955
Epoch 20/88
----------
train Loss: 1.4070 Acc: 0.8517
val Loss: 1.2520 Acc: 0.7727
Epoch 21/88
----------
train Loss: 1.4850 Acc: 0.8469
val Loss: 1.2443 Acc: 0.7955
Epoch 22/88
----------
train Loss: 1.3565 Acc: 0.8469
val Loss: 1.2785 Acc: 0.8409
Epoch 23/88
----------
train Loss: 1.5104 Acc: 0.8469
val Loss: 1.2491 Acc: 0.8409
Epoch 24/88
----------
train Loss: 1.0923 Acc: 0.9282
val Loss: 1.1766 Acc: 0.7955
Epoch 25/88
----------
train Loss: 1.2922 Acc: 0.9330
val Loss: 1.2586 Acc: 0.7727
Epoch 26/88
----------
train Loss: 1.4360 Acc: 0.9091
val Loss: 1.3228 Acc: 0.8182
Epoch 27/88
----------
train Loss: 1.1645 Acc: 0.9713
val Loss: 1.4111 Acc: 0.8182
Epoch 28/88
----------
train Loss: 1.4269 Acc: 0.8708
val Loss: 1.3259 Acc: 0.8409
Epoch 29/88
----------
train Loss: 1.5290 Acc: 0.7751
val Loss: 1.2963 Acc: 0.8409
Epoch 30/88
----------
train Loss: 1.3046 Acc: 0.8660
val Loss: 1.2539 Acc: 0.7955
Epoch 31/88
----------
train Loss: 1.1619 Acc: 0.9282
val Loss: 1.1717 Acc: 0.8182
Epoch 32/88
----------
train Loss: 1.3132 Acc: 0.8900
val Loss: 1.1508 Acc: 0.8182
Epoch 33/88
----------
train Loss: 1.3593 Acc: 0.8612
val Loss: 1.2038 Acc: 0.8182
Epoch 34/88
----------
train Loss: 1.3006 Acc: 0.9282
val Loss: 1.2536 Acc: 0.8182
Epoch 35/88
----------
train Loss: 0.9976 Acc: 0.9809
val Loss: 1.3496 Acc: 0.7955
Epoch 36/88
----------
train Loss: 1.5357 Acc: 0.8469
val Loss: 1.3278 Acc: 0.7955
Epoch 37/88
----------
train Loss: 1.2946 Acc: 0.8182
val Loss: 1.3754 Acc: 0.8182
Epoch 38/88
----------
train Loss: 1.3326 Acc: 0.9330
val Loss: 1.2913 Acc: 0.7955
Epoch 39/88
----------
train Loss: 1.4012 Acc: 0.7656
val Loss: 1.3969 Acc: 0.7727
Epoch 40/88
----------
train Loss: 1.1674 Acc: 0.9043
val Loss: 1.4032 Acc: 0.7273
Epoch 41/88
----------
train Loss: 1.6375 Acc: 0.7177
val Loss: 1.2772 Acc: 0.7955
Epoch 42/88
----------
train Loss: 1.1710 Acc: 0.8804
val Loss: 1.2339 Acc: 0.8182
Epoch 43/88
----------
train Loss: 1.3509 Acc: 0.8756
val Loss: 1.1721 Acc: 0.8409
Epoch 44/88
----------
train Loss: 1.2055 Acc: 0.8852
val Loss: 1.2689 Acc: 0.7955
Epoch 45/88
----------
train Loss: 0.7862 Acc: 0.9713
val Loss: 1.2012 Acc: 0.7955
Epoch 46/88
----------
train Loss: 1.6163 Acc: 0.8421
val Loss: 1.3235 Acc: 0.7955
Epoch 47/88
----------
train Loss: 1.2356 Acc: 0.8995
val Loss: 1.2491 Acc: 0.7955
Epoch 48/88
----------
train Loss: 1.3224 Acc: 0.8708
val Loss: 1.2678 Acc: 0.8182
Epoch 49/88
----------
train Loss: 1.3190 Acc: 0.9522
val Loss: 1.3371 Acc: 0.7727
Epoch 50/88
----------
train Loss: 1.2616 Acc: 0.8852
val Loss: 1.3842 Acc: 0.7955
Epoch 51/88
----------
train Loss: 0.9742 Acc: 0.9856
val Loss: 1.2367 Acc: 0.8409
Epoch 52/88
----------
train Loss: 1.3258 Acc: 0.8469
val Loss: 1.2534 Acc: 0.8182
Epoch 53/88
----------
train Loss: 1.4930 Acc: 0.9139
val Loss: 1.2814 Acc: 0.7273
Epoch 54/88
----------
train Loss: 1.1401 Acc: 0.9426
val Loss: 1.3725 Acc: 0.7727
Epoch 55/88
----------
train Loss: 1.1958 Acc: 0.9426
val Loss: 1.4602 Acc: 0.7273
Epoch 56/88
----------
train Loss: 1.3827 Acc: 0.9187
val Loss: 1.3163 Acc: 0.7500
Epoch 57/88
----------
train Loss: 1.5135 Acc: 0.8469
val Loss: 1.2637 Acc: 0.7955
Epoch 58/88
----------
train Loss: 1.2360 Acc: 0.8230
val Loss: 1.2452 Acc: 0.7955
Epoch 59/88
----------
train Loss: 1.2907 Acc: 0.9043
val Loss: 1.3905 Acc: 0.7500
Epoch 60/88
----------
train Loss: 1.1011 Acc: 0.8804
val Loss: 1.3680 Acc: 0.7727
Epoch 61/88
----------
train Loss: 1.5095 Acc: 0.7560
val Loss: 1.2629 Acc: 0.7500
Epoch 62/88
----------
train Loss: 1.4104 Acc: 0.9330
val Loss: 1.2881 Acc: 0.7500
Epoch 63/88
----------
train Loss: 1.2428 Acc: 0.9330
val Loss: 1.3560 Acc: 0.7727
Epoch 64/88
----------
train Loss: 1.1197 Acc: 0.9474
val Loss: 1.3087 Acc: 0.7727
Epoch 65/88
----------
train Loss: 1.2537 Acc: 0.8565
val Loss: 1.4173 Acc: 0.7500
Epoch 66/88
----------
train Loss: 1.2609 Acc: 0.9043
val Loss: 1.3547 Acc: 0.7500
Epoch 67/88
----------
train Loss: 1.4303 Acc: 0.8565
val Loss: 1.3923 Acc: 0.7500
Epoch 68/88
----------
train Loss: 1.1894 Acc: 0.9091
val Loss: 1.3115 Acc: 0.7727
Epoch 69/88
----------
train Loss: 1.1301 Acc: 0.8804
val Loss: 1.1512 Acc: 0.8182
Epoch 70/88
----------
train Loss: 1.3048 Acc: 0.9043
val Loss: 1.0985 Acc: 0.8409
Epoch 71/88
----------
train Loss: 1.3868 Acc: 0.9187
val Loss: 1.2252 Acc: 0.7727
Epoch 72/88
----------
train Loss: 1.3847 Acc: 0.9091
val Loss: 1.3339 Acc: 0.7273
Epoch 73/88
----------
train Loss: 1.0116 Acc: 0.9713
val Loss: 1.3698 Acc: 0.7955
Epoch 74/88
----------
train Loss: 1.4166 Acc: 0.8660
val Loss: 1.3316 Acc: 0.7500
Epoch 75/88
----------
train Loss: 1.0845 Acc: 0.9665
val Loss: 1.2420 Acc: 0.7727
Epoch 76/88
----------
train Loss: 1.1061 Acc: 0.8995
val Loss: 1.2888 Acc: 0.8182
Epoch 77/88
----------
train Loss: 1.3553 Acc: 0.8852
val Loss: 1.4103 Acc: 0.7500
Epoch 78/88
----------
train Loss: 1.1887 Acc: 0.9139
val Loss: 1.4667 Acc: 0.7500
Epoch 79/88
----------
train Loss: 1.3577 Acc: 0.9043
val Loss: 1.3424 Acc: 0.8182
Epoch 80/88
----------
train Loss: 1.2743 Acc: 0.8756
val Loss: 1.3976 Acc: 0.7955
Epoch 81/88
----------
train Loss: 1.4903 Acc: 0.7799
val Loss: 1.5800 Acc: 0.7500
Epoch 82/88
----------
train Loss: 1.2413 Acc: 0.8565
val Loss: 1.5169 Acc: 0.7045
Epoch 83/88
----------
train Loss: 1.1403 Acc: 0.9713
val Loss: 1.2657 Acc: 0.7273
Epoch 84/88
----------
train Loss: 1.4608 Acc: 0.7990
val Loss: 1.3622 Acc: 0.6818
Epoch 85/88
----------
train Loss: 1.1262 Acc: 0.8708
val Loss: 1.5033 Acc: 0.7273
Epoch 86/88
----------
train Loss: 1.1624 Acc: 0.8995
val Loss: 1.2948 Acc: 0.7727
Epoch 87/88
----------
train Loss: 1.3200 Acc: 0.9474
val Loss: 1.2977 Acc: 0.7500
Epoch 88/88
----------
train Loss: 1.4258 Acc: 0.9091
[32m[I 2025-06-29 15:33:07,349][0m Trial 177 finished with value: 0.7272727272727273 and parameters: {'batch_size': 76, 'lr': 0.00021088650728964557, 'num_epochs': 88, 'weight_decay': 0.01890611610611061, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2336 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_76_lr_0.00021088650728964557_epoch_88_wd_0.01890611610611061_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/79
----------
train Loss: 3.7508 Acc: 0.2440
val Loss: 3.5718 Acc: 0.2955
Epoch 2/79
----------
train Loss: 3.5219 Acc: 0.3397
val Loss: 3.3965 Acc: 0.4545
Epoch 3/79
----------
train Loss: 3.3178 Acc: 0.3971
val Loss: 3.1504 Acc: 0.4773
Epoch 4/79
----------
train Loss: 3.1693 Acc: 0.4402
val Loss: 2.9733 Acc: 0.5682
Epoch 5/79
----------
train Loss: 3.0352 Acc: 0.4689
val Loss: 2.8346 Acc: 0.5909
Epoch 6/79
----------
train Loss: 2.8692 Acc: 0.4928
val Loss: 2.6551 Acc: 0.6364
Epoch 7/79
----------
train Loss: 2.7203 Acc: 0.5167
val Loss: 2.4838 Acc: 0.6364
Epoch 8/79
----------
train Loss: 2.6468 Acc: 0.4928
val Loss: 2.3503 Acc: 0.6364
Epoch 9/79
----------
train Loss: 2.5551 Acc: 0.5167
val Loss: 2.2355 Acc: 0.6364
Epoch 10/79
----------
train Loss: 2.3294 Acc: 0.5120
val Loss: 2.1539 Acc: 0.6591
Epoch 11/79
----------
train Loss: 2.3881 Acc: 0.5120
val Loss: 2.0919 Acc: 0.6591
Epoch 12/79
----------
train Loss: 2.3879 Acc: 0.5120
val Loss: 2.0648 Acc: 0.6818
Epoch 13/79
----------
train Loss: 2.2165 Acc: 0.5502
val Loss: 1.9864 Acc: 0.6818
Epoch 14/79
----------
train Loss: 2.1276 Acc: 0.5646
val Loss: 1.9591 Acc: 0.6818
Epoch 15/79
----------
train Loss: 2.2058 Acc: 0.5407
val Loss: 1.9334 Acc: 0.6818
Epoch 16/79
----------
train Loss: 2.1628 Acc: 0.5742
val Loss: 1.8990 Acc: 0.6818
Epoch 17/79
----------
train Loss: 2.0930 Acc: 0.5837
val Loss: 1.8633 Acc: 0.6818
Epoch 18/79
----------
train Loss: 2.0120 Acc: 0.6268
val Loss: 1.8067 Acc: 0.6818
Epoch 19/79
----------
train Loss: 1.9552 Acc: 0.6268
val Loss: 1.7836 Acc: 0.7045
Epoch 20/79
----------
train Loss: 1.9732 Acc: 0.6220
val Loss: 1.7460 Acc: 0.7045
Epoch 21/79
----------
train Loss: 2.0035 Acc: 0.6411
val Loss: 1.7091 Acc: 0.7273
Epoch 22/79
----------
train Loss: 1.9445 Acc: 0.6555
val Loss: 1.6709 Acc: 0.7045
Epoch 23/79
----------
train Loss: 1.9143 Acc: 0.6890
val Loss: 1.6202 Acc: 0.7500
Epoch 24/79
----------
train Loss: 1.7001 Acc: 0.7273
val Loss: 1.5595 Acc: 0.7500
Epoch 25/79
----------
train Loss: 1.8218 Acc: 0.6986
val Loss: 1.5697 Acc: 0.8409
Epoch 26/79
----------
train Loss: 1.8538 Acc: 0.7273
val Loss: 1.5820 Acc: 0.8409
Epoch 27/79
----------
train Loss: 1.6132 Acc: 0.8182
val Loss: 1.5712 Acc: 0.8182
Epoch 28/79
----------
train Loss: 1.8187 Acc: 0.7177
val Loss: 1.5501 Acc: 0.8182
Epoch 29/79
----------
train Loss: 1.8725 Acc: 0.6507
val Loss: 1.5271 Acc: 0.8409
Epoch 30/79
----------
train Loss: 1.7150 Acc: 0.7512
val Loss: 1.5245 Acc: 0.8182
Epoch 31/79
----------
train Loss: 1.5246 Acc: 0.8565
val Loss: 1.4810 Acc: 0.8182
Epoch 32/79
----------
train Loss: 1.6705 Acc: 0.7416
val Loss: 1.4418 Acc: 0.8182
Epoch 33/79
----------
train Loss: 1.6935 Acc: 0.8038
val Loss: 1.4376 Acc: 0.7955
Epoch 34/79
----------
train Loss: 1.5962 Acc: 0.8517
val Loss: 1.4383 Acc: 0.7955
Epoch 35/79
----------
train Loss: 1.3148 Acc: 0.9234
val Loss: 1.4279 Acc: 0.8182
Epoch 36/79
----------
train Loss: 1.7762 Acc: 0.7560
val Loss: 1.4248 Acc: 0.7955
Epoch 37/79
----------
train Loss: 1.4714 Acc: 0.8038
val Loss: 1.4336 Acc: 0.8182
Epoch 38/79
----------
train Loss: 1.4964 Acc: 0.9234
val Loss: 1.4031 Acc: 0.8409
Epoch 39/79
----------
train Loss: 1.6438 Acc: 0.6986
val Loss: 1.4622 Acc: 0.8409
Epoch 40/79
----------
train Loss: 1.3498 Acc: 0.8660
val Loss: 1.4709 Acc: 0.8182
Epoch 41/79
----------
train Loss: 1.7795 Acc: 0.7225
val Loss: 1.4350 Acc: 0.8182
Epoch 42/79
----------
train Loss: 1.3589 Acc: 0.8421
val Loss: 1.4089 Acc: 0.8182
Epoch 43/79
----------
train Loss: 1.4736 Acc: 0.8373
val Loss: 1.4041 Acc: 0.8182
Epoch 44/79
----------
train Loss: 1.3450 Acc: 0.8565
val Loss: 1.3864 Acc: 0.7955
Epoch 45/79
----------
train Loss: 0.9046 Acc: 0.9617
val Loss: 1.3688 Acc: 0.7727
Epoch 46/79
----------
train Loss: 1.7502 Acc: 0.7895
val Loss: 1.3927 Acc: 0.7955
Epoch 47/79
----------
train Loss: 1.3424 Acc: 0.8708
val Loss: 1.3846 Acc: 0.7955
Epoch 48/79
----------
train Loss: 1.4296 Acc: 0.8278
val Loss: 1.3701 Acc: 0.7955
Epoch 49/79
----------
train Loss: 1.3679 Acc: 0.9091
val Loss: 1.3672 Acc: 0.7727
Epoch 50/79
----------
train Loss: 1.3524 Acc: 0.8804
val Loss: 1.4141 Acc: 0.7727
Epoch 51/79
----------
train Loss: 1.0158 Acc: 0.9809
val Loss: 1.3525 Acc: 0.7727
Epoch 52/79
----------
train Loss: 1.4319 Acc: 0.8038
val Loss: 1.3352 Acc: 0.7727
Epoch 53/79
----------
train Loss: 1.6062 Acc: 0.8995
val Loss: 1.3249 Acc: 0.8409
Epoch 54/79
----------
train Loss: 1.2207 Acc: 0.9139
val Loss: 1.3214 Acc: 0.8409
Epoch 55/79
----------
train Loss: 1.2671 Acc: 0.9234
val Loss: 1.3257 Acc: 0.8182
Epoch 56/79
----------
train Loss: 1.4517 Acc: 0.8947
val Loss: 1.3396 Acc: 0.7727
Epoch 57/79
----------
train Loss: 1.6592 Acc: 0.7847
val Loss: 1.3072 Acc: 0.7955
Epoch 58/79
----------
train Loss: 1.3837 Acc: 0.7990
val Loss: 1.3008 Acc: 0.7727
Epoch 59/79
----------
train Loss: 1.4098 Acc: 0.8565
val Loss: 1.3124 Acc: 0.7727
Epoch 60/79
----------
train Loss: 1.1558 Acc: 0.8756
val Loss: 1.3266 Acc: 0.7955
Epoch 61/79
----------
train Loss: 1.6075 Acc: 0.7512
val Loss: 1.3489 Acc: 0.7727
Epoch 62/79
----------
train Loss: 1.4339 Acc: 0.9330
val Loss: 1.3303 Acc: 0.8182
Epoch 63/79
----------
train Loss: 1.2584 Acc: 0.9282
val Loss: 1.3234 Acc: 0.8182
Epoch 64/79
----------
train Loss: 1.1719 Acc: 0.9426
val Loss: 1.3047 Acc: 0.8182
Epoch 65/79
----------
train Loss: 1.3520 Acc: 0.8230
val Loss: 1.3250 Acc: 0.7955
Epoch 66/79
----------
train Loss: 1.2956 Acc: 0.8708
val Loss: 1.3146 Acc: 0.7955
Epoch 67/79
----------
train Loss: 1.4779 Acc: 0.8660
val Loss: 1.3048 Acc: 0.8182
Epoch 68/79
----------
train Loss: 1.2026 Acc: 0.9043
val Loss: 1.3011 Acc: 0.7955
Epoch 69/79
----------
train Loss: 1.2025 Acc: 0.8900
val Loss: 1.2986 Acc: 0.8182
Epoch 70/79
----------
train Loss: 1.3709 Acc: 0.8804
val Loss: 1.2954 Acc: 0.7955
Epoch 71/79
----------
train Loss: 1.4654 Acc: 0.8995
val Loss: 1.3425 Acc: 0.7955
Epoch 72/79
----------
train Loss: 1.4577 Acc: 0.8852
val Loss: 1.3944 Acc: 0.7955
Epoch 73/79
----------
train Loss: 1.0422 Acc: 0.9569
val Loss: 1.3699 Acc: 0.7727
Epoch 74/79
----------
train Loss: 1.5007 Acc: 0.8373
val Loss: 1.3079 Acc: 0.7500
Epoch 75/79
----------
train Loss: 1.1321 Acc: 0.9378
val Loss: 1.2750 Acc: 0.8182
Epoch 76/79
----------
train Loss: 1.2258 Acc: 0.8086
val Loss: 1.2859 Acc: 0.8182
Epoch 77/79
----------
train Loss: 1.3881 Acc: 0.8421
val Loss: 1.3058 Acc: 0.8182
Epoch 78/79
----------
train Loss: 1.2340 Acc: 0.8852
val Loss: 1.3324 Acc: 0.8409
Epoch 79/79
----------
train Loss: 1.4775 Acc: 0.8612
[32m[I 2025-06-29 15:51:06,979][0m Trial 178 finished with value: 0.8409090909090909 and parameters: {'batch_size': 21, 'lr': 7.599810439815378e-05, 'num_epochs': 79, 'weight_decay': 0.015630769230028145, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3388 Acc: 0.8409
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_21_lr_7.599810439815378e-05_epoch_79_wd_0.015630769230028145_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/67
----------
train Loss: 3.5741 Acc: 0.2967
val Loss: 3.3120 Acc: 0.5682
Epoch 2/67
----------
train Loss: 3.0160 Acc: 0.5024
val Loss: 2.7481 Acc: 0.6364
Epoch 3/67
----------
train Loss: 2.6319 Acc: 0.5120
val Loss: 2.2186 Acc: 0.6364
Epoch 4/67
----------
train Loss: 2.4290 Acc: 0.4976
val Loss: 2.0363 Acc: 0.6364
Epoch 5/67
----------
train Loss: 2.3274 Acc: 0.5120
val Loss: 1.9483 Acc: 0.6364
Epoch 6/67
----------
train Loss: 2.1890 Acc: 0.5359
val Loss: 1.8700 Acc: 0.6818
Epoch 7/67
----------
train Loss: 2.0773 Acc: 0.5694
val Loss: 1.8600 Acc: 0.7045
Epoch 8/67
----------
train Loss: 2.1291 Acc: 0.5694
val Loss: 1.7499 Acc: 0.7500
Epoch 9/67
----------
train Loss: 2.0591 Acc: 0.6459
val Loss: 1.7520 Acc: 0.7955
Epoch 10/67
----------
train Loss: 1.6271 Acc: 0.8230
val Loss: 1.6663 Acc: 0.7500
Epoch 11/67
----------
train Loss: 1.8999 Acc: 0.6842
val Loss: 1.5439 Acc: 0.7500
Epoch 12/67
----------
train Loss: 1.8677 Acc: 0.6459
val Loss: 1.6078 Acc: 0.7727
Epoch 13/67
----------
train Loss: 1.6101 Acc: 0.8278
val Loss: 1.4697 Acc: 0.7727
Epoch 14/67
----------
train Loss: 1.4594 Acc: 0.8038
val Loss: 1.4727 Acc: 0.7273
Epoch 15/67
----------
train Loss: 1.5866 Acc: 0.7703
val Loss: 1.3859 Acc: 0.7500
Epoch 16/67
----------
train Loss: 1.5486 Acc: 0.7656
val Loss: 1.4243 Acc: 0.7955
Epoch 17/67
----------
train Loss: 1.4743 Acc: 0.8134
val Loss: 1.5234 Acc: 0.7955
Epoch 18/67
----------
train Loss: 1.4103 Acc: 0.8325
val Loss: 1.4025 Acc: 0.7727
Epoch 19/67
----------
train Loss: 1.2771 Acc: 0.9426
val Loss: 1.3181 Acc: 0.7500
Epoch 20/67
----------
train Loss: 1.3930 Acc: 0.8660
val Loss: 1.2549 Acc: 0.7955
Epoch 21/67
----------
train Loss: 1.4582 Acc: 0.8708
val Loss: 1.2594 Acc: 0.7955
Epoch 22/67
----------
train Loss: 1.3403 Acc: 0.8517
val Loss: 1.3189 Acc: 0.7955
Epoch 23/67
----------
train Loss: 1.5041 Acc: 0.8421
val Loss: 1.3415 Acc: 0.8182
Epoch 24/67
----------
train Loss: 1.1062 Acc: 0.9187
val Loss: 1.2536 Acc: 0.7955
Epoch 25/67
----------
train Loss: 1.2989 Acc: 0.9330
val Loss: 1.3919 Acc: 0.7727
Epoch 26/67
----------
train Loss: 1.4583 Acc: 0.9091
val Loss: 1.4069 Acc: 0.8182
Epoch 27/67
----------
train Loss: 1.1898 Acc: 0.9665
val Loss: 1.5080 Acc: 0.7955
Epoch 28/67
----------
train Loss: 1.4246 Acc: 0.8804
val Loss: 1.4004 Acc: 0.7727
Epoch 29/67
----------
train Loss: 1.5136 Acc: 0.7656
val Loss: 1.4140 Acc: 0.7955
Epoch 30/67
----------
train Loss: 1.2989 Acc: 0.8756
val Loss: 1.2692 Acc: 0.7500
Epoch 31/67
----------
train Loss: 1.1549 Acc: 0.9282
val Loss: 1.1825 Acc: 0.7955
Epoch 32/67
----------
train Loss: 1.2924 Acc: 0.8900
val Loss: 1.1723 Acc: 0.7955
Epoch 33/67
----------
train Loss: 1.3653 Acc: 0.8708
val Loss: 1.2270 Acc: 0.7955
Epoch 34/67
----------
train Loss: 1.3031 Acc: 0.9378
val Loss: 1.2681 Acc: 0.8182
Epoch 35/67
----------
train Loss: 1.0008 Acc: 0.9713
val Loss: 1.3664 Acc: 0.7727
Epoch 36/67
----------
train Loss: 1.5568 Acc: 0.8660
val Loss: 1.3439 Acc: 0.7727
Epoch 37/67
----------
train Loss: 1.3380 Acc: 0.8182
val Loss: 1.5084 Acc: 0.7273
Epoch 38/67
----------
train Loss: 1.3654 Acc: 0.9426
val Loss: 1.3898 Acc: 0.7500
Epoch 39/67
----------
train Loss: 1.3821 Acc: 0.7512
val Loss: 1.4992 Acc: 0.7273
Epoch 40/67
----------
train Loss: 1.1860 Acc: 0.9187
val Loss: 1.3706 Acc: 0.7500
Epoch 41/67
----------
train Loss: 1.6316 Acc: 0.7225
val Loss: 1.2780 Acc: 0.7500
Epoch 42/67
----------
train Loss: 1.2330 Acc: 0.8708
val Loss: 1.2890 Acc: 0.7500
Epoch 43/67
----------
train Loss: 1.3501 Acc: 0.8804
val Loss: 1.1900 Acc: 0.7955
Epoch 44/67
----------
train Loss: 1.2275 Acc: 0.8804
val Loss: 1.3917 Acc: 0.8182
Epoch 45/67
----------
train Loss: 0.8259 Acc: 0.9569
val Loss: 1.3355 Acc: 0.8409
Epoch 46/67
----------
train Loss: 1.6364 Acc: 0.8134
val Loss: 1.4318 Acc: 0.7273
Epoch 47/67
----------
train Loss: 1.2707 Acc: 0.8804
val Loss: 1.4635 Acc: 0.6818
Epoch 48/67
----------
train Loss: 1.3546 Acc: 0.8517
val Loss: 1.4528 Acc: 0.7500
Epoch 49/67
----------
train Loss: 1.3201 Acc: 0.9522
val Loss: 1.4584 Acc: 0.7955
Epoch 50/67
----------
train Loss: 1.2697 Acc: 0.8708
val Loss: 1.3785 Acc: 0.7955
Epoch 51/67
----------
train Loss: 0.9756 Acc: 0.9809
val Loss: 1.2564 Acc: 0.8182
Epoch 52/67
----------
train Loss: 1.3315 Acc: 0.8469
val Loss: 1.2647 Acc: 0.7727
Epoch 53/67
----------
train Loss: 1.4923 Acc: 0.9139
val Loss: 1.3825 Acc: 0.7500
Epoch 54/67
----------
train Loss: 1.1742 Acc: 0.9378
val Loss: 1.4719 Acc: 0.7273
Epoch 55/67
----------
train Loss: 1.2254 Acc: 0.9522
val Loss: 1.6254 Acc: 0.7045
Epoch 56/67
----------
train Loss: 1.4058 Acc: 0.9043
val Loss: 1.4027 Acc: 0.7273
Epoch 57/67
----------
train Loss: 1.5561 Acc: 0.8421
val Loss: 1.3296 Acc: 0.7273
Epoch 58/67
----------
train Loss: 1.2593 Acc: 0.8517
val Loss: 1.3404 Acc: 0.7273
Epoch 59/67
----------
train Loss: 1.3018 Acc: 0.8995
val Loss: 1.4367 Acc: 0.7045
Epoch 60/67
----------
train Loss: 1.0971 Acc: 0.8804
val Loss: 1.4000 Acc: 0.7273
Epoch 61/67
----------
train Loss: 1.5391 Acc: 0.7560
val Loss: 1.4115 Acc: 0.6591
Epoch 62/67
----------
train Loss: 1.4710 Acc: 0.9187
val Loss: 1.5690 Acc: 0.6364
Epoch 63/67
----------
train Loss: 1.2736 Acc: 0.9282
val Loss: 1.5889 Acc: 0.6591
Epoch 64/67
----------
train Loss: 1.1275 Acc: 0.9378
val Loss: 1.5277 Acc: 0.6818
Epoch 65/67
----------
train Loss: 1.2760 Acc: 0.8708
val Loss: 1.5678 Acc: 0.6591
Epoch 66/67
----------
train Loss: 1.2916 Acc: 0.8900
val Loss: 1.5437 Acc: 0.7500
Epoch 67/67
----------
train Loss: 1.4674 Acc: 0.8708
[32m[I 2025-06-29 16:06:22,920][0m Trial 179 finished with value: 0.7272727272727273 and parameters: {'batch_size': 98, 'lr': 0.00025953458562392794, 'num_epochs': 67, 'weight_decay': 0.02581412835302382, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5917 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/efficientnetb0_bs_98_lr_0.00025953458562392794_epoch_67_wd_0.02581412835302382_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/96
----------
train Loss: 0.6961 Acc: 0.2297
val Loss: 0.6785 Acc: 0.2500
Epoch 2/96
----------
train Loss: 0.6739 Acc: 0.2727
val Loss: 0.6623 Acc: 0.2727
Epoch 3/96
----------
train Loss: 0.6559 Acc: 0.3445
val Loss: 0.6388 Acc: 0.3636
Epoch 4/96
----------
train Loss: 0.6432 Acc: 0.3589
val Loss: 0.6239 Acc: 0.3864
Epoch 5/96
----------
train Loss: 0.6345 Acc: 0.3636
val Loss: 0.6149 Acc: 0.4318
Epoch 6/96
----------
train Loss: 0.6176 Acc: 0.4545
val Loss: 0.6015 Acc: 0.5000
Epoch 7/96
----------
train Loss: 0.6007 Acc: 0.5072
val Loss: 0.5856 Acc: 0.5682
Epoch 8/96
----------
train Loss: 0.5900 Acc: 0.5120
val Loss: 0.5716 Acc: 0.6364
Epoch 9/96
----------
train Loss: 0.5771 Acc: 0.5502
val Loss: 0.5551 Acc: 0.6364
Epoch 10/96
----------
train Loss: 0.5523 Acc: 0.5550
val Loss: 0.5360 Acc: 0.6591
Epoch 11/96
----------
train Loss: 0.5545 Acc: 0.5407
val Loss: 0.5243 Acc: 0.6818
Epoch 12/96
----------
train Loss: 0.5470 Acc: 0.5263
val Loss: 0.5149 Acc: 0.6364
Epoch 13/96
----------
train Loss: 0.5223 Acc: 0.5981
val Loss: 0.4960 Acc: 0.6591
Epoch 14/96
----------
train Loss: 0.5061 Acc: 0.5742
val Loss: 0.4862 Acc: 0.6591
Epoch 15/96
----------
train Loss: 0.5046 Acc: 0.5598
val Loss: 0.4752 Acc: 0.6818
Epoch 16/96
----------
train Loss: 0.4950 Acc: 0.5789
val Loss: 0.4619 Acc: 0.6818
Epoch 17/96
----------
train Loss: 0.4846 Acc: 0.5742
val Loss: 0.4500 Acc: 0.6591
Epoch 18/96
----------
train Loss: 0.4748 Acc: 0.5837
val Loss: 0.4380 Acc: 0.6591
Epoch 19/96
----------
train Loss: 0.4597 Acc: 0.6364
val Loss: 0.4292 Acc: 0.6591
Epoch 20/96
----------
train Loss: 0.4586 Acc: 0.6077
val Loss: 0.4176 Acc: 0.6591
Epoch 21/96
----------
train Loss: 0.4551 Acc: 0.6172
val Loss: 0.4101 Acc: 0.7045
Epoch 22/96
----------
train Loss: 0.4488 Acc: 0.6172
val Loss: 0.4018 Acc: 0.7045
Epoch 23/96
----------
train Loss: 0.4379 Acc: 0.6268
val Loss: 0.3922 Acc: 0.7273
Epoch 24/96
----------
train Loss: 0.4110 Acc: 0.7033
val Loss: 0.3767 Acc: 0.7045
Epoch 25/96
----------
train Loss: 0.4295 Acc: 0.6651
val Loss: 0.3777 Acc: 0.7727
Epoch 26/96
----------
train Loss: 0.4272 Acc: 0.6603
val Loss: 0.3753 Acc: 0.7727
Epoch 27/96
----------
train Loss: 0.3914 Acc: 0.7225
val Loss: 0.3664 Acc: 0.7500
Epoch 28/96
----------
train Loss: 0.4191 Acc: 0.6555
val Loss: 0.3616 Acc: 0.7727
Epoch 29/96
----------
train Loss: 0.4337 Acc: 0.6316
val Loss: 0.3577 Acc: 0.7727
Epoch 30/96
----------
train Loss: 0.4107 Acc: 0.6459
val Loss: 0.3549 Acc: 0.7955
Epoch 31/96
----------
train Loss: 0.3773 Acc: 0.7895
val Loss: 0.3463 Acc: 0.7727
Epoch 32/96
----------
train Loss: 0.3909 Acc: 0.6938
val Loss: 0.3374 Acc: 0.7955
Epoch 33/96
----------
train Loss: 0.4063 Acc: 0.6794
val Loss: 0.3350 Acc: 0.7955
Epoch 34/96
----------
train Loss: 0.3824 Acc: 0.7368
val Loss: 0.3301 Acc: 0.7727
Epoch 35/96
----------
train Loss: 0.3481 Acc: 0.8086
val Loss: 0.3280 Acc: 0.7955
Epoch 36/96
----------
train Loss: 0.4126 Acc: 0.6986
val Loss: 0.3219 Acc: 0.8182
Epoch 37/96
----------
train Loss: 0.3686 Acc: 0.7464
val Loss: 0.3270 Acc: 0.8182
Epoch 38/96
----------
train Loss: 0.3674 Acc: 0.8134
val Loss: 0.3239 Acc: 0.7955
Epoch 39/96
----------
train Loss: 0.3846 Acc: 0.6746
val Loss: 0.3308 Acc: 0.7955
Epoch 40/96
----------
train Loss: 0.3448 Acc: 0.7895
val Loss: 0.3266 Acc: 0.7955
Epoch 41/96
----------
train Loss: 0.3928 Acc: 0.6794
val Loss: 0.3220 Acc: 0.7955
Epoch 42/96
----------
train Loss: 0.3460 Acc: 0.7321
val Loss: 0.3146 Acc: 0.7955
Epoch 43/96
----------
train Loss: 0.3658 Acc: 0.7512
val Loss: 0.3092 Acc: 0.7955
Epoch 44/96
----------
train Loss: 0.3350 Acc: 0.8086
val Loss: 0.3056 Acc: 0.7955
Epoch 45/96
----------
train Loss: 0.2576 Acc: 0.9187
val Loss: 0.3006 Acc: 0.7955
Epoch 46/96
----------
train Loss: 0.3983 Acc: 0.7799
val Loss: 0.3020 Acc: 0.7955
Epoch 47/96
----------
train Loss: 0.3241 Acc: 0.8373
val Loss: 0.2989 Acc: 0.7955
Epoch 48/96
----------
train Loss: 0.3492 Acc: 0.7608
val Loss: 0.3008 Acc: 0.7955
Epoch 49/96
----------
train Loss: 0.3344 Acc: 0.8517
val Loss: 0.2970 Acc: 0.7955
Epoch 50/96
----------
train Loss: 0.3247 Acc: 0.7895
val Loss: 0.2965 Acc: 0.7955
Epoch 51/96
----------
train Loss: 0.2745 Acc: 0.9474
val Loss: 0.2896 Acc: 0.7727
Epoch 52/96
----------
train Loss: 0.3410 Acc: 0.7464
val Loss: 0.2921 Acc: 0.7727
Epoch 53/96
----------
train Loss: 0.3667 Acc: 0.8086
val Loss: 0.2898 Acc: 0.7727
Epoch 54/96
----------
train Loss: 0.2868 Acc: 0.8995
val Loss: 0.2836 Acc: 0.7955
Epoch 55/96
----------
train Loss: 0.3054 Acc: 0.8900
val Loss: 0.2807 Acc: 0.7955
Epoch 56/96
----------
train Loss: 0.3412 Acc: 0.8182
val Loss: 0.2815 Acc: 0.7955
Epoch 57/96
----------
train Loss: 0.3726 Acc: 0.7560
val Loss: 0.2804 Acc: 0.8409
Epoch 58/96
----------
train Loss: 0.3166 Acc: 0.7895
val Loss: 0.2778 Acc: 0.8182
Epoch 59/96
----------
train Loss: 0.3344 Acc: 0.8230
val Loss: 0.2768 Acc: 0.7955
Epoch 60/96
----------
train Loss: 0.2924 Acc: 0.8278
val Loss: 0.2778 Acc: 0.7955
Epoch 61/96
----------
train Loss: 0.3673 Acc: 0.7081
val Loss: 0.2786 Acc: 0.7955
Epoch 62/96
----------
train Loss: 0.3263 Acc: 0.8756
val Loss: 0.2774 Acc: 0.8182
Epoch 63/96
----------
train Loss: 0.2879 Acc: 0.9091
val Loss: 0.2769 Acc: 0.8182
Epoch 64/96
----------
train Loss: 0.2785 Acc: 0.8995
val Loss: 0.2741 Acc: 0.8182
Epoch 65/96
----------
train Loss: 0.3097 Acc: 0.8038
val Loss: 0.2726 Acc: 0.7955
Epoch 66/96
----------
train Loss: 0.3004 Acc: 0.8660
val Loss: 0.2758 Acc: 0.7955
Epoch 67/96
----------
train Loss: 0.3271 Acc: 0.8325
val Loss: 0.2694 Acc: 0.7955
Epoch 68/96
----------
train Loss: 0.2817 Acc: 0.8852
val Loss: 0.2717 Acc: 0.7955
Epoch 69/96
----------
train Loss: 0.2845 Acc: 0.8660
val Loss: 0.2707 Acc: 0.7955
Epoch 70/96
----------
train Loss: 0.3120 Acc: 0.8517
val Loss: 0.2742 Acc: 0.7955
Epoch 71/96
----------
train Loss: 0.3292 Acc: 0.8708
val Loss: 0.2719 Acc: 0.7955
Epoch 72/96
----------
train Loss: 0.3283 Acc: 0.8421
val Loss: 0.2766 Acc: 0.7727
Epoch 73/96
----------
train Loss: 0.2358 Acc: 0.9474
val Loss: 0.2773 Acc: 0.7955
Epoch 74/96
----------
train Loss: 0.3413 Acc: 0.8038
val Loss: 0.2717 Acc: 0.7955
Epoch 75/96
----------
train Loss: 0.2623 Acc: 0.9091
val Loss: 0.2729 Acc: 0.7727
Epoch 76/96
----------
train Loss: 0.2874 Acc: 0.7703
val Loss: 0.2700 Acc: 0.7727
Epoch 77/96
----------
train Loss: 0.3119 Acc: 0.8182
val Loss: 0.2679 Acc: 0.7727
Epoch 78/96
----------
train Loss: 0.2727 Acc: 0.8565
val Loss: 0.2652 Acc: 0.7727
Epoch 79/96
----------
train Loss: 0.3377 Acc: 0.8038
val Loss: 0.2597 Acc: 0.7955
Epoch 80/96
----------
train Loss: 0.2957 Acc: 0.8373
val Loss: 0.2585 Acc: 0.8409
Epoch 81/96
----------
train Loss: 0.3342 Acc: 0.7703
val Loss: 0.2662 Acc: 0.7955
Epoch 82/96
----------
train Loss: 0.2911 Acc: 0.8278
val Loss: 0.2668 Acc: 0.8182
Epoch 83/96
----------
train Loss: 0.2493 Acc: 0.9426
val Loss: 0.2671 Acc: 0.8409
Epoch 84/96
----------
train Loss: 0.3334 Acc: 0.7560
val Loss: 0.2667 Acc: 0.7727
Epoch 85/96
----------
train Loss: 0.2706 Acc: 0.8086
val Loss: 0.2673 Acc: 0.7727
Epoch 86/96
----------
train Loss: 0.2777 Acc: 0.8708
val Loss: 0.2603 Acc: 0.7955
Epoch 87/96
----------
train Loss: 0.3130 Acc: 0.8660
val Loss: 0.2589 Acc: 0.8182
Epoch 88/96
----------
train Loss: 0.3204 Acc: 0.8947
val Loss: 0.2562 Acc: 0.8409
Epoch 89/96
----------
train Loss: 0.3491 Acc: 0.7895
val Loss: 0.2551 Acc: 0.8636
Epoch 90/96
----------
train Loss: 0.2905 Acc: 0.8517
val Loss: 0.2561 Acc: 0.7955
Epoch 91/96
----------
train Loss: 0.2546 Acc: 0.9282
val Loss: 0.2606 Acc: 0.8182
Epoch 92/96
----------
train Loss: 0.2758 Acc: 0.9187
val Loss: 0.2625 Acc: 0.7955
Epoch 93/96
----------
train Loss: 0.2999 Acc: 0.8421
val Loss: 0.2525 Acc: 0.7955
Epoch 94/96
----------
train Loss: 0.2316 Acc: 0.9665
val Loss: 0.2507 Acc: 0.8409
Epoch 95/96
----------
train Loss: 0.2754 Acc: 0.9091
val Loss: 0.2512 Acc: 0.7727
Epoch 96/96
----------
train Loss: 0.1985 Acc: 0.9952
[32m[I 2025-06-29 16:28:12,703][0m Trial 180 finished with value: 0.7954545454545455 and parameters: {'batch_size': 8, 'lr': 3.5488408265866565e-05, 'num_epochs': 96, 'weight_decay': 0.00040781189467194997, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2517 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_8_lr_3.5488408265866565e-05_epoch_96_wd_0.00040781189467194997_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/83
----------
train Loss: 2.9672 Acc: 0.4163
val Loss: 2.0270 Acc: 0.6364
Epoch 2/83
----------
train Loss: 2.4126 Acc: 0.5646
val Loss: 2.4364 Acc: 0.5455
Epoch 3/83
----------
train Loss: 2.0692 Acc: 0.6555
val Loss: 1.9496 Acc: 0.6364
Epoch 4/83
----------
train Loss: 2.0217 Acc: 0.6459
val Loss: 2.0447 Acc: 0.7500
Epoch 5/83
----------
train Loss: 1.8463 Acc: 0.7464
val Loss: 2.3300 Acc: 0.7045
Epoch 6/83
----------
train Loss: 1.8775 Acc: 0.7225
val Loss: 2.3211 Acc: 0.7273
Epoch 7/83
----------
train Loss: 1.6260 Acc: 0.8230
val Loss: 2.3646 Acc: 0.7273
Epoch 8/83
----------
train Loss: 1.7660 Acc: 0.7560
val Loss: 1.9070 Acc: 0.8636
Epoch 9/83
----------
train Loss: 1.7898 Acc: 0.7464
val Loss: 3.4373 Acc: 0.5909
Epoch 10/83
----------
train Loss: 1.1892 Acc: 0.9282
val Loss: 1.5564 Acc: 0.7955
Epoch 11/83
----------
train Loss: 1.9012 Acc: 0.7799
val Loss: 1.5004 Acc: 0.7500
Epoch 12/83
----------
train Loss: 1.7139 Acc: 0.7608
val Loss: 2.8409 Acc: 0.5227
Epoch 13/83
----------
train Loss: 1.5112 Acc: 0.8708
[32m[I 2025-06-29 16:31:11,338][0m Trial 181 finished with value: 0.8636363636363636 and parameters: {'batch_size': 23, 'lr': 0.0012072548040961768, 'num_epochs': 83, 'weight_decay': 0.014298188966771156, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 2.4217 Acc: 0.5909
Early stopping at epoch 13 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_23_lr_0.0012072548040961768_epoch_83_wd_0.014298188966771156_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/77
----------
train Loss: 3.5448 Acc: 0.3158
val Loss: 3.2881 Acc: 0.5682
Epoch 2/77
----------
train Loss: 2.9508 Acc: 0.5167
val Loss: 2.7262 Acc: 0.6364
Epoch 3/77
----------
train Loss: 2.5754 Acc: 0.4976
val Loss: 2.2327 Acc: 0.6364
Epoch 4/77
----------
train Loss: 2.3968 Acc: 0.4976
val Loss: 2.0723 Acc: 0.6364
Epoch 5/77
----------
train Loss: 2.3132 Acc: 0.5167
val Loss: 1.9980 Acc: 0.6591
Epoch 6/77
----------
train Loss: 2.1855 Acc: 0.5359
val Loss: 1.9337 Acc: 0.7045
Epoch 7/77
----------
train Loss: 2.0729 Acc: 0.5694
val Loss: 1.9730 Acc: 0.7045
Epoch 8/77
----------
train Loss: 2.1205 Acc: 0.5837
val Loss: 1.8366 Acc: 0.7727
Epoch 9/77
----------
train Loss: 2.0477 Acc: 0.6411
val Loss: 1.8017 Acc: 0.7500
Epoch 10/77
----------
train Loss: 1.6228 Acc: 0.8182
val Loss: 1.6823 Acc: 0.7045
Epoch 11/77
----------
train Loss: 1.8820 Acc: 0.6938
val Loss: 1.5608 Acc: 0.7727
Epoch 12/77
----------
train Loss: 1.8405 Acc: 0.6555
val Loss: 1.6621 Acc: 0.7955
Epoch 13/77
----------
train Loss: 1.5802 Acc: 0.8325
val Loss: 1.4747 Acc: 0.7727
Epoch 14/77
----------
train Loss: 1.4287 Acc: 0.8038
val Loss: 1.5223 Acc: 0.7045
Epoch 15/77
----------
train Loss: 1.5712 Acc: 0.7703
val Loss: 1.4414 Acc: 0.7500
Epoch 16/77
----------
train Loss: 1.5442 Acc: 0.7608
val Loss: 1.5548 Acc: 0.7955
Epoch 17/77
----------
train Loss: 1.4658 Acc: 0.8182
val Loss: 1.6997 Acc: 0.7727
Epoch 18/77
----------
train Loss: 1.4070 Acc: 0.8517
val Loss: 1.4789 Acc: 0.7727
Epoch 19/77
----------
train Loss: 1.2820 Acc: 0.9330
val Loss: 1.4099 Acc: 0.7273
Epoch 20/77
----------
train Loss: 1.4031 Acc: 0.8517
val Loss: 1.3736 Acc: 0.7273
Epoch 21/77
----------
train Loss: 1.4617 Acc: 0.8804
val Loss: 1.3860 Acc: 0.7955
Epoch 22/77
----------
train Loss: 1.3410 Acc: 0.8612
val Loss: 1.4326 Acc: 0.7727
Epoch 23/77
----------
train Loss: 1.5043 Acc: 0.8565
val Loss: 1.4667 Acc: 0.7727
Epoch 24/77
----------
train Loss: 1.1378 Acc: 0.8947
val Loss: 1.3913 Acc: 0.7727
Epoch 25/77
----------
train Loss: 1.3286 Acc: 0.9187
val Loss: 1.5404 Acc: 0.7727
Epoch 26/77
----------
train Loss: 1.4749 Acc: 0.9234
val Loss: 1.4421 Acc: 0.7727
Epoch 27/77
----------
train Loss: 1.2143 Acc: 0.9617
val Loss: 1.4688 Acc: 0.7500
Epoch 28/77
----------
train Loss: 1.4206 Acc: 0.8852
val Loss: 1.4095 Acc: 0.7500
Epoch 29/77
----------
train Loss: 1.5224 Acc: 0.7895
val Loss: 1.5170 Acc: 0.8182
Epoch 30/77
----------
train Loss: 1.3240 Acc: 0.8660
val Loss: 1.3462 Acc: 0.7500
Epoch 31/77
----------
train Loss: 1.1555 Acc: 0.9234
val Loss: 1.3293 Acc: 0.7727
Epoch 32/77
----------
train Loss: 1.2933 Acc: 0.8804
val Loss: 1.3137 Acc: 0.7727
Epoch 33/77
----------
train Loss: 1.4057 Acc: 0.8660
val Loss: 1.3946 Acc: 0.7500
Epoch 34/77
----------
train Loss: 1.3067 Acc: 0.9474
val Loss: 1.5766 Acc: 0.6818
Epoch 35/77
----------
train Loss: 1.0245 Acc: 0.9617
val Loss: 1.5211 Acc: 0.7500
Epoch 36/77
----------
train Loss: 1.6047 Acc: 0.8278
val Loss: 1.4901 Acc: 0.7045
Epoch 37/77
----------
train Loss: 1.3902 Acc: 0.7943
val Loss: 1.9551 Acc: 0.6591
Epoch 38/77
----------
train Loss: 1.4336 Acc: 0.9282
val Loss: 1.5496 Acc: 0.7045
Epoch 39/77
----------
train Loss: 1.4230 Acc: 0.7512
val Loss: 1.6855 Acc: 0.7045
Epoch 40/77
----------
train Loss: 1.2597 Acc: 0.9091
val Loss: 1.4547 Acc: 0.6818
Epoch 41/77
----------
train Loss: 1.6623 Acc: 0.7129
val Loss: 1.3771 Acc: 0.7273
Epoch 42/77
----------
train Loss: 1.2609 Acc: 0.8660
val Loss: 1.4770 Acc: 0.7045
Epoch 43/77
----------
train Loss: 1.3334 Acc: 0.8852
val Loss: 1.3038 Acc: 0.7727
Epoch 44/77
----------
train Loss: 1.2575 Acc: 0.8612
val Loss: 1.5263 Acc: 0.7727
Epoch 45/77
----------
train Loss: 0.8495 Acc: 0.9522
val Loss: 1.2721 Acc: 0.7727
Epoch 46/77
----------
train Loss: 1.6715 Acc: 0.8421
val Loss: 1.4517 Acc: 0.7273
Epoch 47/77
----------
train Loss: 1.2722 Acc: 0.9043
val Loss: 1.4781 Acc: 0.7500
Epoch 48/77
----------
train Loss: 1.3849 Acc: 0.8421
val Loss: 1.3369 Acc: 0.7727
Epoch 49/77
----------
train Loss: 1.3493 Acc: 0.9378
val Loss: 1.4137 Acc: 0.8182
Epoch 50/77
----------
train Loss: 1.3542 Acc: 0.8565
val Loss: 1.2883 Acc: 0.8409
Epoch 51/77
----------
train Loss: 1.0132 Acc: 0.9665
val Loss: 1.2620 Acc: 0.8182
Epoch 52/77
----------
train Loss: 1.3406 Acc: 0.8325
val Loss: 1.2705 Acc: 0.7273
Epoch 53/77
----------
train Loss: 1.5248 Acc: 0.9282
val Loss: 1.4081 Acc: 0.7273
Epoch 54/77
----------
train Loss: 1.2175 Acc: 0.9474
val Loss: 1.5153 Acc: 0.7727
Epoch 55/77
----------
train Loss: 1.2348 Acc: 0.9474
val Loss: 1.5126 Acc: 0.7500
Epoch 56/77
----------
train Loss: 1.4719 Acc: 0.8804
val Loss: 1.2860 Acc: 0.7500
Epoch 57/77
----------
train Loss: 1.6013 Acc: 0.8278
val Loss: 1.4772 Acc: 0.7727
Epoch 58/77
----------
train Loss: 1.3609 Acc: 0.8182
val Loss: 1.3893 Acc: 0.7500
Epoch 59/77
----------
train Loss: 1.4159 Acc: 0.8660
val Loss: 1.4294 Acc: 0.7045
Epoch 60/77
----------
train Loss: 1.1602 Acc: 0.8852
val Loss: 1.2478 Acc: 0.7500
Epoch 61/77
----------
train Loss: 1.5737 Acc: 0.7608
val Loss: 1.2726 Acc: 0.7273
Epoch 62/77
----------
train Loss: 1.4954 Acc: 0.9187
val Loss: 1.6420 Acc: 0.6136
Epoch 63/77
----------
train Loss: 1.3090 Acc: 0.9139
val Loss: 1.6113 Acc: 0.6818
Epoch 64/77
----------
train Loss: 1.1650 Acc: 0.9522
val Loss: 1.4287 Acc: 0.7727
Epoch 65/77
----------
train Loss: 1.3344 Acc: 0.8660
val Loss: 1.4702 Acc: 0.7727
Epoch 66/77
----------
train Loss: 1.3032 Acc: 0.8995
val Loss: 1.4482 Acc: 0.7727
Epoch 67/77
----------
train Loss: 1.5144 Acc: 0.8612
val Loss: 1.4279 Acc: 0.8182
Epoch 68/77
----------
train Loss: 1.2694 Acc: 0.8900
val Loss: 1.5822 Acc: 0.7955
Epoch 69/77
----------
train Loss: 1.2595 Acc: 0.8612
val Loss: 1.3607 Acc: 0.7500
Epoch 70/77
----------
train Loss: 1.3709 Acc: 0.8804
val Loss: 1.2125 Acc: 0.8409
Epoch 71/77
----------
train Loss: 1.4592 Acc: 0.8852
val Loss: 1.2910 Acc: 0.7500
Epoch 72/77
----------
train Loss: 1.4766 Acc: 0.8708
val Loss: 1.3395 Acc: 0.7727
Epoch 73/77
----------
train Loss: 1.0586 Acc: 0.9522
val Loss: 1.3907 Acc: 0.7727
Epoch 74/77
----------
train Loss: 1.4905 Acc: 0.7751
val Loss: 1.4682 Acc: 0.7955
Epoch 75/77
----------
train Loss: 1.2026 Acc: 0.9522
val Loss: 1.6870 Acc: 0.7273
Epoch 76/77
----------
train Loss: 1.1506 Acc: 0.8660
val Loss: 1.3470 Acc: 0.7045
Epoch 77/77
----------
train Loss: 1.4144 Acc: 0.8565
[32m[I 2025-06-29 16:48:42,239][0m Trial 182 finished with value: 0.7954545454545455 and parameters: {'batch_size': 11, 'lr': 0.0003060238418912766, 'num_epochs': 77, 'weight_decay': 0.03595839220470328, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.3671 Acc: 0.7045
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_11_lr_0.0003060238418912766_epoch_77_wd_0.03595839220470328_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/81
----------
train Loss: 3.7245 Acc: 0.2632
val Loss: 3.5294 Acc: 0.2955
Epoch 2/81
----------
train Loss: 3.4403 Acc: 0.3923
val Loss: 3.3009 Acc: 0.4773
Epoch 3/81
----------
train Loss: 3.1945 Acc: 0.4115
val Loss: 2.9901 Acc: 0.5682
Epoch 4/81
----------
train Loss: 3.0148 Acc: 0.4689
val Loss: 2.7670 Acc: 0.6364
Epoch 5/81
----------
train Loss: 2.8587 Acc: 0.4833
val Loss: 2.6017 Acc: 0.6364
Epoch 6/81
----------
train Loss: 2.6755 Acc: 0.5024
val Loss: 2.4070 Acc: 0.6364
Epoch 7/81
----------
train Loss: 2.5248 Acc: 0.5072
val Loss: 2.2518 Acc: 0.6364
Epoch 8/81
----------
train Loss: 2.4814 Acc: 0.5024
val Loss: 2.1306 Acc: 0.6591
Epoch 9/81
----------
train Loss: 2.4056 Acc: 0.5215
val Loss: 2.0514 Acc: 0.6591
Epoch 10/81
----------
train Loss: 2.1492 Acc: 0.5215
val Loss: 2.0034 Acc: 0.6818
Epoch 11/81
----------
train Loss: 2.2601 Acc: 0.5120
val Loss: 1.9488 Acc: 0.6818
Epoch 12/81
----------
train Loss: 2.2773 Acc: 0.5263
val Loss: 1.9439 Acc: 0.6818
Epoch 13/81
----------
train Loss: 2.0947 Acc: 0.5837
val Loss: 1.8801 Acc: 0.6818
Epoch 14/81
----------
train Loss: 2.0000 Acc: 0.6029
val Loss: 1.8663 Acc: 0.6818
Epoch 15/81
----------
train Loss: 2.1001 Acc: 0.5885
val Loss: 1.8471 Acc: 0.7273
Epoch 16/81
----------
train Loss: 2.0579 Acc: 0.6077
val Loss: 1.8181 Acc: 0.7045
Epoch 17/81
----------
train Loss: 1.9753 Acc: 0.6172
val Loss: 1.7794 Acc: 0.7045
Epoch 18/81
----------
train Loss: 1.8753 Acc: 0.6746
val Loss: 1.7049 Acc: 0.6818
Epoch 19/81
----------
train Loss: 1.8124 Acc: 0.7368
val Loss: 1.6732 Acc: 0.7500
Epoch 20/81
----------
train Loss: 1.8323 Acc: 0.7273
val Loss: 1.6252 Acc: 0.7500
Epoch 21/81
----------
train Loss: 1.8778 Acc: 0.7129
val Loss: 1.5720 Acc: 0.7727
Epoch 22/81
----------
train Loss: 1.7873 Acc: 0.7368
val Loss: 1.5313 Acc: 0.7955
Epoch 23/81
----------
train Loss: 1.7856 Acc: 0.7656
val Loss: 1.4765 Acc: 0.7955
Epoch 24/81
----------
train Loss: 1.5133 Acc: 0.8325
val Loss: 1.4102 Acc: 0.8182
Epoch 25/81
----------
train Loss: 1.6413 Acc: 0.8134
val Loss: 1.4317 Acc: 0.8182
Epoch 26/81
----------
train Loss: 1.6861 Acc: 0.8230
val Loss: 1.4435 Acc: 0.8182
Epoch 27/81
----------
train Loss: 1.4195 Acc: 0.9091
val Loss: 1.4463 Acc: 0.8409
Epoch 28/81
----------
train Loss: 1.6535 Acc: 0.8038
val Loss: 1.4331 Acc: 0.8409
Epoch 29/81
----------
train Loss: 1.7258 Acc: 0.7273
val Loss: 1.4235 Acc: 0.8409
Epoch 30/81
----------
train Loss: 1.5314 Acc: 0.8278
val Loss: 1.4266 Acc: 0.8182
Epoch 31/81
----------
train Loss: 1.3415 Acc: 0.8947
val Loss: 1.3868 Acc: 0.8409
Epoch 32/81
----------
train Loss: 1.5118 Acc: 0.7990
val Loss: 1.3477 Acc: 0.8182
Epoch 33/81
----------
train Loss: 1.5450 Acc: 0.8230
val Loss: 1.3559 Acc: 0.8182
Epoch 34/81
----------
train Loss: 1.4517 Acc: 0.8708
val Loss: 1.3860 Acc: 0.8182
Epoch 35/81
----------
train Loss: 1.1445 Acc: 0.9665
val Loss: 1.4092 Acc: 0.7955
Epoch 36/81
----------
train Loss: 1.6622 Acc: 0.7751
val Loss: 1.4057 Acc: 0.7955
Epoch 37/81
----------
train Loss: 1.3592 Acc: 0.8182
val Loss: 1.4048 Acc: 0.7955
Epoch 38/81
----------
train Loss: 1.3882 Acc: 0.9474
val Loss: 1.3561 Acc: 0.7955
Epoch 39/81
----------
train Loss: 1.5369 Acc: 0.7321
val Loss: 1.4181 Acc: 0.8182
Epoch 40/81
----------
train Loss: 1.2534 Acc: 0.8804
val Loss: 1.4267 Acc: 0.7955
Epoch 41/81
----------
train Loss: 1.7173 Acc: 0.7225
val Loss: 1.3978 Acc: 0.7955
Epoch 42/81
----------
train Loss: 1.2412 Acc: 0.8421
val Loss: 1.3866 Acc: 0.7955
Epoch 43/81
----------
train Loss: 1.3835 Acc: 0.8517
val Loss: 1.3846 Acc: 0.7727
Epoch 44/81
----------
train Loss: 1.2757 Acc: 0.8660
val Loss: 1.3909 Acc: 0.7727
Epoch 45/81
----------
train Loss: 0.8358 Acc: 0.9713
val Loss: 1.3748 Acc: 0.7727
Epoch 46/81
----------
train Loss: 1.7116 Acc: 0.7895
val Loss: 1.3958 Acc: 0.7727
Epoch 47/81
----------
train Loss: 1.2736 Acc: 0.8900
val Loss: 1.3869 Acc: 0.7955
Epoch 48/81
----------
train Loss: 1.3753 Acc: 0.8469
val Loss: 1.3660 Acc: 0.8182
Epoch 49/81
----------
train Loss: 1.3159 Acc: 0.9330
val Loss: 1.3621 Acc: 0.7727
Epoch 50/81
----------
train Loss: 1.3060 Acc: 0.8852
val Loss: 1.4195 Acc: 0.7727
Epoch 51/81
----------
train Loss: 0.9740 Acc: 0.9761
val Loss: 1.3368 Acc: 0.7727
Epoch 52/81
----------
train Loss: 1.3935 Acc: 0.8325
val Loss: 1.3016 Acc: 0.7955
Epoch 53/81
----------
train Loss: 1.5715 Acc: 0.9043
val Loss: 1.2961 Acc: 0.8409
Epoch 54/81
----------
train Loss: 1.1820 Acc: 0.9234
val Loss: 1.3273 Acc: 0.8182
Epoch 55/81
----------
train Loss: 1.2304 Acc: 0.9187
val Loss: 1.3668 Acc: 0.8182
Epoch 56/81
----------
train Loss: 1.4267 Acc: 0.8900
val Loss: 1.3773 Acc: 0.7500
Epoch 57/81
----------
train Loss: 1.6196 Acc: 0.7751
val Loss: 1.3448 Acc: 0.7955
Epoch 58/81
----------
train Loss: 1.3390 Acc: 0.7990
val Loss: 1.3152 Acc: 0.7955
Epoch 59/81
----------
train Loss: 1.3629 Acc: 0.8804
val Loss: 1.3206 Acc: 0.8182
Epoch 60/81
----------
train Loss: 1.1176 Acc: 0.8900
val Loss: 1.3265 Acc: 0.8182
Epoch 61/81
----------
train Loss: 1.5680 Acc: 0.7464
val Loss: 1.3336 Acc: 0.7727
Epoch 62/81
----------
train Loss: 1.4162 Acc: 0.9569
val Loss: 1.3184 Acc: 0.7500
Epoch 63/81
----------
train Loss: 1.2346 Acc: 0.9378
val Loss: 1.3129 Acc: 0.7955
Epoch 64/81
----------
train Loss: 1.1414 Acc: 0.9569
val Loss: 1.2843 Acc: 0.8182
Epoch 65/81
----------
train Loss: 1.3116 Acc: 0.8373
val Loss: 1.3225 Acc: 0.8409
Epoch 66/81
----------
train Loss: 1.2762 Acc: 0.8756
val Loss: 1.3375 Acc: 0.8182
Epoch 67/81
----------
train Loss: 1.4479 Acc: 0.8612
val Loss: 1.3172 Acc: 0.8182
Epoch 68/81
----------
train Loss: 1.1825 Acc: 0.8900
val Loss: 1.3125 Acc: 0.7727
Epoch 69/81
----------
train Loss: 1.1626 Acc: 0.8852
val Loss: 1.2796 Acc: 0.7955
Epoch 70/81
----------
train Loss: 1.3476 Acc: 0.8900
val Loss: 1.2829 Acc: 0.7955
Epoch 71/81
----------
train Loss: 1.4404 Acc: 0.9282
val Loss: 1.3574 Acc: 0.7955
Epoch 72/81
----------
train Loss: 1.4134 Acc: 0.8852
val Loss: 1.4083 Acc: 0.7955
Epoch 73/81
----------
train Loss: 1.0189 Acc: 0.9665
val Loss: 1.3709 Acc: 0.7955
Epoch 74/81
----------
train Loss: 1.4610 Acc: 0.8565
val Loss: 1.3006 Acc: 0.7955
Epoch 75/81
----------
train Loss: 1.1063 Acc: 0.9522
val Loss: 1.2599 Acc: 0.7955
Epoch 76/81
----------
train Loss: 1.1815 Acc: 0.8278
val Loss: 1.2610 Acc: 0.8182
Epoch 77/81
----------
train Loss: 1.3552 Acc: 0.8612
val Loss: 1.3010 Acc: 0.8182
Epoch 78/81
----------
train Loss: 1.2081 Acc: 0.8947
val Loss: 1.3506 Acc: 0.8182
Epoch 79/81
----------
train Loss: 1.4437 Acc: 0.8517
val Loss: 1.3380 Acc: 0.8409
Epoch 80/81
----------
train Loss: 1.3067 Acc: 0.8565
val Loss: 1.3597 Acc: 0.7955
Epoch 81/81
----------
train Loss: 1.4963 Acc: 0.7895
[32m[I 2025-06-29 17:07:06,858][0m Trial 183 finished with value: 0.7954545454545455 and parameters: {'batch_size': 94, 'lr': 0.00010147615275939906, 'num_epochs': 81, 'weight_decay': 0.018854991574077287, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4211 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_94_lr_0.00010147615275939906_epoch_81_wd_0.018854991574077287_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/41
----------
train Loss: 3.3727 Acc: 0.3684
val Loss: 2.8812 Acc: 0.6136
Epoch 2/41
----------
train Loss: 2.5749 Acc: 0.5455
val Loss: 1.9891 Acc: 0.6364
Epoch 3/41
----------
train Loss: 2.2500 Acc: 0.5167
val Loss: 1.8339 Acc: 0.6364
Epoch 4/41
----------
train Loss: 2.1460 Acc: 0.5407
val Loss: 1.7610 Acc: 0.7500
Epoch 5/41
----------
train Loss: 2.0663 Acc: 0.6507
val Loss: 1.6419 Acc: 0.8182
Epoch 6/41
----------
train Loss: 1.8767 Acc: 0.6699
val Loss: 1.5059 Acc: 0.8182
Epoch 7/41
----------
train Loss: 1.6658 Acc: 0.7990
val Loss: 1.3959 Acc: 0.8409
Epoch 8/41
----------
train Loss: 1.7495 Acc: 0.7560
val Loss: 1.3980 Acc: 0.7955
Epoch 9/41
----------
train Loss: 1.7188 Acc: 0.7464
val Loss: 1.5810 Acc: 0.8182
Epoch 10/41
----------
train Loss: 1.0738 Acc: 0.9474
val Loss: 1.2830 Acc: 0.7955
Epoch 11/41
----------
train Loss: 1.7367 Acc: 0.7895
val Loss: 1.2309 Acc: 0.8409
Epoch 12/41
----------
train Loss: 1.5078 Acc: 0.7656
val Loss: 1.7681 Acc: 0.7500
Epoch 13/41
----------
train Loss: 1.3441 Acc: 0.9091
val Loss: 1.5267 Acc: 0.7727
Epoch 14/41
----------
train Loss: 1.2354 Acc: 0.8325
val Loss: 1.3907 Acc: 0.7500
Epoch 15/41
----------
train Loss: 1.3809 Acc: 0.8278
val Loss: 1.1266 Acc: 0.7955
Epoch 16/41
----------
train Loss: 1.4491 Acc: 0.8038
val Loss: 1.3068 Acc: 0.8409
Epoch 17/41
----------
train Loss: 1.4060 Acc: 0.8660
val Loss: 1.4047 Acc: 0.8182
Epoch 18/41
----------
train Loss: 1.3354 Acc: 0.8230
val Loss: 1.3659 Acc: 0.7955
Epoch 19/41
----------
train Loss: 1.2204 Acc: 0.9330
val Loss: 1.2708 Acc: 0.7727
Epoch 20/41
----------
train Loss: 1.3270 Acc: 0.8804
val Loss: 1.2243 Acc: 0.7727
Epoch 21/41
----------
train Loss: 1.4307 Acc: 0.8804
val Loss: 1.1403 Acc: 0.8182
Epoch 22/41
----------
train Loss: 1.2546 Acc: 0.8852
val Loss: 1.2426 Acc: 0.7955
Epoch 23/41
----------
train Loss: 1.4829 Acc: 0.8900
val Loss: 1.3127 Acc: 0.7500
Epoch 24/41
----------
train Loss: 1.1070 Acc: 0.9234
val Loss: 1.1295 Acc: 0.8182
Epoch 25/41
----------
train Loss: 1.2439 Acc: 0.9378
val Loss: 1.2146 Acc: 0.8409
Epoch 26/41
----------
train Loss: 1.4697 Acc: 0.9378
val Loss: 1.1475 Acc: 0.8636
Epoch 27/41
----------
train Loss: 1.1780 Acc: 0.9665
val Loss: 1.3099 Acc: 0.8409
Epoch 28/41
----------
train Loss: 1.3916 Acc: 0.8517
val Loss: 1.1647 Acc: 0.8182
Epoch 29/41
----------
train Loss: 1.4572 Acc: 0.7943
val Loss: 1.1336 Acc: 0.8864
Epoch 30/41
----------
train Loss: 1.2841 Acc: 0.8708
val Loss: 1.0036 Acc: 0.8636
Epoch 31/41
----------
train Loss: 1.1344 Acc: 0.9522
val Loss: 1.1779 Acc: 0.8182
Epoch 32/41
----------
train Loss: 1.2124 Acc: 0.8995
val Loss: 1.2401 Acc: 0.7500
Epoch 33/41
----------
train Loss: 1.3962 Acc: 0.8804
val Loss: 1.3454 Acc: 0.8182
Epoch 34/41
----------
train Loss: 1.3459 Acc: 0.9234
val Loss: 1.4486 Acc: 0.7273
Epoch 35/41
----------
train Loss: 1.0338 Acc: 0.9617
val Loss: 1.4043 Acc: 0.7727
Epoch 36/41
----------
train Loss: 1.5804 Acc: 0.8565
val Loss: 1.3414 Acc: 0.7727
Epoch 37/41
----------
train Loss: 1.3464 Acc: 0.8325
val Loss: 1.3714 Acc: 0.7955
Epoch 38/41
----------
train Loss: 1.3705 Acc: 0.9426
val Loss: 1.2482 Acc: 0.7955
Epoch 39/41
----------
train Loss: 1.3929 Acc: 0.7799
val Loss: 1.4130 Acc: 0.7273
Epoch 40/41
----------
train Loss: 1.1744 Acc: 0.9282
val Loss: 1.2851 Acc: 0.7273
Epoch 41/41
----------
train Loss: 1.6013 Acc: 0.6842
[32m[I 2025-06-29 17:16:27,922][0m Trial 184 finished with value: 0.7954545454545455 and parameters: {'batch_size': 86, 'lr': 0.0004550957974292667, 'num_epochs': 41, 'weight_decay': 0.011478388249681023, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5038 Acc: 0.6818
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_86_lr_0.0004550957974292667_epoch_41_wd_0.011478388249681023_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/93
----------
train Loss: 3.2325 Acc: 0.3876
val Loss: 2.4476 Acc: 0.6364
Epoch 2/93
----------
train Loss: 2.4156 Acc: 0.5502
val Loss: 1.9349 Acc: 0.6364
Epoch 3/93
----------
train Loss: 2.1572 Acc: 0.5550
val Loss: 1.7881 Acc: 0.7045
Epoch 4/93
----------
train Loss: 2.0437 Acc: 0.5837
val Loss: 1.8365 Acc: 0.7500
Epoch 5/93
----------
train Loss: 1.9298 Acc: 0.7464
val Loss: 1.5587 Acc: 0.7955
Epoch 6/93
----------
train Loss: 1.7811 Acc: 0.7225
val Loss: 1.3679 Acc: 0.7955
Epoch 7/93
----------
train Loss: 1.4862 Acc: 0.8804
val Loss: 1.3214 Acc: 0.7500
Epoch 8/93
----------
train Loss: 1.6721 Acc: 0.7847
val Loss: 1.3793 Acc: 0.7500
Epoch 9/93
----------
train Loss: 1.6707 Acc: 0.8038
val Loss: 1.5758 Acc: 0.8182
Epoch 10/93
----------
train Loss: 1.0382 Acc: 0.9330
val Loss: 1.0341 Acc: 0.8409
Epoch 11/93
----------
train Loss: 1.7361 Acc: 0.8038
val Loss: 1.4670 Acc: 0.7727
Epoch 12/93
----------
train Loss: 1.4922 Acc: 0.7560
val Loss: 2.0238 Acc: 0.6591
Epoch 13/93
----------
train Loss: 1.3725 Acc: 0.8947
val Loss: 1.5671 Acc: 0.8409
Epoch 14/93
----------
train Loss: 1.2652 Acc: 0.8325
val Loss: 1.5474 Acc: 0.7727
Epoch 15/93
----------
train Loss: 1.4507 Acc: 0.8325
val Loss: 1.4015 Acc: 0.7727
Epoch 16/93
----------
train Loss: 1.4630 Acc: 0.7895
val Loss: 1.7072 Acc: 0.8182
Epoch 17/93
----------
train Loss: 1.3843 Acc: 0.8421
val Loss: 1.6497 Acc: 0.7955
Epoch 18/93
----------
train Loss: 1.3368 Acc: 0.8469
val Loss: 1.3014 Acc: 0.7500
Epoch 19/93
----------
train Loss: 1.2118 Acc: 0.9187
val Loss: 1.2308 Acc: 0.7955
Epoch 20/93
----------
train Loss: 1.3059 Acc: 0.8756
val Loss: 1.3060 Acc: 0.7955
Epoch 21/93
----------
train Loss: 1.4486 Acc: 0.8660
val Loss: 1.2067 Acc: 0.8409
Epoch 22/93
----------
train Loss: 1.3052 Acc: 0.8804
val Loss: 1.4305 Acc: 0.7273
Epoch 23/93
----------
train Loss: 1.5602 Acc: 0.8708
val Loss: 1.2461 Acc: 0.7955
Epoch 24/93
----------
train Loss: 1.1284 Acc: 0.9234
val Loss: 1.1711 Acc: 0.7955
Epoch 25/93
----------
train Loss: 1.2423 Acc: 0.9330
val Loss: 1.4526 Acc: 0.7727
Epoch 26/93
----------
train Loss: 1.4462 Acc: 0.9378
val Loss: 1.3277 Acc: 0.7727
Epoch 27/93
----------
train Loss: 1.1897 Acc: 0.9713
val Loss: 1.7165 Acc: 0.6818
Epoch 28/93
----------
train Loss: 1.3965 Acc: 0.8517
val Loss: 1.3589 Acc: 0.7500
Epoch 29/93
----------
train Loss: 1.4758 Acc: 0.7703
val Loss: 1.4178 Acc: 0.7500
Epoch 30/93
----------
train Loss: 1.3055 Acc: 0.8708
val Loss: 1.1108 Acc: 0.7955
Epoch 31/93
----------
train Loss: 1.1233 Acc: 0.9139
val Loss: 1.3658 Acc: 0.8182
Epoch 32/93
----------
train Loss: 1.2692 Acc: 0.9139
val Loss: 1.3973 Acc: 0.7500
Epoch 33/93
----------
train Loss: 1.3828 Acc: 0.8612
val Loss: 1.5662 Acc: 0.7273
Epoch 34/93
----------
train Loss: 1.3227 Acc: 0.9426
val Loss: 1.4876 Acc: 0.7273
Epoch 35/93
----------
train Loss: 1.0388 Acc: 0.9713
val Loss: 1.3053 Acc: 0.7955
Epoch 36/93
----------
train Loss: 1.5329 Acc: 0.8421
val Loss: 1.2561 Acc: 0.8182
Epoch 37/93
----------
train Loss: 1.3164 Acc: 0.8373
val Loss: 1.5356 Acc: 0.7727
Epoch 38/93
----------
train Loss: 1.4170 Acc: 0.9378
val Loss: 1.5802 Acc: 0.7500
Epoch 39/93
----------
train Loss: 1.4361 Acc: 0.7751
val Loss: 1.6901 Acc: 0.7727
Epoch 40/93
----------
train Loss: 1.1875 Acc: 0.9378
val Loss: 1.5881 Acc: 0.7727
Epoch 41/93
----------
train Loss: 1.6024 Acc: 0.7273
val Loss: 1.3567 Acc: 0.7273
Epoch 42/93
----------
train Loss: 1.1855 Acc: 0.8660
val Loss: 1.4621 Acc: 0.7500
Epoch 43/93
----------
train Loss: 1.3111 Acc: 0.8804
val Loss: 1.5646 Acc: 0.8182
Epoch 44/93
----------
train Loss: 1.2008 Acc: 0.8756
val Loss: 1.7494 Acc: 0.7273
Epoch 45/93
----------
train Loss: 0.8056 Acc: 0.9665
val Loss: 1.4044 Acc: 0.7273
Epoch 46/93
----------
train Loss: 1.6479 Acc: 0.8325
val Loss: 1.7941 Acc: 0.7045
Epoch 47/93
----------
train Loss: 1.2711 Acc: 0.8852
val Loss: 1.8312 Acc: 0.7500
Epoch 48/93
----------
train Loss: 1.3064 Acc: 0.8852
[32m[I 2025-06-29 17:27:22,234][0m Trial 185 finished with value: 0.8181818181818182 and parameters: {'batch_size': 89, 'lr': 0.000621809679272768, 'num_epochs': 93, 'weight_decay': 0.008567355104258148, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5377 Acc: 0.7500
Early stopping at epoch 48 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_89_lr_0.000621809679272768_epoch_93_wd_0.008567355104258148_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/84
----------
train Loss: 3.4525 Acc: 0.3445
val Loss: 3.0748 Acc: 0.5909
Epoch 2/84
----------
train Loss: 2.7233 Acc: 0.5263
val Loss: 2.1717 Acc: 0.6364
Epoch 3/84
----------
train Loss: 2.3404 Acc: 0.5072
val Loss: 1.8950 Acc: 0.6364
Epoch 4/84
----------
train Loss: 2.2178 Acc: 0.5072
val Loss: 1.8147 Acc: 0.6818
Epoch 5/84
----------
train Loss: 2.1482 Acc: 0.6124
val Loss: 1.7277 Acc: 0.7500
Epoch 6/84
----------
train Loss: 1.9664 Acc: 0.6411
val Loss: 1.6420 Acc: 0.7727
Epoch 7/84
----------
train Loss: 1.8080 Acc: 0.7129
val Loss: 1.5680 Acc: 0.7955
Epoch 8/84
----------
train Loss: 1.8753 Acc: 0.7081
val Loss: 1.3774 Acc: 0.7955
Epoch 9/84
----------
train Loss: 1.8288 Acc: 0.7464
val Loss: 1.5214 Acc: 0.7727
Epoch 10/84
----------
train Loss: 1.2206 Acc: 0.9282
val Loss: 1.3522 Acc: 0.7955
Epoch 11/84
----------
train Loss: 1.6806 Acc: 0.7751
val Loss: 1.1841 Acc: 0.8864
Epoch 12/84
----------
train Loss: 1.5324 Acc: 0.7273
val Loss: 1.4421 Acc: 0.8409
Epoch 13/84
----------
train Loss: 1.3478 Acc: 0.9043
val Loss: 1.4170 Acc: 0.7955
Epoch 14/84
----------
train Loss: 1.2669 Acc: 0.8278
val Loss: 1.4023 Acc: 0.7273
Epoch 15/84
----------
train Loss: 1.4152 Acc: 0.8038
val Loss: 1.1777 Acc: 0.7727
Epoch 16/84
----------
train Loss: 1.4921 Acc: 0.7990
val Loss: 1.3519 Acc: 0.8182
Epoch 17/84
----------
train Loss: 1.4300 Acc: 0.8660
val Loss: 1.4278 Acc: 0.8636
Epoch 18/84
----------
train Loss: 1.3250 Acc: 0.8278
val Loss: 1.3057 Acc: 0.8182
Epoch 19/84
----------
train Loss: 1.2176 Acc: 0.9569
val Loss: 1.2630 Acc: 0.7955
Epoch 20/84
----------
train Loss: 1.3298 Acc: 0.8660
val Loss: 1.2466 Acc: 0.7727
Epoch 21/84
----------
train Loss: 1.4411 Acc: 0.8947
val Loss: 1.1525 Acc: 0.7727
Epoch 22/84
----------
train Loss: 1.2552 Acc: 0.8756
val Loss: 1.1670 Acc: 0.8409
Epoch 23/84
----------
train Loss: 1.4697 Acc: 0.8804
val Loss: 1.2470 Acc: 0.8636
Epoch 24/84
----------
train Loss: 1.0677 Acc: 0.9187
val Loss: 1.1623 Acc: 0.7955
Epoch 25/84
----------
train Loss: 1.2458 Acc: 0.9522
val Loss: 1.3521 Acc: 0.7727
Epoch 26/84
----------
train Loss: 1.4605 Acc: 0.9474
val Loss: 1.2674 Acc: 0.7727
Epoch 27/84
----------
train Loss: 1.1702 Acc: 0.9761
val Loss: 1.3536 Acc: 0.7727
Epoch 28/84
----------
train Loss: 1.3457 Acc: 0.8612
[32m[I 2025-06-29 17:33:45,436][0m Trial 186 finished with value: 0.8636363636363636 and parameters: {'batch_size': 30, 'lr': 0.0003705039288236878, 'num_epochs': 84, 'weight_decay': 0.013977006063616628, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2074 Acc: 0.7500
Early stopping at epoch 28 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_30_lr_0.0003705039288236878_epoch_84_wd_0.013977006063616628_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/88
----------
train Loss: 3.2894 Acc: 0.3780
val Loss: 2.7038 Acc: 0.6364
Epoch 2/88
----------
train Loss: 2.4730 Acc: 0.5455
val Loss: 1.9421 Acc: 0.6364
Epoch 3/88
----------
train Loss: 2.2063 Acc: 0.5263
val Loss: 1.8989 Acc: 0.7045
Epoch 4/88
----------
train Loss: 2.1073 Acc: 0.5742
val Loss: 2.0168 Acc: 0.7500
Epoch 5/88
----------
train Loss: 2.0098 Acc: 0.6794
val Loss: 1.8274 Acc: 0.7955
Epoch 6/88
----------
train Loss: 1.8366 Acc: 0.7033
val Loss: 1.5620 Acc: 0.7955
Epoch 7/88
----------
train Loss: 1.5550 Acc: 0.8421
val Loss: 1.3919 Acc: 0.7955
Epoch 8/88
----------
train Loss: 1.6986 Acc: 0.7464
val Loss: 1.4691 Acc: 0.8409
Epoch 9/88
----------
train Loss: 1.7069 Acc: 0.7464
val Loss: 1.5992 Acc: 0.7727
Epoch 10/88
----------
train Loss: 1.0383 Acc: 0.9426
val Loss: 1.1543 Acc: 0.8409
Epoch 11/88
----------
train Loss: 1.7676 Acc: 0.7799
val Loss: 1.4047 Acc: 0.8182
Epoch 12/88
----------
train Loss: 1.5100 Acc: 0.7608
val Loss: 2.3055 Acc: 0.6818
Epoch 13/88
----------
train Loss: 1.3756 Acc: 0.8900
val Loss: 1.6935 Acc: 0.7727
Epoch 14/88
----------
train Loss: 1.2662 Acc: 0.8325
val Loss: 1.5179 Acc: 0.7727
Epoch 15/88
----------
train Loss: 1.4277 Acc: 0.8278
val Loss: 1.2989 Acc: 0.7727
Epoch 16/88
----------
train Loss: 1.4431 Acc: 0.7990
val Loss: 1.5152 Acc: 0.8409
Epoch 17/88
----------
train Loss: 1.3939 Acc: 0.8230
val Loss: 1.5894 Acc: 0.7955
Epoch 18/88
----------
train Loss: 1.3627 Acc: 0.8038
val Loss: 1.4009 Acc: 0.7955
Epoch 19/88
----------
train Loss: 1.2879 Acc: 0.8995
val Loss: 1.2642 Acc: 0.8182
Epoch 20/88
----------
train Loss: 1.3646 Acc: 0.8565
val Loss: 1.2752 Acc: 0.7727
Epoch 21/88
----------
train Loss: 1.4677 Acc: 0.8852
val Loss: 1.2357 Acc: 0.8182
Epoch 22/88
----------
train Loss: 1.3160 Acc: 0.8565
val Loss: 1.4837 Acc: 0.7727
Epoch 23/88
----------
train Loss: 1.5369 Acc: 0.8517
val Loss: 1.4326 Acc: 0.7727
Epoch 24/88
----------
train Loss: 1.1682 Acc: 0.9187
val Loss: 1.5497 Acc: 0.7500
Epoch 25/88
----------
train Loss: 1.2946 Acc: 0.9282
val Loss: 1.7576 Acc: 0.7273
Epoch 26/88
----------
train Loss: 1.4481 Acc: 0.9234
val Loss: 1.3917 Acc: 0.7955
Epoch 27/88
----------
train Loss: 1.2453 Acc: 0.9474
val Loss: 1.7702 Acc: 0.7045
Epoch 28/88
----------
train Loss: 1.4573 Acc: 0.8134
val Loss: 1.3755 Acc: 0.7955
Epoch 29/88
----------
train Loss: 1.4741 Acc: 0.7847
val Loss: 1.2812 Acc: 0.7955
Epoch 30/88
----------
train Loss: 1.3310 Acc: 0.8469
val Loss: 1.2305 Acc: 0.7500
Epoch 31/88
----------
train Loss: 1.1596 Acc: 0.9282
val Loss: 1.4109 Acc: 0.7273
Epoch 32/88
----------
train Loss: 1.3037 Acc: 0.9043
val Loss: 1.4289 Acc: 0.7500
Epoch 33/88
----------
train Loss: 1.4079 Acc: 0.8708
val Loss: 1.5237 Acc: 0.7045
Epoch 34/88
----------
train Loss: 1.3833 Acc: 0.9282
val Loss: 1.5515 Acc: 0.7500
Epoch 35/88
----------
train Loss: 1.0647 Acc: 0.9617
val Loss: 1.3183 Acc: 0.7955
Epoch 36/88
----------
train Loss: 1.6103 Acc: 0.8565
val Loss: 1.3426 Acc: 0.7500
Epoch 37/88
----------
train Loss: 1.3423 Acc: 0.8325
val Loss: 1.8828 Acc: 0.6818
Epoch 38/88
----------
train Loss: 1.4717 Acc: 0.9139
val Loss: 1.2969 Acc: 0.8182
Epoch 39/88
----------
train Loss: 1.4194 Acc: 0.7799
val Loss: 1.5729 Acc: 0.6818
Epoch 40/88
----------
train Loss: 1.2506 Acc: 0.9043
val Loss: 1.4056 Acc: 0.7955
Epoch 41/88
----------
train Loss: 1.6556 Acc: 0.6986
val Loss: 1.4762 Acc: 0.6818
Epoch 42/88
----------
train Loss: 1.2577 Acc: 0.8612
val Loss: 1.5424 Acc: 0.6818
Epoch 43/88
----------
train Loss: 1.3598 Acc: 0.8804
val Loss: 1.3297 Acc: 0.7500
Epoch 44/88
----------
train Loss: 1.2948 Acc: 0.8660
val Loss: 1.6624 Acc: 0.7500
Epoch 45/88
----------
train Loss: 0.8216 Acc: 0.9569
val Loss: 1.5150 Acc: 0.7955
Epoch 46/88
----------
train Loss: 1.7006 Acc: 0.8230
val Loss: 1.7880 Acc: 0.6818
Epoch 47/88
----------
train Loss: 1.3904 Acc: 0.8804
val Loss: 1.6161 Acc: 0.7500
Epoch 48/88
----------
train Loss: 1.3844 Acc: 0.8565
val Loss: 1.5099 Acc: 0.7500
Epoch 49/88
----------
train Loss: 1.3387 Acc: 0.9091
val Loss: 1.4960 Acc: 0.7500
Epoch 50/88
----------
train Loss: 1.2964 Acc: 0.8517
val Loss: 1.5389 Acc: 0.7727
Epoch 51/88
----------
train Loss: 1.0107 Acc: 0.9809
val Loss: 1.5833 Acc: 0.6818
Epoch 52/88
----------
train Loss: 1.3467 Acc: 0.8230
val Loss: 1.2940 Acc: 0.7500
Epoch 53/88
----------
train Loss: 1.4725 Acc: 0.9378
val Loss: 1.6610 Acc: 0.6818
Epoch 54/88
----------
train Loss: 1.2221 Acc: 0.9139
val Loss: 1.5349 Acc: 0.7500
Epoch 55/88
----------
train Loss: 1.2356 Acc: 0.9474
val Loss: 1.4966 Acc: 0.7500
Epoch 56/88
----------
train Loss: 1.3664 Acc: 0.9139
val Loss: 1.4686 Acc: 0.7500
Epoch 57/88
----------
train Loss: 1.5645 Acc: 0.8421
val Loss: 1.6483 Acc: 0.7500
Epoch 58/88
----------
train Loss: 1.2900 Acc: 0.8230
val Loss: 1.6370 Acc: 0.7045
Epoch 59/88
----------
train Loss: 1.3800 Acc: 0.8900
val Loss: 1.7257 Acc: 0.6364
Epoch 60/88
----------
train Loss: 1.1304 Acc: 0.8852
val Loss: 1.5287 Acc: 0.7045
Epoch 61/88
----------
train Loss: 1.5109 Acc: 0.7895
val Loss: 1.8718 Acc: 0.7045
Epoch 62/88
----------
train Loss: 1.5062 Acc: 0.8947
val Loss: 1.6286 Acc: 0.6591
Epoch 63/88
----------
train Loss: 1.3324 Acc: 0.9091
val Loss: 1.8481 Acc: 0.6818
Epoch 64/88
----------
train Loss: 1.1325 Acc: 0.9665
val Loss: 1.3817 Acc: 0.6818
Epoch 65/88
----------
train Loss: 1.3731 Acc: 0.8660
val Loss: 1.4763 Acc: 0.7500
Epoch 66/88
----------
train Loss: 1.3439 Acc: 0.8852
val Loss: 1.5591 Acc: 0.7955
Epoch 67/88
----------
train Loss: 1.4885 Acc: 0.8469
val Loss: 1.9187 Acc: 0.5682
Epoch 68/88
----------
train Loss: 1.2062 Acc: 0.8565
val Loss: 1.5374 Acc: 0.7045
Epoch 69/88
----------
train Loss: 1.2131 Acc: 0.8852
val Loss: 1.5234 Acc: 0.7273
Epoch 70/88
----------
train Loss: 1.4130 Acc: 0.8900
val Loss: 1.5604 Acc: 0.7500
Epoch 71/88
----------
train Loss: 1.4376 Acc: 0.8612
val Loss: 2.0575 Acc: 0.6364
Epoch 72/88
----------
train Loss: 1.5046 Acc: 0.8660
val Loss: 1.7322 Acc: 0.6364
Epoch 73/88
----------
train Loss: 1.0218 Acc: 0.9474
val Loss: 1.4366 Acc: 0.7500
Epoch 74/88
----------
train Loss: 1.4525 Acc: 0.8325
val Loss: 1.4641 Acc: 0.7955
Epoch 75/88
----------
train Loss: 1.1442 Acc: 0.9569
val Loss: 1.6964 Acc: 0.7955
Epoch 76/88
----------
train Loss: 1.1619 Acc: 0.8278
val Loss: 1.4029 Acc: 0.6591
Epoch 77/88
----------
train Loss: 1.4361 Acc: 0.8565
val Loss: 1.4917 Acc: 0.6818
Epoch 78/88
----------
train Loss: 1.3413 Acc: 0.9187
val Loss: 2.0442 Acc: 0.6818
Epoch 79/88
----------
train Loss: 1.4609 Acc: 0.8230
val Loss: 1.4012 Acc: 0.8182
Epoch 80/88
----------
train Loss: 1.3564 Acc: 0.8469
val Loss: 1.8941 Acc: 0.6364
Epoch 81/88
----------
train Loss: 1.5068 Acc: 0.7799
val Loss: 1.5564 Acc: 0.7045
Epoch 82/88
----------
train Loss: 1.2756 Acc: 0.8708
val Loss: 1.6766 Acc: 0.7727
Epoch 83/88
----------
train Loss: 1.1570 Acc: 0.9569
val Loss: 1.4874 Acc: 0.7727
Epoch 84/88
----------
train Loss: 1.5001 Acc: 0.7703
val Loss: 1.6700 Acc: 0.6818
Epoch 85/88
----------
train Loss: 1.1666 Acc: 0.8804
val Loss: 1.5679 Acc: 0.7955
Epoch 86/88
----------
train Loss: 1.2143 Acc: 0.8852
val Loss: 1.4909 Acc: 0.7727
Epoch 87/88
----------
train Loss: 1.3700 Acc: 0.9139
val Loss: 1.8084 Acc: 0.6591
Epoch 88/88
----------
train Loss: 1.4925 Acc: 0.8708
[32m[I 2025-06-29 17:53:44,732][0m Trial 187 finished with value: 0.7727272727272727 and parameters: {'batch_size': 81, 'lr': 0.0005723996961846345, 'num_epochs': 88, 'weight_decay': 0.014479022758901512, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.6813 Acc: 0.7045
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_81_lr_0.0005723996961846345_epoch_88_wd_0.014479022758901512_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/95
----------
train Loss: 3.3254 Acc: 0.3732
val Loss: 2.6195 Acc: 0.6364
Epoch 2/95
----------
train Loss: 2.4925 Acc: 0.5359
val Loss: 1.9692 Acc: 0.6364
Epoch 3/95
----------
train Loss: 2.1932 Acc: 0.5311
val Loss: 1.7759 Acc: 0.6591
Epoch 4/95
----------
train Loss: 2.0864 Acc: 0.5646
val Loss: 1.5831 Acc: 0.7727
Epoch 5/95
----------
train Loss: 1.9923 Acc: 0.7033
val Loss: 1.4321 Acc: 0.8182
Epoch 6/95
----------
train Loss: 1.8102 Acc: 0.6986
val Loss: 1.3091 Acc: 0.8409
Epoch 7/95
----------
train Loss: 1.5525 Acc: 0.8325
val Loss: 1.2423 Acc: 0.7955
Epoch 8/95
----------
train Loss: 1.7187 Acc: 0.7656
val Loss: 1.2669 Acc: 0.7955
Epoch 9/95
----------
train Loss: 1.6891 Acc: 0.7847
val Loss: 1.3718 Acc: 0.7727
Epoch 10/95
----------
train Loss: 1.0252 Acc: 0.9569
val Loss: 1.2491 Acc: 0.7727
Epoch 11/95
----------
train Loss: 1.7263 Acc: 0.7799
val Loss: 1.1967 Acc: 0.8409
Epoch 12/95
----------
train Loss: 1.4403 Acc: 0.7895
val Loss: 1.4817 Acc: 0.7500
Epoch 13/95
----------
train Loss: 1.3269 Acc: 0.8995
val Loss: 1.3485 Acc: 0.7955
Epoch 14/95
----------
train Loss: 1.2182 Acc: 0.8421
val Loss: 1.2505 Acc: 0.7955
Epoch 15/95
----------
train Loss: 1.3795 Acc: 0.8230
val Loss: 1.1023 Acc: 0.8409
Epoch 16/95
----------
train Loss: 1.3750 Acc: 0.8038
val Loss: 1.2129 Acc: 0.8409
Epoch 17/95
----------
train Loss: 1.3641 Acc: 0.8708
val Loss: 1.2533 Acc: 0.7955
Epoch 18/95
----------
train Loss: 1.2974 Acc: 0.8612
val Loss: 1.1793 Acc: 0.8182
Epoch 19/95
----------
train Loss: 1.2241 Acc: 0.9234
val Loss: 1.1103 Acc: 0.8409
Epoch 20/95
----------
train Loss: 1.3143 Acc: 0.8756
val Loss: 1.1639 Acc: 0.8182
Epoch 21/95
----------
train Loss: 1.4093 Acc: 0.9043
val Loss: 1.1035 Acc: 0.7955
Epoch 22/95
----------
train Loss: 1.2260 Acc: 0.8947
val Loss: 1.1992 Acc: 0.7955
Epoch 23/95
----------
train Loss: 1.4802 Acc: 0.8804
val Loss: 1.2914 Acc: 0.7727
Epoch 24/95
----------
train Loss: 1.0332 Acc: 0.9569
val Loss: 1.2946 Acc: 0.7955
Epoch 25/95
----------
train Loss: 1.2023 Acc: 0.9522
val Loss: 1.3488 Acc: 0.7727
Epoch 26/95
----------
train Loss: 1.4154 Acc: 0.9569
val Loss: 1.2566 Acc: 0.8409
Epoch 27/95
----------
train Loss: 1.1374 Acc: 0.9665
val Loss: 1.2614 Acc: 0.8409
Epoch 28/95
----------
train Loss: 1.3032 Acc: 0.8565
val Loss: 1.2352 Acc: 0.8182
Epoch 29/95
----------
train Loss: 1.4309 Acc: 0.7895
val Loss: 1.1197 Acc: 0.7955
Epoch 30/95
----------
train Loss: 1.2146 Acc: 0.8708
val Loss: 1.0738 Acc: 0.7727
Epoch 31/95
----------
train Loss: 1.0775 Acc: 0.9426
val Loss: 1.1262 Acc: 0.8409
Epoch 32/95
----------
train Loss: 1.1871 Acc: 0.9091
val Loss: 1.1521 Acc: 0.7727
Epoch 33/95
----------
train Loss: 1.2844 Acc: 0.8804
val Loss: 1.1912 Acc: 0.7727
Epoch 34/95
----------
train Loss: 1.2222 Acc: 0.9569
val Loss: 1.3263 Acc: 0.7500
Epoch 35/95
----------
train Loss: 0.9439 Acc: 0.9713
val Loss: 1.3843 Acc: 0.7955
Epoch 36/95
----------
train Loss: 1.4980 Acc: 0.8660
val Loss: 1.2552 Acc: 0.7727
Epoch 37/95
----------
train Loss: 1.2457 Acc: 0.8230
val Loss: 1.2291 Acc: 0.7955
Epoch 38/95
----------
train Loss: 1.3211 Acc: 0.9713
val Loss: 1.1591 Acc: 0.8182
Epoch 39/95
----------
train Loss: 1.2671 Acc: 0.7799
val Loss: 1.2425 Acc: 0.7955
Epoch 40/95
----------
train Loss: 1.0946 Acc: 0.9234
val Loss: 1.2637 Acc: 0.7500
Epoch 41/95
----------
train Loss: 1.5005 Acc: 0.7081
val Loss: 1.2029 Acc: 0.7727
Epoch 42/95
----------
train Loss: 1.0918 Acc: 0.9091
val Loss: 1.2803 Acc: 0.7273
Epoch 43/95
----------
train Loss: 1.2374 Acc: 0.8756
val Loss: 1.2252 Acc: 0.7727
Epoch 44/95
----------
train Loss: 1.1353 Acc: 0.8947
val Loss: 1.2877 Acc: 0.7955
Epoch 45/95
----------
train Loss: 0.7608 Acc: 0.9665
val Loss: 1.2571 Acc: 0.7955
Epoch 46/95
----------
train Loss: 1.5582 Acc: 0.8325
val Loss: 1.3407 Acc: 0.7955
Epoch 47/95
----------
train Loss: 1.1661 Acc: 0.9474
val Loss: 1.4941 Acc: 0.7273
Epoch 48/95
----------
train Loss: 1.2420 Acc: 0.8565
val Loss: 1.4257 Acc: 0.7727
Epoch 49/95
----------
train Loss: 1.2741 Acc: 0.9474
val Loss: 1.2730 Acc: 0.7500
Epoch 50/95
----------
train Loss: 1.1955 Acc: 0.8947
val Loss: 1.2576 Acc: 0.7727
Epoch 51/95
----------
train Loss: 0.9421 Acc: 0.9952
val Loss: 1.2142 Acc: 0.7727
Epoch 52/95
----------
train Loss: 1.2145 Acc: 0.8756
val Loss: 1.1860 Acc: 0.7500
Epoch 53/95
----------
train Loss: 1.4048 Acc: 0.9474
val Loss: 1.2131 Acc: 0.7500
Epoch 54/95
----------
train Loss: 1.0944 Acc: 0.9378
val Loss: 1.3140 Acc: 0.7273
Epoch 55/95
----------
train Loss: 1.1513 Acc: 0.9522
val Loss: 1.4744 Acc: 0.7045
Epoch 56/95
----------
train Loss: 1.3086 Acc: 0.9522
val Loss: 1.3100 Acc: 0.7727
Epoch 57/95
----------
train Loss: 1.4259 Acc: 0.8756
val Loss: 1.3181 Acc: 0.7500
Epoch 58/95
----------
train Loss: 1.1367 Acc: 0.8230
val Loss: 1.3021 Acc: 0.7727
Epoch 59/95
----------
train Loss: 1.1788 Acc: 0.9234
val Loss: 1.3917 Acc: 0.6818
Epoch 60/95
----------
train Loss: 0.9852 Acc: 0.9139
val Loss: 1.3563 Acc: 0.7500
Epoch 61/95
----------
train Loss: 1.3596 Acc: 0.7990
val Loss: 1.4232 Acc: 0.7273
Epoch 62/95
----------
train Loss: 1.3610 Acc: 0.9522
val Loss: 1.5381 Acc: 0.6591
Epoch 63/95
----------
train Loss: 1.1666 Acc: 0.9426
val Loss: 1.5329 Acc: 0.6591
Epoch 64/95
----------
train Loss: 1.0422 Acc: 0.9474
val Loss: 1.4984 Acc: 0.7045
Epoch 65/95
----------
train Loss: 1.1671 Acc: 0.9091
val Loss: 1.5863 Acc: 0.7045
Epoch 66/95
----------
train Loss: 1.1720 Acc: 0.9187
val Loss: 1.6295 Acc: 0.7045
Epoch 67/95
----------
train Loss: 1.3306 Acc: 0.8660
val Loss: 1.6863 Acc: 0.7273
Epoch 68/95
----------
train Loss: 1.1223 Acc: 0.9091
val Loss: 1.5226 Acc: 0.7955
Epoch 69/95
----------
train Loss: 1.0523 Acc: 0.8852
val Loss: 1.5322 Acc: 0.7727
Epoch 70/95
----------
train Loss: 1.2342 Acc: 0.9091
val Loss: 1.4475 Acc: 0.7727
Epoch 71/95
----------
train Loss: 1.3053 Acc: 0.9330
val Loss: 1.3917 Acc: 0.7500
Epoch 72/95
----------
train Loss: 1.2882 Acc: 0.8995
val Loss: 1.4172 Acc: 0.7500
Epoch 73/95
----------
train Loss: 0.9509 Acc: 0.9665
val Loss: 1.4277 Acc: 0.7955
Epoch 74/95
----------
train Loss: 1.3150 Acc: 0.8804
val Loss: 1.4634 Acc: 0.7955
Epoch 75/95
----------
train Loss: 1.0630 Acc: 0.9665
val Loss: 1.4118 Acc: 0.7955
Epoch 76/95
----------
train Loss: 1.0514 Acc: 0.8804
val Loss: 1.2596 Acc: 0.7955
Epoch 77/95
----------
train Loss: 1.2560 Acc: 0.8947
val Loss: 1.3702 Acc: 0.7273
Epoch 78/95
----------
train Loss: 1.1466 Acc: 0.9187
val Loss: 1.4014 Acc: 0.7045
Epoch 79/95
----------
train Loss: 1.2835 Acc: 0.9282
val Loss: 1.2918 Acc: 0.7955
Epoch 80/95
----------
train Loss: 1.1939 Acc: 0.8995
val Loss: 1.2980 Acc: 0.7955
Epoch 81/95
----------
train Loss: 1.3480 Acc: 0.7990
val Loss: 1.4381 Acc: 0.6818
Epoch 82/95
----------
train Loss: 1.1637 Acc: 0.9139
val Loss: 1.5623 Acc: 0.6591
Epoch 83/95
----------
train Loss: 1.0623 Acc: 0.9809
val Loss: 1.5565 Acc: 0.6591
Epoch 84/95
----------
train Loss: 1.3274 Acc: 0.8086
val Loss: 1.4761 Acc: 0.6591
Epoch 85/95
----------
train Loss: 1.0506 Acc: 0.9091
[32m[I 2025-06-29 18:13:06,047][0m Trial 188 finished with value: 0.7954545454545455 and parameters: {'batch_size': 102, 'lr': 0.000475255908028311, 'num_epochs': 95, 'weight_decay': 0.0013144540413856105, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4737 Acc: 0.7045
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_102_lr_0.000475255908028311_epoch_95_wd_0.0013144540413856105_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/97
----------
train Loss: 0.6891 Acc: 0.2344
val Loss: 0.6661 Acc: 0.3182
Epoch 2/97
----------
train Loss: 0.6508 Acc: 0.3636
val Loss: 0.6342 Acc: 0.4318
Epoch 3/97
----------
train Loss: 0.6201 Acc: 0.4450
val Loss: 0.5925 Acc: 0.4545
Epoch 4/97
----------
train Loss: 0.5967 Acc: 0.4689
val Loss: 0.5636 Acc: 0.6136
Epoch 5/97
----------
train Loss: 0.5781 Acc: 0.5072
val Loss: 0.5440 Acc: 0.6136
Epoch 6/97
----------
train Loss: 0.5511 Acc: 0.5311
val Loss: 0.5161 Acc: 0.6364
Epoch 7/97
----------
train Loss: 0.5244 Acc: 0.5359
val Loss: 0.4888 Acc: 0.6591
Epoch 8/97
----------
train Loss: 0.5156 Acc: 0.5311
val Loss: 0.4639 Acc: 0.6818
Epoch 9/97
----------
train Loss: 0.4997 Acc: 0.5407
val Loss: 0.4433 Acc: 0.6818
Epoch 10/97
----------
train Loss: 0.4569 Acc: 0.5837
val Loss: 0.4258 Acc: 0.6818
Epoch 11/97
----------
train Loss: 0.4688 Acc: 0.5550
val Loss: 0.4103 Acc: 0.7045
Epoch 12/97
----------
train Loss: 0.4693 Acc: 0.5598
val Loss: 0.4049 Acc: 0.7045
Epoch 13/97
----------
train Loss: 0.4348 Acc: 0.6459
val Loss: 0.3885 Acc: 0.7045
Epoch 14/97
----------
train Loss: 0.4117 Acc: 0.6507
val Loss: 0.3751 Acc: 0.7273
Epoch 15/97
----------
train Loss: 0.4248 Acc: 0.6316
val Loss: 0.3664 Acc: 0.7500
Epoch 16/97
----------
train Loss: 0.4152 Acc: 0.6842
val Loss: 0.3607 Acc: 0.7500
Epoch 17/97
----------
train Loss: 0.4044 Acc: 0.7033
val Loss: 0.3551 Acc: 0.7500
Epoch 18/97
----------
train Loss: 0.3861 Acc: 0.7033
val Loss: 0.3424 Acc: 0.7500
Epoch 19/97
----------
train Loss: 0.3664 Acc: 0.7799
val Loss: 0.3357 Acc: 0.7500
Epoch 20/97
----------
train Loss: 0.3784 Acc: 0.7608
val Loss: 0.3248 Acc: 0.7727
Epoch 21/97
----------
train Loss: 0.3798 Acc: 0.7608
val Loss: 0.3145 Acc: 0.7955
Epoch 22/97
----------
train Loss: 0.3669 Acc: 0.7464
val Loss: 0.3103 Acc: 0.7955
Epoch 23/97
----------
train Loss: 0.3625 Acc: 0.7847
val Loss: 0.3036 Acc: 0.7955
Epoch 24/97
----------
train Loss: 0.3197 Acc: 0.8325
val Loss: 0.2882 Acc: 0.7955
Epoch 25/97
----------
train Loss: 0.3448 Acc: 0.8182
val Loss: 0.2953 Acc: 0.7955
Epoch 26/97
----------
train Loss: 0.3517 Acc: 0.8421
val Loss: 0.2994 Acc: 0.7955
Epoch 27/97
----------
train Loss: 0.2972 Acc: 0.9234
val Loss: 0.3028 Acc: 0.7955
Epoch 28/97
----------
train Loss: 0.3494 Acc: 0.7943
val Loss: 0.2998 Acc: 0.7727
Epoch 29/97
----------
train Loss: 0.3730 Acc: 0.7368
val Loss: 0.3002 Acc: 0.7727
Epoch 30/97
----------
train Loss: 0.3301 Acc: 0.7799
val Loss: 0.2901 Acc: 0.7727
Epoch 31/97
----------
train Loss: 0.2850 Acc: 0.8995
val Loss: 0.2783 Acc: 0.7955
Epoch 32/97
----------
train Loss: 0.3122 Acc: 0.8038
val Loss: 0.2744 Acc: 0.7955
Epoch 33/97
----------
train Loss: 0.3306 Acc: 0.8134
val Loss: 0.2736 Acc: 0.7727
Epoch 34/97
----------
train Loss: 0.3053 Acc: 0.8517
val Loss: 0.2751 Acc: 0.7727
Epoch 35/97
----------
train Loss: 0.2519 Acc: 0.9569
val Loss: 0.2840 Acc: 0.7727
Epoch 36/97
----------
train Loss: 0.3508 Acc: 0.7656
val Loss: 0.2860 Acc: 0.7727
Epoch 37/97
----------
train Loss: 0.2918 Acc: 0.8230
val Loss: 0.2880 Acc: 0.7727
Epoch 38/97
----------
train Loss: 0.2908 Acc: 0.9330
val Loss: 0.2773 Acc: 0.7727
Epoch 39/97
----------
train Loss: 0.3238 Acc: 0.7416
val Loss: 0.2850 Acc: 0.7727
Epoch 40/97
----------
train Loss: 0.2655 Acc: 0.8804
val Loss: 0.2834 Acc: 0.8182
Epoch 41/97
----------
train Loss: 0.3493 Acc: 0.7368
val Loss: 0.2752 Acc: 0.8182
Epoch 42/97
----------
train Loss: 0.2642 Acc: 0.8517
val Loss: 0.2677 Acc: 0.8182
Epoch 43/97
----------
train Loss: 0.2885 Acc: 0.8517
val Loss: 0.2649 Acc: 0.8182
Epoch 44/97
----------
train Loss: 0.2709 Acc: 0.8708
val Loss: 0.2672 Acc: 0.7955
Epoch 45/97
----------
train Loss: 0.1734 Acc: 0.9665
val Loss: 0.2676 Acc: 0.7955
Epoch 46/97
----------
train Loss: 0.3622 Acc: 0.8038
val Loss: 0.2737 Acc: 0.7955
Epoch 47/97
----------
train Loss: 0.2611 Acc: 0.8852
val Loss: 0.2717 Acc: 0.8182
Epoch 48/97
----------
train Loss: 0.2955 Acc: 0.8517
val Loss: 0.2738 Acc: 0.7727
Epoch 49/97
----------
train Loss: 0.2783 Acc: 0.9378
val Loss: 0.2746 Acc: 0.7500
Epoch 50/97
----------
train Loss: 0.2714 Acc: 0.8756
val Loss: 0.2747 Acc: 0.7500
Epoch 51/97
----------
train Loss: 0.2038 Acc: 0.9856
val Loss: 0.2634 Acc: 0.7727
Epoch 52/97
----------
train Loss: 0.2886 Acc: 0.8230
val Loss: 0.2614 Acc: 0.7727
Epoch 53/97
----------
train Loss: 0.3239 Acc: 0.9091
val Loss: 0.2604 Acc: 0.7955
Epoch 54/97
----------
train Loss: 0.2375 Acc: 0.9282
val Loss: 0.2586 Acc: 0.8182
Epoch 55/97
----------
train Loss: 0.2527 Acc: 0.9378
val Loss: 0.2660 Acc: 0.7727
Epoch 56/97
----------
train Loss: 0.2962 Acc: 0.9043
val Loss: 0.2675 Acc: 0.7955
Epoch 57/97
----------
train Loss: 0.3393 Acc: 0.7990
val Loss: 0.2665 Acc: 0.7727
Epoch 58/97
----------
train Loss: 0.2758 Acc: 0.7990
val Loss: 0.2603 Acc: 0.8182
Epoch 59/97
----------
train Loss: 0.2874 Acc: 0.8852
val Loss: 0.2633 Acc: 0.7955
Epoch 60/97
----------
train Loss: 0.2373 Acc: 0.8900
val Loss: 0.2647 Acc: 0.7955
Epoch 61/97
----------
train Loss: 0.3288 Acc: 0.7799
val Loss: 0.2643 Acc: 0.7727
Epoch 62/97
----------
train Loss: 0.2922 Acc: 0.9569
val Loss: 0.2629 Acc: 0.7727
Epoch 63/97
----------
train Loss: 0.2541 Acc: 0.9330
val Loss: 0.2624 Acc: 0.7955
Epoch 64/97
----------
train Loss: 0.2391 Acc: 0.9522
val Loss: 0.2584 Acc: 0.7955
Epoch 65/97
----------
train Loss: 0.2707 Acc: 0.8278
val Loss: 0.2621 Acc: 0.7955
Epoch 66/97
----------
train Loss: 0.2657 Acc: 0.8995
val Loss: 0.2713 Acc: 0.7727
Epoch 67/97
----------
train Loss: 0.2971 Acc: 0.8756
val Loss: 0.2633 Acc: 0.8182
Epoch 68/97
----------
train Loss: 0.2508 Acc: 0.8947
val Loss: 0.2671 Acc: 0.7955
Epoch 69/97
----------
train Loss: 0.2470 Acc: 0.8947
val Loss: 0.2622 Acc: 0.7727
Epoch 70/97
----------
train Loss: 0.2818 Acc: 0.9043
val Loss: 0.2675 Acc: 0.7727
Epoch 71/97
----------
train Loss: 0.2959 Acc: 0.9091
val Loss: 0.2673 Acc: 0.7500
Epoch 72/97
----------
train Loss: 0.2947 Acc: 0.8660
val Loss: 0.2747 Acc: 0.7727
Epoch 73/97
----------
train Loss: 0.2131 Acc: 0.9713
val Loss: 0.2782 Acc: 0.7727
Epoch 74/97
----------
train Loss: 0.3100 Acc: 0.8660
val Loss: 0.2681 Acc: 0.7500
Epoch 75/97
----------
train Loss: 0.2289 Acc: 0.9665
val Loss: 0.2620 Acc: 0.7955
Epoch 76/97
----------
train Loss: 0.2453 Acc: 0.8325
val Loss: 0.2595 Acc: 0.7727
Epoch 77/97
----------
train Loss: 0.2861 Acc: 0.8517
val Loss: 0.2643 Acc: 0.7955
Epoch 78/97
----------
train Loss: 0.2466 Acc: 0.8947
val Loss: 0.2710 Acc: 0.7955
Epoch 79/97
----------
train Loss: 0.3023 Acc: 0.8469
val Loss: 0.2673 Acc: 0.8409
Epoch 80/97
----------
train Loss: 0.2690 Acc: 0.8325
val Loss: 0.2665 Acc: 0.8409
Epoch 81/97
----------
train Loss: 0.3105 Acc: 0.7990
val Loss: 0.2763 Acc: 0.8182
Epoch 82/97
----------
train Loss: 0.2665 Acc: 0.8421
val Loss: 0.2809 Acc: 0.7955
Epoch 83/97
----------
train Loss: 0.2330 Acc: 0.9713
val Loss: 0.2775 Acc: 0.7955
Epoch 84/97
----------
train Loss: 0.3020 Acc: 0.7895
val Loss: 0.2658 Acc: 0.7727
Epoch 85/97
----------
train Loss: 0.2387 Acc: 0.8373
val Loss: 0.2582 Acc: 0.7955
Epoch 86/97
----------
train Loss: 0.2522 Acc: 0.8756
val Loss: 0.2474 Acc: 0.8636
Epoch 87/97
----------
train Loss: 0.2836 Acc: 0.9426
val Loss: 0.2490 Acc: 0.8182
Epoch 88/97
----------
train Loss: 0.3022 Acc: 0.9091
val Loss: 0.2504 Acc: 0.8182
Epoch 89/97
----------
train Loss: 0.3232 Acc: 0.8134
val Loss: 0.2520 Acc: 0.8182
Epoch 90/97
----------
train Loss: 0.2799 Acc: 0.8612
val Loss: 0.2554 Acc: 0.8182
Epoch 91/97
----------
train Loss: 0.2367 Acc: 0.9569
val Loss: 0.2582 Acc: 0.7727
Epoch 92/97
----------
train Loss: 0.2604 Acc: 0.9426
val Loss: 0.2600 Acc: 0.7727
Epoch 93/97
----------
train Loss: 0.2760 Acc: 0.8660
val Loss: 0.2481 Acc: 0.7955
Epoch 94/97
----------
train Loss: 0.2168 Acc: 0.9904
val Loss: 0.2532 Acc: 0.7955
Epoch 95/97
----------
train Loss: 0.2547 Acc: 0.9282
val Loss: 0.2523 Acc: 0.7955
Epoch 96/97
----------
train Loss: 0.1853 Acc: 0.9856
val Loss: 0.2503 Acc: 0.8182
Epoch 97/97
----------
train Loss: 0.2344 Acc: 0.9330
[32m[I 2025-06-29 18:35:10,662][0m Trial 189 finished with value: 0.8181818181818182 and parameters: {'batch_size': 92, 'lr': 7.861499295815856e-05, 'num_epochs': 97, 'weight_decay': 0.0020024163267920287, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2455 Acc: 0.8182
Best val Acc: 0.818182

Model weights saved at ./model_weights/efficientnetb0_bs_92_lr_7.861499295815856e-05_epoch_97_wd_0.0020024163267920287_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/68
----------
train Loss: 3.3369 Acc: 0.3636
val Loss: 2.7131 Acc: 0.6364
Epoch 2/68
----------
train Loss: 2.5109 Acc: 0.5455
val Loss: 1.9529 Acc: 0.6364
Epoch 3/68
----------
train Loss: 2.2059 Acc: 0.5215
val Loss: 1.7749 Acc: 0.6591
Epoch 4/68
----------
train Loss: 2.1027 Acc: 0.5550
val Loss: 1.6520 Acc: 0.7727
Epoch 5/68
----------
train Loss: 2.0099 Acc: 0.6794
val Loss: 1.5195 Acc: 0.7955
Epoch 6/68
----------
train Loss: 1.8261 Acc: 0.6890
val Loss: 1.3755 Acc: 0.8182
Epoch 7/68
----------
train Loss: 1.5668 Acc: 0.8325
val Loss: 1.2896 Acc: 0.8409
Epoch 8/68
----------
train Loss: 1.7100 Acc: 0.7799
val Loss: 1.3119 Acc: 0.7955
Epoch 9/68
----------
train Loss: 1.7048 Acc: 0.7656
val Loss: 1.4287 Acc: 0.7955
Epoch 10/68
----------
train Loss: 1.0318 Acc: 0.9378
val Loss: 1.2345 Acc: 0.7727
Epoch 11/68
----------
train Loss: 1.7301 Acc: 0.7990
val Loss: 1.2352 Acc: 0.8409
Epoch 12/68
----------
train Loss: 1.4802 Acc: 0.7560
val Loss: 1.6485 Acc: 0.7273
Epoch 13/68
----------
train Loss: 1.3387 Acc: 0.8900
val Loss: 1.4848 Acc: 0.7955
Epoch 14/68
----------
train Loss: 1.2255 Acc: 0.8373
val Loss: 1.3567 Acc: 0.7955
Epoch 15/68
----------
train Loss: 1.3894 Acc: 0.8230
val Loss: 1.1231 Acc: 0.8182
Epoch 16/68
----------
train Loss: 1.3899 Acc: 0.8230
val Loss: 1.3662 Acc: 0.8409
Epoch 17/68
----------
train Loss: 1.3948 Acc: 0.8660
val Loss: 1.3769 Acc: 0.7955
Epoch 18/68
----------
train Loss: 1.3226 Acc: 0.8278
val Loss: 1.2950 Acc: 0.7727
Epoch 19/68
----------
train Loss: 1.2345 Acc: 0.9426
val Loss: 1.1735 Acc: 0.7955
Epoch 20/68
----------
train Loss: 1.3139 Acc: 0.8708
val Loss: 1.1904 Acc: 0.7500
Epoch 21/68
----------
train Loss: 1.4421 Acc: 0.8900
val Loss: 1.0393 Acc: 0.8409
Epoch 22/68
----------
train Loss: 1.2412 Acc: 0.8900
val Loss: 1.1710 Acc: 0.7955
Epoch 23/68
----------
train Loss: 1.4856 Acc: 0.8708
val Loss: 1.3153 Acc: 0.7727
Epoch 24/68
----------
train Loss: 1.0608 Acc: 0.9330
val Loss: 1.2976 Acc: 0.7500
Epoch 25/68
----------
train Loss: 1.2232 Acc: 0.9474
val Loss: 1.3385 Acc: 0.7273
Epoch 26/68
----------
train Loss: 1.4345 Acc: 0.9378
val Loss: 1.2404 Acc: 0.7500
Epoch 27/68
----------
train Loss: 1.1498 Acc: 0.9713
val Loss: 1.2815 Acc: 0.7955
Epoch 28/68
----------
train Loss: 1.3456 Acc: 0.8469
val Loss: 1.1589 Acc: 0.7955
Epoch 29/68
----------
train Loss: 1.4438 Acc: 0.8134
val Loss: 1.1960 Acc: 0.8409
Epoch 30/68
----------
train Loss: 1.2619 Acc: 0.8852
val Loss: 1.1746 Acc: 0.7727
Epoch 31/68
----------
train Loss: 1.1107 Acc: 0.9474
val Loss: 1.2218 Acc: 0.7955
Epoch 32/68
----------
train Loss: 1.1871 Acc: 0.9091
val Loss: 1.2518 Acc: 0.7955
Epoch 33/68
----------
train Loss: 1.3576 Acc: 0.8804
val Loss: 1.4310 Acc: 0.7955
Epoch 34/68
----------
train Loss: 1.2780 Acc: 0.9330
val Loss: 1.6030 Acc: 0.7273
Epoch 35/68
----------
train Loss: 0.9936 Acc: 0.9665
val Loss: 1.4901 Acc: 0.7500
Epoch 36/68
----------
train Loss: 1.5378 Acc: 0.8660
val Loss: 1.4774 Acc: 0.7500
Epoch 37/68
----------
train Loss: 1.3244 Acc: 0.8278
val Loss: 1.4216 Acc: 0.7273
Epoch 38/68
----------
train Loss: 1.3284 Acc: 0.9522
val Loss: 1.3128 Acc: 0.7955
Epoch 39/68
----------
train Loss: 1.3374 Acc: 0.7990
val Loss: 1.3799 Acc: 0.6818
Epoch 40/68
----------
train Loss: 1.1682 Acc: 0.9234
val Loss: 1.4098 Acc: 0.7045
Epoch 41/68
----------
train Loss: 1.5721 Acc: 0.7129
val Loss: 1.1936 Acc: 0.7045
Epoch 42/68
----------
train Loss: 1.1574 Acc: 0.8708
val Loss: 1.3430 Acc: 0.7500
Epoch 43/68
----------
train Loss: 1.2782 Acc: 0.8660
val Loss: 1.2901 Acc: 0.7727
Epoch 44/68
----------
train Loss: 1.1667 Acc: 0.8804
val Loss: 1.5172 Acc: 0.7727
Epoch 45/68
----------
train Loss: 0.8051 Acc: 0.9617
val Loss: 1.2320 Acc: 0.7045
Epoch 46/68
----------
train Loss: 1.6272 Acc: 0.8086
val Loss: 1.3722 Acc: 0.7500
Epoch 47/68
----------
train Loss: 1.2380 Acc: 0.9139
val Loss: 1.3761 Acc: 0.7045
Epoch 48/68
----------
train Loss: 1.3334 Acc: 0.8517
val Loss: 1.4222 Acc: 0.7273
Epoch 49/68
----------
train Loss: 1.2930 Acc: 0.9426
val Loss: 1.2242 Acc: 0.7955
Epoch 50/68
----------
train Loss: 1.2288 Acc: 0.8660
val Loss: 1.2463 Acc: 0.7045
Epoch 51/68
----------
train Loss: 0.9548 Acc: 0.9904
val Loss: 1.3016 Acc: 0.7727
Epoch 52/68
----------
train Loss: 1.2545 Acc: 0.8565
val Loss: 1.1414 Acc: 0.7727
Epoch 53/68
----------
train Loss: 1.4795 Acc: 0.9139
val Loss: 1.4656 Acc: 0.7045
Epoch 54/68
----------
train Loss: 1.1744 Acc: 0.9426
val Loss: 1.4107 Acc: 0.7273
Epoch 55/68
----------
train Loss: 1.1869 Acc: 0.9617
val Loss: 1.5848 Acc: 0.6818
Epoch 56/68
----------
train Loss: 1.3717 Acc: 0.9426
val Loss: 1.3688 Acc: 0.7045
Epoch 57/68
----------
train Loss: 1.4827 Acc: 0.8517
val Loss: 1.4217 Acc: 0.7500
Epoch 58/68
----------
train Loss: 1.2470 Acc: 0.8278
val Loss: 1.4201 Acc: 0.7045
Epoch 59/68
----------
train Loss: 1.2814 Acc: 0.9139
val Loss: 1.4297 Acc: 0.7045
Epoch 60/68
----------
train Loss: 1.0304 Acc: 0.9378
val Loss: 1.3130 Acc: 0.7045
Epoch 61/68
----------
train Loss: 1.4446 Acc: 0.7895
val Loss: 1.5065 Acc: 0.7045
Epoch 62/68
----------
train Loss: 1.4074 Acc: 0.9282
val Loss: 1.3858 Acc: 0.7273
Epoch 63/68
----------
train Loss: 1.2292 Acc: 0.9522
val Loss: 1.4531 Acc: 0.6818
Epoch 64/68
----------
train Loss: 1.0860 Acc: 0.9665
val Loss: 1.4660 Acc: 0.7045
Epoch 65/68
----------
train Loss: 1.2222 Acc: 0.9234
val Loss: 1.3104 Acc: 0.7955
Epoch 66/68
----------
train Loss: 1.2570 Acc: 0.9139
val Loss: 1.7750 Acc: 0.7273
Epoch 67/68
----------
train Loss: 1.4331 Acc: 0.8469
val Loss: 1.4963 Acc: 0.7500
Epoch 68/68
----------
train Loss: 1.1644 Acc: 0.8852
[32m[I 2025-06-29 18:50:38,215][0m Trial 190 finished with value: 0.7954545454545455 and parameters: {'batch_size': 78, 'lr': 0.00047955266109951194, 'num_epochs': 68, 'weight_decay': 0.006390158462235621, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4849 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_78_lr_0.00047955266109951194_epoch_68_wd_0.006390158462235621_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/94
----------
train Loss: 0.6933 Acc: 0.2344
val Loss: 0.6738 Acc: 0.2955
Epoch 2/94
----------
train Loss: 0.6644 Acc: 0.3062
val Loss: 0.6512 Acc: 0.3182
Epoch 3/94
----------
train Loss: 0.6408 Acc: 0.3732
val Loss: 0.6200 Acc: 0.4318
Epoch 4/94
----------
train Loss: 0.6233 Acc: 0.4115
val Loss: 0.5988 Acc: 0.4318
Epoch 5/94
----------
train Loss: 0.6099 Acc: 0.4737
val Loss: 0.5843 Acc: 0.5227
Epoch 6/94
----------
train Loss: 0.5879 Acc: 0.5024
val Loss: 0.5636 Acc: 0.6136
Epoch 7/94
----------
train Loss: 0.5652 Acc: 0.5502
val Loss: 0.5404 Acc: 0.6136
Epoch 8/94
----------
train Loss: 0.5541 Acc: 0.5359
val Loss: 0.5196 Acc: 0.6364
Epoch 9/94
----------
train Loss: 0.5380 Acc: 0.5694
val Loss: 0.4983 Acc: 0.6818
Epoch 10/94
----------
train Loss: 0.5040 Acc: 0.5789
val Loss: 0.4771 Acc: 0.6591
Epoch 11/94
----------
train Loss: 0.5095 Acc: 0.5550
val Loss: 0.4619 Acc: 0.6818
Epoch 12/94
----------
train Loss: 0.5046 Acc: 0.5646
val Loss: 0.4533 Acc: 0.6818
Epoch 13/94
----------
train Loss: 0.4740 Acc: 0.6077
val Loss: 0.4344 Acc: 0.6818
Epoch 14/94
----------
train Loss: 0.4544 Acc: 0.6077
val Loss: 0.4231 Acc: 0.6591
Epoch 15/94
----------
train Loss: 0.4589 Acc: 0.5981
val Loss: 0.4119 Acc: 0.7045
Epoch 16/94
----------
train Loss: 0.4493 Acc: 0.6172
val Loss: 0.4006 Acc: 0.7045
Epoch 17/94
----------
train Loss: 0.4384 Acc: 0.6029
val Loss: 0.3905 Acc: 0.7045
Epoch 18/94
----------
train Loss: 0.4256 Acc: 0.6555
val Loss: 0.3788 Acc: 0.7045
Epoch 19/94
----------
train Loss: 0.4081 Acc: 0.7081
val Loss: 0.3718 Acc: 0.7955
Epoch 20/94
----------
train Loss: 0.4137 Acc: 0.7033
val Loss: 0.3606 Acc: 0.7273
Epoch 21/94
----------
train Loss: 0.4113 Acc: 0.6842
val Loss: 0.3513 Acc: 0.7500
Epoch 22/94
----------
train Loss: 0.4032 Acc: 0.6699
val Loss: 0.3454 Acc: 0.7500
Epoch 23/94
----------
train Loss: 0.3964 Acc: 0.7033
val Loss: 0.3363 Acc: 0.7727
Epoch 24/94
----------
train Loss: 0.3613 Acc: 0.7799
val Loss: 0.3219 Acc: 0.7727
Epoch 25/94
----------
train Loss: 0.3835 Acc: 0.7081
val Loss: 0.3243 Acc: 0.7955
Epoch 26/94
----------
train Loss: 0.3856 Acc: 0.7464
val Loss: 0.3235 Acc: 0.7955
Epoch 27/94
----------
train Loss: 0.3395 Acc: 0.8278
val Loss: 0.3196 Acc: 0.8182
Epoch 28/94
----------
train Loss: 0.3816 Acc: 0.7416
val Loss: 0.3170 Acc: 0.7955
Epoch 29/94
----------
train Loss: 0.4010 Acc: 0.6651
val Loss: 0.3159 Acc: 0.7955
Epoch 30/94
----------
train Loss: 0.3673 Acc: 0.7225
val Loss: 0.3111 Acc: 0.7727
Epoch 31/94
----------
train Loss: 0.3260 Acc: 0.8421
val Loss: 0.3019 Acc: 0.7727
Epoch 32/94
----------
train Loss: 0.3483 Acc: 0.7608
val Loss: 0.2945 Acc: 0.7727
Epoch 33/94
----------
train Loss: 0.3671 Acc: 0.7751
val Loss: 0.2937 Acc: 0.7727
Epoch 34/94
----------
train Loss: 0.3404 Acc: 0.8325
val Loss: 0.2914 Acc: 0.7727
Epoch 35/94
----------
train Loss: 0.2947 Acc: 0.8947
val Loss: 0.2936 Acc: 0.7955
Epoch 36/94
----------
train Loss: 0.3790 Acc: 0.7321
val Loss: 0.2900 Acc: 0.7955
Epoch 37/94
----------
train Loss: 0.3244 Acc: 0.7895
val Loss: 0.2964 Acc: 0.7955
Epoch 38/94
----------
train Loss: 0.3229 Acc: 0.8995
val Loss: 0.2919 Acc: 0.7955
Epoch 39/94
----------
train Loss: 0.3502 Acc: 0.7321
val Loss: 0.2990 Acc: 0.7273
Epoch 40/94
----------
train Loss: 0.2977 Acc: 0.8278
val Loss: 0.2951 Acc: 0.7500
Epoch 41/94
----------
train Loss: 0.3646 Acc: 0.7177
val Loss: 0.2885 Acc: 0.7955
Epoch 42/94
----------
train Loss: 0.3015 Acc: 0.7943
val Loss: 0.2797 Acc: 0.7955
Epoch 43/94
----------
train Loss: 0.3237 Acc: 0.8182
val Loss: 0.2760 Acc: 0.7955
Epoch 44/94
----------
train Loss: 0.2952 Acc: 0.8421
val Loss: 0.2751 Acc: 0.8182
Epoch 45/94
----------
train Loss: 0.2034 Acc: 0.9569
val Loss: 0.2726 Acc: 0.7955
Epoch 46/94
----------
train Loss: 0.3748 Acc: 0.8086
val Loss: 0.2753 Acc: 0.8182
Epoch 47/94
----------
train Loss: 0.2852 Acc: 0.8708
val Loss: 0.2712 Acc: 0.8182
Epoch 48/94
----------
train Loss: 0.3157 Acc: 0.7943
val Loss: 0.2743 Acc: 0.8182
Epoch 49/94
----------
train Loss: 0.2998 Acc: 0.8947
val Loss: 0.2728 Acc: 0.7955
Epoch 50/94
----------
train Loss: 0.2911 Acc: 0.8421
val Loss: 0.2738 Acc: 0.7955
Epoch 51/94
----------
train Loss: 0.2265 Acc: 0.9713
val Loss: 0.2679 Acc: 0.7955
Epoch 52/94
----------
train Loss: 0.3070 Acc: 0.7703
val Loss: 0.2700 Acc: 0.7727
Epoch 53/94
----------
train Loss: 0.3390 Acc: 0.8852
val Loss: 0.2676 Acc: 0.7727
Epoch 54/94
----------
train Loss: 0.2528 Acc: 0.9187
val Loss: 0.2615 Acc: 0.7955
Epoch 55/94
----------
train Loss: 0.2697 Acc: 0.9234
val Loss: 0.2609 Acc: 0.8182
Epoch 56/94
----------
train Loss: 0.3128 Acc: 0.8612
val Loss: 0.2617 Acc: 0.7727
Epoch 57/94
----------
train Loss: 0.3483 Acc: 0.7943
val Loss: 0.2597 Acc: 0.8182
Epoch 58/94
----------
train Loss: 0.2902 Acc: 0.7990
val Loss: 0.2577 Acc: 0.8182
Epoch 59/94
----------
train Loss: 0.3023 Acc: 0.8421
val Loss: 0.2571 Acc: 0.7955
Epoch 60/94
----------
train Loss: 0.2557 Acc: 0.8565
val Loss: 0.2600 Acc: 0.7955
Epoch 61/94
----------
train Loss: 0.3431 Acc: 0.7368
val Loss: 0.2617 Acc: 0.7955
Epoch 62/94
----------
train Loss: 0.3035 Acc: 0.9139
val Loss: 0.2609 Acc: 0.7727
Epoch 63/94
----------
train Loss: 0.2628 Acc: 0.9330
val Loss: 0.2610 Acc: 0.7727
Epoch 64/94
----------
train Loss: 0.2504 Acc: 0.9282
val Loss: 0.2591 Acc: 0.7955
Epoch 65/94
----------
train Loss: 0.2842 Acc: 0.8134
val Loss: 0.2612 Acc: 0.7955
Epoch 66/94
----------
train Loss: 0.2756 Acc: 0.8947
val Loss: 0.2650 Acc: 0.7955
Epoch 67/94
----------
train Loss: 0.3087 Acc: 0.8565
val Loss: 0.2585 Acc: 0.8182
Epoch 68/94
----------
train Loss: 0.2586 Acc: 0.8995
val Loss: 0.2618 Acc: 0.7955
Epoch 69/94
----------
train Loss: 0.2586 Acc: 0.8852
val Loss: 0.2598 Acc: 0.8182
Epoch 70/94
----------
train Loss: 0.2915 Acc: 0.8947
val Loss: 0.2616 Acc: 0.7955
Epoch 71/94
----------
train Loss: 0.3056 Acc: 0.9091
val Loss: 0.2593 Acc: 0.7727
Epoch 72/94
----------
train Loss: 0.3076 Acc: 0.8756
val Loss: 0.2650 Acc: 0.7727
Epoch 73/94
----------
train Loss: 0.2178 Acc: 0.9617
val Loss: 0.2685 Acc: 0.7500
Epoch 74/94
----------
train Loss: 0.3208 Acc: 0.8469
val Loss: 0.2627 Acc: 0.7727
Epoch 75/94
----------
train Loss: 0.2391 Acc: 0.9282
val Loss: 0.2621 Acc: 0.7273
Epoch 76/94
----------
train Loss: 0.2611 Acc: 0.8134
val Loss: 0.2588 Acc: 0.7727
Epoch 77/94
----------
train Loss: 0.2965 Acc: 0.8469
val Loss: 0.2575 Acc: 0.7727
Epoch 78/94
----------
train Loss: 0.2561 Acc: 0.8756
val Loss: 0.2572 Acc: 0.8182
Epoch 79/94
----------
train Loss: 0.3163 Acc: 0.8325
val Loss: 0.2537 Acc: 0.8182
Epoch 80/94
----------
train Loss: 0.2772 Acc: 0.8373
val Loss: 0.2532 Acc: 0.8636
Epoch 81/94
----------
train Loss: 0.3193 Acc: 0.7847
val Loss: 0.2624 Acc: 0.7955
Epoch 82/94
----------
train Loss: 0.2755 Acc: 0.8373
val Loss: 0.2652 Acc: 0.7955
Epoch 83/94
----------
train Loss: 0.2372 Acc: 0.9522
val Loss: 0.2664 Acc: 0.7955
Epoch 84/94
----------
train Loss: 0.3156 Acc: 0.7751
val Loss: 0.2636 Acc: 0.7273
Epoch 85/94
----------
train Loss: 0.2507 Acc: 0.8086
[32m[I 2025-06-29 19:09:57,615][0m Trial 191 finished with value: 0.8636363636363636 and parameters: {'batch_size': 13, 'lr': 5.0720893125134026e-05, 'num_epochs': 94, 'weight_decay': 0.0006174621585653693, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2630 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_13_lr_5.0720893125134026e-05_epoch_94_wd_0.0006174621585653693_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/94
----------
train Loss: 0.6933 Acc: 0.2344
val Loss: 0.6737 Acc: 0.2955
Epoch 2/94
----------
train Loss: 0.6644 Acc: 0.3062
val Loss: 0.6511 Acc: 0.3182
Epoch 3/94
----------
train Loss: 0.6408 Acc: 0.3732
val Loss: 0.6199 Acc: 0.4318
Epoch 4/94
----------
train Loss: 0.6234 Acc: 0.4163
val Loss: 0.5989 Acc: 0.4318
Epoch 5/94
----------
train Loss: 0.6099 Acc: 0.4689
val Loss: 0.5846 Acc: 0.5227
Epoch 6/94
----------
train Loss: 0.5880 Acc: 0.4976
val Loss: 0.5641 Acc: 0.6136
Epoch 7/94
----------
train Loss: 0.5655 Acc: 0.5502
val Loss: 0.5410 Acc: 0.6136
Epoch 8/94
----------
train Loss: 0.5544 Acc: 0.5359
val Loss: 0.5203 Acc: 0.6364
Epoch 9/94
----------
train Loss: 0.5385 Acc: 0.5646
val Loss: 0.4992 Acc: 0.6818
Epoch 10/94
----------
train Loss: 0.5048 Acc: 0.5646
val Loss: 0.4781 Acc: 0.6591
Epoch 11/94
----------
train Loss: 0.5101 Acc: 0.5550
val Loss: 0.4631 Acc: 0.6818
Epoch 12/94
----------
train Loss: 0.5052 Acc: 0.5598
val Loss: 0.4543 Acc: 0.6818
Epoch 13/94
----------
train Loss: 0.4748 Acc: 0.6029
val Loss: 0.4357 Acc: 0.6818
Epoch 14/94
----------
train Loss: 0.4552 Acc: 0.5981
val Loss: 0.4243 Acc: 0.6591
Epoch 15/94
----------
train Loss: 0.4597 Acc: 0.5981
val Loss: 0.4133 Acc: 0.7045
Epoch 16/94
----------
train Loss: 0.4501 Acc: 0.6124
val Loss: 0.4019 Acc: 0.7045
Epoch 17/94
----------
train Loss: 0.4392 Acc: 0.6029
val Loss: 0.3919 Acc: 0.7045
Epoch 18/94
----------
train Loss: 0.4264 Acc: 0.6555
val Loss: 0.3802 Acc: 0.7045
Epoch 19/94
----------
train Loss: 0.4090 Acc: 0.7129
val Loss: 0.3734 Acc: 0.7955
Epoch 20/94
----------
train Loss: 0.4144 Acc: 0.6938
val Loss: 0.3618 Acc: 0.7273
Epoch 21/94
----------
train Loss: 0.4122 Acc: 0.6794
val Loss: 0.3526 Acc: 0.7727
Epoch 22/94
----------
train Loss: 0.4041 Acc: 0.6651
val Loss: 0.3464 Acc: 0.7500
Epoch 23/94
----------
train Loss: 0.3970 Acc: 0.7033
val Loss: 0.3373 Acc: 0.7727
Epoch 24/94
----------
train Loss: 0.3622 Acc: 0.7751
val Loss: 0.3230 Acc: 0.7727
Epoch 25/94
----------
train Loss: 0.3844 Acc: 0.7081
val Loss: 0.3256 Acc: 0.7955
Epoch 26/94
----------
train Loss: 0.3865 Acc: 0.7416
val Loss: 0.3249 Acc: 0.7955
Epoch 27/94
----------
train Loss: 0.3405 Acc: 0.8182
val Loss: 0.3208 Acc: 0.8182
Epoch 28/94
----------
train Loss: 0.3822 Acc: 0.7368
val Loss: 0.3181 Acc: 0.7955
Epoch 29/94
----------
train Loss: 0.4017 Acc: 0.6651
val Loss: 0.3171 Acc: 0.7955
Epoch 30/94
----------
train Loss: 0.3682 Acc: 0.7225
val Loss: 0.3125 Acc: 0.7727
Epoch 31/94
----------
train Loss: 0.3269 Acc: 0.8325
val Loss: 0.3032 Acc: 0.7727
Epoch 32/94
----------
train Loss: 0.3490 Acc: 0.7608
val Loss: 0.2956 Acc: 0.7727
Epoch 33/94
----------
train Loss: 0.3676 Acc: 0.7751
val Loss: 0.2951 Acc: 0.7727
Epoch 34/94
----------
train Loss: 0.3410 Acc: 0.8278
val Loss: 0.2927 Acc: 0.7727
Epoch 35/94
----------
train Loss: 0.2955 Acc: 0.8947
val Loss: 0.2948 Acc: 0.7955
Epoch 36/94
----------
train Loss: 0.3794 Acc: 0.7321
val Loss: 0.2911 Acc: 0.7955
Epoch 37/94
----------
train Loss: 0.3250 Acc: 0.7895
val Loss: 0.2975 Acc: 0.7955
Epoch 38/94
----------
train Loss: 0.3234 Acc: 0.9043
val Loss: 0.2928 Acc: 0.7955
Epoch 39/94
----------
train Loss: 0.3507 Acc: 0.7273
val Loss: 0.3001 Acc: 0.7273
Epoch 40/94
----------
train Loss: 0.2984 Acc: 0.8421
val Loss: 0.2961 Acc: 0.7500
Epoch 41/94
----------
train Loss: 0.3652 Acc: 0.7225
val Loss: 0.2896 Acc: 0.7955
Epoch 42/94
----------
train Loss: 0.3021 Acc: 0.7943
val Loss: 0.2808 Acc: 0.7955
Epoch 43/94
----------
train Loss: 0.3242 Acc: 0.8182
val Loss: 0.2772 Acc: 0.7955
Epoch 44/94
----------
train Loss: 0.2957 Acc: 0.8421
val Loss: 0.2760 Acc: 0.7955
Epoch 45/94
----------
train Loss: 0.2040 Acc: 0.9522
val Loss: 0.2733 Acc: 0.7955
Epoch 46/94
----------
train Loss: 0.3749 Acc: 0.8038
val Loss: 0.2760 Acc: 0.8182
Epoch 47/94
----------
train Loss: 0.2856 Acc: 0.8708
val Loss: 0.2721 Acc: 0.8182
Epoch 48/94
----------
train Loss: 0.3157 Acc: 0.7943
val Loss: 0.2749 Acc: 0.8182
Epoch 49/94
----------
train Loss: 0.3001 Acc: 0.8947
val Loss: 0.2734 Acc: 0.7955
Epoch 50/94
----------
train Loss: 0.2912 Acc: 0.8373
val Loss: 0.2745 Acc: 0.7955
Epoch 51/94
----------
train Loss: 0.2270 Acc: 0.9665
val Loss: 0.2685 Acc: 0.7955
Epoch 52/94
----------
train Loss: 0.3072 Acc: 0.7799
val Loss: 0.2704 Acc: 0.7727
Epoch 53/94
----------
train Loss: 0.3392 Acc: 0.8852
val Loss: 0.2684 Acc: 0.7727
Epoch 54/94
----------
train Loss: 0.2531 Acc: 0.9234
val Loss: 0.2620 Acc: 0.7955
Epoch 55/94
----------
train Loss: 0.2699 Acc: 0.9234
val Loss: 0.2619 Acc: 0.8182
Epoch 56/94
----------
train Loss: 0.3128 Acc: 0.8565
val Loss: 0.2623 Acc: 0.7727
Epoch 57/94
----------
train Loss: 0.3487 Acc: 0.7943
val Loss: 0.2605 Acc: 0.8182
Epoch 58/94
----------
train Loss: 0.2905 Acc: 0.7943
val Loss: 0.2588 Acc: 0.8182
Epoch 59/94
----------
train Loss: 0.3027 Acc: 0.8421
val Loss: 0.2583 Acc: 0.7955
Epoch 60/94
----------
train Loss: 0.2560 Acc: 0.8517
val Loss: 0.2610 Acc: 0.7955
Epoch 61/94
----------
train Loss: 0.3433 Acc: 0.7368
val Loss: 0.2626 Acc: 0.7955
Epoch 62/94
----------
train Loss: 0.3033 Acc: 0.9234
val Loss: 0.2614 Acc: 0.7727
Epoch 63/94
----------
train Loss: 0.2631 Acc: 0.9282
val Loss: 0.2614 Acc: 0.7955
Epoch 64/94
----------
train Loss: 0.2507 Acc: 0.9282
val Loss: 0.2598 Acc: 0.7955
Epoch 65/94
----------
train Loss: 0.2841 Acc: 0.8134
val Loss: 0.2617 Acc: 0.7955
Epoch 66/94
----------
train Loss: 0.2756 Acc: 0.8900
val Loss: 0.2655 Acc: 0.7955
Epoch 67/94
----------
train Loss: 0.3087 Acc: 0.8612
val Loss: 0.2590 Acc: 0.8182
Epoch 68/94
----------
train Loss: 0.2587 Acc: 0.8947
val Loss: 0.2623 Acc: 0.7955
Epoch 69/94
----------
train Loss: 0.2587 Acc: 0.8852
val Loss: 0.2605 Acc: 0.8182
Epoch 70/94
----------
train Loss: 0.2919 Acc: 0.8947
val Loss: 0.2624 Acc: 0.7955
Epoch 71/94
----------
train Loss: 0.3057 Acc: 0.9091
val Loss: 0.2600 Acc: 0.7727
Epoch 72/94
----------
train Loss: 0.3077 Acc: 0.8756
val Loss: 0.2660 Acc: 0.7727
Epoch 73/94
----------
train Loss: 0.2180 Acc: 0.9617
val Loss: 0.2692 Acc: 0.7727
Epoch 74/94
----------
train Loss: 0.3210 Acc: 0.8469
val Loss: 0.2632 Acc: 0.7727
Epoch 75/94
----------
train Loss: 0.2390 Acc: 0.9330
val Loss: 0.2619 Acc: 0.7500
Epoch 76/94
----------
train Loss: 0.2611 Acc: 0.8134
val Loss: 0.2591 Acc: 0.7727
Epoch 77/94
----------
train Loss: 0.2966 Acc: 0.8469
val Loss: 0.2580 Acc: 0.7955
Epoch 78/94
----------
train Loss: 0.2559 Acc: 0.8756
val Loss: 0.2579 Acc: 0.8182
Epoch 79/94
----------
train Loss: 0.3166 Acc: 0.8325
val Loss: 0.2546 Acc: 0.8182
Epoch 80/94
----------
train Loss: 0.2774 Acc: 0.8373
val Loss: 0.2543 Acc: 0.8636
Epoch 81/94
----------
train Loss: 0.3197 Acc: 0.7847
val Loss: 0.2634 Acc: 0.7955
Epoch 82/94
----------
train Loss: 0.2754 Acc: 0.8373
val Loss: 0.2661 Acc: 0.7955
Epoch 83/94
----------
train Loss: 0.2373 Acc: 0.9474
val Loss: 0.2671 Acc: 0.7955
Epoch 84/94
----------
train Loss: 0.3154 Acc: 0.7799
val Loss: 0.2639 Acc: 0.7500
Epoch 85/94
----------
train Loss: 0.2508 Acc: 0.8134
[32m[I 2025-06-29 19:29:17,178][0m Trial 192 finished with value: 0.8636363636363636 and parameters: {'batch_size': 19, 'lr': 5.1247835316854504e-05, 'num_epochs': 94, 'weight_decay': 0.0008118659407528943, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2628 Acc: 0.7500
Early stopping at epoch 85 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.863636

Model weights saved at ./model_weights/efficientnetb0_bs_19_lr_5.1247835316854504e-05_epoch_94_wd_0.0008118659407528943_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/92
----------
train Loss: 3.8377 Acc: 0.2201
val Loss: 3.7195 Acc: 0.1591
Epoch 2/92
----------
train Loss: 3.8151 Acc: 0.2201
val Loss: 3.7234 Acc: 0.2045
Epoch 3/92
----------
train Loss: 3.7939 Acc: 0.2201
val Loss: 3.6906 Acc: 0.1591
Epoch 4/92
----------
train Loss: 3.8041 Acc: 0.2105
val Loss: 3.6949 Acc: 0.1591
Epoch 5/92
----------
train Loss: 3.8199 Acc: 0.1818
val Loss: 3.7143 Acc: 0.1591
Epoch 6/92
----------
train Loss: 3.8031 Acc: 0.2105
val Loss: 3.7164 Acc: 0.2045
Epoch 7/92
----------
train Loss: 3.8029 Acc: 0.1962
val Loss: 3.7088 Acc: 0.2045
Epoch 8/92
----------
train Loss: 3.7775 Acc: 0.2057
val Loss: 3.7196 Acc: 0.2273
Epoch 9/92
----------
train Loss: 3.7894 Acc: 0.2536
val Loss: 3.7142 Acc: 0.1818
Epoch 10/92
----------
train Loss: 3.7595 Acc: 0.2057
val Loss: 3.7153 Acc: 0.1818
Epoch 11/92
----------
train Loss: 3.7707 Acc: 0.2153
val Loss: 3.7129 Acc: 0.1818
Epoch 12/92
----------
train Loss: 3.7677 Acc: 0.2105
val Loss: 3.7077 Acc: 0.1818
Epoch 13/92
----------
train Loss: 3.7461 Acc: 0.2536
val Loss: 3.6936 Acc: 0.2045
Epoch 14/92
----------
train Loss: 3.7496 Acc: 0.2153
val Loss: 3.6937 Acc: 0.2045
Epoch 15/92
----------
train Loss: 3.7283 Acc: 0.2967
val Loss: 3.7028 Acc: 0.1818
Epoch 16/92
----------
train Loss: 3.7189 Acc: 0.2488
val Loss: 3.6693 Acc: 0.2273
Epoch 17/92
----------
train Loss: 3.7294 Acc: 0.2249
val Loss: 3.6818 Acc: 0.2045
Epoch 18/92
----------
train Loss: 3.7433 Acc: 0.2488
val Loss: 3.6722 Acc: 0.2045
Epoch 19/92
----------
train Loss: 3.7114 Acc: 0.2584
val Loss: 3.6602 Acc: 0.2273
Epoch 20/92
----------
train Loss: 3.6986 Acc: 0.2584
val Loss: 3.6628 Acc: 0.2273
Epoch 21/92
----------
train Loss: 3.6980 Acc: 0.2584
val Loss: 3.6607 Acc: 0.2500
Epoch 22/92
----------
train Loss: 3.7099 Acc: 0.2201
val Loss: 3.6623 Acc: 0.2500
Epoch 23/92
----------
train Loss: 3.6872 Acc: 0.2249
val Loss: 3.6519 Acc: 0.2273
Epoch 24/92
----------
train Loss: 3.6660 Acc: 0.3014
val Loss: 3.6284 Acc: 0.2273
Epoch 25/92
----------
train Loss: 3.6765 Acc: 0.3301
val Loss: 3.6418 Acc: 0.2500
Epoch 26/92
----------
train Loss: 3.6751 Acc: 0.2727
val Loss: 3.6465 Acc: 0.2273
Epoch 27/92
----------
train Loss: 3.6685 Acc: 0.2727
val Loss: 3.6200 Acc: 0.2273
Epoch 28/92
----------
train Loss: 3.6904 Acc: 0.2440
val Loss: 3.6156 Acc: 0.2500
Epoch 29/92
----------
train Loss: 3.6683 Acc: 0.2775
val Loss: 3.6219 Acc: 0.2500
Epoch 30/92
----------
train Loss: 3.6732 Acc: 0.2727
val Loss: 3.6167 Acc: 0.2500
Epoch 31/92
----------
train Loss: 3.6338 Acc: 0.2727
val Loss: 3.6037 Acc: 0.2500
Epoch 32/92
----------
train Loss: 3.6347 Acc: 0.3445
val Loss: 3.6107 Acc: 0.2273
Epoch 33/92
----------
train Loss: 3.6369 Acc: 0.2201
val Loss: 3.6098 Acc: 0.2273
Epoch 34/92
----------
train Loss: 3.6252 Acc: 0.2632
val Loss: 3.6139 Acc: 0.2273
Epoch 35/92
----------
train Loss: 3.6141 Acc: 0.2775
val Loss: 3.6059 Acc: 0.2045
Epoch 36/92
----------
train Loss: 3.6309 Acc: 0.2584
val Loss: 3.6008 Acc: 0.2500
Epoch 37/92
----------
train Loss: 3.6201 Acc: 0.2967
val Loss: 3.5787 Acc: 0.2500
Epoch 38/92
----------
train Loss: 3.6034 Acc: 0.2679
val Loss: 3.5740 Acc: 0.2500
Epoch 39/92
----------
train Loss: 3.6075 Acc: 0.2967
val Loss: 3.5782 Acc: 0.2500
Epoch 40/92
----------
train Loss: 3.5981 Acc: 0.3397
val Loss: 3.5621 Acc: 0.2727
Epoch 41/92
----------
train Loss: 3.5947 Acc: 0.2727
val Loss: 3.5544 Acc: 0.2727
Epoch 42/92
----------
train Loss: 3.5724 Acc: 0.2967
val Loss: 3.5527 Acc: 0.2500
Epoch 43/92
----------
train Loss: 3.5846 Acc: 0.2919
val Loss: 3.5484 Acc: 0.2273
Epoch 44/92
----------
train Loss: 3.5724 Acc: 0.2584
val Loss: 3.5308 Acc: 0.2727
Epoch 45/92
----------
train Loss: 3.5569 Acc: 0.3062
val Loss: 3.5095 Acc: 0.2727
Epoch 46/92
----------
train Loss: 3.5744 Acc: 0.3636
val Loss: 3.5350 Acc: 0.2955
Epoch 47/92
----------
train Loss: 3.5517 Acc: 0.2679
val Loss: 3.5225 Acc: 0.2727
Epoch 48/92
----------
train Loss: 3.5532 Acc: 0.3589
val Loss: 3.4998 Acc: 0.2727
Epoch 49/92
----------
train Loss: 3.5295 Acc: 0.3493
val Loss: 3.5009 Acc: 0.2955
Epoch 50/92
----------
train Loss: 3.5372 Acc: 0.2919
val Loss: 3.5048 Acc: 0.2955
Epoch 51/92
----------
train Loss: 3.5283 Acc: 0.2967
val Loss: 3.4720 Acc: 0.3182
Epoch 52/92
----------
train Loss: 3.5240 Acc: 0.3301
val Loss: 3.4836 Acc: 0.3409
Epoch 53/92
----------
train Loss: 3.5359 Acc: 0.2919
val Loss: 3.4950 Acc: 0.3182
Epoch 54/92
----------
train Loss: 3.4895 Acc: 0.3684
val Loss: 3.4914 Acc: 0.3182
Epoch 55/92
----------
train Loss: 3.4945 Acc: 0.3301
val Loss: 3.4681 Acc: 0.3409
Epoch 56/92
----------
train Loss: 3.5074 Acc: 0.3349
val Loss: 3.4927 Acc: 0.2955
Epoch 57/92
----------
train Loss: 3.5090 Acc: 0.3541
val Loss: 3.4789 Acc: 0.2727
Epoch 58/92
----------
train Loss: 3.4880 Acc: 0.3541
val Loss: 3.4815 Acc: 0.3409
Epoch 59/92
----------
train Loss: 3.4560 Acc: 0.3732
val Loss: 3.4778 Acc: 0.3182
Epoch 60/92
----------
train Loss: 3.4915 Acc: 0.3206
val Loss: 3.4680 Acc: 0.3409
Epoch 61/92
----------
train Loss: 3.4963 Acc: 0.3589
val Loss: 3.4638 Acc: 0.3182
Epoch 62/92
----------
train Loss: 3.4500 Acc: 0.3732
val Loss: 3.4539 Acc: 0.3182
Epoch 63/92
----------
train Loss: 3.4527 Acc: 0.3493
val Loss: 3.4560 Acc: 0.3409
Epoch 64/92
----------
train Loss: 3.4505 Acc: 0.3301
val Loss: 3.4673 Acc: 0.2955
Epoch 65/92
----------
train Loss: 3.4459 Acc: 0.4019
val Loss: 3.4563 Acc: 0.3182
Epoch 66/92
----------
train Loss: 3.4600 Acc: 0.3493
val Loss: 3.4254 Acc: 0.3409
Epoch 67/92
----------
train Loss: 3.4541 Acc: 0.3636
val Loss: 3.4158 Acc: 0.3409
Epoch 68/92
----------
train Loss: 3.4409 Acc: 0.3397
val Loss: 3.3980 Acc: 0.3636
Epoch 69/92
----------
train Loss: 3.4437 Acc: 0.3206
val Loss: 3.4067 Acc: 0.3182
Epoch 70/92
----------
train Loss: 3.4331 Acc: 0.3780
val Loss: 3.4017 Acc: 0.3636
Epoch 71/92
----------
train Loss: 3.4418 Acc: 0.3301
val Loss: 3.4043 Acc: 0.3636
Epoch 72/92
----------
train Loss: 3.4108 Acc: 0.3589
val Loss: 3.4214 Acc: 0.3409
Epoch 73/92
----------
train Loss: 3.4065 Acc: 0.4115
val Loss: 3.3758 Acc: 0.4091
Epoch 74/92
----------
train Loss: 3.4269 Acc: 0.3780
val Loss: 3.3809 Acc: 0.3864
Epoch 75/92
----------
train Loss: 3.3834 Acc: 0.4163
val Loss: 3.3755 Acc: 0.4091
Epoch 76/92
----------
train Loss: 3.3932 Acc: 0.3828
val Loss: 3.4058 Acc: 0.3636
Epoch 77/92
----------
train Loss: 3.3931 Acc: 0.3684
val Loss: 3.4083 Acc: 0.3409
Epoch 78/92
----------
train Loss: 3.3817 Acc: 0.3684
val Loss: 3.3939 Acc: 0.3636
Epoch 79/92
----------
train Loss: 3.3713 Acc: 0.4115
val Loss: 3.3999 Acc: 0.3864
Epoch 80/92
----------
train Loss: 3.3526 Acc: 0.4019
val Loss: 3.3840 Acc: 0.4318
Epoch 81/92
----------
train Loss: 3.4096 Acc: 0.3684
val Loss: 3.3962 Acc: 0.3864
Epoch 82/92
----------
train Loss: 3.3496 Acc: 0.4306
val Loss: 3.3788 Acc: 0.4091
Epoch 83/92
----------
train Loss: 3.3477 Acc: 0.4258
val Loss: 3.3579 Acc: 0.3864
Epoch 84/92
----------
train Loss: 3.3609 Acc: 0.4163
val Loss: 3.3616 Acc: 0.3636
Epoch 85/92
----------
train Loss: 3.3487 Acc: 0.3923
val Loss: 3.3432 Acc: 0.3636
Epoch 86/92
----------
train Loss: 3.3571 Acc: 0.3636
val Loss: 3.3333 Acc: 0.3864
Epoch 87/92
----------
train Loss: 3.2928 Acc: 0.4354
val Loss: 3.3228 Acc: 0.3864
Epoch 88/92
----------
train Loss: 3.3462 Acc: 0.3589
val Loss: 3.3335 Acc: 0.3864
Epoch 89/92
----------
train Loss: 3.3307 Acc: 0.4211
val Loss: 3.3488 Acc: 0.3864
Epoch 90/92
----------
train Loss: 3.3172 Acc: 0.4115
val Loss: 3.3406 Acc: 0.4545
Epoch 91/92
----------
train Loss: 3.3023 Acc: 0.4067
val Loss: 3.3146 Acc: 0.4773
Epoch 92/92
----------
train Loss: 3.3100 Acc: 0.4545
[32m[I 2025-06-29 19:50:12,758][0m Trial 193 finished with value: 0.5 and parameters: {'batch_size': 102, 'lr': 1.8533968709217595e-06, 'num_epochs': 92, 'weight_decay': 0.0009204455429431248, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 3.2700 Acc: 0.5000
Best val Acc: 0.500000

Model weights saved at ./model_weights/efficientnetb0_bs_102_lr_1.8533968709217595e-06_epoch_92_wd_0.0009204455429431248_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/76
----------
train Loss: 3.4023 Acc: 0.3493
val Loss: 2.8703 Acc: 0.6136
Epoch 2/76
----------
train Loss: 2.6060 Acc: 0.5502
val Loss: 1.9714 Acc: 0.6364
Epoch 3/76
----------
train Loss: 2.2489 Acc: 0.5167
val Loss: 1.8064 Acc: 0.6364
Epoch 4/76
----------
train Loss: 2.1383 Acc: 0.5359
val Loss: 1.6401 Acc: 0.7500
Epoch 5/76
----------
train Loss: 2.0593 Acc: 0.6651
val Loss: 1.5131 Acc: 0.7500
Epoch 6/76
----------
train Loss: 1.8613 Acc: 0.6651
val Loss: 1.3782 Acc: 0.7727
Epoch 7/76
----------
train Loss: 1.6557 Acc: 0.8038
val Loss: 1.2914 Acc: 0.8409
Epoch 8/76
----------
train Loss: 1.7528 Acc: 0.7560
val Loss: 1.2962 Acc: 0.7500
Epoch 9/76
----------
train Loss: 1.7522 Acc: 0.7512
val Loss: 1.3968 Acc: 0.7273
Epoch 10/76
----------
train Loss: 1.0779 Acc: 0.9522
val Loss: 1.2415 Acc: 0.8409
Epoch 11/76
----------
train Loss: 1.6960 Acc: 0.7943
val Loss: 1.1587 Acc: 0.8182
Epoch 12/76
----------
train Loss: 1.4770 Acc: 0.7560
val Loss: 1.3758 Acc: 0.7955
Epoch 13/76
----------
train Loss: 1.3159 Acc: 0.8995
val Loss: 1.3659 Acc: 0.8182
Epoch 14/76
----------
train Loss: 1.2348 Acc: 0.8373
val Loss: 1.3076 Acc: 0.7500
Epoch 15/76
----------
train Loss: 1.3686 Acc: 0.8325
val Loss: 1.1360 Acc: 0.8182
Epoch 16/76
----------
train Loss: 1.4305 Acc: 0.8182
val Loss: 1.2274 Acc: 0.8182
Epoch 17/76
----------
train Loss: 1.3775 Acc: 0.8660
val Loss: 1.3191 Acc: 0.7955
Epoch 18/76
----------
train Loss: 1.2957 Acc: 0.8373
val Loss: 1.3449 Acc: 0.7727
Epoch 19/76
----------
train Loss: 1.2312 Acc: 0.9091
val Loss: 1.2436 Acc: 0.7727
Epoch 20/76
----------
train Loss: 1.2853 Acc: 0.8804
val Loss: 1.1704 Acc: 0.8182
Epoch 21/76
----------
train Loss: 1.3852 Acc: 0.9139
val Loss: 1.1443 Acc: 0.8864
Epoch 22/76
----------
train Loss: 1.2276 Acc: 0.8947
val Loss: 1.1498 Acc: 0.8409
Epoch 23/76
----------
train Loss: 1.4858 Acc: 0.8804
val Loss: 1.1679 Acc: 0.7955
Epoch 24/76
----------
train Loss: 1.0370 Acc: 0.9426
val Loss: 1.1781 Acc: 0.8409
Epoch 25/76
----------
train Loss: 1.2314 Acc: 0.9426
val Loss: 1.2421 Acc: 0.8182
Epoch 26/76
----------
train Loss: 1.4020 Acc: 0.9617
val Loss: 1.2442 Acc: 0.8182
Epoch 27/76
----------
train Loss: 1.1345 Acc: 0.9761
val Loss: 1.3122 Acc: 0.8182
Epoch 28/76
----------
train Loss: 1.3349 Acc: 0.8708
val Loss: 1.2169 Acc: 0.8182
Epoch 29/76
----------
train Loss: 1.4217 Acc: 0.8086
val Loss: 1.1083 Acc: 0.7955
Epoch 30/76
----------
train Loss: 1.2305 Acc: 0.8708
val Loss: 1.0332 Acc: 0.7727
Epoch 31/76
----------
train Loss: 1.0727 Acc: 0.9426
val Loss: 1.0953 Acc: 0.7955
Epoch 32/76
----------
train Loss: 1.2004 Acc: 0.9091
val Loss: 1.0765 Acc: 0.7955
Epoch 33/76
----------
train Loss: 1.2988 Acc: 0.8995
val Loss: 1.1000 Acc: 0.8182
Epoch 34/76
----------
train Loss: 1.2344 Acc: 0.9665
val Loss: 1.2722 Acc: 0.8182
Epoch 35/76
----------
train Loss: 0.9354 Acc: 0.9761
val Loss: 1.3917 Acc: 0.7727
Epoch 36/76
----------
train Loss: 1.4938 Acc: 0.8612
val Loss: 1.2218 Acc: 0.8182
Epoch 37/76
----------
train Loss: 1.2546 Acc: 0.8230
val Loss: 1.2479 Acc: 0.7955
Epoch 38/76
----------
train Loss: 1.2883 Acc: 0.9569
val Loss: 1.2098 Acc: 0.7955
Epoch 39/76
----------
train Loss: 1.3097 Acc: 0.7799
val Loss: 1.2803 Acc: 0.7727
Epoch 40/76
----------
train Loss: 1.1117 Acc: 0.9187
val Loss: 1.3090 Acc: 0.7727
Epoch 41/76
----------
train Loss: 1.5556 Acc: 0.6986
val Loss: 1.2848 Acc: 0.7727
Epoch 42/76
----------
train Loss: 1.0957 Acc: 0.8995
val Loss: 1.2862 Acc: 0.7045
Epoch 43/76
----------
train Loss: 1.2504 Acc: 0.8852
val Loss: 1.2214 Acc: 0.7500
Epoch 44/76
----------
train Loss: 1.1461 Acc: 0.8947
val Loss: 1.3138 Acc: 0.8182
Epoch 45/76
----------
train Loss: 0.7751 Acc: 0.9665
val Loss: 1.2433 Acc: 0.7955
Epoch 46/76
----------
train Loss: 1.5732 Acc: 0.8086
val Loss: 1.2463 Acc: 0.7955
Epoch 47/76
----------
train Loss: 1.1663 Acc: 0.9234
val Loss: 1.3156 Acc: 0.7500
Epoch 48/76
----------
train Loss: 1.2852 Acc: 0.8517
val Loss: 1.4009 Acc: 0.7500
Epoch 49/76
----------
train Loss: 1.2770 Acc: 0.9426
val Loss: 1.3209 Acc: 0.7727
Epoch 50/76
----------
train Loss: 1.1883 Acc: 0.8852
val Loss: 1.3296 Acc: 0.7727
Epoch 51/76
----------
train Loss: 0.9256 Acc: 1.0000
val Loss: 1.2202 Acc: 0.7955
Epoch 52/76
----------
train Loss: 1.2329 Acc: 0.9091
val Loss: 1.2163 Acc: 0.7955
Epoch 53/76
----------
train Loss: 1.4299 Acc: 0.9522
val Loss: 1.2675 Acc: 0.7500
Epoch 54/76
----------
train Loss: 1.0940 Acc: 0.9569
val Loss: 1.3412 Acc: 0.7500
Epoch 55/76
----------
train Loss: 1.1693 Acc: 0.9569
val Loss: 1.4813 Acc: 0.6818
Epoch 56/76
----------
train Loss: 1.3436 Acc: 0.9282
val Loss: 1.3544 Acc: 0.7273
Epoch 57/76
----------
train Loss: 1.4175 Acc: 0.8756
val Loss: 1.3909 Acc: 0.7727
Epoch 58/76
----------
train Loss: 1.1744 Acc: 0.8565
val Loss: 1.3527 Acc: 0.7500
Epoch 59/76
----------
train Loss: 1.2042 Acc: 0.9234
val Loss: 1.5031 Acc: 0.7273
Epoch 60/76
----------
train Loss: 1.0072 Acc: 0.9043
val Loss: 1.4951 Acc: 0.7273
Epoch 61/76
----------
train Loss: 1.3904 Acc: 0.8182
val Loss: 1.4636 Acc: 0.6591
Epoch 62/76
----------
train Loss: 1.3499 Acc: 0.9474
val Loss: 1.4540 Acc: 0.6818
Epoch 63/76
----------
train Loss: 1.1660 Acc: 0.9569
val Loss: 1.4922 Acc: 0.6818
Epoch 64/76
----------
train Loss: 1.0576 Acc: 0.9522
val Loss: 1.6283 Acc: 0.7273
Epoch 65/76
----------
train Loss: 1.1992 Acc: 0.8900
val Loss: 1.4781 Acc: 0.7045
Epoch 66/76
----------
train Loss: 1.1919 Acc: 0.9091
val Loss: 1.5372 Acc: 0.7273
Epoch 67/76
----------
train Loss: 1.3590 Acc: 0.8517
val Loss: 1.5594 Acc: 0.7500
Epoch 68/76
----------
train Loss: 1.1389 Acc: 0.8900
val Loss: 1.5507 Acc: 0.7955
Epoch 69/76
----------
train Loss: 1.0860 Acc: 0.8804
val Loss: 1.4746 Acc: 0.7955
Epoch 70/76
----------
train Loss: 1.2677 Acc: 0.9043
val Loss: 1.3757 Acc: 0.7955
Epoch 71/76
----------
train Loss: 1.3029 Acc: 0.9139
val Loss: 1.3896 Acc: 0.7955
Epoch 72/76
----------
train Loss: 1.3123 Acc: 0.8947
val Loss: 1.3957 Acc: 0.8409
Epoch 73/76
----------
train Loss: 0.9728 Acc: 0.9617
val Loss: 1.4311 Acc: 0.7955
Epoch 74/76
----------
train Loss: 1.3226 Acc: 0.8995
val Loss: 1.4305 Acc: 0.7727
Epoch 75/76
----------
train Loss: 1.0719 Acc: 0.9713
val Loss: 1.4743 Acc: 0.7955
Epoch 76/76
----------
train Loss: 1.0974 Acc: 0.8660
[32m[I 2025-06-29 20:07:30,570][0m Trial 194 finished with value: 0.7954545454545455 and parameters: {'batch_size': 19, 'lr': 0.000394931773913327, 'num_epochs': 76, 'weight_decay': 0.0030625980557548635, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.2573 Acc: 0.7955
Best val Acc: 0.795455

Model weights saved at ./model_weights/efficientnetb0_bs_19_lr_0.000394931773913327_epoch_76_wd_0.0030625980557548635_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/79
----------
train Loss: 3.0173 Acc: 0.4115
val Loss: 2.0446 Acc: 0.6364
Epoch 2/79
----------
train Loss: 2.3858 Acc: 0.5455
val Loss: 1.9846 Acc: 0.6364
Epoch 3/79
----------
train Loss: 2.0768 Acc: 0.6411
val Loss: 1.9641 Acc: 0.7273
Epoch 4/79
----------
train Loss: 2.0022 Acc: 0.6459
val Loss: 1.9333 Acc: 0.7727
Epoch 5/79
----------
train Loss: 1.8041 Acc: 0.7751
val Loss: 1.4985 Acc: 0.8182
Epoch 6/79
----------
train Loss: 1.7397 Acc: 0.7608
val Loss: 1.9497 Acc: 0.7500
Epoch 7/79
----------
train Loss: 1.5543 Acc: 0.8421
val Loss: 1.8328 Acc: 0.7045
Epoch 8/79
----------
train Loss: 1.7377 Acc: 0.7416
val Loss: 1.8849 Acc: 0.7727
Epoch 9/79
----------
train Loss: 1.7545 Acc: 0.7703
val Loss: 2.3369 Acc: 0.7045
Epoch 10/79
----------
train Loss: 1.1303 Acc: 0.9426
val Loss: 1.5784 Acc: 0.7500
Epoch 11/79
----------
train Loss: 1.8052 Acc: 0.7512
val Loss: 1.6991 Acc: 0.7955
Epoch 12/79
----------
train Loss: 1.5919 Acc: 0.7368
val Loss: 2.2926 Acc: 0.7273
Epoch 13/79
----------
train Loss: 1.4820 Acc: 0.8421
val Loss: 2.3230 Acc: 0.6591
Epoch 14/79
----------
train Loss: 1.4298 Acc: 0.7943
val Loss: 1.7815 Acc: 0.6818
Epoch 15/79
----------
train Loss: 1.6057 Acc: 0.7703
val Loss: 2.0192 Acc: 0.7727
Epoch 16/79
----------
train Loss: 1.7022 Acc: 0.7847
val Loss: 2.4634 Acc: 0.6591
Epoch 17/79
----------
train Loss: 1.4720 Acc: 0.8182
val Loss: 1.8853 Acc: 0.6136
Epoch 18/79
----------
train Loss: 1.4467 Acc: 0.8086
val Loss: 1.6017 Acc: 0.7045
Epoch 19/79
----------
train Loss: 1.3348 Acc: 0.9091
val Loss: 1.2975 Acc: 0.7955
Epoch 20/79
----------
train Loss: 1.3957 Acc: 0.8708
val Loss: 1.3871 Acc: 0.7500
Epoch 21/79
----------
train Loss: 1.4846 Acc: 0.9091
val Loss: 1.7162 Acc: 0.7500
Epoch 22/79
----------
train Loss: 1.4271 Acc: 0.8421
val Loss: 1.5950 Acc: 0.7045
Epoch 23/79
----------
train Loss: 1.6239 Acc: 0.8182
val Loss: 1.4023 Acc: 0.7500
Epoch 24/79
----------
train Loss: 1.1957 Acc: 0.9043
val Loss: 1.6823 Acc: 0.7273
Epoch 25/79
----------
train Loss: 1.4368 Acc: 0.9139
val Loss: 1.8982 Acc: 0.7273
Epoch 26/79
----------
train Loss: 1.5037 Acc: 0.8852
val Loss: 1.6429 Acc: 0.6818
Epoch 27/79
----------
train Loss: 1.3093 Acc: 0.9234
val Loss: 1.7188 Acc: 0.7273
Epoch 28/79
----------
train Loss: 1.4346 Acc: 0.8038
val Loss: 1.5409 Acc: 0.7273
Epoch 29/79
----------
train Loss: 1.6176 Acc: 0.7703
val Loss: 1.6147 Acc: 0.7273
Epoch 30/79
----------
train Loss: 1.4821 Acc: 0.7751
val Loss: 1.4024 Acc: 0.7955
Epoch 31/79
----------
train Loss: 1.2000 Acc: 0.9426
val Loss: 1.7623 Acc: 0.6591
Epoch 32/79
----------
train Loss: 1.4013 Acc: 0.8517
val Loss: 1.5548 Acc: 0.6818
Epoch 33/79
----------
train Loss: 1.5087 Acc: 0.7990
val Loss: 1.4952 Acc: 0.7500
Epoch 34/79
----------
train Loss: 1.3944 Acc: 0.9139
val Loss: 1.7561 Acc: 0.6818
Epoch 35/79
----------
train Loss: 1.1201 Acc: 0.9378
val Loss: 1.5288 Acc: 0.7727
Epoch 36/79
----------
train Loss: 1.6334 Acc: 0.8325
val Loss: 1.5554 Acc: 0.7273
Epoch 37/79
----------
train Loss: 1.4585 Acc: 0.8182
val Loss: 1.6057 Acc: 0.8409
Epoch 38/79
----------
train Loss: 1.4566 Acc: 0.9187
val Loss: 1.5261 Acc: 0.7273
Epoch 39/79
----------
train Loss: 1.5033 Acc: 0.7608
val Loss: 2.3206 Acc: 0.5455
Epoch 40/79
----------
train Loss: 1.3638 Acc: 0.8804
val Loss: 1.6293 Acc: 0.6818
Epoch 41/79
----------
train Loss: 1.7284 Acc: 0.6938
val Loss: 1.7620 Acc: 0.6591
Epoch 42/79
----------
train Loss: 1.4494 Acc: 0.8038
[32m[I 2025-06-29 20:17:03,330][0m Trial 195 finished with value: 0.8409090909090909 and parameters: {'batch_size': 90, 'lr': 0.0010351678399857008, 'num_epochs': 79, 'weight_decay': 0.011505322154865622, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.7215 Acc: 0.6818
Early stopping at epoch 42 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.840909

Model weights saved at ./model_weights/efficientnetb0_bs_90_lr_0.0010351678399857008_epoch_79_wd_0.011505322154865622_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/91
----------
train Loss: 0.6904 Acc: 0.2440
val Loss: 0.6687 Acc: 0.2955
Epoch 2/91
----------
train Loss: 0.6545 Acc: 0.3541
val Loss: 0.6389 Acc: 0.4091
Epoch 3/91
----------
train Loss: 0.6253 Acc: 0.4211
val Loss: 0.5986 Acc: 0.4318
Epoch 4/91
----------
train Loss: 0.6030 Acc: 0.4641
val Loss: 0.5695 Acc: 0.5682
Epoch 5/91
----------
train Loss: 0.5850 Acc: 0.5167
val Loss: 0.5488 Acc: 0.6136
Epoch 6/91
----------
train Loss: 0.5579 Acc: 0.5263
val Loss: 0.5212 Acc: 0.6591
Epoch 7/91
----------
train Loss: 0.5302 Acc: 0.5742
val Loss: 0.4931 Acc: 0.6591
Epoch 8/91
----------
train Loss: 0.5208 Acc: 0.5407
val Loss: 0.4682 Acc: 0.6818
Epoch 9/91
----------
train Loss: 0.5039 Acc: 0.5550
val Loss: 0.4463 Acc: 0.6818
Epoch 10/91
----------
train Loss: 0.4602 Acc: 0.5933
val Loss: 0.4278 Acc: 0.6818
Epoch 11/91
----------
train Loss: 0.4721 Acc: 0.5694
val Loss: 0.4119 Acc: 0.7045
Epoch 12/91
----------
train Loss: 0.4714 Acc: 0.5742
val Loss: 0.4048 Acc: 0.7045
Epoch 13/91
----------
train Loss: 0.4364 Acc: 0.6411
val Loss: 0.3877 Acc: 0.7045
Epoch 14/91
----------
train Loss: 0.4141 Acc: 0.6603
val Loss: 0.3748 Acc: 0.7273
Epoch 15/91
----------
train Loss: 0.4254 Acc: 0.6364
val Loss: 0.3646 Acc: 0.7727
Epoch 16/91
----------
train Loss: 0.4164 Acc: 0.6794
val Loss: 0.3571 Acc: 0.7500
Epoch 17/91
----------
train Loss: 0.4047 Acc: 0.7225
val Loss: 0.3504 Acc: 0.7500
Epoch 18/91
----------
train Loss: 0.3881 Acc: 0.7033
val Loss: 0.3392 Acc: 0.7500
Epoch 19/91
----------
train Loss: 0.3683 Acc: 0.7751
val Loss: 0.3334 Acc: 0.7727
Epoch 20/91
----------
train Loss: 0.3809 Acc: 0.7512
val Loss: 0.3222 Acc: 0.7727
Epoch 21/91
----------
train Loss: 0.3804 Acc: 0.7560
val Loss: 0.3123 Acc: 0.7955
Epoch 22/91
----------
train Loss: 0.3680 Acc: 0.7368
val Loss: 0.3086 Acc: 0.7955
Epoch 23/91
----------
train Loss: 0.3662 Acc: 0.7608
val Loss: 0.3015 Acc: 0.7955
Epoch 24/91
----------
train Loss: 0.3223 Acc: 0.8373
val Loss: 0.2872 Acc: 0.7955
Epoch 25/91
----------
train Loss: 0.3470 Acc: 0.7895
val Loss: 0.2904 Acc: 0.8182
Epoch 26/91
----------
train Loss: 0.3534 Acc: 0.8182
val Loss: 0.2909 Acc: 0.8409
Epoch 27/91
----------
train Loss: 0.2999 Acc: 0.9091
val Loss: 0.2932 Acc: 0.8182
Epoch 28/91
----------
train Loss: 0.3525 Acc: 0.7847
val Loss: 0.2913 Acc: 0.7500
Epoch 29/91
----------
train Loss: 0.3750 Acc: 0.7225
val Loss: 0.2924 Acc: 0.7727
Epoch 30/91
----------
train Loss: 0.3320 Acc: 0.7703
val Loss: 0.2828 Acc: 0.7955
Epoch 31/91
----------
train Loss: 0.2882 Acc: 0.8995
val Loss: 0.2729 Acc: 0.8182
Epoch 32/91
----------
train Loss: 0.3156 Acc: 0.8086
val Loss: 0.2680 Acc: 0.7955
Epoch 33/91
----------
train Loss: 0.3345 Acc: 0.8182
val Loss: 0.2677 Acc: 0.7955
Epoch 34/91
----------
train Loss: 0.3097 Acc: 0.8517
val Loss: 0.2684 Acc: 0.7955
Epoch 35/91
----------
train Loss: 0.2567 Acc: 0.9569
val Loss: 0.2753 Acc: 0.7727
Epoch 36/91
----------
train Loss: 0.3551 Acc: 0.7703
val Loss: 0.2744 Acc: 0.7727
Epoch 37/91
----------
train Loss: 0.2953 Acc: 0.8278
val Loss: 0.2791 Acc: 0.7500
Epoch 38/91
----------
train Loss: 0.2947 Acc: 0.9330
val Loss: 0.2708 Acc: 0.7727
Epoch 39/91
----------
train Loss: 0.3263 Acc: 0.7273
val Loss: 0.2762 Acc: 0.7727
Epoch 40/91
----------
train Loss: 0.2674 Acc: 0.8900
val Loss: 0.2740 Acc: 0.7955
Epoch 41/91
----------
train Loss: 0.3490 Acc: 0.7368
val Loss: 0.2674 Acc: 0.8182
Epoch 42/91
----------
train Loss: 0.2691 Acc: 0.8278
val Loss: 0.2602 Acc: 0.7955
Epoch 43/91
----------
train Loss: 0.2928 Acc: 0.8469
val Loss: 0.2585 Acc: 0.7955
Epoch 44/91
----------
train Loss: 0.2735 Acc: 0.8612
val Loss: 0.2616 Acc: 0.8182
Epoch 45/91
----------
train Loss: 0.1751 Acc: 0.9665
val Loss: 0.2625 Acc: 0.8409
Epoch 46/91
----------
train Loss: 0.3629 Acc: 0.8134
val Loss: 0.2671 Acc: 0.8182
Epoch 47/91
----------
train Loss: 0.2622 Acc: 0.8804
val Loss: 0.2617 Acc: 0.8182
Epoch 48/91
----------
train Loss: 0.2982 Acc: 0.8373
val Loss: 0.2649 Acc: 0.7727
Epoch 49/91
----------
train Loss: 0.2804 Acc: 0.9282
val Loss: 0.2651 Acc: 0.7955
Epoch 50/91
----------
train Loss: 0.2744 Acc: 0.8660
val Loss: 0.2651 Acc: 0.7727
Epoch 51/91
----------
train Loss: 0.2041 Acc: 0.9856
val Loss: 0.2581 Acc: 0.7727
Epoch 52/91
----------
train Loss: 0.2903 Acc: 0.8086
val Loss: 0.2590 Acc: 0.7500
Epoch 53/91
----------
train Loss: 0.3246 Acc: 0.9139
val Loss: 0.2564 Acc: 0.7955
Epoch 54/91
----------
train Loss: 0.2388 Acc: 0.9282
val Loss: 0.2522 Acc: 0.7955
Epoch 55/91
----------
train Loss: 0.2543 Acc: 0.9330
val Loss: 0.2551 Acc: 0.7727
Epoch 56/91
----------
train Loss: 0.2971 Acc: 0.8947
val Loss: 0.2571 Acc: 0.7727
Epoch 57/91
----------
train Loss: 0.3381 Acc: 0.8134
val Loss: 0.2560 Acc: 0.7955
Epoch 58/91
----------
train Loss: 0.2772 Acc: 0.7943
val Loss: 0.2507 Acc: 0.8182
Epoch 59/91
----------
train Loss: 0.2872 Acc: 0.8852
val Loss: 0.2519 Acc: 0.7955
Epoch 60/91
----------
train Loss: 0.2389 Acc: 0.8756
val Loss: 0.2534 Acc: 0.7727
Epoch 61/91
----------
train Loss: 0.3288 Acc: 0.7703
val Loss: 0.2580 Acc: 0.7727
Epoch 62/91
----------
train Loss: 0.2951 Acc: 0.9522
val Loss: 0.2583 Acc: 0.7727
Epoch 63/91
----------
train Loss: 0.2537 Acc: 0.9378
val Loss: 0.2571 Acc: 0.7727
Epoch 64/91
----------
train Loss: 0.2387 Acc: 0.9474
val Loss: 0.2555 Acc: 0.7955
Epoch 65/91
----------
train Loss: 0.2735 Acc: 0.8230
val Loss: 0.2593 Acc: 0.7727
Epoch 66/91
----------
train Loss: 0.2669 Acc: 0.9043
val Loss: 0.2655 Acc: 0.7727
Epoch 67/91
----------
train Loss: 0.2996 Acc: 0.8708
val Loss: 0.2603 Acc: 0.7955
Epoch 68/91
----------
train Loss: 0.2508 Acc: 0.8947
val Loss: 0.2642 Acc: 0.7955
Epoch 69/91
----------
train Loss: 0.2487 Acc: 0.8900
val Loss: 0.2589 Acc: 0.7727
Epoch 70/91
----------
train Loss: 0.2813 Acc: 0.9091
val Loss: 0.2589 Acc: 0.7727
Epoch 71/91
----------
train Loss: 0.2966 Acc: 0.9091
val Loss: 0.2571 Acc: 0.7500
Epoch 72/91
----------
train Loss: 0.2959 Acc: 0.8947
val Loss: 0.2638 Acc: 0.7500
Epoch 73/91
----------
train Loss: 0.2125 Acc: 0.9617
val Loss: 0.2691 Acc: 0.7500
Epoch 74/91
----------
train Loss: 0.3107 Acc: 0.8612
val Loss: 0.2630 Acc: 0.7500
Epoch 75/91
----------
train Loss: 0.2304 Acc: 0.9569
val Loss: 0.2594 Acc: 0.7500
Epoch 76/91
----------
train Loss: 0.2485 Acc: 0.8278
val Loss: 0.2570 Acc: 0.7500
Epoch 77/91
----------
train Loss: 0.2870 Acc: 0.8612
val Loss: 0.2575 Acc: 0.7955
Epoch 78/91
----------
train Loss: 0.2492 Acc: 0.8852
val Loss: 0.2591 Acc: 0.7955
Epoch 79/91
----------
train Loss: 0.3026 Acc: 0.8708
val Loss: 0.2556 Acc: 0.7955
Epoch 80/91
----------
train Loss: 0.2686 Acc: 0.8421
val Loss: 0.2564 Acc: 0.8409
Epoch 81/91
----------
train Loss: 0.3097 Acc: 0.8038
val Loss: 0.2672 Acc: 0.7955
Epoch 82/91
----------
train Loss: 0.2674 Acc: 0.8373
val Loss: 0.2714 Acc: 0.7955
Epoch 83/91
----------
train Loss: 0.2326 Acc: 0.9761
val Loss: 0.2721 Acc: 0.7955
Epoch 84/91
----------
train Loss: 0.3052 Acc: 0.7751
val Loss: 0.2675 Acc: 0.7727
Epoch 85/91
----------
train Loss: 0.2401 Acc: 0.8325
val Loss: 0.2635 Acc: 0.7955
Epoch 86/91
----------
train Loss: 0.2533 Acc: 0.8804
val Loss: 0.2519 Acc: 0.8409
Epoch 87/91
----------
train Loss: 0.2873 Acc: 0.9043
val Loss: 0.2485 Acc: 0.8182
Epoch 88/91
----------
train Loss: 0.3027 Acc: 0.9043
val Loss: 0.2475 Acc: 0.8409
Epoch 89/91
----------
train Loss: 0.3268 Acc: 0.8230
val Loss: 0.2477 Acc: 0.8409
Epoch 90/91
----------
train Loss: 0.2788 Acc: 0.8708
val Loss: 0.2503 Acc: 0.8182
Epoch 91/91
----------
train Loss: 0.2366 Acc: 0.9569
[32m[I 2025-06-29 20:37:47,830][0m Trial 196 finished with value: 0.7727272727272727 and parameters: {'batch_size': 12, 'lr': 6.649138510424878e-05, 'num_epochs': 91, 'weight_decay': 0.0005151040654573585, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 0.2562 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_12_lr_6.649138510424878e-05_epoch_91_wd_0.0005151040654573585_wlf_False.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/86
----------
train Loss: 3.2768 Acc: 0.3732
val Loss: 2.4998 Acc: 0.6364
Epoch 2/86
----------
train Loss: 2.4415 Acc: 0.5502
val Loss: 1.9697 Acc: 0.6364
Epoch 3/86
----------
train Loss: 2.1653 Acc: 0.5407
val Loss: 1.7138 Acc: 0.6591
Epoch 4/86
----------
train Loss: 2.0534 Acc: 0.5789
val Loss: 1.6210 Acc: 0.7727
Epoch 5/86
----------
train Loss: 1.9518 Acc: 0.7416
val Loss: 1.4518 Acc: 0.8182
Epoch 6/86
----------
train Loss: 1.7968 Acc: 0.7177
val Loss: 1.3367 Acc: 0.8182
Epoch 7/86
----------
train Loss: 1.4989 Acc: 0.8756
val Loss: 1.2408 Acc: 0.7955
Epoch 8/86
----------
train Loss: 1.6788 Acc: 0.7751
val Loss: 1.2619 Acc: 0.7727
Epoch 9/86
----------
train Loss: 1.6761 Acc: 0.7943
val Loss: 1.4488 Acc: 0.8182
Epoch 10/86
----------
train Loss: 1.0167 Acc: 0.9474
val Loss: 1.1634 Acc: 0.7955
Epoch 11/86
----------
train Loss: 1.7334 Acc: 0.7895
val Loss: 1.2623 Acc: 0.7955
Epoch 12/86
----------
train Loss: 1.4634 Acc: 0.7560
val Loss: 1.6100 Acc: 0.7727
Epoch 13/86
----------
train Loss: 1.3331 Acc: 0.8852
val Loss: 1.4519 Acc: 0.8182
Epoch 14/86
----------
train Loss: 1.2335 Acc: 0.8325
val Loss: 1.3862 Acc: 0.7727
Epoch 15/86
----------
train Loss: 1.4081 Acc: 0.8230
val Loss: 1.1485 Acc: 0.8409
Epoch 16/86
----------
train Loss: 1.4182 Acc: 0.8182
val Loss: 1.3259 Acc: 0.8636
Epoch 17/86
----------
train Loss: 1.3687 Acc: 0.8612
val Loss: 1.3753 Acc: 0.7955
Epoch 18/86
----------
train Loss: 1.3137 Acc: 0.8421
val Loss: 1.3354 Acc: 0.7727
Epoch 19/86
----------
train Loss: 1.2108 Acc: 0.9330
val Loss: 1.1753 Acc: 0.7955
Epoch 20/86
----------
train Loss: 1.2926 Acc: 0.8804
val Loss: 1.1822 Acc: 0.8409
Epoch 21/86
----------
train Loss: 1.3898 Acc: 0.9139
val Loss: 1.1265 Acc: 0.8409
Epoch 22/86
----------
train Loss: 1.2484 Acc: 0.8660
val Loss: 1.1878 Acc: 0.8636
Epoch 23/86
----------
train Loss: 1.5006 Acc: 0.8756
val Loss: 1.2765 Acc: 0.8182
Epoch 24/86
----------
train Loss: 1.0855 Acc: 0.9282
val Loss: 1.2650 Acc: 0.8409
Epoch 25/86
----------
train Loss: 1.2244 Acc: 0.9522
val Loss: 1.3374 Acc: 0.8182
Epoch 26/86
----------
train Loss: 1.3961 Acc: 0.9569
val Loss: 1.2579 Acc: 0.8636
Epoch 27/86
----------
train Loss: 1.1369 Acc: 0.9809
val Loss: 1.2916 Acc: 0.8409
Epoch 28/86
----------
train Loss: 1.3702 Acc: 0.8517
val Loss: 1.2185 Acc: 0.8409
Epoch 29/86
----------
train Loss: 1.4154 Acc: 0.8230
val Loss: 1.3224 Acc: 0.8182
Epoch 30/86
----------
train Loss: 1.2404 Acc: 0.8995
val Loss: 1.3228 Acc: 0.7273
Epoch 31/86
----------
train Loss: 1.0944 Acc: 0.9282
val Loss: 1.3069 Acc: 0.7955
Epoch 32/86
----------
train Loss: 1.1921 Acc: 0.8995
val Loss: 1.2455 Acc: 0.7955
Epoch 33/86
----------
train Loss: 1.3257 Acc: 0.8995
val Loss: 1.3835 Acc: 0.7500
Epoch 34/86
----------
train Loss: 1.2542 Acc: 0.9282
val Loss: 1.4218 Acc: 0.7727
Epoch 35/86
----------
train Loss: 0.9729 Acc: 0.9617
val Loss: 1.3477 Acc: 0.7500
Epoch 36/86
----------
train Loss: 1.5025 Acc: 0.8756
val Loss: 1.2875 Acc: 0.7045
Epoch 37/86
----------
train Loss: 1.2942 Acc: 0.8182
val Loss: 1.5166 Acc: 0.7273
Epoch 38/86
----------
train Loss: 1.3386 Acc: 0.9522
val Loss: 1.2806 Acc: 0.6818
Epoch 39/86
----------
train Loss: 1.2755 Acc: 0.7943
val Loss: 1.3205 Acc: 0.7273
Epoch 40/86
----------
train Loss: 1.1595 Acc: 0.9330
val Loss: 1.3772 Acc: 0.7273
Epoch 41/86
----------
train Loss: 1.5675 Acc: 0.7177
val Loss: 1.3466 Acc: 0.7273
Epoch 42/86
----------
train Loss: 1.1250 Acc: 0.8804
val Loss: 1.4109 Acc: 0.6818
Epoch 43/86
----------
train Loss: 1.2688 Acc: 0.8804
val Loss: 1.3808 Acc: 0.8182
Epoch 44/86
----------
train Loss: 1.1859 Acc: 0.8804
val Loss: 1.6078 Acc: 0.7727
Epoch 45/86
----------
train Loss: 0.8106 Acc: 0.9617
val Loss: 1.2375 Acc: 0.7955
Epoch 46/86
----------
train Loss: 1.5980 Acc: 0.8086
val Loss: 1.3257 Acc: 0.7500
Epoch 47/86
----------
train Loss: 1.2183 Acc: 0.9187
val Loss: 1.5466 Acc: 0.6818
Epoch 48/86
----------
train Loss: 1.2733 Acc: 0.8325
val Loss: 1.4850 Acc: 0.7727
Epoch 49/86
----------
train Loss: 1.2615 Acc: 0.9522
val Loss: 1.2674 Acc: 0.7955
Epoch 50/86
----------
train Loss: 1.2309 Acc: 0.8756
val Loss: 1.2877 Acc: 0.7045
Epoch 51/86
----------
train Loss: 0.9610 Acc: 0.9856
val Loss: 1.3332 Acc: 0.7727
Epoch 52/86
----------
train Loss: 1.2567 Acc: 0.8421
val Loss: 1.1173 Acc: 0.7955
Epoch 53/86
----------
train Loss: 1.4368 Acc: 0.9139
val Loss: 1.3000 Acc: 0.7500
Epoch 54/86
----------
train Loss: 1.1261 Acc: 0.9378
val Loss: 1.5020 Acc: 0.7273
Epoch 55/86
----------
train Loss: 1.1787 Acc: 0.9569
val Loss: 1.6883 Acc: 0.7500
Epoch 56/86
----------
train Loss: 1.3576 Acc: 0.9522
val Loss: 1.4932 Acc: 0.7500
Epoch 57/86
----------
train Loss: 1.4586 Acc: 0.8517
val Loss: 1.4978 Acc: 0.7273
Epoch 58/86
----------
train Loss: 1.2041 Acc: 0.8421
val Loss: 1.5613 Acc: 0.7045
Epoch 59/86
----------
train Loss: 1.2769 Acc: 0.9043
val Loss: 1.6218 Acc: 0.6591
Epoch 60/86
----------
train Loss: 1.0269 Acc: 0.9091
val Loss: 1.4868 Acc: 0.7727
Epoch 61/86
----------
train Loss: 1.4295 Acc: 0.7943
val Loss: 1.4617 Acc: 0.7727
Epoch 62/86
----------
train Loss: 1.4049 Acc: 0.9378
val Loss: 1.5113 Acc: 0.7045
Epoch 63/86
----------
train Loss: 1.2253 Acc: 0.9522
val Loss: 1.4506 Acc: 0.7045
Epoch 64/86
----------
train Loss: 1.0804 Acc: 0.9474
val Loss: 1.4324 Acc: 0.7045
Epoch 65/86
----------
train Loss: 1.2332 Acc: 0.8852
val Loss: 1.3421 Acc: 0.7045
Epoch 66/86
----------
train Loss: 1.2062 Acc: 0.8947
val Loss: 1.7895 Acc: 0.7727
Epoch 67/86
----------
train Loss: 1.4531 Acc: 0.8421
val Loss: 1.5900 Acc: 0.8182
Epoch 68/86
----------
train Loss: 1.1747 Acc: 0.9091
val Loss: 1.3295 Acc: 0.8182
Epoch 69/86
----------
train Loss: 1.0892 Acc: 0.8804
val Loss: 1.2893 Acc: 0.7955
Epoch 70/86
----------
train Loss: 1.2903 Acc: 0.8995
val Loss: 1.3400 Acc: 0.8182
Epoch 71/86
----------
train Loss: 1.3353 Acc: 0.9043
val Loss: 1.2386 Acc: 0.8182
Epoch 72/86
----------
train Loss: 1.3451 Acc: 0.8900
val Loss: 1.3653 Acc: 0.8182
Epoch 73/86
----------
train Loss: 0.9417 Acc: 0.9617
val Loss: 1.5206 Acc: 0.7955
Epoch 74/86
----------
train Loss: 1.3534 Acc: 0.8565
val Loss: 1.4572 Acc: 0.7955
Epoch 75/86
----------
train Loss: 1.1012 Acc: 0.9856
val Loss: 1.3646 Acc: 0.7727
Epoch 76/86
----------
train Loss: 1.0551 Acc: 0.8756
val Loss: 1.3831 Acc: 0.7273
Epoch 77/86
----------
train Loss: 1.3272 Acc: 0.8565
val Loss: 1.3575 Acc: 0.7045
Epoch 78/86
----------
train Loss: 1.2038 Acc: 0.9187
val Loss: 1.4155 Acc: 0.7500
Epoch 79/86
----------
train Loss: 1.3425 Acc: 0.9091
val Loss: 1.3070 Acc: 0.7727
Epoch 80/86
----------
train Loss: 1.2841 Acc: 0.8612
val Loss: 1.4177 Acc: 0.7273
Epoch 81/86
----------
train Loss: 1.4345 Acc: 0.8134
val Loss: 1.4315 Acc: 0.7273
Epoch 82/86
----------
train Loss: 1.2338 Acc: 0.8995
val Loss: 1.3476 Acc: 0.7955
Epoch 83/86
----------
train Loss: 1.1067 Acc: 0.9569
val Loss: 1.4092 Acc: 0.7500
Epoch 84/86
----------
train Loss: 1.3902 Acc: 0.7990
val Loss: 1.4404 Acc: 0.7500
Epoch 85/86
----------
train Loss: 1.0636 Acc: 0.8804
val Loss: 1.6637 Acc: 0.7273
Epoch 86/86
----------
train Loss: 1.1473 Acc: 0.9187
[32m[I 2025-06-29 20:57:20,954][0m Trial 197 finished with value: 0.75 and parameters: {'batch_size': 108, 'lr': 0.0005452597477310494, 'num_epochs': 86, 'weight_decay': 0.004026061746308891, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.4523 Acc: 0.7500
Best val Acc: 0.750000

Model weights saved at ./model_weights/efficientnetb0_bs_108_lr_0.0005452597477310494_epoch_86_wd_0.004026061746308891_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/78
----------
train Loss: 3.1562 Acc: 0.4019
val Loss: 2.5475 Acc: 0.6364
Epoch 2/78
----------
train Loss: 2.3997 Acc: 0.5359
val Loss: 2.0824 Acc: 0.6364
Epoch 3/78
----------
train Loss: 2.1752 Acc: 0.5550
val Loss: 2.7669 Acc: 0.6818
Epoch 4/78
----------
train Loss: 2.0716 Acc: 0.5837
val Loss: 3.0158 Acc: 0.7045
Epoch 5/78
----------
train Loss: 1.9181 Acc: 0.7225
val Loss: 2.5015 Acc: 0.7500
Epoch 6/78
----------
train Loss: 1.7919 Acc: 0.7129
val Loss: 1.8777 Acc: 0.7727
Epoch 7/78
----------
train Loss: 1.5139 Acc: 0.8947
val Loss: 2.5208 Acc: 0.6818
Epoch 8/78
----------
train Loss: 1.7866 Acc: 0.7464
val Loss: 2.2259 Acc: 0.7727
Epoch 9/78
----------
train Loss: 1.7511 Acc: 0.7847
val Loss: 3.2407 Acc: 0.6364
Epoch 10/78
----------
train Loss: 1.1434 Acc: 0.9426
val Loss: 1.8814 Acc: 0.7727
Epoch 11/78
----------
train Loss: 1.8545 Acc: 0.7608
val Loss: 2.5913 Acc: 0.7500
Epoch 12/78
----------
train Loss: 1.6534 Acc: 0.7751
val Loss: 3.5633 Acc: 0.5000
Epoch 13/78
----------
train Loss: 1.5460 Acc: 0.8421
val Loss: 2.7120 Acc: 0.6136
Epoch 14/78
----------
train Loss: 1.4696 Acc: 0.8086
val Loss: 1.7128 Acc: 0.7727
Epoch 15/78
----------
train Loss: 1.5322 Acc: 0.8230
val Loss: 3.2722 Acc: 0.5227
Epoch 16/78
----------
train Loss: 1.6104 Acc: 0.7943
val Loss: 3.4811 Acc: 0.3182
Epoch 17/78
----------
train Loss: 1.5217 Acc: 0.8182
val Loss: 1.5821 Acc: 0.6591
Epoch 18/78
----------
train Loss: 1.4816 Acc: 0.8134
val Loss: 1.4662 Acc: 0.7500
Epoch 19/78
----------
train Loss: 1.3537 Acc: 0.8947
val Loss: 1.6941 Acc: 0.7045
Epoch 20/78
----------
train Loss: 1.5272 Acc: 0.8182
val Loss: 2.0212 Acc: 0.7273
Epoch 21/78
----------
train Loss: 1.5478 Acc: 0.8373
val Loss: 3.4840 Acc: 0.5909
Epoch 22/78
----------
train Loss: 1.4033 Acc: 0.8517
val Loss: 1.9231 Acc: 0.7045
Epoch 23/78
----------
train Loss: 1.7125 Acc: 0.8134
val Loss: 1.6295 Acc: 0.7045
Epoch 24/78
----------
train Loss: 1.2504 Acc: 0.8995
val Loss: 2.3492 Acc: 0.7500
Epoch 25/78
----------
train Loss: 1.4188 Acc: 0.8804
val Loss: 2.1399 Acc: 0.7273
Epoch 26/78
----------
train Loss: 1.5618 Acc: 0.8708
val Loss: 1.7986 Acc: 0.7045
Epoch 27/78
----------
train Loss: 1.3781 Acc: 0.9378
val Loss: 1.9170 Acc: 0.7727
Epoch 28/78
----------
train Loss: 1.5555 Acc: 0.8230
val Loss: 1.4564 Acc: 0.7500
Epoch 29/78
----------
train Loss: 1.5675 Acc: 0.7990
val Loss: 1.6498 Acc: 0.7273
Epoch 30/78
----------
train Loss: 1.4613 Acc: 0.7751
val Loss: 2.2165 Acc: 0.6591
Epoch 31/78
----------
train Loss: 1.1902 Acc: 0.9139
val Loss: 1.6495 Acc: 0.7273
Epoch 32/78
----------
train Loss: 1.4483 Acc: 0.8660
val Loss: 1.6977 Acc: 0.7500
Epoch 33/78
----------
train Loss: 1.5348 Acc: 0.8612
val Loss: 1.7694 Acc: 0.7273
Epoch 34/78
----------
train Loss: 1.4512 Acc: 0.8900
val Loss: 1.7004 Acc: 0.6364
Epoch 35/78
----------
train Loss: 1.0676 Acc: 0.9569
val Loss: 1.8434 Acc: 0.7955
Epoch 36/78
----------
train Loss: 1.6884 Acc: 0.8325
val Loss: 1.6322 Acc: 0.6818
Epoch 37/78
----------
train Loss: 1.6564 Acc: 0.7847
val Loss: 1.7056 Acc: 0.6591
Epoch 38/78
----------
train Loss: 1.5373 Acc: 0.8756
val Loss: 1.5603 Acc: 0.6818
Epoch 39/78
----------
train Loss: 1.4951 Acc: 0.7512
val Loss: 1.6585 Acc: 0.6591
Epoch 40/78
----------
train Loss: 1.3682 Acc: 0.8900
val Loss: 1.5461 Acc: 0.7727
Epoch 41/78
----------
train Loss: 1.7665 Acc: 0.7177
val Loss: 1.7258 Acc: 0.7273
Epoch 42/78
----------
train Loss: 1.3830 Acc: 0.7990
val Loss: 1.5525 Acc: 0.7500
Epoch 43/78
----------
train Loss: 1.4502 Acc: 0.8230
val Loss: 1.5444 Acc: 0.7045
Epoch 44/78
----------
train Loss: 1.3633 Acc: 0.8565
val Loss: 1.5455 Acc: 0.7727
Epoch 45/78
----------
train Loss: 0.8595 Acc: 0.9474
val Loss: 2.0220 Acc: 0.7500
Epoch 46/78
----------
train Loss: 1.8347 Acc: 0.7847
val Loss: 2.2880 Acc: 0.6591
Epoch 47/78
----------
train Loss: 1.5012 Acc: 0.8660
val Loss: 1.5776 Acc: 0.7500
Epoch 48/78
----------
train Loss: 1.3913 Acc: 0.8230
val Loss: 1.9134 Acc: 0.7727
Epoch 49/78
----------
train Loss: 1.5727 Acc: 0.8182
val Loss: 2.0446 Acc: 0.7045
Epoch 50/78
----------
train Loss: 1.5251 Acc: 0.8182
val Loss: 1.6094 Acc: 0.7045
Epoch 51/78
----------
train Loss: 1.0543 Acc: 0.9569
val Loss: 1.4381 Acc: 0.7500
Epoch 52/78
----------
train Loss: 1.4022 Acc: 0.8086
val Loss: 1.5078 Acc: 0.7727
Epoch 53/78
----------
train Loss: 1.6505 Acc: 0.8900
val Loss: 1.8780 Acc: 0.6818
Epoch 54/78
----------
train Loss: 1.2949 Acc: 0.9091
val Loss: 1.8396 Acc: 0.6364
Epoch 55/78
----------
train Loss: 1.3106 Acc: 0.9569
val Loss: 1.7989 Acc: 0.7273
Epoch 56/78
----------
train Loss: 1.4944 Acc: 0.8708
val Loss: 1.8927 Acc: 0.7273
Epoch 57/78
----------
train Loss: 1.7193 Acc: 0.8086
val Loss: 2.5201 Acc: 0.2727
Epoch 58/78
----------
train Loss: 1.4542 Acc: 0.8086
val Loss: 1.8454 Acc: 0.7045
Epoch 59/78
----------
train Loss: 1.5060 Acc: 0.8134
val Loss: 2.0160 Acc: 0.7045
Epoch 60/78
----------
train Loss: 1.1717 Acc: 0.8804
val Loss: 1.5834 Acc: 0.7500
Epoch 61/78
----------
train Loss: 1.6156 Acc: 0.7703
val Loss: 1.8974 Acc: 0.7273
Epoch 62/78
----------
train Loss: 1.7057 Acc: 0.8612
val Loss: 1.4551 Acc: 0.7727
Epoch 63/78
----------
train Loss: 1.3748 Acc: 0.8900
val Loss: 2.6613 Acc: 0.6364
Epoch 64/78
----------
train Loss: 1.2480 Acc: 0.9139
val Loss: 2.7880 Acc: 0.2273
Epoch 65/78
----------
train Loss: 1.4262 Acc: 0.8230
val Loss: 1.5151 Acc: 0.6818
Epoch 66/78
----------
train Loss: 1.4084 Acc: 0.8995
val Loss: 1.8029 Acc: 0.6818
Epoch 67/78
----------
train Loss: 1.6140 Acc: 0.8086
[32m[I 2025-06-29 21:12:36,822][0m Trial 198 finished with value: 0.7727272727272727 and parameters: {'batch_size': 83, 'lr': 0.000817611515875406, 'num_epochs': 78, 'weight_decay': 0.02347942011254659, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 1.5284 Acc: 0.6818
Early stopping at epoch 67 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.772727

Model weights saved at ./model_weights/efficientnetb0_bs_83_lr_0.000817611515875406_epoch_78_wd_0.02347942011254659_wlf_True.pth

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/89
----------
train Loss: 2.9164 Acc: 0.4306
val Loss: 2.8540 Acc: 0.6591
Epoch 2/89
----------
train Loss: 2.4643 Acc: 0.5502
val Loss: 6.6110 Acc: 0.1136
Epoch 3/89
----------
train Loss: 2.1501 Acc: 0.6555
val Loss: 7.7439 Acc: 0.1591
Epoch 4/89
----------
train Loss: 2.1055 Acc: 0.6029
val Loss: 9.0394 Acc: 0.1364
Epoch 5/89
----------
train Loss: 2.0455 Acc: 0.6938
val Loss: 8.8283 Acc: 0.1364
Epoch 6/89
----------
train Loss: 1.9865 Acc: 0.6986
[32m[I 2025-06-29 21:13:59,266][0m Trial 199 finished with value: 0.6590909090909091 and parameters: {'batch_size': 88, 'lr': 0.0017472224917770625, 'num_epochs': 89, 'weight_decay': 0.051840178849497126, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 89 with value: 0.8863636363636364.[0m
val Loss: 8.6804 Acc: 0.1364
Early stopping at epoch 6 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.659091

Model weights saved at ./model_weights/efficientnetb0_bs_88_lr_0.0017472224917770625_epoch_89_wd_0.051840178849497126_wlf_True.pth

Best parameters: {'batch_size': 79, 'lr': 0.000422832210953983, 'num_epochs': 78, 'weight_decay': 0.01605540302060581, 'weight_loss_flag': True, 'mixup_flag': True}
Best score: 0.8863636363636364
Best model is saved at: ./model_weights/efficientNet_bs_79_lr_0.000422832210953983_epoch_78_wd_0.01605540302060581_wlf_True.pth
