Training vitbase16 on auto_selected frames

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/34
----------
train Loss: 2.9205 Acc: 0.4450
val Loss: 2.2036 Acc: 0.6364
Epoch 2/34
----------
train Loss: 2.5325 Acc: 0.5072
val Loss: 1.9846 Acc: 0.6364
Epoch 3/34
----------
train Loss: 2.4924 Acc: 0.5072
val Loss: 1.9207 Acc: 0.6364
Epoch 4/34
----------
train Loss: 2.4033 Acc: 0.5072
val Loss: 1.9075 Acc: 0.6364
Epoch 5/34
----------
train Loss: 2.3704 Acc: 0.5215
val Loss: 1.8773 Acc: 0.6136
Epoch 6/34
----------
train Loss: 2.2281 Acc: 0.5598
val Loss: 1.7651 Acc: 0.7045
Epoch 7/34
----------
train Loss: 2.2939 Acc: 0.5694
val Loss: 1.7731 Acc: 0.6364
Epoch 8/34
----------
train Loss: 2.0625 Acc: 0.6842
val Loss: 1.6629 Acc: 0.6591
Epoch 9/34
----------
train Loss: 1.7622 Acc: 0.7321
val Loss: 1.7153 Acc: 0.6364
Epoch 10/34
----------
train Loss: 1.7952 Acc: 0.7321
val Loss: 1.7365 Acc: 0.6818
Epoch 11/34
----------
train Loss: 1.7951 Acc: 0.6746
val Loss: 1.8766 Acc: 0.6591
Epoch 12/34
----------
train Loss: 2.0004 Acc: 0.7129
val Loss: 1.6757 Acc: 0.6591
Epoch 13/34
----------
train Loss: 1.6605 Acc: 0.7799
val Loss: 1.6906 Acc: 0.7273
Epoch 14/34
----------
train Loss: 1.5868 Acc: 0.8134
val Loss: 1.6249 Acc: 0.6136
Epoch 15/34
----------
train Loss: 1.6698 Acc: 0.7512
val Loss: 1.9304 Acc: 0.5909
Epoch 16/34
----------
train Loss: 1.7968 Acc: 0.8230
val Loss: 2.0322 Acc: 0.6364
Epoch 17/34
----------
train Loss: 1.7057 Acc: 0.7847
val Loss: 1.5811 Acc: 0.7045
Epoch 18/34
----------
train Loss: 1.6791 Acc: 0.7847
val Loss: 1.4190 Acc: 0.7045
Epoch 19/34
----------
train Loss: 1.6758 Acc: 0.7990
val Loss: 1.3926 Acc: 0.6818
Epoch 20/34
----------
train Loss: 1.2750 Acc: 0.9330
val Loss: 1.4599 Acc: 0.6818
Epoch 21/34
----------
train Loss: 1.3036 Acc: 0.8947
val Loss: 1.3788 Acc: 0.6818
Epoch 22/34
----------
train Loss: 1.4214 Acc: 0.9091
val Loss: 1.4304 Acc: 0.6591
Epoch 23/34
----------
train Loss: 1.0739 Acc: 0.9234
val Loss: 1.2767 Acc: 0.6818
Epoch 24/34
----------
train Loss: 1.1613 Acc: 0.9282
val Loss: 1.3523 Acc: 0.7273
Epoch 25/34
----------
train Loss: 1.5430 Acc: 0.8947
val Loss: 1.7248 Acc: 0.6591
Epoch 26/34
----------
train Loss: 1.7825 Acc: 0.7081
val Loss: 1.5145 Acc: 0.7500
Epoch 27/34
----------
train Loss: 1.3771 Acc: 0.8804
val Loss: 1.6076 Acc: 0.6364
Epoch 28/34
----------
train Loss: 1.4557 Acc: 0.8373
val Loss: 1.4887 Acc: 0.6818
Epoch 29/34
----------
train Loss: 1.4918 Acc: 0.7943
val Loss: 1.6447 Acc: 0.6818
Epoch 30/34
----------
train Loss: 1.4309 Acc: 0.8947
val Loss: 1.3565 Acc: 0.7045
Epoch 31/34
----------
train Loss: 1.1275 Acc: 0.9522
val Loss: 1.4101 Acc: 0.6818
Epoch 32/34
----------
train Loss: 1.4899 Acc: 0.8660
val Loss: 1.2891 Acc: 0.7500
Epoch 33/34
----------
train Loss: 1.4386 Acc: 0.7656
val Loss: 1.4214 Acc: 0.7273
Epoch 34/34
----------
train Loss: 1.4024 Acc: 0.8469
val Loss: 1.4888 Acc: 0.7273
Best val Acc: 0.727273

Model weights saved at ./model_weights/vitbase16_bs_69_lr_6e-05_epoch_34_wd_0.0855_wlf_True.pth

Evaluating on the test set...
Evaluation Metrics:
Accuracy: 0.6739
AUC: 0.8291
Precision: 0.7188
Recall: 0.5150
F1-score: 0.5397

Confusion Matrix:
 [[ 3  5  0  4]
 [ 0 24  0  1]
 [ 0  0  3  2]
 [ 0  3  0  1]]

Classification Report:
               precision    recall  f1-score   support

           0       1.00      0.25      0.40        12
           1       0.75      0.96      0.84        25
           2       1.00      0.60      0.75         5
           3       0.12      0.25      0.17         4

    accuracy                           0.67        46
   macro avg       0.72      0.52      0.54        46
weighted avg       0.79      0.67      0.66        46

