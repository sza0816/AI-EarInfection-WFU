Training resnet34 on auto_selected frames

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/98
----------
train Loss: 1.2769 Acc: 0.4354
val Loss: 1.3321 Acc: 0.5000
Epoch 2/98
----------
train Loss: 0.4766 Acc: 0.8230
val Loss: 3.5838 Acc: 0.5000
Epoch 3/98
----------
train Loss: 0.2572 Acc: 0.9330
val Loss: 1.5416 Acc: 0.6818
Epoch 4/98
----------
train Loss: 0.2271 Acc: 0.9330
val Loss: 2.3914 Acc: 0.5000
Epoch 5/98
----------
train Loss: 0.3213 Acc: 0.9187
val Loss: 2.0757 Acc: 0.5455
Epoch 6/98
----------
train Loss: 0.2307 Acc: 0.9187
val Loss: 1.0243 Acc: 0.6591
Epoch 7/98
----------
train Loss: 0.3021 Acc: 0.8947
val Loss: 3.8284 Acc: 0.5682
Epoch 8/98
----------
train Loss: 0.5393 Acc: 0.8373
val Loss: 0.9784 Acc: 0.6136
Epoch 9/98
----------
train Loss: 0.4938 Acc: 0.8565
val Loss: 1.7274 Acc: 0.6136
Epoch 10/98
----------
train Loss: 0.3556 Acc: 0.8852
val Loss: 1.9862 Acc: 0.4545
Epoch 11/98
----------
train Loss: 0.2820 Acc: 0.9043
val Loss: 1.0191 Acc: 0.7500
Epoch 12/98
----------
train Loss: 0.3269 Acc: 0.8660
val Loss: 2.0871 Acc: 0.4318
Epoch 13/98
----------
train Loss: 0.2882 Acc: 0.8995
val Loss: 0.7281 Acc: 0.7273
Epoch 14/98
----------
train Loss: 0.1837 Acc: 0.9522
val Loss: 1.1640 Acc: 0.5000
Epoch 15/98
----------
train Loss: 0.1164 Acc: 0.9617
val Loss: 0.9570 Acc: 0.6136
Epoch 16/98
----------
train Loss: 0.2275 Acc: 0.9378
val Loss: 1.8480 Acc: 0.5909
Epoch 17/98
----------
train Loss: 0.5018 Acc: 0.8421
val Loss: 1.0338 Acc: 0.6591
Epoch 18/98
----------
train Loss: 0.4015 Acc: 0.8612
val Loss: 1.1019 Acc: 0.7045
Epoch 19/98
----------
train Loss: 0.3111 Acc: 0.8995
val Loss: 3.2714 Acc: 0.3636
Epoch 20/98
----------
train Loss: 0.2768 Acc: 0.9091
val Loss: 4.8325 Acc: 0.6364
Epoch 21/98
----------
train Loss: 0.5291 Acc: 0.8134
val Loss: 1.0855 Acc: 0.5909
Epoch 22/98
----------
train Loss: 0.3606 Acc: 0.8852
val Loss: 1.0075 Acc: 0.6136
Epoch 23/98
----------
train Loss: 0.3037 Acc: 0.9091
val Loss: 1.1509 Acc: 0.6364
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.704545

Model weights saved at ./model_weights/resnet34_bs_47_lr_0.00045_epoch_98_wd_0.068_wlf_False.pth

Evaluating on the test set...
Evaluation Metrics:
Accuracy: 0.6522
AUC: 0.7524
Precision: 0.4557
Recall: 0.4525
F1-score: 0.4057

Confusion Matrix:
 [[ 3  5  4  0]
 [ 0 24  1  0]
 [ 1  0  3  1]
 [ 0  1  3  0]]

Classification Report:
               precision    recall  f1-score   support

           0       0.75      0.25      0.38        12
           1       0.80      0.96      0.87        25
           2       0.27      0.60      0.38         5
           3       0.00      0.00      0.00         4

    accuracy                           0.65        46
   macro avg       0.46      0.45      0.41        46
weighted avg       0.66      0.65      0.61        46

