Training vitbase16 on human_selected frames

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/50
----------
train Loss: 1.3821 Acc: 0.4641
val Loss: 1.0751 Acc: 0.6136
Epoch 2/50
----------
train Loss: 0.8532 Acc: 0.7368
val Loss: 0.8893 Acc: 0.6591
Epoch 3/50
----------
train Loss: 0.5605 Acc: 0.8517
val Loss: 0.8160 Acc: 0.6136
Epoch 4/50
----------
train Loss: 0.3343 Acc: 0.9617
val Loss: 0.7169 Acc: 0.7273
Epoch 5/50
----------
train Loss: 0.1783 Acc: 0.9952
val Loss: 0.6916 Acc: 0.7045
Epoch 6/50
----------
train Loss: 0.0910 Acc: 1.0000
val Loss: 0.6866 Acc: 0.7273
Epoch 7/50
----------
train Loss: 0.0534 Acc: 1.0000
val Loss: 0.6469 Acc: 0.7273
Epoch 8/50
----------
train Loss: 0.0338 Acc: 1.0000
val Loss: 0.6529 Acc: 0.7273
Epoch 9/50
----------
train Loss: 0.0240 Acc: 1.0000
val Loss: 0.6595 Acc: 0.7273
Epoch 10/50
----------
train Loss: 0.0193 Acc: 1.0000
val Loss: 0.6632 Acc: 0.7273
Epoch 11/50
----------
train Loss: 0.0164 Acc: 1.0000
val Loss: 0.6876 Acc: 0.7273
Epoch 12/50
----------
train Loss: 0.0144 Acc: 1.0000
val Loss: 0.6953 Acc: 0.7273
Epoch 13/50
----------
train Loss: 0.0133 Acc: 1.0000
val Loss: 0.7010 Acc: 0.7273
Epoch 14/50
----------
train Loss: 0.0124 Acc: 1.0000
val Loss: 0.7026 Acc: 0.7273
Epoch 15/50
----------
train Loss: 0.0117 Acc: 1.0000
val Loss: 0.7064 Acc: 0.7273
Epoch 16/50
----------
train Loss: 0.0110 Acc: 1.0000
val Loss: 0.7127 Acc: 0.7273
Epoch 17/50
----------
train Loss: 0.0103 Acc: 1.0000
val Loss: 0.7203 Acc: 0.7273
Epoch 18/50
----------
train Loss: 0.0098 Acc: 1.0000
val Loss: 0.7242 Acc: 0.7273
Epoch 19/50
----------
train Loss: 0.0093 Acc: 1.0000
val Loss: 0.7323 Acc: 0.7273
Epoch 20/50
----------
train Loss: 0.0086 Acc: 1.0000
val Loss: 0.7372 Acc: 0.7273
Epoch 21/50
----------
train Loss: 0.0082 Acc: 1.0000
val Loss: 0.7439 Acc: 0.7273
Epoch 22/50
----------
train Loss: 0.0077 Acc: 1.0000
val Loss: 0.7592 Acc: 0.7273
Epoch 23/50
----------
train Loss: 0.0072 Acc: 1.0000
val Loss: 0.7633 Acc: 0.7273
Epoch 24/50
----------
train Loss: 0.0068 Acc: 1.0000
val Loss: 0.7764 Acc: 0.7273
Epoch 25/50
----------
train Loss: 0.0064 Acc: 1.0000
val Loss: 0.7832 Acc: 0.7273
Epoch 26/50
----------
train Loss: 0.0061 Acc: 1.0000
val Loss: 0.8006 Acc: 0.7273
Epoch 27/50
----------
train Loss: 0.0058 Acc: 1.0000
val Loss: 0.8096 Acc: 0.7273
Epoch 28/50
----------
train Loss: 0.0054 Acc: 1.0000
val Loss: 0.8196 Acc: 0.7273
Epoch 29/50
----------
train Loss: 0.0052 Acc: 1.0000
val Loss: 0.8283 Acc: 0.7273
Epoch 30/50
----------
train Loss: 0.0051 Acc: 1.0000
val Loss: 0.8423 Acc: 0.7273
Epoch 31/50
----------
train Loss: 0.0049 Acc: 1.0000
val Loss: 0.8639 Acc: 0.7045
Epoch 32/50
----------
train Loss: 0.0045 Acc: 1.0000
val Loss: 0.8596 Acc: 0.7273
Epoch 33/50
----------
train Loss: 0.0042 Acc: 1.0000
val Loss: 0.8918 Acc: 0.7045
Epoch 34/50
----------
train Loss: 0.0040 Acc: 1.0000
val Loss: 0.8897 Acc: 0.7273
Epoch 35/50
----------
train Loss: 0.0038 Acc: 1.0000
val Loss: 0.9015 Acc: 0.7045
Epoch 36/50
----------
train Loss: 0.0036 Acc: 1.0000
val Loss: 0.9068 Acc: 0.7045
Epoch 37/50
----------
train Loss: 0.0035 Acc: 1.0000
val Loss: 0.9133 Acc: 0.7500
Epoch 38/50
----------
train Loss: 0.0034 Acc: 1.0000
val Loss: 0.9155 Acc: 0.7273
Epoch 39/50
----------
train Loss: 0.0033 Acc: 1.0000
val Loss: 0.9267 Acc: 0.7273
Epoch 40/50
----------
train Loss: 0.0031 Acc: 1.0000
val Loss: 0.9286 Acc: 0.7045
Epoch 41/50
----------
train Loss: 0.0029 Acc: 1.0000
val Loss: 0.9421 Acc: 0.7273
Epoch 42/50
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 0.9640 Acc: 0.7273
Epoch 43/50
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 0.9370 Acc: 0.7273
Epoch 44/50
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 0.9359 Acc: 0.7045
Epoch 45/50
----------
train Loss: 0.0026 Acc: 1.0000
val Loss: 0.9605 Acc: 0.7273
Epoch 46/50
----------
train Loss: 0.0025 Acc: 1.0000
val Loss: 0.9631 Acc: 0.7500
Epoch 47/50
----------
train Loss: 0.0027 Acc: 1.0000
val Loss: 1.0141 Acc: 0.7273
Epoch 48/50
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 1.0392 Acc: 0.7273
Epoch 49/50
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 1.0072 Acc: 0.7273
Epoch 50/50
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 0.9572 Acc: 0.7727
Best val Acc: 0.772727

Model weights saved at ./model_weights/vitbase16_bs_60_lr_3e-05_epoch_50_wd_0.01_wlf_False.pth

Evaluating on the test set...
Evaluation Metrics:
Accuracy: 0.6522
AUC: 0.8515
Precision: 0.4917
Recall: 0.4942
F1-score: 0.4670

Confusion Matrix:
 [[ 2  5  3  2]
 [ 0 24  0  1]
 [ 0  0  3  2]
 [ 2  1  0  1]]

Classification Report:
               precision    recall  f1-score   support

           0       0.50      0.17      0.25        12
           1       0.80      0.96      0.87        25
           2       0.50      0.60      0.55         5
           3       0.17      0.25      0.20         4

    accuracy                           0.65        46
   macro avg       0.49      0.49      0.47        46
weighted avg       0.63      0.65      0.62        46

