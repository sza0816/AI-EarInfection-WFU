Training resnet34 on human_selected frames

Classes with more than 35 images: ['Tympanosclerosis', 'Effusion', 'Normal', 'Perforation']
Old to New Class Index Mapping: {0: 0, 1: 1, 2: 2, 3: 3}
Number of samples after filtering and remapping: 299
New class-to-index mapping: {'Effusion': 0, 'Normal': 1, 'Perforation': 2, 'Tympanosclerosis': 3}

Data splitted successfully: 

Number of training images: 209
Number of validation images: 44
Number of test images: 46

Epoch 1/45
----------
train Loss: 1.2595 Acc: 0.5215
val Loss: 1.2091 Acc: 0.5909
Epoch 2/45
----------
train Loss: 0.5398 Acc: 0.7751
val Loss: 4.5380 Acc: 0.3636
Epoch 3/45
----------
train Loss: 0.2870 Acc: 0.8995
val Loss: 2.1030 Acc: 0.3636
Epoch 4/45
----------
train Loss: 0.1643 Acc: 0.9330
val Loss: 1.4732 Acc: 0.6364
Epoch 5/45
----------
train Loss: 0.1237 Acc: 0.9617
val Loss: 0.8535 Acc: 0.7273
Epoch 6/45
----------
train Loss: 0.1041 Acc: 0.9617
val Loss: 0.8299 Acc: 0.6591
Epoch 7/45
----------
train Loss: 0.0675 Acc: 0.9856
val Loss: 1.0760 Acc: 0.7045
Epoch 8/45
----------
train Loss: 0.0949 Acc: 0.9617
val Loss: 2.0390 Acc: 0.4091
Epoch 9/45
----------
train Loss: 0.1297 Acc: 0.9569
val Loss: 1.8255 Acc: 0.6364
Epoch 10/45
----------
train Loss: 0.1200 Acc: 0.9665
val Loss: 1.1869 Acc: 0.7045
Epoch 11/45
----------
train Loss: 0.1808 Acc: 0.9330
val Loss: 0.7598 Acc: 0.7273
Epoch 12/45
----------
train Loss: 0.1939 Acc: 0.9378
val Loss: 1.4316 Acc: 0.7045
Epoch 13/45
----------
train Loss: 0.2156 Acc: 0.9330
val Loss: 1.3500 Acc: 0.6591
Epoch 14/45
----------
train Loss: 0.1634 Acc: 0.9522
val Loss: 1.2383 Acc: 0.5455
Epoch 15/45
----------
train Loss: 0.0757 Acc: 0.9809
val Loss: 0.9238 Acc: 0.7273
Epoch 16/45
----------
train Loss: 0.0375 Acc: 0.9904
val Loss: 1.0664 Acc: 0.7500
Epoch 17/45
----------
train Loss: 0.0490 Acc: 0.9856
val Loss: 1.4536 Acc: 0.6136
Epoch 18/45
----------
train Loss: 0.1251 Acc: 0.9665
val Loss: 1.2983 Acc: 0.6364
Epoch 19/45
----------
train Loss: 0.0560 Acc: 0.9809
val Loss: 1.6744 Acc: 0.6591
Epoch 20/45
----------
train Loss: 0.0505 Acc: 0.9761
val Loss: 1.5266 Acc: 0.6364
Epoch 21/45
----------
train Loss: 0.0440 Acc: 0.9904
val Loss: 1.7506 Acc: 0.6136
Early stopping at epoch 21 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.750000

Model weights saved at ./model_weights/resnet34_bs_49_lr_0.000418_epoch_45_wd_0.00285_wlf_False.pth

Evaluating on the test set...
Evaluation Metrics:
Accuracy: 0.6739
AUC: 0.8668
Precision: 0.5986
Recall: 0.6417
F1-score: 0.5905

Confusion Matrix:
 [[ 5  2  1  4]
 [ 2 20  1  2]
 [ 0  1  3  1]
 [ 1  0  0  3]]

Classification Report:
               precision    recall  f1-score   support

           0       0.62      0.42      0.50        12
           1       0.87      0.80      0.83        25
           2       0.60      0.60      0.60         5
           3       0.30      0.75      0.43         4

    accuracy                           0.67        46
   macro avg       0.60      0.64      0.59        46
weighted avg       0.73      0.67      0.69        46

